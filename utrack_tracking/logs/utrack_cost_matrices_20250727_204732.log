20:47:32.102 |     INFO |           get_logger | === COST_MATRICES MODULE LOGGING STARTED ===
20:47:32.102 |     INFO |           get_logger | Log file: /Users/george/.FLIKA/plugins/utrack_tracking/logs/utrack_cost_matrices_20250727_204732.log
20:47:32.102 |     INFO |           get_logger | Log level: DEBUG
20:47:32.102 |     INFO |           get_logger | Session ID: 20250727_204732
20:47:32.102 |    DEBUG |             __init__ | Initialized CostMatrixRandomDirectedSwitchingMotion
20:47:32.102 |     INFO |             log_info | === ENHANCED U-TRACK COST MATRIX CALCULATOR INITIALIZED ===
20:47:32.102 |     INFO |             log_info | Full LAP framework with Kalman filtering and motion models (maintaining original class name)
20:47:32.102 |     INFO |             log_info | Enhanced implementation based on Jaqaman et al. 2008
20:47:32.596 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=0, prob_dim=2, num_features_frame1=52, num_features_frame2=53)
20:47:32.596 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:32.596 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:32.596 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:32.596 |     INFO |       log_parameters |   current_frame: 0
20:47:32.596 |     INFO |       log_parameters |   prob_dim: 2
20:47:32.596 |     INFO |       log_parameters |   num_features_frame1: 52
20:47:32.596 |     INFO |       log_parameters |   num_features_frame2: 53
20:47:32.596 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:32.596 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:32.596 |     INFO |       log_parameters |   linear_motion: 1
20:47:32.596 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:32.596 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:32.596 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:32.596 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:32.596 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:32.596 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:32.596 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:32.596 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:32.596 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:32.596 |     INFO |       log_parameters |   use_local_density: 0
20:47:32.596 |     INFO |       log_parameters |   nn_window: 5
20:47:32.596 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:32.596 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:32.596 |     INFO |       log_parameters |   len_for_classify: 5
20:47:32.596 |     INFO |       log_parameters |   res_limit: 0.1
20:47:32.596 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:32.596 |     INFO |       log_parameters |   strategy_bd: -1
20:47:32.597 |     INFO |       log_parameters |   lft_cdf: None
20:47:32.597 |     INFO |       log_parameters |   kalman_init_param: None
20:47:32.597 |     INFO |       log_parameters |   diagnostics: None
20:47:32.597 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:32.597 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:32.597 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:32.597 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:32.597 |     INFO |       log_parameters |   coords_shape: (52, 2)
20:47:32.597 |     INFO |       log_parameters |   uncertainties_shape: (52, 2)
20:47:32.597 |     INFO |       log_parameters |   mean_uncertainty: 0.3002239519230769
20:47:32.597 |     INFO |       log_parameters |   uncertainty_range: [0.217207, 0.358885]
20:47:32.597 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:32.597 |     INFO |       log_parameters |   coords_shape: (53, 2)
20:47:32.597 |     INFO |       log_parameters |   uncertainties_shape: (53, 2)
20:47:32.597 |     INFO |       log_parameters |   mean_uncertainty: 0.3014392075471698
20:47:32.597 |     INFO |       log_parameters |   uncertainty_range: [0.219737, 0.353152]
20:47:32.597 |    DEBUG |            log_debug | Initializing Kalman for 53 features, prob_dim=2, state_dim=4
20:47:32.597 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:32.597 |     INFO |       log_parameters |   num_features: 53
20:47:32.597 |     INFO |       log_parameters |   state_dim: 4
20:47:32.597 |     INFO |       log_parameters |   prob_dim: 2
20:47:32.597 |     INFO |       log_parameters |   state_vec_shape: (53, 4)
20:47:32.597 |     INFO |       log_parameters |   state_noise_var_shape: (53, 4, 4)
20:47:32.597 |    DEBUG |            log_debug | State vector shape: (52, 4), Expected: (52, 4)
20:47:32.597 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:32.597 |     INFO |       log_parameters |   num_features_predicted: 52
20:47:32.597 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:32.597 |     INFO |       log_parameters |   brownian_motion_features: 52
20:47:32.597 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:32.597 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:32.597 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:32.597 |     INFO |       log_parameters |   search_radii_shape: (52, 2)
20:47:32.597 |     INFO |       log_parameters |   min_radius: 0.1
20:47:32.597 |     INFO |       log_parameters |   max_radius: 0.1
20:47:32.598 |     INFO |       log_parameters |   mean_radius: 0.1
20:47:32.598 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:32.598 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.1
20:47:32.598 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:32.598 |     INFO |       log_parameters |   distance_matrix_shape: (52, 53)
20:47:32.598 |     INFO |       log_parameters |   cost_matrix_shape: (52, 53)
20:47:32.598 |     INFO |       log_parameters |   finite_costs: 2756
20:47:32.598 |     INFO |       log_parameters |   infinite_costs: 0
20:47:32.598 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:32.598 |     INFO |       log_parameters |   min_distance: 5.958119963876273
20:47:32.598 |     INFO |       log_parameters |   max_distance: 130.61555520751145
20:47:32.598 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:32.598 |     INFO |       log_parameters |   motion_costs_shape: (52, 53)
20:47:32.598 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:32.598 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:32.598 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:32.598 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:32.598 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:32.600 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:32.600 |     INFO |       log_parameters |   coords_shape: (52, 2)
20:47:32.600 |     INFO |       log_parameters |   uncertainties_shape: (52, 2)
20:47:32.600 |     INFO |       log_parameters |   mean_uncertainty: 0.3002239519230769
20:47:32.600 |     INFO |       log_parameters |   uncertainty_range: [0.217207, 0.358885]
20:47:32.600 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:32.600 |     INFO |       log_parameters |   coords_shape: (53, 2)
20:47:32.600 |     INFO |       log_parameters |   uncertainties_shape: (53, 2)
20:47:32.600 |     INFO |       log_parameters |   mean_uncertainty: 0.3014392075471698
20:47:32.600 |     INFO |       log_parameters |   uncertainty_range: [0.219737, 0.353152]
20:47:32.600 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:32.600 |     INFO |       log_parameters |   feature_costs_shape: (52, 53)
20:47:32.600 |     INFO |       log_parameters |   feature_costs_min: 1.000017246901336
20:47:32.600 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:32.600 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:32.600 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:32.600 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:32.600 |     INFO |       log_parameters |   original_shape: (52, 53)
20:47:32.600 |     INFO |       log_parameters |   augmented_shape: (105, 105)
20:47:32.600 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:32.600 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:32.600 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:32.600 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:32.600 |    DEBUG |            log_debug |   observed_positions.shape: (53, 2)
20:47:32.600 |    DEBUG |            log_debug |   num_features (from observed_positions): 53
20:47:32.600 |    DEBUG |            log_debug |   predicted_positions.shape: (52, 2)
20:47:32.600 |    DEBUG |            log_debug |   predicted_velocities.shape: (52, 2)
20:47:32.600 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (53, 4)
20:47:32.600 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=53 but predicted_positions has 52 rows
20:47:32.600 |    ERROR |            log_error |   This will cause index 52 to fail when array only goes to 51
20:47:32.600 |    DEBUG |            log_debug | Kalman update: 53 features, state_dim=4, prob_dim=2
20:47:32.601 |    ERROR |            log_error | Error in enhanced linking: index 52 is out of bounds for axis 0 with size 52
20:47:32.601 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 52 is out of bounds for axis 0 with size 52
20:47:32.603 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0071 seconds
20:47:32.613 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=1, prob_dim=2, num_features_frame1=53, num_features_frame2=49)
20:47:32.613 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:32.613 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:32.613 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:32.613 |     INFO |       log_parameters |   current_frame: 1
20:47:32.613 |     INFO |       log_parameters |   prob_dim: 2
20:47:32.613 |     INFO |       log_parameters |   num_features_frame1: 53
20:47:32.613 |     INFO |       log_parameters |   num_features_frame2: 49
20:47:32.613 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:32.613 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:32.613 |     INFO |       log_parameters |   linear_motion: 1
20:47:32.613 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:32.613 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:32.613 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:32.613 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:32.613 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:32.613 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:32.613 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:32.613 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:32.613 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:32.613 |     INFO |       log_parameters |   use_local_density: 0
20:47:32.613 |     INFO |       log_parameters |   nn_window: 5
20:47:32.613 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:32.613 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:32.613 |     INFO |       log_parameters |   len_for_classify: 5
20:47:32.613 |     INFO |       log_parameters |   res_limit: 0.1
20:47:32.613 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:32.613 |     INFO |       log_parameters |   strategy_bd: -1
20:47:32.613 |     INFO |       log_parameters |   lft_cdf: None
20:47:32.613 |     INFO |       log_parameters |   kalman_init_param: None
20:47:32.613 |     INFO |       log_parameters |   diagnostics: None
20:47:32.613 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:32.613 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:32.613 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:32.613 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:32.613 |     INFO |       log_parameters |   coords_shape: (53, 2)
20:47:32.613 |     INFO |       log_parameters |   uncertainties_shape: (53, 2)
20:47:32.613 |     INFO |       log_parameters |   mean_uncertainty: 0.3014392075471698
20:47:32.613 |     INFO |       log_parameters |   uncertainty_range: [0.219737, 0.353152]
20:47:32.613 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:32.613 |     INFO |       log_parameters |   coords_shape: (49, 2)
20:47:32.613 |     INFO |       log_parameters |   uncertainties_shape: (49, 2)
20:47:32.613 |     INFO |       log_parameters |   mean_uncertainty: 0.30057010204081636
20:47:32.613 |     INFO |       log_parameters |   uncertainty_range: [0.218286, 0.354995]
20:47:32.613 |    DEBUG |            log_debug | Initializing Kalman for 49 features, prob_dim=2, state_dim=4
20:47:32.614 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:32.614 |     INFO |       log_parameters |   num_features: 49
20:47:32.614 |     INFO |       log_parameters |   state_dim: 4
20:47:32.614 |     INFO |       log_parameters |   prob_dim: 2
20:47:32.614 |     INFO |       log_parameters |   state_vec_shape: (49, 4)
20:47:32.614 |     INFO |       log_parameters |   state_noise_var_shape: (49, 4, 4)
20:47:32.614 |    DEBUG |            log_debug | State vector shape: (53, 4), Expected: (53, 4)
20:47:32.614 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:32.614 |     INFO |       log_parameters |   num_features_predicted: 53
20:47:32.614 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:32.614 |     INFO |       log_parameters |   brownian_motion_features: 53
20:47:32.614 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:32.614 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:32.614 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:32.614 |     INFO |       log_parameters |   search_radii_shape: (53, 2)
20:47:32.614 |     INFO |       log_parameters |   min_radius: 0.1
20:47:32.614 |     INFO |       log_parameters |   max_radius: 0.1
20:47:32.614 |     INFO |       log_parameters |   mean_radius: 0.09999999999999999
20:47:32.614 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:32.614 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999999
20:47:32.615 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:32.615 |     INFO |       log_parameters |   distance_matrix_shape: (53, 49)
20:47:32.615 |     INFO |       log_parameters |   cost_matrix_shape: (53, 49)
20:47:32.615 |     INFO |       log_parameters |   finite_costs: 2597
20:47:32.615 |     INFO |       log_parameters |   infinite_costs: 0
20:47:32.615 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:32.615 |     INFO |       log_parameters |   min_distance: 4.502361717335137
20:47:32.615 |     INFO |       log_parameters |   max_distance: 130.66904722946543
20:47:32.615 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:32.615 |     INFO |       log_parameters |   motion_costs_shape: (53, 49)
20:47:32.615 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:32.615 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:32.615 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:32.615 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:32.615 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:32.616 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:32.616 |     INFO |       log_parameters |   coords_shape: (53, 2)
20:47:32.616 |     INFO |       log_parameters |   uncertainties_shape: (53, 2)
20:47:32.616 |     INFO |       log_parameters |   mean_uncertainty: 0.3014392075471698
20:47:32.616 |     INFO |       log_parameters |   uncertainty_range: [0.219737, 0.353152]
20:47:32.616 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:32.616 |     INFO |       log_parameters |   coords_shape: (49, 2)
20:47:32.616 |     INFO |       log_parameters |   uncertainties_shape: (49, 2)
20:47:32.617 |     INFO |       log_parameters |   mean_uncertainty: 0.30057010204081636
20:47:32.617 |     INFO |       log_parameters |   uncertainty_range: [0.218286, 0.354995]
20:47:32.617 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:32.617 |     INFO |       log_parameters |   feature_costs_shape: (53, 49)
20:47:32.617 |     INFO |       log_parameters |   feature_costs_min: 1.0001756340704562
20:47:32.617 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:32.617 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:32.617 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:32.617 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:32.617 |     INFO |       log_parameters |   original_shape: (53, 49)
20:47:32.617 |     INFO |       log_parameters |   augmented_shape: (102, 102)
20:47:32.617 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:32.617 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:32.617 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:32.617 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:32.617 |    DEBUG |            log_debug |   observed_positions.shape: (49, 2)
20:47:32.617 |    DEBUG |            log_debug |   num_features (from observed_positions): 49
20:47:32.617 |    DEBUG |            log_debug |   predicted_positions.shape: (53, 2)
20:47:32.617 |    DEBUG |            log_debug |   predicted_velocities.shape: (53, 2)
20:47:32.617 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (49, 4)
20:47:32.617 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=49 but predicted_positions has 53 rows
20:47:32.617 |    ERROR |            log_error |   This will cause index 48 to fail when array only goes to 52
20:47:32.617 |    DEBUG |            log_debug | Kalman update: 49 features, state_dim=4, prob_dim=2
20:47:32.618 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman update):
20:47:32.618 |     INFO |       log_parameters |   features_updated: 49
20:47:32.618 |     INFO |       log_parameters |   state_dim: 4
20:47:32.618 |     INFO |       log_parameters |   dt_used: 1.0
20:47:32.618 |     INFO |       log_parameters |   process_noise_scale: 1.0
20:47:32.618 |     INFO |       log_parameters |   measurement_noise_scale: 1.0
20:47:32.618 |     INFO |             log_info | Enhanced linking completed successfully for frame 1
20:47:32.618 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0048 seconds
20:47:32.800 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=2, prob_dim=2, num_features_frame1=49, num_features_frame2=53)
20:47:32.800 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:32.800 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:32.800 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:32.800 |     INFO |       log_parameters |   current_frame: 2
20:47:32.800 |     INFO |       log_parameters |   prob_dim: 2
20:47:32.800 |     INFO |       log_parameters |   num_features_frame1: 49
20:47:32.800 |     INFO |       log_parameters |   num_features_frame2: 53
20:47:32.800 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:32.800 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:32.800 |     INFO |       log_parameters |   linear_motion: 1
20:47:32.800 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:32.800 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:32.800 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:32.800 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:32.800 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:32.800 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:32.800 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:32.800 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:32.800 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:32.800 |     INFO |       log_parameters |   use_local_density: 0
20:47:32.800 |     INFO |       log_parameters |   nn_window: 5
20:47:32.801 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:32.801 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:32.801 |     INFO |       log_parameters |   len_for_classify: 5
20:47:32.801 |     INFO |       log_parameters |   res_limit: 0.1
20:47:32.801 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:32.801 |     INFO |       log_parameters |   strategy_bd: -1
20:47:32.801 |     INFO |       log_parameters |   lft_cdf: None
20:47:32.801 |     INFO |       log_parameters |   kalman_init_param: None
20:47:32.801 |     INFO |       log_parameters |   diagnostics: None
20:47:32.801 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:32.801 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:32.801 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:32.801 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:32.801 |     INFO |       log_parameters |   coords_shape: (49, 2)
20:47:32.801 |     INFO |       log_parameters |   uncertainties_shape: (49, 2)
20:47:32.801 |     INFO |       log_parameters |   mean_uncertainty: 0.30057010204081636
20:47:32.801 |     INFO |       log_parameters |   uncertainty_range: [0.218286, 0.354995]
20:47:32.801 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:32.801 |     INFO |       log_parameters |   coords_shape: (53, 2)
20:47:32.801 |     INFO |       log_parameters |   uncertainties_shape: (53, 2)
20:47:32.801 |     INFO |       log_parameters |   mean_uncertainty: 0.30301145283018877
20:47:32.801 |     INFO |       log_parameters |   uncertainty_range: [0.21909, 0.352375]
20:47:32.801 |    DEBUG |            log_debug | Initializing Kalman for 53 features, prob_dim=2, state_dim=4
20:47:32.801 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:32.801 |     INFO |       log_parameters |   num_features: 53
20:47:32.801 |     INFO |       log_parameters |   state_dim: 4
20:47:32.801 |     INFO |       log_parameters |   prob_dim: 2
20:47:32.801 |     INFO |       log_parameters |   state_vec_shape: (53, 4)
20:47:32.801 |     INFO |       log_parameters |   state_noise_var_shape: (53, 4, 4)
20:47:32.801 |    DEBUG |            log_debug | State vector shape: (49, 4), Expected: (49, 4)
20:47:32.801 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:32.801 |     INFO |       log_parameters |   num_features_predicted: 49
20:47:32.801 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:32.801 |     INFO |       log_parameters |   brownian_motion_features: 49
20:47:32.801 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:32.801 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:32.801 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:32.801 |     INFO |       log_parameters |   search_radii_shape: (49, 2)
20:47:32.801 |     INFO |       log_parameters |   min_radius: 0.1
20:47:32.801 |     INFO |       log_parameters |   max_radius: 0.1
20:47:32.801 |     INFO |       log_parameters |   mean_radius: 0.09999999999999999
20:47:32.801 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:32.801 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999999
20:47:32.802 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:32.802 |     INFO |       log_parameters |   distance_matrix_shape: (49, 53)
20:47:32.802 |     INFO |       log_parameters |   cost_matrix_shape: (49, 53)
20:47:32.802 |     INFO |       log_parameters |   finite_costs: 2597
20:47:32.802 |     INFO |       log_parameters |   infinite_costs: 0
20:47:32.802 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:32.802 |     INFO |       log_parameters |   min_distance: 5.016032547412148
20:47:32.802 |     INFO |       log_parameters |   max_distance: 131.51169786532873
20:47:32.802 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:32.802 |     INFO |       log_parameters |   motion_costs_shape: (49, 53)
20:47:32.802 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:32.802 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:32.802 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:32.802 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:32.802 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:32.804 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:32.804 |     INFO |       log_parameters |   coords_shape: (49, 2)
20:47:32.804 |     INFO |       log_parameters |   uncertainties_shape: (49, 2)
20:47:32.804 |     INFO |       log_parameters |   mean_uncertainty: 0.30057010204081636
20:47:32.804 |     INFO |       log_parameters |   uncertainty_range: [0.218286, 0.354995]
20:47:32.804 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:32.804 |     INFO |       log_parameters |   coords_shape: (53, 2)
20:47:32.804 |     INFO |       log_parameters |   uncertainties_shape: (53, 2)
20:47:32.804 |     INFO |       log_parameters |   mean_uncertainty: 0.30301145283018877
20:47:32.804 |     INFO |       log_parameters |   uncertainty_range: [0.21909, 0.352375]
20:47:32.804 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:32.804 |     INFO |       log_parameters |   feature_costs_shape: (49, 53)
20:47:32.804 |     INFO |       log_parameters |   feature_costs_min: 1.000033111680084
20:47:32.804 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:32.804 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:32.804 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:32.804 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:32.804 |     INFO |       log_parameters |   original_shape: (49, 53)
20:47:32.804 |     INFO |       log_parameters |   augmented_shape: (102, 102)
20:47:32.804 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:32.804 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:32.804 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:32.804 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:32.804 |    DEBUG |            log_debug |   observed_positions.shape: (53, 2)
20:47:32.804 |    DEBUG |            log_debug |   num_features (from observed_positions): 53
20:47:32.804 |    DEBUG |            log_debug |   predicted_positions.shape: (49, 2)
20:47:32.804 |    DEBUG |            log_debug |   predicted_velocities.shape: (49, 2)
20:47:32.804 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (53, 4)
20:47:32.804 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=53 but predicted_positions has 49 rows
20:47:32.804 |    ERROR |            log_error |   This will cause index 52 to fail when array only goes to 48
20:47:32.804 |    DEBUG |            log_debug | Kalman update: 53 features, state_dim=4, prob_dim=2
20:47:32.805 |    ERROR |            log_error | Error in enhanced linking: index 49 is out of bounds for axis 0 with size 49
20:47:32.805 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 49 is out of bounds for axis 0 with size 49
20:47:32.805 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0049 seconds
20:47:32.815 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=3, prob_dim=2, num_features_frame1=53, num_features_frame2=55)
20:47:32.815 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:32.815 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:32.815 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:32.815 |     INFO |       log_parameters |   current_frame: 3
20:47:32.815 |     INFO |       log_parameters |   prob_dim: 2
20:47:32.815 |     INFO |       log_parameters |   num_features_frame1: 53
20:47:32.815 |     INFO |       log_parameters |   num_features_frame2: 55
20:47:32.815 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:32.815 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:32.815 |     INFO |       log_parameters |   linear_motion: 1
20:47:32.815 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:32.815 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:32.815 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:32.815 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:32.815 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:32.815 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:32.815 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:32.815 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:32.815 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:32.815 |     INFO |       log_parameters |   use_local_density: 0
20:47:32.815 |     INFO |       log_parameters |   nn_window: 5
20:47:32.815 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:32.815 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:32.815 |     INFO |       log_parameters |   len_for_classify: 5
20:47:32.815 |     INFO |       log_parameters |   res_limit: 0.1
20:47:32.815 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:32.815 |     INFO |       log_parameters |   strategy_bd: -1
20:47:32.815 |     INFO |       log_parameters |   lft_cdf: None
20:47:32.815 |     INFO |       log_parameters |   kalman_init_param: None
20:47:32.815 |     INFO |       log_parameters |   diagnostics: None
20:47:32.815 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:32.815 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:32.815 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:32.815 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:32.815 |     INFO |       log_parameters |   coords_shape: (53, 2)
20:47:32.815 |     INFO |       log_parameters |   uncertainties_shape: (53, 2)
20:47:32.815 |     INFO |       log_parameters |   mean_uncertainty: 0.30301145283018877
20:47:32.815 |     INFO |       log_parameters |   uncertainty_range: [0.21909, 0.352375]
20:47:32.816 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:32.816 |     INFO |       log_parameters |   coords_shape: (55, 2)
20:47:32.816 |     INFO |       log_parameters |   uncertainties_shape: (55, 2)
20:47:32.816 |     INFO |       log_parameters |   mean_uncertainty: 0.3051617545454545
20:47:32.816 |     INFO |       log_parameters |   uncertainty_range: [0.216971, 0.352245]
20:47:32.816 |    DEBUG |            log_debug | Initializing Kalman for 55 features, prob_dim=2, state_dim=4
20:47:32.816 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:32.816 |     INFO |       log_parameters |   num_features: 55
20:47:32.816 |     INFO |       log_parameters |   state_dim: 4
20:47:32.816 |     INFO |       log_parameters |   prob_dim: 2
20:47:32.816 |     INFO |       log_parameters |   state_vec_shape: (55, 4)
20:47:32.816 |     INFO |       log_parameters |   state_noise_var_shape: (55, 4, 4)
20:47:32.816 |    DEBUG |            log_debug | State vector shape: (53, 4), Expected: (53, 4)
20:47:32.816 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:32.816 |     INFO |       log_parameters |   num_features_predicted: 53
20:47:32.816 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:32.816 |     INFO |       log_parameters |   brownian_motion_features: 53
20:47:32.816 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:32.816 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:32.816 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:32.816 |     INFO |       log_parameters |   search_radii_shape: (53, 2)
20:47:32.816 |     INFO |       log_parameters |   min_radius: 0.1
20:47:32.816 |     INFO |       log_parameters |   max_radius: 0.1
20:47:32.816 |     INFO |       log_parameters |   mean_radius: 0.09999999999999999
20:47:32.816 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:32.816 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999999
20:47:32.817 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:32.817 |     INFO |       log_parameters |   distance_matrix_shape: (53, 55)
20:47:32.817 |     INFO |       log_parameters |   cost_matrix_shape: (53, 55)
20:47:32.817 |     INFO |       log_parameters |   finite_costs: 2915
20:47:32.817 |     INFO |       log_parameters |   infinite_costs: 0
20:47:32.817 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:32.817 |     INFO |       log_parameters |   min_distance: 4.588514081514951
20:47:32.817 |     INFO |       log_parameters |   max_distance: 132.59421166742246
20:47:32.817 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:32.817 |     INFO |       log_parameters |   motion_costs_shape: (53, 55)
20:47:32.817 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:32.817 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:32.817 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:32.817 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:32.817 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:32.819 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:32.819 |     INFO |       log_parameters |   coords_shape: (53, 2)
20:47:32.819 |     INFO |       log_parameters |   uncertainties_shape: (53, 2)
20:47:32.819 |     INFO |       log_parameters |   mean_uncertainty: 0.30301145283018877
20:47:32.819 |     INFO |       log_parameters |   uncertainty_range: [0.21909, 0.352375]
20:47:32.819 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:32.819 |     INFO |       log_parameters |   coords_shape: (55, 2)
20:47:32.819 |     INFO |       log_parameters |   uncertainties_shape: (55, 2)
20:47:32.819 |     INFO |       log_parameters |   mean_uncertainty: 0.3051617545454545
20:47:32.819 |     INFO |       log_parameters |   uncertainty_range: [0.216971, 0.352245]
20:47:32.819 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:32.819 |     INFO |       log_parameters |   feature_costs_shape: (53, 55)
20:47:32.819 |     INFO |       log_parameters |   feature_costs_min: 1.0000861221362016
20:47:32.819 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:32.819 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:32.819 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:32.819 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:32.819 |     INFO |       log_parameters |   original_shape: (53, 55)
20:47:32.819 |     INFO |       log_parameters |   augmented_shape: (108, 108)
20:47:32.819 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:32.819 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:32.819 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:32.819 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:32.819 |    DEBUG |            log_debug |   observed_positions.shape: (55, 2)
20:47:32.819 |    DEBUG |            log_debug |   num_features (from observed_positions): 55
20:47:32.819 |    DEBUG |            log_debug |   predicted_positions.shape: (53, 2)
20:47:32.819 |    DEBUG |            log_debug |   predicted_velocities.shape: (53, 2)
20:47:32.819 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (55, 4)
20:47:32.819 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=55 but predicted_positions has 53 rows
20:47:32.819 |    ERROR |            log_error |   This will cause index 54 to fail when array only goes to 52
20:47:32.819 |    DEBUG |            log_debug | Kalman update: 55 features, state_dim=4, prob_dim=2
20:47:32.820 |    ERROR |            log_error | Error in enhanced linking: index 53 is out of bounds for axis 0 with size 53
20:47:32.820 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 53 is out of bounds for axis 0 with size 53
20:47:32.820 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0052 seconds
20:47:32.831 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=4, prob_dim=2, num_features_frame1=55, num_features_frame2=59)
20:47:32.831 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:32.831 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:32.831 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:32.831 |     INFO |       log_parameters |   current_frame: 4
20:47:32.831 |     INFO |       log_parameters |   prob_dim: 2
20:47:32.831 |     INFO |       log_parameters |   num_features_frame1: 55
20:47:32.831 |     INFO |       log_parameters |   num_features_frame2: 59
20:47:32.831 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:32.831 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:32.831 |     INFO |       log_parameters |   linear_motion: 1
20:47:32.831 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:32.831 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:32.831 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:32.831 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:32.831 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:32.831 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:32.831 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:32.831 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:32.831 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:32.831 |     INFO |       log_parameters |   use_local_density: 0
20:47:32.831 |     INFO |       log_parameters |   nn_window: 5
20:47:32.831 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:32.831 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:32.831 |     INFO |       log_parameters |   len_for_classify: 5
20:47:32.831 |     INFO |       log_parameters |   res_limit: 0.1
20:47:32.831 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:32.831 |     INFO |       log_parameters |   strategy_bd: -1
20:47:32.831 |     INFO |       log_parameters |   lft_cdf: None
20:47:32.831 |     INFO |       log_parameters |   kalman_init_param: None
20:47:32.831 |     INFO |       log_parameters |   diagnostics: None
20:47:32.831 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:32.831 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:32.831 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:32.831 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:32.831 |     INFO |       log_parameters |   coords_shape: (55, 2)
20:47:32.831 |     INFO |       log_parameters |   uncertainties_shape: (55, 2)
20:47:32.831 |     INFO |       log_parameters |   mean_uncertainty: 0.3051617545454545
20:47:32.831 |     INFO |       log_parameters |   uncertainty_range: [0.216971, 0.352245]
20:47:32.831 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:32.831 |     INFO |       log_parameters |   coords_shape: (59, 2)
20:47:32.831 |     INFO |       log_parameters |   uncertainties_shape: (59, 2)
20:47:32.831 |     INFO |       log_parameters |   mean_uncertainty: 0.3059918050847458
20:47:32.831 |     INFO |       log_parameters |   uncertainty_range: [0.194155, 0.356011]
20:47:32.831 |    DEBUG |            log_debug | Initializing Kalman for 59 features, prob_dim=2, state_dim=4
20:47:32.831 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:32.831 |     INFO |       log_parameters |   num_features: 59
20:47:32.831 |     INFO |       log_parameters |   state_dim: 4
20:47:32.831 |     INFO |       log_parameters |   prob_dim: 2
20:47:32.831 |     INFO |       log_parameters |   state_vec_shape: (59, 4)
20:47:32.831 |     INFO |       log_parameters |   state_noise_var_shape: (59, 4, 4)
20:47:32.831 |    DEBUG |            log_debug | State vector shape: (55, 4), Expected: (55, 4)
20:47:32.832 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:32.832 |     INFO |       log_parameters |   num_features_predicted: 55
20:47:32.832 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:32.832 |     INFO |       log_parameters |   brownian_motion_features: 55
20:47:32.832 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:32.832 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:32.832 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:32.832 |     INFO |       log_parameters |   search_radii_shape: (55, 2)
20:47:32.832 |     INFO |       log_parameters |   min_radius: 0.1
20:47:32.832 |     INFO |       log_parameters |   max_radius: 0.1
20:47:32.832 |     INFO |       log_parameters |   mean_radius: 0.09999999999999998
20:47:32.832 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:32.832 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999998
20:47:32.833 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:32.833 |     INFO |       log_parameters |   distance_matrix_shape: (55, 59)
20:47:32.833 |     INFO |       log_parameters |   cost_matrix_shape: (55, 59)
20:47:32.833 |     INFO |       log_parameters |   finite_costs: 3245
20:47:32.833 |     INFO |       log_parameters |   infinite_costs: 0
20:47:32.833 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:32.833 |     INFO |       log_parameters |   min_distance: 5.219965963723901
20:47:32.833 |     INFO |       log_parameters |   max_distance: 133.01870635276066
20:47:32.833 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:32.833 |     INFO |       log_parameters |   motion_costs_shape: (55, 59)
20:47:32.833 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:32.833 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:32.833 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:32.833 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:32.833 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:32.835 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:32.835 |     INFO |       log_parameters |   coords_shape: (55, 2)
20:47:32.835 |     INFO |       log_parameters |   uncertainties_shape: (55, 2)
20:47:32.835 |     INFO |       log_parameters |   mean_uncertainty: 0.3051617545454545
20:47:32.835 |     INFO |       log_parameters |   uncertainty_range: [0.216971, 0.352245]
20:47:32.835 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:32.835 |     INFO |       log_parameters |   coords_shape: (59, 2)
20:47:32.835 |     INFO |       log_parameters |   uncertainties_shape: (59, 2)
20:47:32.835 |     INFO |       log_parameters |   mean_uncertainty: 0.3059918050847458
20:47:32.835 |     INFO |       log_parameters |   uncertainty_range: [0.194155, 0.356011]
20:47:32.835 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:32.835 |     INFO |       log_parameters |   feature_costs_shape: (55, 59)
20:47:32.835 |     INFO |       log_parameters |   feature_costs_min: 1.000103027154156
20:47:32.835 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:32.835 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:32.835 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:32.835 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:32.835 |     INFO |       log_parameters |   original_shape: (55, 59)
20:47:32.835 |     INFO |       log_parameters |   augmented_shape: (114, 114)
20:47:32.835 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:32.835 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:32.835 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:32.835 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:32.835 |    DEBUG |            log_debug |   observed_positions.shape: (59, 2)
20:47:32.835 |    DEBUG |            log_debug |   num_features (from observed_positions): 59
20:47:32.835 |    DEBUG |            log_debug |   predicted_positions.shape: (55, 2)
20:47:32.835 |    DEBUG |            log_debug |   predicted_velocities.shape: (55, 2)
20:47:32.835 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (59, 4)
20:47:32.835 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=59 but predicted_positions has 55 rows
20:47:32.835 |    ERROR |            log_error |   This will cause index 58 to fail when array only goes to 54
20:47:32.835 |    DEBUG |            log_debug | Kalman update: 59 features, state_dim=4, prob_dim=2
20:47:32.836 |    ERROR |            log_error | Error in enhanced linking: index 55 is out of bounds for axis 0 with size 55
20:47:32.836 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 55 is out of bounds for axis 0 with size 55
20:47:32.836 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0056 seconds
20:47:32.846 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=5, prob_dim=2, num_features_frame1=59, num_features_frame2=47)
20:47:32.846 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:32.846 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:32.846 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:32.846 |     INFO |       log_parameters |   current_frame: 5
20:47:32.846 |     INFO |       log_parameters |   prob_dim: 2
20:47:32.846 |     INFO |       log_parameters |   num_features_frame1: 59
20:47:32.846 |     INFO |       log_parameters |   num_features_frame2: 47
20:47:32.846 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:32.846 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:32.846 |     INFO |       log_parameters |   linear_motion: 1
20:47:32.846 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:32.846 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:32.846 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:32.846 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:32.846 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:32.846 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:32.846 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:32.846 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:32.846 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:32.846 |     INFO |       log_parameters |   use_local_density: 0
20:47:32.846 |     INFO |       log_parameters |   nn_window: 5
20:47:32.846 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:32.846 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:32.847 |     INFO |       log_parameters |   len_for_classify: 5
20:47:32.847 |     INFO |       log_parameters |   res_limit: 0.1
20:47:32.847 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:32.847 |     INFO |       log_parameters |   strategy_bd: -1
20:47:32.847 |     INFO |       log_parameters |   lft_cdf: None
20:47:32.847 |     INFO |       log_parameters |   kalman_init_param: None
20:47:32.847 |     INFO |       log_parameters |   diagnostics: None
20:47:32.847 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:32.847 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:32.847 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:32.847 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:32.847 |     INFO |       log_parameters |   coords_shape: (59, 2)
20:47:32.847 |     INFO |       log_parameters |   uncertainties_shape: (59, 2)
20:47:32.847 |     INFO |       log_parameters |   mean_uncertainty: 0.3059918050847458
20:47:32.847 |     INFO |       log_parameters |   uncertainty_range: [0.194155, 0.356011]
20:47:32.847 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:32.847 |     INFO |       log_parameters |   coords_shape: (47, 2)
20:47:32.847 |     INFO |       log_parameters |   uncertainties_shape: (47, 2)
20:47:32.847 |     INFO |       log_parameters |   mean_uncertainty: 0.29801999999999995
20:47:32.847 |     INFO |       log_parameters |   uncertainty_range: [0.205575, 0.351175]
20:47:32.847 |    DEBUG |            log_debug | Initializing Kalman for 47 features, prob_dim=2, state_dim=4
20:47:32.847 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:32.847 |     INFO |       log_parameters |   num_features: 47
20:47:32.847 |     INFO |       log_parameters |   state_dim: 4
20:47:32.847 |     INFO |       log_parameters |   prob_dim: 2
20:47:32.847 |     INFO |       log_parameters |   state_vec_shape: (47, 4)
20:47:32.847 |     INFO |       log_parameters |   state_noise_var_shape: (47, 4, 4)
20:47:32.847 |    DEBUG |            log_debug | State vector shape: (59, 4), Expected: (59, 4)
20:47:32.847 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:32.847 |     INFO |       log_parameters |   num_features_predicted: 59
20:47:32.847 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:32.847 |     INFO |       log_parameters |   brownian_motion_features: 59
20:47:32.847 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:32.847 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:32.847 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:32.847 |     INFO |       log_parameters |   search_radii_shape: (59, 2)
20:47:32.847 |     INFO |       log_parameters |   min_radius: 0.1
20:47:32.847 |     INFO |       log_parameters |   max_radius: 0.1
20:47:32.848 |     INFO |       log_parameters |   mean_radius: 0.09999999999999999
20:47:32.848 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:32.848 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999999
20:47:32.848 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:32.848 |     INFO |       log_parameters |   distance_matrix_shape: (59, 47)
20:47:32.848 |     INFO |       log_parameters |   cost_matrix_shape: (59, 47)
20:47:32.848 |     INFO |       log_parameters |   finite_costs: 2773
20:47:32.848 |     INFO |       log_parameters |   infinite_costs: 0
20:47:32.848 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:32.848 |     INFO |       log_parameters |   min_distance: 3.850598398220853
20:47:32.848 |     INFO |       log_parameters |   max_distance: 132.91401495966716
20:47:32.848 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:32.848 |     INFO |       log_parameters |   motion_costs_shape: (59, 47)
20:47:32.848 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:32.848 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:32.848 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:32.848 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:32.848 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:32.850 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:32.850 |     INFO |       log_parameters |   coords_shape: (59, 2)
20:47:32.850 |     INFO |       log_parameters |   uncertainties_shape: (59, 2)
20:47:32.850 |     INFO |       log_parameters |   mean_uncertainty: 0.3059918050847458
20:47:32.850 |     INFO |       log_parameters |   uncertainty_range: [0.194155, 0.356011]
20:47:32.850 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:32.850 |     INFO |       log_parameters |   coords_shape: (47, 2)
20:47:32.850 |     INFO |       log_parameters |   uncertainties_shape: (47, 2)
20:47:32.850 |     INFO |       log_parameters |   mean_uncertainty: 0.29801999999999995
20:47:32.850 |     INFO |       log_parameters |   uncertainty_range: [0.205575, 0.351175]
20:47:32.850 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:32.850 |     INFO |       log_parameters |   feature_costs_shape: (59, 47)
20:47:32.850 |     INFO |       log_parameters |   feature_costs_min: 1.0000754747768972
20:47:32.850 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:32.850 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:32.850 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:32.850 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:32.850 |     INFO |       log_parameters |   original_shape: (59, 47)
20:47:32.850 |     INFO |       log_parameters |   augmented_shape: (106, 106)
20:47:32.850 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:32.850 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:32.850 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:32.850 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:32.850 |    DEBUG |            log_debug |   observed_positions.shape: (47, 2)
20:47:32.850 |    DEBUG |            log_debug |   num_features (from observed_positions): 47
20:47:32.850 |    DEBUG |            log_debug |   predicted_positions.shape: (59, 2)
20:47:32.850 |    DEBUG |            log_debug |   predicted_velocities.shape: (59, 2)
20:47:32.850 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (47, 4)
20:47:32.850 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=47 but predicted_positions has 59 rows
20:47:32.850 |    ERROR |            log_error |   This will cause index 46 to fail when array only goes to 58
20:47:32.850 |    DEBUG |            log_debug | Kalman update: 47 features, state_dim=4, prob_dim=2
20:47:32.851 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman update):
20:47:32.851 |     INFO |       log_parameters |   features_updated: 47
20:47:32.851 |     INFO |       log_parameters |   state_dim: 4
20:47:32.851 |     INFO |       log_parameters |   dt_used: 1.0
20:47:32.851 |     INFO |       log_parameters |   process_noise_scale: 1.0
20:47:32.851 |     INFO |       log_parameters |   measurement_noise_scale: 1.0
20:47:32.851 |     INFO |             log_info | Enhanced linking completed successfully for frame 5
20:47:32.851 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0049 seconds
20:47:33.030 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=6, prob_dim=2, num_features_frame1=47, num_features_frame2=52)
20:47:33.030 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:33.030 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:33.030 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:33.030 |     INFO |       log_parameters |   current_frame: 6
20:47:33.030 |     INFO |       log_parameters |   prob_dim: 2
20:47:33.030 |     INFO |       log_parameters |   num_features_frame1: 47
20:47:33.030 |     INFO |       log_parameters |   num_features_frame2: 52
20:47:33.030 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:33.030 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:33.030 |     INFO |       log_parameters |   linear_motion: 1
20:47:33.030 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:33.030 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:33.030 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:33.030 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:33.030 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:33.030 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:33.030 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:33.030 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:33.030 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:33.030 |     INFO |       log_parameters |   use_local_density: 0
20:47:33.030 |     INFO |       log_parameters |   nn_window: 5
20:47:33.030 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:33.030 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:33.030 |     INFO |       log_parameters |   len_for_classify: 5
20:47:33.030 |     INFO |       log_parameters |   res_limit: 0.1
20:47:33.030 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:33.030 |     INFO |       log_parameters |   strategy_bd: -1
20:47:33.030 |     INFO |       log_parameters |   lft_cdf: None
20:47:33.030 |     INFO |       log_parameters |   kalman_init_param: None
20:47:33.030 |     INFO |       log_parameters |   diagnostics: None
20:47:33.030 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:33.030 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:33.030 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:33.030 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:33.030 |     INFO |       log_parameters |   coords_shape: (47, 2)
20:47:33.030 |     INFO |       log_parameters |   uncertainties_shape: (47, 2)
20:47:33.030 |     INFO |       log_parameters |   mean_uncertainty: 0.29801999999999995
20:47:33.030 |     INFO |       log_parameters |   uncertainty_range: [0.205575, 0.351175]
20:47:33.030 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:33.030 |     INFO |       log_parameters |   coords_shape: (52, 2)
20:47:33.030 |     INFO |       log_parameters |   uncertainties_shape: (52, 2)
20:47:33.030 |     INFO |       log_parameters |   mean_uncertainty: 0.30353546153846156
20:47:33.030 |     INFO |       log_parameters |   uncertainty_range: [0.216362, 0.35451]
20:47:33.030 |    DEBUG |            log_debug | Initializing Kalman for 52 features, prob_dim=2, state_dim=4
20:47:33.030 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:33.030 |     INFO |       log_parameters |   num_features: 52
20:47:33.030 |     INFO |       log_parameters |   state_dim: 4
20:47:33.030 |     INFO |       log_parameters |   prob_dim: 2
20:47:33.030 |     INFO |       log_parameters |   state_vec_shape: (52, 4)
20:47:33.030 |     INFO |       log_parameters |   state_noise_var_shape: (52, 4, 4)
20:47:33.031 |    DEBUG |            log_debug | State vector shape: (47, 4), Expected: (47, 4)
20:47:33.031 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:33.031 |     INFO |       log_parameters |   num_features_predicted: 47
20:47:33.031 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:33.031 |     INFO |       log_parameters |   brownian_motion_features: 47
20:47:33.031 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:33.031 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:33.031 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:33.031 |     INFO |       log_parameters |   search_radii_shape: (47, 2)
20:47:33.031 |     INFO |       log_parameters |   min_radius: 0.1
20:47:33.031 |     INFO |       log_parameters |   max_radius: 0.1
20:47:33.031 |     INFO |       log_parameters |   mean_radius: 0.09999999999999996
20:47:33.031 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:33.031 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999996
20:47:33.032 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:33.032 |     INFO |       log_parameters |   distance_matrix_shape: (47, 52)
20:47:33.032 |     INFO |       log_parameters |   cost_matrix_shape: (47, 52)
20:47:33.032 |     INFO |       log_parameters |   finite_costs: 2444
20:47:33.032 |     INFO |       log_parameters |   infinite_costs: 0
20:47:33.032 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:33.032 |     INFO |       log_parameters |   min_distance: 3.134523651709299
20:47:33.032 |     INFO |       log_parameters |   max_distance: 132.75331057439246
20:47:33.032 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:33.032 |     INFO |       log_parameters |   motion_costs_shape: (47, 52)
20:47:33.032 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:33.032 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:33.032 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:33.032 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:33.032 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:33.033 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:33.033 |     INFO |       log_parameters |   coords_shape: (47, 2)
20:47:33.033 |     INFO |       log_parameters |   uncertainties_shape: (47, 2)
20:47:33.033 |     INFO |       log_parameters |   mean_uncertainty: 0.29801999999999995
20:47:33.033 |     INFO |       log_parameters |   uncertainty_range: [0.205575, 0.351175]
20:47:33.033 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:33.033 |     INFO |       log_parameters |   coords_shape: (52, 2)
20:47:33.033 |     INFO |       log_parameters |   uncertainties_shape: (52, 2)
20:47:33.033 |     INFO |       log_parameters |   mean_uncertainty: 0.30353546153846156
20:47:33.033 |     INFO |       log_parameters |   uncertainty_range: [0.216362, 0.35451]
20:47:33.034 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:33.034 |     INFO |       log_parameters |   feature_costs_shape: (47, 52)
20:47:33.034 |     INFO |       log_parameters |   feature_costs_min: 1.0001210835978636
20:47:33.034 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:33.034 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:33.034 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:33.034 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:33.034 |     INFO |       log_parameters |   original_shape: (47, 52)
20:47:33.034 |     INFO |       log_parameters |   augmented_shape: (99, 99)
20:47:33.034 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:33.034 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:33.034 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:33.034 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:33.034 |    DEBUG |            log_debug |   observed_positions.shape: (52, 2)
20:47:33.034 |    DEBUG |            log_debug |   num_features (from observed_positions): 52
20:47:33.034 |    DEBUG |            log_debug |   predicted_positions.shape: (47, 2)
20:47:33.034 |    DEBUG |            log_debug |   predicted_velocities.shape: (47, 2)
20:47:33.034 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (52, 4)
20:47:33.034 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=52 but predicted_positions has 47 rows
20:47:33.034 |    ERROR |            log_error |   This will cause index 51 to fail when array only goes to 46
20:47:33.034 |    DEBUG |            log_debug | Kalman update: 52 features, state_dim=4, prob_dim=2
20:47:33.035 |    ERROR |            log_error | Error in enhanced linking: index 47 is out of bounds for axis 0 with size 47
20:47:33.035 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 47 is out of bounds for axis 0 with size 47
20:47:33.035 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0048 seconds
20:47:33.044 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=7, prob_dim=2, num_features_frame1=52, num_features_frame2=41)
20:47:33.044 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:33.044 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:33.044 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:33.044 |     INFO |       log_parameters |   current_frame: 7
20:47:33.044 |     INFO |       log_parameters |   prob_dim: 2
20:47:33.044 |     INFO |       log_parameters |   num_features_frame1: 52
20:47:33.044 |     INFO |       log_parameters |   num_features_frame2: 41
20:47:33.044 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:33.044 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:33.044 |     INFO |       log_parameters |   linear_motion: 1
20:47:33.044 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:33.044 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:33.044 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:33.044 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:33.044 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:33.044 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:33.044 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:33.044 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:33.044 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:33.044 |     INFO |       log_parameters |   use_local_density: 0
20:47:33.044 |     INFO |       log_parameters |   nn_window: 5
20:47:33.044 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:33.044 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:33.044 |     INFO |       log_parameters |   len_for_classify: 5
20:47:33.044 |     INFO |       log_parameters |   res_limit: 0.1
20:47:33.044 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:33.044 |     INFO |       log_parameters |   strategy_bd: -1
20:47:33.044 |     INFO |       log_parameters |   lft_cdf: None
20:47:33.044 |     INFO |       log_parameters |   kalman_init_param: None
20:47:33.044 |     INFO |       log_parameters |   diagnostics: None
20:47:33.044 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:33.044 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:33.044 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:33.044 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:33.044 |     INFO |       log_parameters |   coords_shape: (52, 2)
20:47:33.044 |     INFO |       log_parameters |   uncertainties_shape: (52, 2)
20:47:33.044 |     INFO |       log_parameters |   mean_uncertainty: 0.30353546153846156
20:47:33.044 |     INFO |       log_parameters |   uncertainty_range: [0.216362, 0.35451]
20:47:33.044 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:33.044 |     INFO |       log_parameters |   coords_shape: (41, 2)
20:47:33.044 |     INFO |       log_parameters |   uncertainties_shape: (41, 2)
20:47:33.044 |     INFO |       log_parameters |   mean_uncertainty: 0.2937780487804878
20:47:33.044 |     INFO |       log_parameters |   uncertainty_range: [0.22435, 0.346372]
20:47:33.044 |    DEBUG |            log_debug | Initializing Kalman for 41 features, prob_dim=2, state_dim=4
20:47:33.044 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:33.044 |     INFO |       log_parameters |   num_features: 41
20:47:33.044 |     INFO |       log_parameters |   state_dim: 4
20:47:33.044 |     INFO |       log_parameters |   prob_dim: 2
20:47:33.044 |     INFO |       log_parameters |   state_vec_shape: (41, 4)
20:47:33.044 |     INFO |       log_parameters |   state_noise_var_shape: (41, 4, 4)
20:47:33.044 |    DEBUG |            log_debug | State vector shape: (52, 4), Expected: (52, 4)
20:47:33.045 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:33.045 |     INFO |       log_parameters |   num_features_predicted: 52
20:47:33.045 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:33.045 |     INFO |       log_parameters |   brownian_motion_features: 52
20:47:33.045 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:33.045 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:33.045 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:33.045 |     INFO |       log_parameters |   search_radii_shape: (52, 2)
20:47:33.045 |     INFO |       log_parameters |   min_radius: 0.1
20:47:33.045 |     INFO |       log_parameters |   max_radius: 0.1
20:47:33.045 |     INFO |       log_parameters |   mean_radius: 0.1
20:47:33.045 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:33.045 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.1
20:47:33.046 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:33.046 |     INFO |       log_parameters |   distance_matrix_shape: (52, 41)
20:47:33.046 |     INFO |       log_parameters |   cost_matrix_shape: (52, 41)
20:47:33.046 |     INFO |       log_parameters |   finite_costs: 2132
20:47:33.046 |     INFO |       log_parameters |   infinite_costs: 0
20:47:33.046 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:33.046 |     INFO |       log_parameters |   min_distance: 3.096014065583682
20:47:33.046 |     INFO |       log_parameters |   max_distance: 133.405031025541
20:47:33.046 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:33.046 |     INFO |       log_parameters |   motion_costs_shape: (52, 41)
20:47:33.046 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:33.046 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:33.046 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:33.046 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:33.046 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:33.047 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:33.047 |     INFO |       log_parameters |   coords_shape: (52, 2)
20:47:33.047 |     INFO |       log_parameters |   uncertainties_shape: (52, 2)
20:47:33.047 |     INFO |       log_parameters |   mean_uncertainty: 0.30353546153846156
20:47:33.047 |     INFO |       log_parameters |   uncertainty_range: [0.216362, 0.35451]
20:47:33.047 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:33.047 |     INFO |       log_parameters |   coords_shape: (41, 2)
20:47:33.047 |     INFO |       log_parameters |   uncertainties_shape: (41, 2)
20:47:33.047 |     INFO |       log_parameters |   mean_uncertainty: 0.2937780487804878
20:47:33.047 |     INFO |       log_parameters |   uncertainty_range: [0.22435, 0.346372]
20:47:33.047 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:33.047 |     INFO |       log_parameters |   feature_costs_shape: (52, 41)
20:47:33.047 |     INFO |       log_parameters |   feature_costs_min: 1.0000375809608564
20:47:33.047 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:33.047 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:33.047 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:33.047 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:33.047 |     INFO |       log_parameters |   original_shape: (52, 41)
20:47:33.047 |     INFO |       log_parameters |   augmented_shape: (93, 93)
20:47:33.047 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:33.047 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:33.047 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:33.047 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:33.047 |    DEBUG |            log_debug |   observed_positions.shape: (41, 2)
20:47:33.047 |    DEBUG |            log_debug |   num_features (from observed_positions): 41
20:47:33.047 |    DEBUG |            log_debug |   predicted_positions.shape: (52, 2)
20:47:33.047 |    DEBUG |            log_debug |   predicted_velocities.shape: (52, 2)
20:47:33.047 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (41, 4)
20:47:33.047 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=41 but predicted_positions has 52 rows
20:47:33.047 |    ERROR |            log_error |   This will cause index 40 to fail when array only goes to 51
20:47:33.047 |    DEBUG |            log_debug | Kalman update: 41 features, state_dim=4, prob_dim=2
20:47:33.048 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman update):
20:47:33.048 |     INFO |       log_parameters |   features_updated: 41
20:47:33.048 |     INFO |       log_parameters |   state_dim: 4
20:47:33.048 |     INFO |       log_parameters |   dt_used: 1.0
20:47:33.048 |     INFO |       log_parameters |   process_noise_scale: 1.0
20:47:33.048 |     INFO |       log_parameters |   measurement_noise_scale: 1.0
20:47:33.048 |     INFO |             log_info | Enhanced linking completed successfully for frame 7
20:47:33.048 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0042 seconds
20:47:33.189 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=8, prob_dim=2, num_features_frame1=41, num_features_frame2=50)
20:47:33.189 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:33.189 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:33.189 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:33.189 |     INFO |       log_parameters |   current_frame: 8
20:47:33.189 |     INFO |       log_parameters |   prob_dim: 2
20:47:33.189 |     INFO |       log_parameters |   num_features_frame1: 41
20:47:33.189 |     INFO |       log_parameters |   num_features_frame2: 50
20:47:33.189 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:33.189 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:33.189 |     INFO |       log_parameters |   linear_motion: 1
20:47:33.189 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:33.189 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:33.189 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:33.189 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:33.189 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:33.189 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:33.189 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:33.189 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:33.189 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:33.189 |     INFO |       log_parameters |   use_local_density: 0
20:47:33.189 |     INFO |       log_parameters |   nn_window: 5
20:47:33.189 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:33.189 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:33.189 |     INFO |       log_parameters |   len_for_classify: 5
20:47:33.189 |     INFO |       log_parameters |   res_limit: 0.1
20:47:33.189 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:33.189 |     INFO |       log_parameters |   strategy_bd: -1
20:47:33.189 |     INFO |       log_parameters |   lft_cdf: None
20:47:33.189 |     INFO |       log_parameters |   kalman_init_param: None
20:47:33.189 |     INFO |       log_parameters |   diagnostics: None
20:47:33.189 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:33.189 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:33.189 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:33.189 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:33.189 |     INFO |       log_parameters |   coords_shape: (41, 2)
20:47:33.189 |     INFO |       log_parameters |   uncertainties_shape: (41, 2)
20:47:33.189 |     INFO |       log_parameters |   mean_uncertainty: 0.2937780487804878
20:47:33.189 |     INFO |       log_parameters |   uncertainty_range: [0.22435, 0.346372]
20:47:33.189 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:33.189 |     INFO |       log_parameters |   coords_shape: (50, 2)
20:47:33.189 |     INFO |       log_parameters |   uncertainties_shape: (50, 2)
20:47:33.189 |     INFO |       log_parameters |   mean_uncertainty: 0.3024896
20:47:33.189 |     INFO |       log_parameters |   uncertainty_range: [0.220174, 0.354657]
20:47:33.189 |    DEBUG |            log_debug | Initializing Kalman for 50 features, prob_dim=2, state_dim=4
20:47:33.190 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:33.190 |     INFO |       log_parameters |   num_features: 50
20:47:33.190 |     INFO |       log_parameters |   state_dim: 4
20:47:33.190 |     INFO |       log_parameters |   prob_dim: 2
20:47:33.190 |     INFO |       log_parameters |   state_vec_shape: (50, 4)
20:47:33.190 |     INFO |       log_parameters |   state_noise_var_shape: (50, 4, 4)
20:47:33.190 |    DEBUG |            log_debug | State vector shape: (41, 4), Expected: (41, 4)
20:47:33.190 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:33.190 |     INFO |       log_parameters |   num_features_predicted: 41
20:47:33.190 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:33.190 |     INFO |       log_parameters |   brownian_motion_features: 41
20:47:33.190 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:33.190 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:33.190 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:33.190 |     INFO |       log_parameters |   search_radii_shape: (41, 2)
20:47:33.190 |     INFO |       log_parameters |   min_radius: 0.1
20:47:33.190 |     INFO |       log_parameters |   max_radius: 0.1
20:47:33.190 |     INFO |       log_parameters |   mean_radius: 0.09999999999999999
20:47:33.190 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:33.190 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999999
20:47:33.191 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:33.191 |     INFO |       log_parameters |   distance_matrix_shape: (41, 50)
20:47:33.191 |     INFO |       log_parameters |   cost_matrix_shape: (41, 50)
20:47:33.191 |     INFO |       log_parameters |   finite_costs: 2050
20:47:33.191 |     INFO |       log_parameters |   infinite_costs: 0
20:47:33.191 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:33.191 |     INFO |       log_parameters |   min_distance: 3.0715696706628677
20:47:33.191 |     INFO |       log_parameters |   max_distance: 133.15177497278583
20:47:33.191 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:33.191 |     INFO |       log_parameters |   motion_costs_shape: (41, 50)
20:47:33.191 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:33.191 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:33.191 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:33.191 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:33.191 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:33.192 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:33.192 |     INFO |       log_parameters |   coords_shape: (41, 2)
20:47:33.192 |     INFO |       log_parameters |   uncertainties_shape: (41, 2)
20:47:33.192 |     INFO |       log_parameters |   mean_uncertainty: 0.2937780487804878
20:47:33.192 |     INFO |       log_parameters |   uncertainty_range: [0.22435, 0.346372]
20:47:33.192 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:33.192 |     INFO |       log_parameters |   coords_shape: (50, 2)
20:47:33.192 |     INFO |       log_parameters |   uncertainties_shape: (50, 2)
20:47:33.192 |     INFO |       log_parameters |   mean_uncertainty: 0.3024896
20:47:33.192 |     INFO |       log_parameters |   uncertainty_range: [0.220174, 0.354657]
20:47:33.192 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:33.192 |     INFO |       log_parameters |   feature_costs_shape: (41, 50)
20:47:33.192 |     INFO |       log_parameters |   feature_costs_min: 1.0001433265789164
20:47:33.192 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:33.192 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:33.192 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:33.192 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:33.192 |     INFO |       log_parameters |   original_shape: (41, 50)
20:47:33.192 |     INFO |       log_parameters |   augmented_shape: (91, 91)
20:47:33.192 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:33.192 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:33.192 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:33.192 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:33.192 |    DEBUG |            log_debug |   observed_positions.shape: (50, 2)
20:47:33.192 |    DEBUG |            log_debug |   num_features (from observed_positions): 50
20:47:33.192 |    DEBUG |            log_debug |   predicted_positions.shape: (41, 2)
20:47:33.192 |    DEBUG |            log_debug |   predicted_velocities.shape: (41, 2)
20:47:33.192 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (50, 4)
20:47:33.192 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=50 but predicted_positions has 41 rows
20:47:33.192 |    ERROR |            log_error |   This will cause index 49 to fail when array only goes to 40
20:47:33.192 |    DEBUG |            log_debug | Kalman update: 50 features, state_dim=4, prob_dim=2
20:47:33.193 |    ERROR |            log_error | Error in enhanced linking: index 41 is out of bounds for axis 0 with size 41
20:47:33.193 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 41 is out of bounds for axis 0 with size 41
20:47:33.193 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0042 seconds
20:47:33.202 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=9, prob_dim=2, num_features_frame1=50, num_features_frame2=46)
20:47:33.202 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:33.202 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:33.202 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:33.202 |     INFO |       log_parameters |   current_frame: 9
20:47:33.202 |     INFO |       log_parameters |   prob_dim: 2
20:47:33.202 |     INFO |       log_parameters |   num_features_frame1: 50
20:47:33.202 |     INFO |       log_parameters |   num_features_frame2: 46
20:47:33.202 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:33.202 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:33.202 |     INFO |       log_parameters |   linear_motion: 1
20:47:33.202 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:33.202 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:33.202 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:33.202 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:33.202 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:33.202 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:33.202 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:33.202 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:33.203 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:33.203 |     INFO |       log_parameters |   use_local_density: 0
20:47:33.203 |     INFO |       log_parameters |   nn_window: 5
20:47:33.203 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:33.203 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:33.203 |     INFO |       log_parameters |   len_for_classify: 5
20:47:33.203 |     INFO |       log_parameters |   res_limit: 0.1
20:47:33.203 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:33.203 |     INFO |       log_parameters |   strategy_bd: -1
20:47:33.203 |     INFO |       log_parameters |   lft_cdf: None
20:47:33.203 |     INFO |       log_parameters |   kalman_init_param: None
20:47:33.203 |     INFO |       log_parameters |   diagnostics: None
20:47:33.203 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:33.203 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:33.203 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:33.203 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:33.203 |     INFO |       log_parameters |   coords_shape: (50, 2)
20:47:33.203 |     INFO |       log_parameters |   uncertainties_shape: (50, 2)
20:47:33.203 |     INFO |       log_parameters |   mean_uncertainty: 0.3024896
20:47:33.203 |     INFO |       log_parameters |   uncertainty_range: [0.220174, 0.354657]
20:47:33.203 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:33.203 |     INFO |       log_parameters |   coords_shape: (46, 2)
20:47:33.203 |     INFO |       log_parameters |   uncertainties_shape: (46, 2)
20:47:33.203 |     INFO |       log_parameters |   mean_uncertainty: 0.2985224673913044
20:47:33.203 |     INFO |       log_parameters |   uncertainty_range: [0.21347, 0.349276]
20:47:33.203 |    DEBUG |            log_debug | Initializing Kalman for 46 features, prob_dim=2, state_dim=4
20:47:33.203 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:33.203 |     INFO |       log_parameters |   num_features: 46
20:47:33.203 |     INFO |       log_parameters |   state_dim: 4
20:47:33.203 |     INFO |       log_parameters |   prob_dim: 2
20:47:33.203 |     INFO |       log_parameters |   state_vec_shape: (46, 4)
20:47:33.203 |     INFO |       log_parameters |   state_noise_var_shape: (46, 4, 4)
20:47:33.203 |    DEBUG |            log_debug | State vector shape: (50, 4), Expected: (50, 4)
20:47:33.203 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:33.203 |     INFO |       log_parameters |   num_features_predicted: 50
20:47:33.203 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:33.203 |     INFO |       log_parameters |   brownian_motion_features: 50
20:47:33.203 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:33.203 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:33.203 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:33.203 |     INFO |       log_parameters |   search_radii_shape: (50, 2)
20:47:33.203 |     INFO |       log_parameters |   min_radius: 0.1
20:47:33.203 |     INFO |       log_parameters |   max_radius: 0.1
20:47:33.203 |     INFO |       log_parameters |   mean_radius: 0.09999999999999998
20:47:33.203 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:33.203 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999998
20:47:33.204 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:33.204 |     INFO |       log_parameters |   distance_matrix_shape: (50, 46)
20:47:33.204 |     INFO |       log_parameters |   cost_matrix_shape: (50, 46)
20:47:33.204 |     INFO |       log_parameters |   finite_costs: 2300
20:47:33.204 |     INFO |       log_parameters |   infinite_costs: 0
20:47:33.204 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:33.204 |     INFO |       log_parameters |   min_distance: 3.442914716447388
20:47:33.204 |     INFO |       log_parameters |   max_distance: 132.89206695302965
20:47:33.204 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:33.204 |     INFO |       log_parameters |   motion_costs_shape: (50, 46)
20:47:33.204 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:33.204 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:33.204 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:33.204 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:33.204 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:33.205 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:33.205 |     INFO |       log_parameters |   coords_shape: (50, 2)
20:47:33.205 |     INFO |       log_parameters |   uncertainties_shape: (50, 2)
20:47:33.205 |     INFO |       log_parameters |   mean_uncertainty: 0.3024896
20:47:33.205 |     INFO |       log_parameters |   uncertainty_range: [0.220174, 0.354657]
20:47:33.205 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:33.205 |     INFO |       log_parameters |   coords_shape: (46, 2)
20:47:33.206 |     INFO |       log_parameters |   uncertainties_shape: (46, 2)
20:47:33.206 |     INFO |       log_parameters |   mean_uncertainty: 0.2985224673913044
20:47:33.206 |     INFO |       log_parameters |   uncertainty_range: [0.21347, 0.349276]
20:47:33.206 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:33.206 |     INFO |       log_parameters |   feature_costs_shape: (50, 46)
20:47:33.206 |     INFO |       log_parameters |   feature_costs_min: 1.0001058280245456
20:47:33.206 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:33.206 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:33.206 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:33.206 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:33.206 |     INFO |       log_parameters |   original_shape: (50, 46)
20:47:33.206 |     INFO |       log_parameters |   augmented_shape: (96, 96)
20:47:33.206 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:33.206 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:33.206 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:33.206 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:33.206 |    DEBUG |            log_debug |   observed_positions.shape: (46, 2)
20:47:33.206 |    DEBUG |            log_debug |   num_features (from observed_positions): 46
20:47:33.206 |    DEBUG |            log_debug |   predicted_positions.shape: (50, 2)
20:47:33.206 |    DEBUG |            log_debug |   predicted_velocities.shape: (50, 2)
20:47:33.206 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (46, 4)
20:47:33.206 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=46 but predicted_positions has 50 rows
20:47:33.206 |    ERROR |            log_error |   This will cause index 45 to fail when array only goes to 49
20:47:33.206 |    DEBUG |            log_debug | Kalman update: 46 features, state_dim=4, prob_dim=2
20:47:33.207 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman update):
20:47:33.207 |     INFO |       log_parameters |   features_updated: 46
20:47:33.207 |     INFO |       log_parameters |   state_dim: 4
20:47:33.207 |     INFO |       log_parameters |   dt_used: 1.0
20:47:33.207 |     INFO |       log_parameters |   process_noise_scale: 1.0
20:47:33.207 |     INFO |       log_parameters |   measurement_noise_scale: 1.0
20:47:33.207 |     INFO |             log_info | Enhanced linking completed successfully for frame 9
20:47:33.207 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0044 seconds
20:47:33.368 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=10, prob_dim=2, num_features_frame1=46, num_features_frame2=56)
20:47:33.368 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:33.368 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:33.368 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:33.368 |     INFO |       log_parameters |   current_frame: 10
20:47:33.368 |     INFO |       log_parameters |   prob_dim: 2
20:47:33.368 |     INFO |       log_parameters |   num_features_frame1: 46
20:47:33.368 |     INFO |       log_parameters |   num_features_frame2: 56
20:47:33.368 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:33.368 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:33.368 |     INFO |       log_parameters |   linear_motion: 1
20:47:33.368 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:33.368 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:33.368 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:33.368 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:33.368 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:33.368 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:33.368 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:33.368 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:33.368 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:33.368 |     INFO |       log_parameters |   use_local_density: 0
20:47:33.368 |     INFO |       log_parameters |   nn_window: 5
20:47:33.368 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:33.368 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:33.368 |     INFO |       log_parameters |   len_for_classify: 5
20:47:33.368 |     INFO |       log_parameters |   res_limit: 0.1
20:47:33.368 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:33.368 |     INFO |       log_parameters |   strategy_bd: -1
20:47:33.368 |     INFO |       log_parameters |   lft_cdf: None
20:47:33.368 |     INFO |       log_parameters |   kalman_init_param: None
20:47:33.368 |     INFO |       log_parameters |   diagnostics: None
20:47:33.368 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:33.368 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:33.368 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:33.368 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:33.368 |     INFO |       log_parameters |   coords_shape: (46, 2)
20:47:33.368 |     INFO |       log_parameters |   uncertainties_shape: (46, 2)
20:47:33.368 |     INFO |       log_parameters |   mean_uncertainty: 0.2985224673913044
20:47:33.368 |     INFO |       log_parameters |   uncertainty_range: [0.21347, 0.349276]
20:47:33.368 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:33.368 |     INFO |       log_parameters |   coords_shape: (56, 2)
20:47:33.368 |     INFO |       log_parameters |   uncertainties_shape: (56, 2)
20:47:33.368 |     INFO |       log_parameters |   mean_uncertainty: 0.3059016875
20:47:33.368 |     INFO |       log_parameters |   uncertainty_range: [0.211085, 0.352902]
20:47:33.368 |    DEBUG |            log_debug | Initializing Kalman for 56 features, prob_dim=2, state_dim=4
20:47:33.368 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:33.368 |     INFO |       log_parameters |   num_features: 56
20:47:33.368 |     INFO |       log_parameters |   state_dim: 4
20:47:33.368 |     INFO |       log_parameters |   prob_dim: 2
20:47:33.368 |     INFO |       log_parameters |   state_vec_shape: (56, 4)
20:47:33.368 |     INFO |       log_parameters |   state_noise_var_shape: (56, 4, 4)
20:47:33.368 |    DEBUG |            log_debug | State vector shape: (46, 4), Expected: (46, 4)
20:47:33.369 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:33.369 |     INFO |       log_parameters |   num_features_predicted: 46
20:47:33.369 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:33.369 |     INFO |       log_parameters |   brownian_motion_features: 46
20:47:33.369 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:33.369 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:33.369 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:33.369 |     INFO |       log_parameters |   search_radii_shape: (46, 2)
20:47:33.369 |     INFO |       log_parameters |   min_radius: 0.1
20:47:33.369 |     INFO |       log_parameters |   max_radius: 0.1
20:47:33.369 |     INFO |       log_parameters |   mean_radius: 0.09999999999999998
20:47:33.369 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:33.369 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999998
20:47:33.370 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:33.370 |     INFO |       log_parameters |   distance_matrix_shape: (46, 56)
20:47:33.370 |     INFO |       log_parameters |   cost_matrix_shape: (46, 56)
20:47:33.370 |     INFO |       log_parameters |   finite_costs: 2576
20:47:33.370 |     INFO |       log_parameters |   infinite_costs: 0
20:47:33.370 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:33.370 |     INFO |       log_parameters |   min_distance: 3.358412348148006
20:47:33.370 |     INFO |       log_parameters |   max_distance: 132.14547030451195
20:47:33.370 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:33.370 |     INFO |       log_parameters |   motion_costs_shape: (46, 56)
20:47:33.370 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:33.370 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:33.370 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:33.370 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:33.370 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:33.371 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:33.371 |     INFO |       log_parameters |   coords_shape: (46, 2)
20:47:33.371 |     INFO |       log_parameters |   uncertainties_shape: (46, 2)
20:47:33.371 |     INFO |       log_parameters |   mean_uncertainty: 0.2985224673913044
20:47:33.371 |     INFO |       log_parameters |   uncertainty_range: [0.21347, 0.349276]
20:47:33.371 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:33.371 |     INFO |       log_parameters |   coords_shape: (56, 2)
20:47:33.371 |     INFO |       log_parameters |   uncertainties_shape: (56, 2)
20:47:33.371 |     INFO |       log_parameters |   mean_uncertainty: 0.3059016875
20:47:33.371 |     INFO |       log_parameters |   uncertainty_range: [0.211085, 0.352902]
20:47:33.372 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:33.372 |     INFO |       log_parameters |   feature_costs_shape: (46, 56)
20:47:33.372 |     INFO |       log_parameters |   feature_costs_min: 1.0000129102041602
20:47:33.372 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:33.372 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:33.372 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:33.372 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:33.372 |     INFO |       log_parameters |   original_shape: (46, 56)
20:47:33.372 |     INFO |       log_parameters |   augmented_shape: (102, 102)
20:47:33.372 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:33.372 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:33.372 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:33.372 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:33.372 |    DEBUG |            log_debug |   observed_positions.shape: (56, 2)
20:47:33.372 |    DEBUG |            log_debug |   num_features (from observed_positions): 56
20:47:33.372 |    DEBUG |            log_debug |   predicted_positions.shape: (46, 2)
20:47:33.372 |    DEBUG |            log_debug |   predicted_velocities.shape: (46, 2)
20:47:33.372 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (56, 4)
20:47:33.372 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=56 but predicted_positions has 46 rows
20:47:33.372 |    ERROR |            log_error |   This will cause index 55 to fail when array only goes to 45
20:47:33.372 |    DEBUG |            log_debug | Kalman update: 56 features, state_dim=4, prob_dim=2
20:47:33.373 |    ERROR |            log_error | Error in enhanced linking: index 46 is out of bounds for axis 0 with size 46
20:47:33.373 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 46 is out of bounds for axis 0 with size 46
20:47:33.373 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0049 seconds
20:47:33.383 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=11, prob_dim=2, num_features_frame1=56, num_features_frame2=51)
20:47:33.383 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:33.383 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:33.383 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:33.383 |     INFO |       log_parameters |   current_frame: 11
20:47:33.383 |     INFO |       log_parameters |   prob_dim: 2
20:47:33.383 |     INFO |       log_parameters |   num_features_frame1: 56
20:47:33.383 |     INFO |       log_parameters |   num_features_frame2: 51
20:47:33.383 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:33.383 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:33.383 |     INFO |       log_parameters |   linear_motion: 1
20:47:33.383 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:33.383 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:33.383 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:33.383 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:33.383 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:33.383 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:33.383 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:33.383 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:33.383 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:33.383 |     INFO |       log_parameters |   use_local_density: 0
20:47:33.383 |     INFO |       log_parameters |   nn_window: 5
20:47:33.383 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:33.383 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:33.383 |     INFO |       log_parameters |   len_for_classify: 5
20:47:33.383 |     INFO |       log_parameters |   res_limit: 0.1
20:47:33.383 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:33.383 |     INFO |       log_parameters |   strategy_bd: -1
20:47:33.383 |     INFO |       log_parameters |   lft_cdf: None
20:47:33.383 |     INFO |       log_parameters |   kalman_init_param: None
20:47:33.383 |     INFO |       log_parameters |   diagnostics: None
20:47:33.383 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:33.383 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:33.383 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:33.383 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:33.383 |     INFO |       log_parameters |   coords_shape: (56, 2)
20:47:33.383 |     INFO |       log_parameters |   uncertainties_shape: (56, 2)
20:47:33.383 |     INFO |       log_parameters |   mean_uncertainty: 0.3059016875
20:47:33.383 |     INFO |       log_parameters |   uncertainty_range: [0.211085, 0.352902]
20:47:33.383 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:33.383 |     INFO |       log_parameters |   coords_shape: (51, 2)
20:47:33.383 |     INFO |       log_parameters |   uncertainties_shape: (51, 2)
20:47:33.383 |     INFO |       log_parameters |   mean_uncertainty: 0.30382819607843137
20:47:33.383 |     INFO |       log_parameters |   uncertainty_range: [0.212025, 0.359038]
20:47:33.383 |    DEBUG |            log_debug | Initializing Kalman for 51 features, prob_dim=2, state_dim=4
20:47:33.383 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:33.383 |     INFO |       log_parameters |   num_features: 51
20:47:33.383 |     INFO |       log_parameters |   state_dim: 4
20:47:33.383 |     INFO |       log_parameters |   prob_dim: 2
20:47:33.383 |     INFO |       log_parameters |   state_vec_shape: (51, 4)
20:47:33.383 |     INFO |       log_parameters |   state_noise_var_shape: (51, 4, 4)
20:47:33.383 |    DEBUG |            log_debug | State vector shape: (56, 4), Expected: (56, 4)
20:47:33.384 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:33.384 |     INFO |       log_parameters |   num_features_predicted: 56
20:47:33.384 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:33.384 |     INFO |       log_parameters |   brownian_motion_features: 56
20:47:33.384 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:33.384 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:33.384 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:33.384 |     INFO |       log_parameters |   search_radii_shape: (56, 2)
20:47:33.384 |     INFO |       log_parameters |   min_radius: 0.1
20:47:33.384 |     INFO |       log_parameters |   max_radius: 0.1
20:47:33.384 |     INFO |       log_parameters |   mean_radius: 0.1
20:47:33.384 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:33.384 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.1
20:47:33.385 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:33.385 |     INFO |       log_parameters |   distance_matrix_shape: (56, 51)
20:47:33.385 |     INFO |       log_parameters |   cost_matrix_shape: (56, 51)
20:47:33.385 |     INFO |       log_parameters |   finite_costs: 2856
20:47:33.385 |     INFO |       log_parameters |   infinite_costs: 0
20:47:33.385 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:33.385 |     INFO |       log_parameters |   min_distance: 3.1106960516218876
20:47:33.385 |     INFO |       log_parameters |   max_distance: 132.0098533202966
20:47:33.385 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:33.385 |     INFO |       log_parameters |   motion_costs_shape: (56, 51)
20:47:33.385 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:33.385 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:33.385 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:33.385 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:33.385 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:33.386 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:33.386 |     INFO |       log_parameters |   coords_shape: (56, 2)
20:47:33.386 |     INFO |       log_parameters |   uncertainties_shape: (56, 2)
20:47:33.386 |     INFO |       log_parameters |   mean_uncertainty: 0.3059016875
20:47:33.386 |     INFO |       log_parameters |   uncertainty_range: [0.211085, 0.352902]
20:47:33.386 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:33.386 |     INFO |       log_parameters |   coords_shape: (51, 2)
20:47:33.386 |     INFO |       log_parameters |   uncertainties_shape: (51, 2)
20:47:33.386 |     INFO |       log_parameters |   mean_uncertainty: 0.30382819607843137
20:47:33.386 |     INFO |       log_parameters |   uncertainty_range: [0.212025, 0.359038]
20:47:33.387 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:33.387 |     INFO |       log_parameters |   feature_costs_shape: (56, 51)
20:47:33.387 |     INFO |       log_parameters |   feature_costs_min: 1.0000023359264354
20:47:33.387 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:33.387 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:33.387 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:33.387 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:33.387 |     INFO |       log_parameters |   original_shape: (56, 51)
20:47:33.387 |     INFO |       log_parameters |   augmented_shape: (107, 107)
20:47:33.387 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:33.387 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:33.387 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:33.387 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:33.387 |    DEBUG |            log_debug |   observed_positions.shape: (51, 2)
20:47:33.387 |    DEBUG |            log_debug |   num_features (from observed_positions): 51
20:47:33.387 |    DEBUG |            log_debug |   predicted_positions.shape: (56, 2)
20:47:33.387 |    DEBUG |            log_debug |   predicted_velocities.shape: (56, 2)
20:47:33.387 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (51, 4)
20:47:33.387 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=51 but predicted_positions has 56 rows
20:47:33.387 |    ERROR |            log_error |   This will cause index 50 to fail when array only goes to 55
20:47:33.387 |    DEBUG |            log_debug | Kalman update: 51 features, state_dim=4, prob_dim=2
20:47:33.388 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman update):
20:47:33.388 |     INFO |       log_parameters |   features_updated: 51
20:47:33.388 |     INFO |       log_parameters |   state_dim: 4
20:47:33.388 |     INFO |       log_parameters |   dt_used: 1.0
20:47:33.388 |     INFO |       log_parameters |   process_noise_scale: 1.0
20:47:33.388 |     INFO |       log_parameters |   measurement_noise_scale: 1.0
20:47:33.388 |     INFO |             log_info | Enhanced linking completed successfully for frame 11
20:47:33.388 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0050 seconds
20:47:33.582 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=12, prob_dim=2, num_features_frame1=51, num_features_frame2=57)
20:47:33.582 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:33.582 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:33.582 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:33.582 |     INFO |       log_parameters |   current_frame: 12
20:47:33.582 |     INFO |       log_parameters |   prob_dim: 2
20:47:33.582 |     INFO |       log_parameters |   num_features_frame1: 51
20:47:33.582 |     INFO |       log_parameters |   num_features_frame2: 57
20:47:33.582 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:33.582 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:33.582 |     INFO |       log_parameters |   linear_motion: 1
20:47:33.582 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:33.582 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:33.582 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:33.582 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:33.582 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:33.582 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:33.582 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:33.582 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:33.582 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:33.582 |     INFO |       log_parameters |   use_local_density: 0
20:47:33.582 |     INFO |       log_parameters |   nn_window: 5
20:47:33.582 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:33.582 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:33.582 |     INFO |       log_parameters |   len_for_classify: 5
20:47:33.582 |     INFO |       log_parameters |   res_limit: 0.1
20:47:33.582 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:33.582 |     INFO |       log_parameters |   strategy_bd: -1
20:47:33.582 |     INFO |       log_parameters |   lft_cdf: None
20:47:33.583 |     INFO |       log_parameters |   kalman_init_param: None
20:47:33.583 |     INFO |       log_parameters |   diagnostics: None
20:47:33.583 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:33.583 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:33.583 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:33.583 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:33.583 |     INFO |       log_parameters |   coords_shape: (51, 2)
20:47:33.583 |     INFO |       log_parameters |   uncertainties_shape: (51, 2)
20:47:33.583 |     INFO |       log_parameters |   mean_uncertainty: 0.30382819607843137
20:47:33.583 |     INFO |       log_parameters |   uncertainty_range: [0.212025, 0.359038]
20:47:33.583 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:33.583 |     INFO |       log_parameters |   coords_shape: (57, 2)
20:47:33.583 |     INFO |       log_parameters |   uncertainties_shape: (57, 2)
20:47:33.583 |     INFO |       log_parameters |   mean_uncertainty: 0.30895990350877195
20:47:33.583 |     INFO |       log_parameters |   uncertainty_range: [0.216107, 0.354781]
20:47:33.583 |    DEBUG |            log_debug | Initializing Kalman for 57 features, prob_dim=2, state_dim=4
20:47:33.583 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:33.583 |     INFO |       log_parameters |   num_features: 57
20:47:33.583 |     INFO |       log_parameters |   state_dim: 4
20:47:33.583 |     INFO |       log_parameters |   prob_dim: 2
20:47:33.583 |     INFO |       log_parameters |   state_vec_shape: (57, 4)
20:47:33.583 |     INFO |       log_parameters |   state_noise_var_shape: (57, 4, 4)
20:47:33.583 |    DEBUG |            log_debug | State vector shape: (51, 4), Expected: (51, 4)
20:47:33.583 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:33.583 |     INFO |       log_parameters |   num_features_predicted: 51
20:47:33.583 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:33.583 |     INFO |       log_parameters |   brownian_motion_features: 51
20:47:33.583 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:33.583 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:33.583 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:33.583 |     INFO |       log_parameters |   search_radii_shape: (51, 2)
20:47:33.583 |     INFO |       log_parameters |   min_radius: 0.1
20:47:33.583 |     INFO |       log_parameters |   max_radius: 0.1
20:47:33.583 |     INFO |       log_parameters |   mean_radius: 0.09999999999999998
20:47:33.583 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:33.583 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999998
20:47:33.584 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:33.584 |     INFO |       log_parameters |   distance_matrix_shape: (51, 57)
20:47:33.584 |     INFO |       log_parameters |   cost_matrix_shape: (51, 57)
20:47:33.584 |     INFO |       log_parameters |   finite_costs: 2907
20:47:33.584 |     INFO |       log_parameters |   infinite_costs: 0
20:47:33.584 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:33.584 |     INFO |       log_parameters |   min_distance: 3.5538086473001047
20:47:33.584 |     INFO |       log_parameters |   max_distance: 132.11149591845216
20:47:33.584 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:33.584 |     INFO |       log_parameters |   motion_costs_shape: (51, 57)
20:47:33.584 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:33.584 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:33.584 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:33.584 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:33.584 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:33.586 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:33.586 |     INFO |       log_parameters |   coords_shape: (51, 2)
20:47:33.586 |     INFO |       log_parameters |   uncertainties_shape: (51, 2)
20:47:33.586 |     INFO |       log_parameters |   mean_uncertainty: 0.30382819607843137
20:47:33.586 |     INFO |       log_parameters |   uncertainty_range: [0.212025, 0.359038]
20:47:33.586 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:33.586 |     INFO |       log_parameters |   coords_shape: (57, 2)
20:47:33.586 |     INFO |       log_parameters |   uncertainties_shape: (57, 2)
20:47:33.586 |     INFO |       log_parameters |   mean_uncertainty: 0.30895990350877195
20:47:33.586 |     INFO |       log_parameters |   uncertainty_range: [0.216107, 0.354781]
20:47:33.586 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:33.586 |     INFO |       log_parameters |   feature_costs_shape: (51, 57)
20:47:33.586 |     INFO |       log_parameters |   feature_costs_min: 1.0000495051955216
20:47:33.586 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:33.586 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:33.586 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:33.586 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:33.586 |     INFO |       log_parameters |   original_shape: (51, 57)
20:47:33.586 |     INFO |       log_parameters |   augmented_shape: (108, 108)
20:47:33.586 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:33.586 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:33.586 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:33.586 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:33.586 |    DEBUG |            log_debug |   observed_positions.shape: (57, 2)
20:47:33.586 |    DEBUG |            log_debug |   num_features (from observed_positions): 57
20:47:33.586 |    DEBUG |            log_debug |   predicted_positions.shape: (51, 2)
20:47:33.586 |    DEBUG |            log_debug |   predicted_velocities.shape: (51, 2)
20:47:33.586 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (57, 4)
20:47:33.586 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=57 but predicted_positions has 51 rows
20:47:33.586 |    ERROR |            log_error |   This will cause index 56 to fail when array only goes to 50
20:47:33.586 |    DEBUG |            log_debug | Kalman update: 57 features, state_dim=4, prob_dim=2
20:47:33.587 |    ERROR |            log_error | Error in enhanced linking: index 51 is out of bounds for axis 0 with size 51
20:47:33.587 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 51 is out of bounds for axis 0 with size 51
20:47:33.588 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0053 seconds
20:47:33.598 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=13, prob_dim=2, num_features_frame1=57, num_features_frame2=54)
20:47:33.598 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:33.598 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:33.598 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:33.598 |     INFO |       log_parameters |   current_frame: 13
20:47:33.598 |     INFO |       log_parameters |   prob_dim: 2
20:47:33.598 |     INFO |       log_parameters |   num_features_frame1: 57
20:47:33.598 |     INFO |       log_parameters |   num_features_frame2: 54
20:47:33.598 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:33.598 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:33.598 |     INFO |       log_parameters |   linear_motion: 1
20:47:33.598 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:33.598 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:33.598 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:33.598 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:33.598 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:33.598 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:33.598 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:33.598 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:33.598 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:33.598 |     INFO |       log_parameters |   use_local_density: 0
20:47:33.598 |     INFO |       log_parameters |   nn_window: 5
20:47:33.598 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:33.598 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:33.598 |     INFO |       log_parameters |   len_for_classify: 5
20:47:33.598 |     INFO |       log_parameters |   res_limit: 0.1
20:47:33.598 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:33.598 |     INFO |       log_parameters |   strategy_bd: -1
20:47:33.598 |     INFO |       log_parameters |   lft_cdf: None
20:47:33.598 |     INFO |       log_parameters |   kalman_init_param: None
20:47:33.598 |     INFO |       log_parameters |   diagnostics: None
20:47:33.598 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:33.598 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:33.598 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:33.598 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:33.598 |     INFO |       log_parameters |   coords_shape: (57, 2)
20:47:33.598 |     INFO |       log_parameters |   uncertainties_shape: (57, 2)
20:47:33.598 |     INFO |       log_parameters |   mean_uncertainty: 0.30895990350877195
20:47:33.598 |     INFO |       log_parameters |   uncertainty_range: [0.216107, 0.354781]
20:47:33.598 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:33.598 |     INFO |       log_parameters |   coords_shape: (54, 2)
20:47:33.598 |     INFO |       log_parameters |   uncertainties_shape: (54, 2)
20:47:33.598 |     INFO |       log_parameters |   mean_uncertainty: 0.3049488796296296
20:47:33.598 |     INFO |       log_parameters |   uncertainty_range: [0.206519, 0.354491]
20:47:33.598 |    DEBUG |            log_debug | Initializing Kalman for 54 features, prob_dim=2, state_dim=4
20:47:33.598 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:33.598 |     INFO |       log_parameters |   num_features: 54
20:47:33.598 |     INFO |       log_parameters |   state_dim: 4
20:47:33.598 |     INFO |       log_parameters |   prob_dim: 2
20:47:33.598 |     INFO |       log_parameters |   state_vec_shape: (54, 4)
20:47:33.598 |     INFO |       log_parameters |   state_noise_var_shape: (54, 4, 4)
20:47:33.598 |    DEBUG |            log_debug | State vector shape: (57, 4), Expected: (57, 4)
20:47:33.599 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:33.599 |     INFO |       log_parameters |   num_features_predicted: 57
20:47:33.599 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:33.599 |     INFO |       log_parameters |   brownian_motion_features: 57
20:47:33.599 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:33.599 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:33.599 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:33.599 |     INFO |       log_parameters |   search_radii_shape: (57, 2)
20:47:33.599 |     INFO |       log_parameters |   min_radius: 0.1
20:47:33.599 |     INFO |       log_parameters |   max_radius: 0.1
20:47:33.599 |     INFO |       log_parameters |   mean_radius: 0.1
20:47:33.599 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:33.599 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.1
20:47:33.600 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:33.600 |     INFO |       log_parameters |   distance_matrix_shape: (57, 54)
20:47:33.600 |     INFO |       log_parameters |   cost_matrix_shape: (57, 54)
20:47:33.600 |     INFO |       log_parameters |   finite_costs: 3078
20:47:33.600 |     INFO |       log_parameters |   infinite_costs: 0
20:47:33.600 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:33.600 |     INFO |       log_parameters |   min_distance: 2.6160229428797064
20:47:33.600 |     INFO |       log_parameters |   max_distance: 132.1431085861538
20:47:33.600 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:33.600 |     INFO |       log_parameters |   motion_costs_shape: (57, 54)
20:47:33.600 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:33.600 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:33.600 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:33.600 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:33.600 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:33.602 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:33.602 |     INFO |       log_parameters |   coords_shape: (57, 2)
20:47:33.602 |     INFO |       log_parameters |   uncertainties_shape: (57, 2)
20:47:33.602 |     INFO |       log_parameters |   mean_uncertainty: 0.30895990350877195
20:47:33.602 |     INFO |       log_parameters |   uncertainty_range: [0.216107, 0.354781]
20:47:33.602 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:33.602 |     INFO |       log_parameters |   coords_shape: (54, 2)
20:47:33.602 |     INFO |       log_parameters |   uncertainties_shape: (54, 2)
20:47:33.602 |     INFO |       log_parameters |   mean_uncertainty: 0.3049488796296296
20:47:33.602 |     INFO |       log_parameters |   uncertainty_range: [0.206519, 0.354491]
20:47:33.602 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:33.602 |     INFO |       log_parameters |   feature_costs_shape: (57, 54)
20:47:33.602 |     INFO |       log_parameters |   feature_costs_min: 1.0000419942514858
20:47:33.602 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:33.602 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:33.602 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:33.602 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:33.602 |     INFO |       log_parameters |   original_shape: (57, 54)
20:47:33.602 |     INFO |       log_parameters |   augmented_shape: (111, 111)
20:47:33.602 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:33.602 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:33.602 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:33.602 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:33.602 |    DEBUG |            log_debug |   observed_positions.shape: (54, 2)
20:47:33.602 |    DEBUG |            log_debug |   num_features (from observed_positions): 54
20:47:33.602 |    DEBUG |            log_debug |   predicted_positions.shape: (57, 2)
20:47:33.602 |    DEBUG |            log_debug |   predicted_velocities.shape: (57, 2)
20:47:33.602 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (54, 4)
20:47:33.602 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=54 but predicted_positions has 57 rows
20:47:33.602 |    ERROR |            log_error |   This will cause index 53 to fail when array only goes to 56
20:47:33.602 |    DEBUG |            log_debug | Kalman update: 54 features, state_dim=4, prob_dim=2
20:47:33.603 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman update):
20:47:33.603 |     INFO |       log_parameters |   features_updated: 54
20:47:33.603 |     INFO |       log_parameters |   state_dim: 4
20:47:33.603 |     INFO |       log_parameters |   dt_used: 1.0
20:47:33.603 |     INFO |       log_parameters |   process_noise_scale: 1.0
20:47:33.603 |     INFO |       log_parameters |   measurement_noise_scale: 1.0
20:47:33.603 |     INFO |             log_info | Enhanced linking completed successfully for frame 13
20:47:33.603 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0052 seconds
20:47:33.813 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=14, prob_dim=2, num_features_frame1=54, num_features_frame2=49)
20:47:33.813 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:33.813 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:33.813 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:33.813 |     INFO |       log_parameters |   current_frame: 14
20:47:33.813 |     INFO |       log_parameters |   prob_dim: 2
20:47:33.813 |     INFO |       log_parameters |   num_features_frame1: 54
20:47:33.813 |     INFO |       log_parameters |   num_features_frame2: 49
20:47:33.813 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:33.813 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:33.813 |     INFO |       log_parameters |   linear_motion: 1
20:47:33.813 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:33.813 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:33.813 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:33.813 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:33.813 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:33.813 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:33.813 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:33.813 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:33.813 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:33.813 |     INFO |       log_parameters |   use_local_density: 0
20:47:33.813 |     INFO |       log_parameters |   nn_window: 5
20:47:33.813 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:33.813 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:33.813 |     INFO |       log_parameters |   len_for_classify: 5
20:47:33.813 |     INFO |       log_parameters |   res_limit: 0.1
20:47:33.813 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:33.813 |     INFO |       log_parameters |   strategy_bd: -1
20:47:33.813 |     INFO |       log_parameters |   lft_cdf: None
20:47:33.813 |     INFO |       log_parameters |   kalman_init_param: None
20:47:33.813 |     INFO |       log_parameters |   diagnostics: None
20:47:33.813 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:33.813 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:33.813 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:33.813 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:33.813 |     INFO |       log_parameters |   coords_shape: (54, 2)
20:47:33.813 |     INFO |       log_parameters |   uncertainties_shape: (54, 2)
20:47:33.813 |     INFO |       log_parameters |   mean_uncertainty: 0.3049488796296296
20:47:33.813 |     INFO |       log_parameters |   uncertainty_range: [0.206519, 0.354491]
20:47:33.813 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:33.813 |     INFO |       log_parameters |   coords_shape: (49, 2)
20:47:33.813 |     INFO |       log_parameters |   uncertainties_shape: (49, 2)
20:47:33.813 |     INFO |       log_parameters |   mean_uncertainty: 0.3016802142857143
20:47:33.813 |     INFO |       log_parameters |   uncertainty_range: [0.216022, 0.359002]
20:47:33.813 |    DEBUG |            log_debug | Initializing Kalman for 49 features, prob_dim=2, state_dim=4
20:47:33.813 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:33.813 |     INFO |       log_parameters |   num_features: 49
20:47:33.813 |     INFO |       log_parameters |   state_dim: 4
20:47:33.813 |     INFO |       log_parameters |   prob_dim: 2
20:47:33.813 |     INFO |       log_parameters |   state_vec_shape: (49, 4)
20:47:33.813 |     INFO |       log_parameters |   state_noise_var_shape: (49, 4, 4)
20:47:33.814 |    DEBUG |            log_debug | State vector shape: (54, 4), Expected: (54, 4)
20:47:33.814 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:33.814 |     INFO |       log_parameters |   num_features_predicted: 54
20:47:33.814 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:33.814 |     INFO |       log_parameters |   brownian_motion_features: 54
20:47:33.814 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:33.814 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:33.814 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:33.814 |     INFO |       log_parameters |   search_radii_shape: (54, 2)
20:47:33.814 |     INFO |       log_parameters |   min_radius: 0.1
20:47:33.814 |     INFO |       log_parameters |   max_radius: 0.1
20:47:33.814 |     INFO |       log_parameters |   mean_radius: 0.09999999999999999
20:47:33.814 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:33.814 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999999
20:47:33.815 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:33.815 |     INFO |       log_parameters |   distance_matrix_shape: (54, 49)
20:47:33.815 |     INFO |       log_parameters |   cost_matrix_shape: (54, 49)
20:47:33.815 |     INFO |       log_parameters |   finite_costs: 2646
20:47:33.815 |     INFO |       log_parameters |   infinite_costs: 0
20:47:33.815 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:33.815 |     INFO |       log_parameters |   min_distance: 17.188489117706247
20:47:33.815 |     INFO |       log_parameters |   max_distance: 132.44010489282576
20:47:33.815 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:33.815 |     INFO |       log_parameters |   motion_costs_shape: (54, 49)
20:47:33.815 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:33.815 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:33.815 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:33.815 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:33.815 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:33.816 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:33.816 |     INFO |       log_parameters |   coords_shape: (54, 2)
20:47:33.816 |     INFO |       log_parameters |   uncertainties_shape: (54, 2)
20:47:33.816 |     INFO |       log_parameters |   mean_uncertainty: 0.3049488796296296
20:47:33.816 |     INFO |       log_parameters |   uncertainty_range: [0.206519, 0.354491]
20:47:33.816 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:33.816 |     INFO |       log_parameters |   coords_shape: (49, 2)
20:47:33.816 |     INFO |       log_parameters |   uncertainties_shape: (49, 2)
20:47:33.816 |     INFO |       log_parameters |   mean_uncertainty: 0.3016802142857143
20:47:33.816 |     INFO |       log_parameters |   uncertainty_range: [0.216022, 0.359002]
20:47:33.817 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:33.817 |     INFO |       log_parameters |   feature_costs_shape: (54, 49)
20:47:33.817 |     INFO |       log_parameters |   feature_costs_min: 1.000034367444103
20:47:33.817 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:33.817 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:33.817 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:33.817 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:33.817 |     INFO |       log_parameters |   original_shape: (54, 49)
20:47:33.817 |     INFO |       log_parameters |   augmented_shape: (103, 103)
20:47:33.817 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:33.817 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:33.817 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:33.817 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:33.817 |    DEBUG |            log_debug |   observed_positions.shape: (49, 2)
20:47:33.817 |    DEBUG |            log_debug |   num_features (from observed_positions): 49
20:47:33.817 |    DEBUG |            log_debug |   predicted_positions.shape: (54, 2)
20:47:33.817 |    DEBUG |            log_debug |   predicted_velocities.shape: (54, 2)
20:47:33.817 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (49, 4)
20:47:33.817 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=49 but predicted_positions has 54 rows
20:47:33.817 |    ERROR |            log_error |   This will cause index 48 to fail when array only goes to 53
20:47:33.817 |    DEBUG |            log_debug | Kalman update: 49 features, state_dim=4, prob_dim=2
20:47:33.818 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman update):
20:47:33.818 |     INFO |       log_parameters |   features_updated: 49
20:47:33.818 |     INFO |       log_parameters |   state_dim: 4
20:47:33.818 |     INFO |       log_parameters |   dt_used: 1.0
20:47:33.818 |     INFO |       log_parameters |   process_noise_scale: 1.0
20:47:33.818 |     INFO |       log_parameters |   measurement_noise_scale: 1.0
20:47:33.818 |     INFO |             log_info | Enhanced linking completed successfully for frame 14
20:47:33.818 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0048 seconds
20:47:34.002 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=15, prob_dim=2, num_features_frame1=49, num_features_frame2=58)
20:47:34.002 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:34.002 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:34.002 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:34.002 |     INFO |       log_parameters |   current_frame: 15
20:47:34.002 |     INFO |       log_parameters |   prob_dim: 2
20:47:34.002 |     INFO |       log_parameters |   num_features_frame1: 49
20:47:34.002 |     INFO |       log_parameters |   num_features_frame2: 58
20:47:34.002 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:34.002 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:34.002 |     INFO |       log_parameters |   linear_motion: 1
20:47:34.002 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:34.002 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:34.002 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:34.002 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:34.002 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:34.002 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:34.002 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:34.002 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:34.002 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:34.002 |     INFO |       log_parameters |   use_local_density: 0
20:47:34.002 |     INFO |       log_parameters |   nn_window: 5
20:47:34.002 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:34.002 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:34.002 |     INFO |       log_parameters |   len_for_classify: 5
20:47:34.002 |     INFO |       log_parameters |   res_limit: 0.1
20:47:34.002 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:34.002 |     INFO |       log_parameters |   strategy_bd: -1
20:47:34.002 |     INFO |       log_parameters |   lft_cdf: None
20:47:34.002 |     INFO |       log_parameters |   kalman_init_param: None
20:47:34.002 |     INFO |       log_parameters |   diagnostics: None
20:47:34.002 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:34.002 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:34.002 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:34.002 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:34.002 |     INFO |       log_parameters |   coords_shape: (49, 2)
20:47:34.002 |     INFO |       log_parameters |   uncertainties_shape: (49, 2)
20:47:34.002 |     INFO |       log_parameters |   mean_uncertainty: 0.3016802142857143
20:47:34.002 |     INFO |       log_parameters |   uncertainty_range: [0.216022, 0.359002]
20:47:34.002 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:34.002 |     INFO |       log_parameters |   coords_shape: (58, 2)
20:47:34.002 |     INFO |       log_parameters |   uncertainties_shape: (58, 2)
20:47:34.002 |     INFO |       log_parameters |   mean_uncertainty: 0.3087171896551724
20:47:34.002 |     INFO |       log_parameters |   uncertainty_range: [0.218992, 0.356148]
20:47:34.002 |    DEBUG |            log_debug | Initializing Kalman for 58 features, prob_dim=2, state_dim=4
20:47:34.003 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:34.003 |     INFO |       log_parameters |   num_features: 58
20:47:34.003 |     INFO |       log_parameters |   state_dim: 4
20:47:34.003 |     INFO |       log_parameters |   prob_dim: 2
20:47:34.003 |     INFO |       log_parameters |   state_vec_shape: (58, 4)
20:47:34.003 |     INFO |       log_parameters |   state_noise_var_shape: (58, 4, 4)
20:47:34.003 |    DEBUG |            log_debug | State vector shape: (49, 4), Expected: (49, 4)
20:47:34.003 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:34.003 |     INFO |       log_parameters |   num_features_predicted: 49
20:47:34.003 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:34.003 |     INFO |       log_parameters |   brownian_motion_features: 49
20:47:34.003 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:34.003 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:34.003 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:34.003 |     INFO |       log_parameters |   search_radii_shape: (49, 2)
20:47:34.003 |     INFO |       log_parameters |   min_radius: 0.1
20:47:34.003 |     INFO |       log_parameters |   max_radius: 0.1
20:47:34.003 |     INFO |       log_parameters |   mean_radius: 0.09999999999999999
20:47:34.003 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:34.003 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999999
20:47:34.004 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:34.004 |     INFO |       log_parameters |   distance_matrix_shape: (49, 58)
20:47:34.004 |     INFO |       log_parameters |   cost_matrix_shape: (49, 58)
20:47:34.004 |     INFO |       log_parameters |   finite_costs: 2842
20:47:34.004 |     INFO |       log_parameters |   infinite_costs: 0
20:47:34.004 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:34.004 |     INFO |       log_parameters |   min_distance: 20.1770665834541
20:47:34.004 |     INFO |       log_parameters |   max_distance: 132.21285607786
20:47:34.004 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:34.004 |     INFO |       log_parameters |   motion_costs_shape: (49, 58)
20:47:34.004 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:34.004 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:34.004 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:34.004 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:34.004 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:34.006 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:34.006 |     INFO |       log_parameters |   coords_shape: (49, 2)
20:47:34.006 |     INFO |       log_parameters |   uncertainties_shape: (49, 2)
20:47:34.006 |     INFO |       log_parameters |   mean_uncertainty: 0.3016802142857143
20:47:34.006 |     INFO |       log_parameters |   uncertainty_range: [0.216022, 0.359002]
20:47:34.006 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:34.006 |     INFO |       log_parameters |   coords_shape: (58, 2)
20:47:34.006 |     INFO |       log_parameters |   uncertainties_shape: (58, 2)
20:47:34.006 |     INFO |       log_parameters |   mean_uncertainty: 0.3087171896551724
20:47:34.006 |     INFO |       log_parameters |   uncertainty_range: [0.218992, 0.356148]
20:47:34.006 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:34.006 |     INFO |       log_parameters |   feature_costs_shape: (49, 58)
20:47:34.006 |     INFO |       log_parameters |   feature_costs_min: 1.000417578942733
20:47:34.006 |     INFO |       log_parameters |   feature_costs_max: 5.0
20:47:34.006 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:34.006 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:34.006 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:34.006 |     INFO |       log_parameters |   original_shape: (49, 58)
20:47:34.006 |     INFO |       log_parameters |   augmented_shape: (107, 107)
20:47:34.006 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:34.006 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:34.006 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:34.006 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:34.006 |    DEBUG |            log_debug |   observed_positions.shape: (58, 2)
20:47:34.006 |    DEBUG |            log_debug |   num_features (from observed_positions): 58
20:47:34.006 |    DEBUG |            log_debug |   predicted_positions.shape: (49, 2)
20:47:34.006 |    DEBUG |            log_debug |   predicted_velocities.shape: (49, 2)
20:47:34.006 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (58, 4)
20:47:34.006 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=58 but predicted_positions has 49 rows
20:47:34.006 |    ERROR |            log_error |   This will cause index 57 to fail when array only goes to 48
20:47:34.006 |    DEBUG |            log_debug | Kalman update: 58 features, state_dim=4, prob_dim=2
20:47:34.007 |    ERROR |            log_error | Error in enhanced linking: index 49 is out of bounds for axis 0 with size 49
20:47:34.007 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 49 is out of bounds for axis 0 with size 49
20:47:34.007 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0053 seconds
20:47:34.018 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=16, prob_dim=2, num_features_frame1=58, num_features_frame2=55)
20:47:34.018 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:34.018 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:34.018 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:34.018 |     INFO |       log_parameters |   current_frame: 16
20:47:34.018 |     INFO |       log_parameters |   prob_dim: 2
20:47:34.018 |     INFO |       log_parameters |   num_features_frame1: 58
20:47:34.018 |     INFO |       log_parameters |   num_features_frame2: 55
20:47:34.018 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:34.018 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:34.018 |     INFO |       log_parameters |   linear_motion: 1
20:47:34.018 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:34.018 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:34.018 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:34.018 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:34.018 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:34.018 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:34.018 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:34.018 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:34.018 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:34.018 |     INFO |       log_parameters |   use_local_density: 0
20:47:34.018 |     INFO |       log_parameters |   nn_window: 5
20:47:34.018 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:34.018 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:34.018 |     INFO |       log_parameters |   len_for_classify: 5
20:47:34.018 |     INFO |       log_parameters |   res_limit: 0.1
20:47:34.018 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:34.018 |     INFO |       log_parameters |   strategy_bd: -1
20:47:34.018 |     INFO |       log_parameters |   lft_cdf: None
20:47:34.018 |     INFO |       log_parameters |   kalman_init_param: None
20:47:34.018 |     INFO |       log_parameters |   diagnostics: None
20:47:34.018 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:34.018 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:34.018 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:34.018 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:34.018 |     INFO |       log_parameters |   coords_shape: (58, 2)
20:47:34.018 |     INFO |       log_parameters |   uncertainties_shape: (58, 2)
20:47:34.018 |     INFO |       log_parameters |   mean_uncertainty: 0.3087171896551724
20:47:34.018 |     INFO |       log_parameters |   uncertainty_range: [0.218992, 0.356148]
20:47:34.018 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:34.018 |     INFO |       log_parameters |   coords_shape: (55, 2)
20:47:34.018 |     INFO |       log_parameters |   uncertainties_shape: (55, 2)
20:47:34.018 |     INFO |       log_parameters |   mean_uncertainty: 0.3052714818181819
20:47:34.018 |     INFO |       log_parameters |   uncertainty_range: [0.218069, 0.357174]
20:47:34.018 |    DEBUG |            log_debug | Initializing Kalman for 55 features, prob_dim=2, state_dim=4
20:47:34.018 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:34.018 |     INFO |       log_parameters |   num_features: 55
20:47:34.018 |     INFO |       log_parameters |   state_dim: 4
20:47:34.018 |     INFO |       log_parameters |   prob_dim: 2
20:47:34.018 |     INFO |       log_parameters |   state_vec_shape: (55, 4)
20:47:34.018 |     INFO |       log_parameters |   state_noise_var_shape: (55, 4, 4)
20:47:34.018 |    DEBUG |            log_debug | State vector shape: (58, 4), Expected: (58, 4)
20:47:34.019 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:34.019 |     INFO |       log_parameters |   num_features_predicted: 58
20:47:34.019 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:34.019 |     INFO |       log_parameters |   brownian_motion_features: 58
20:47:34.019 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:34.019 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:34.019 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:34.019 |     INFO |       log_parameters |   search_radii_shape: (58, 2)
20:47:34.019 |     INFO |       log_parameters |   min_radius: 0.1
20:47:34.019 |     INFO |       log_parameters |   max_radius: 0.1
20:47:34.019 |     INFO |       log_parameters |   mean_radius: 0.09999999999999999
20:47:34.019 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:34.019 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999999
20:47:34.020 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:34.020 |     INFO |       log_parameters |   distance_matrix_shape: (58, 55)
20:47:34.020 |     INFO |       log_parameters |   cost_matrix_shape: (58, 55)
20:47:34.020 |     INFO |       log_parameters |   finite_costs: 3190
20:47:34.020 |     INFO |       log_parameters |   infinite_costs: 0
20:47:34.020 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:34.020 |     INFO |       log_parameters |   min_distance: 11.65726518630356
20:47:34.020 |     INFO |       log_parameters |   max_distance: 132.4668808388979
20:47:34.020 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:34.020 |     INFO |       log_parameters |   motion_costs_shape: (58, 55)
20:47:34.020 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:34.020 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:34.020 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:34.020 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:34.020 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:34.022 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:34.022 |     INFO |       log_parameters |   coords_shape: (58, 2)
20:47:34.022 |     INFO |       log_parameters |   uncertainties_shape: (58, 2)
20:47:34.022 |     INFO |       log_parameters |   mean_uncertainty: 0.3087171896551724
20:47:34.022 |     INFO |       log_parameters |   uncertainty_range: [0.218992, 0.356148]
20:47:34.022 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:34.022 |     INFO |       log_parameters |   coords_shape: (55, 2)
20:47:34.022 |     INFO |       log_parameters |   uncertainties_shape: (55, 2)
20:47:34.022 |     INFO |       log_parameters |   mean_uncertainty: 0.3052714818181819
20:47:34.022 |     INFO |       log_parameters |   uncertainty_range: [0.218069, 0.357174]
20:47:34.022 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:34.022 |     INFO |       log_parameters |   feature_costs_shape: (58, 55)
20:47:34.022 |     INFO |       log_parameters |   feature_costs_min: 1.0000135313262635
20:47:34.022 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:34.022 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:34.022 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:34.022 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:34.022 |     INFO |       log_parameters |   original_shape: (58, 55)
20:47:34.022 |     INFO |       log_parameters |   augmented_shape: (113, 113)
20:47:34.022 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:34.022 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:34.022 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:34.022 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:34.022 |    DEBUG |            log_debug |   observed_positions.shape: (55, 2)
20:47:34.022 |    DEBUG |            log_debug |   num_features (from observed_positions): 55
20:47:34.022 |    DEBUG |            log_debug |   predicted_positions.shape: (58, 2)
20:47:34.022 |    DEBUG |            log_debug |   predicted_velocities.shape: (58, 2)
20:47:34.022 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (55, 4)
20:47:34.022 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=55 but predicted_positions has 58 rows
20:47:34.022 |    ERROR |            log_error |   This will cause index 54 to fail when array only goes to 57
20:47:34.022 |    DEBUG |            log_debug | Kalman update: 55 features, state_dim=4, prob_dim=2
20:47:34.023 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman update):
20:47:34.023 |     INFO |       log_parameters |   features_updated: 55
20:47:34.023 |     INFO |       log_parameters |   state_dim: 4
20:47:34.023 |     INFO |       log_parameters |   dt_used: 1.0
20:47:34.023 |     INFO |       log_parameters |   process_noise_scale: 1.0
20:47:34.023 |     INFO |       log_parameters |   measurement_noise_scale: 1.0
20:47:34.023 |     INFO |             log_info | Enhanced linking completed successfully for frame 16
20:47:34.023 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0054 seconds
20:47:34.242 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=17, prob_dim=2, num_features_frame1=55, num_features_frame2=54)
20:47:34.242 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:34.242 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:34.242 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:34.242 |     INFO |       log_parameters |   current_frame: 17
20:47:34.242 |     INFO |       log_parameters |   prob_dim: 2
20:47:34.242 |     INFO |       log_parameters |   num_features_frame1: 55
20:47:34.242 |     INFO |       log_parameters |   num_features_frame2: 54
20:47:34.242 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:34.242 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:34.242 |     INFO |       log_parameters |   linear_motion: 1
20:47:34.242 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:34.242 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:34.242 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:34.242 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:34.242 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:34.242 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:34.242 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:34.242 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:34.242 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:34.242 |     INFO |       log_parameters |   use_local_density: 0
20:47:34.242 |     INFO |       log_parameters |   nn_window: 5
20:47:34.242 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:34.242 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:34.242 |     INFO |       log_parameters |   len_for_classify: 5
20:47:34.242 |     INFO |       log_parameters |   res_limit: 0.1
20:47:34.242 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:34.242 |     INFO |       log_parameters |   strategy_bd: -1
20:47:34.243 |     INFO |       log_parameters |   lft_cdf: None
20:47:34.243 |     INFO |       log_parameters |   kalman_init_param: None
20:47:34.243 |     INFO |       log_parameters |   diagnostics: None
20:47:34.243 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:34.243 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:34.243 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:34.243 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:34.243 |     INFO |       log_parameters |   coords_shape: (55, 2)
20:47:34.243 |     INFO |       log_parameters |   uncertainties_shape: (55, 2)
20:47:34.243 |     INFO |       log_parameters |   mean_uncertainty: 0.3052714818181819
20:47:34.243 |     INFO |       log_parameters |   uncertainty_range: [0.218069, 0.357174]
20:47:34.243 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:34.243 |     INFO |       log_parameters |   coords_shape: (54, 2)
20:47:34.243 |     INFO |       log_parameters |   uncertainties_shape: (54, 2)
20:47:34.243 |     INFO |       log_parameters |   mean_uncertainty: 0.3081475092592594
20:47:34.243 |     INFO |       log_parameters |   uncertainty_range: [0.220847, 0.35562]
20:47:34.243 |    DEBUG |            log_debug | Initializing Kalman for 54 features, prob_dim=2, state_dim=4
20:47:34.243 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:34.243 |     INFO |       log_parameters |   num_features: 54
20:47:34.243 |     INFO |       log_parameters |   state_dim: 4
20:47:34.243 |     INFO |       log_parameters |   prob_dim: 2
20:47:34.243 |     INFO |       log_parameters |   state_vec_shape: (54, 4)
20:47:34.243 |     INFO |       log_parameters |   state_noise_var_shape: (54, 4, 4)
20:47:34.243 |    DEBUG |            log_debug | State vector shape: (55, 4), Expected: (55, 4)
20:47:34.243 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:34.243 |     INFO |       log_parameters |   num_features_predicted: 55
20:47:34.243 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:34.243 |     INFO |       log_parameters |   brownian_motion_features: 55
20:47:34.243 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:34.243 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:34.243 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:34.243 |     INFO |       log_parameters |   search_radii_shape: (55, 2)
20:47:34.243 |     INFO |       log_parameters |   min_radius: 0.1
20:47:34.243 |     INFO |       log_parameters |   max_radius: 0.1
20:47:34.243 |     INFO |       log_parameters |   mean_radius: 0.09999999999999998
20:47:34.243 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:34.243 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999998
20:47:34.244 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:34.244 |     INFO |       log_parameters |   distance_matrix_shape: (55, 54)
20:47:34.244 |     INFO |       log_parameters |   cost_matrix_shape: (55, 54)
20:47:34.244 |     INFO |       log_parameters |   finite_costs: 2970
20:47:34.244 |     INFO |       log_parameters |   infinite_costs: 0
20:47:34.244 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:34.244 |     INFO |       log_parameters |   min_distance: 15.611114519582642
20:47:34.244 |     INFO |       log_parameters |   max_distance: 132.23138403614092
20:47:34.244 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:34.244 |     INFO |       log_parameters |   motion_costs_shape: (55, 54)
20:47:34.244 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:34.244 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:34.244 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:34.244 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:34.244 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:34.246 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:34.246 |     INFO |       log_parameters |   coords_shape: (55, 2)
20:47:34.246 |     INFO |       log_parameters |   uncertainties_shape: (55, 2)
20:47:34.246 |     INFO |       log_parameters |   mean_uncertainty: 0.3052714818181819
20:47:34.246 |     INFO |       log_parameters |   uncertainty_range: [0.218069, 0.357174]
20:47:34.246 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:34.246 |     INFO |       log_parameters |   coords_shape: (54, 2)
20:47:34.246 |     INFO |       log_parameters |   uncertainties_shape: (54, 2)
20:47:34.246 |     INFO |       log_parameters |   mean_uncertainty: 0.3081475092592594
20:47:34.246 |     INFO |       log_parameters |   uncertainty_range: [0.220847, 0.35562]
20:47:34.246 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:34.246 |     INFO |       log_parameters |   feature_costs_shape: (55, 54)
20:47:34.246 |     INFO |       log_parameters |   feature_costs_min: 1.0000405877329892
20:47:34.246 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:34.246 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:34.246 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:34.246 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:34.246 |     INFO |       log_parameters |   original_shape: (55, 54)
20:47:34.246 |     INFO |       log_parameters |   augmented_shape: (109, 109)
20:47:34.246 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:34.246 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:34.246 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:34.246 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:34.246 |    DEBUG |            log_debug |   observed_positions.shape: (54, 2)
20:47:34.246 |    DEBUG |            log_debug |   num_features (from observed_positions): 54
20:47:34.246 |    DEBUG |            log_debug |   predicted_positions.shape: (55, 2)
20:47:34.246 |    DEBUG |            log_debug |   predicted_velocities.shape: (55, 2)
20:47:34.246 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (54, 4)
20:47:34.246 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=54 but predicted_positions has 55 rows
20:47:34.246 |    ERROR |            log_error |   This will cause index 53 to fail when array only goes to 54
20:47:34.246 |    DEBUG |            log_debug | Kalman update: 54 features, state_dim=4, prob_dim=2
20:47:34.247 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman update):
20:47:34.247 |     INFO |       log_parameters |   features_updated: 54
20:47:34.247 |     INFO |       log_parameters |   state_dim: 4
20:47:34.247 |     INFO |       log_parameters |   dt_used: 1.0
20:47:34.247 |     INFO |       log_parameters |   process_noise_scale: 1.0
20:47:34.247 |     INFO |       log_parameters |   measurement_noise_scale: 1.0
20:47:34.247 |     INFO |             log_info | Enhanced linking completed successfully for frame 17
20:47:34.247 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0052 seconds
20:47:34.455 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=18, prob_dim=2, num_features_frame1=54, num_features_frame2=52)
20:47:34.455 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:34.455 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:34.455 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:34.455 |     INFO |       log_parameters |   current_frame: 18
20:47:34.455 |     INFO |       log_parameters |   prob_dim: 2
20:47:34.455 |     INFO |       log_parameters |   num_features_frame1: 54
20:47:34.455 |     INFO |       log_parameters |   num_features_frame2: 52
20:47:34.455 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:34.455 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:34.455 |     INFO |       log_parameters |   linear_motion: 1
20:47:34.455 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:34.455 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:34.455 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:34.455 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:34.455 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:34.455 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:34.455 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:34.455 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:34.455 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:34.455 |     INFO |       log_parameters |   use_local_density: 0
20:47:34.455 |     INFO |       log_parameters |   nn_window: 5
20:47:34.455 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:34.455 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:34.455 |     INFO |       log_parameters |   len_for_classify: 5
20:47:34.455 |     INFO |       log_parameters |   res_limit: 0.1
20:47:34.455 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:34.455 |     INFO |       log_parameters |   strategy_bd: -1
20:47:34.455 |     INFO |       log_parameters |   lft_cdf: None
20:47:34.455 |     INFO |       log_parameters |   kalman_init_param: None
20:47:34.455 |     INFO |       log_parameters |   diagnostics: None
20:47:34.455 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:34.455 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:34.455 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:34.455 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:34.455 |     INFO |       log_parameters |   coords_shape: (54, 2)
20:47:34.455 |     INFO |       log_parameters |   uncertainties_shape: (54, 2)
20:47:34.455 |     INFO |       log_parameters |   mean_uncertainty: 0.3081475092592594
20:47:34.455 |     INFO |       log_parameters |   uncertainty_range: [0.220847, 0.35562]
20:47:34.455 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:34.455 |     INFO |       log_parameters |   coords_shape: (52, 2)
20:47:34.455 |     INFO |       log_parameters |   uncertainties_shape: (52, 2)
20:47:34.455 |     INFO |       log_parameters |   mean_uncertainty: 0.3043214134615385
20:47:34.455 |     INFO |       log_parameters |   uncertainty_range: [0.217274, 0.354212]
20:47:34.455 |    DEBUG |            log_debug | Initializing Kalman for 52 features, prob_dim=2, state_dim=4
20:47:34.455 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:34.455 |     INFO |       log_parameters |   num_features: 52
20:47:34.455 |     INFO |       log_parameters |   state_dim: 4
20:47:34.455 |     INFO |       log_parameters |   prob_dim: 2
20:47:34.455 |     INFO |       log_parameters |   state_vec_shape: (52, 4)
20:47:34.455 |     INFO |       log_parameters |   state_noise_var_shape: (52, 4, 4)
20:47:34.455 |    DEBUG |            log_debug | State vector shape: (54, 4), Expected: (54, 4)
20:47:34.456 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:34.456 |     INFO |       log_parameters |   num_features_predicted: 54
20:47:34.456 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:34.456 |     INFO |       log_parameters |   brownian_motion_features: 54
20:47:34.456 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:34.456 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:34.456 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:34.456 |     INFO |       log_parameters |   search_radii_shape: (54, 2)
20:47:34.456 |     INFO |       log_parameters |   min_radius: 0.1
20:47:34.456 |     INFO |       log_parameters |   max_radius: 0.1
20:47:34.456 |     INFO |       log_parameters |   mean_radius: 0.09999999999999999
20:47:34.456 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:34.456 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999999
20:47:34.457 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:34.457 |     INFO |       log_parameters |   distance_matrix_shape: (54, 52)
20:47:34.457 |     INFO |       log_parameters |   cost_matrix_shape: (54, 52)
20:47:34.457 |     INFO |       log_parameters |   finite_costs: 2808
20:47:34.457 |     INFO |       log_parameters |   infinite_costs: 0
20:47:34.457 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:34.457 |     INFO |       log_parameters |   min_distance: 17.020843352361716
20:47:34.457 |     INFO |       log_parameters |   max_distance: 132.3209569840512
20:47:34.457 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:34.457 |     INFO |       log_parameters |   motion_costs_shape: (54, 52)
20:47:34.457 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:34.457 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:34.457 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:34.457 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:34.457 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:34.458 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:34.458 |     INFO |       log_parameters |   coords_shape: (54, 2)
20:47:34.458 |     INFO |       log_parameters |   uncertainties_shape: (54, 2)
20:47:34.458 |     INFO |       log_parameters |   mean_uncertainty: 0.3081475092592594
20:47:34.458 |     INFO |       log_parameters |   uncertainty_range: [0.220847, 0.35562]
20:47:34.458 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:34.458 |     INFO |       log_parameters |   coords_shape: (52, 2)
20:47:34.459 |     INFO |       log_parameters |   uncertainties_shape: (52, 2)
20:47:34.459 |     INFO |       log_parameters |   mean_uncertainty: 0.3043214134615385
20:47:34.459 |     INFO |       log_parameters |   uncertainty_range: [0.217274, 0.354212]
20:47:34.459 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:34.459 |     INFO |       log_parameters |   feature_costs_shape: (54, 52)
20:47:34.459 |     INFO |       log_parameters |   feature_costs_min: 1.0001331313125355
20:47:34.459 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:34.459 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:34.459 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:34.459 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:34.459 |     INFO |       log_parameters |   original_shape: (54, 52)
20:47:34.459 |     INFO |       log_parameters |   augmented_shape: (106, 106)
20:47:34.459 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:34.459 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:34.459 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:34.459 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:34.459 |    DEBUG |            log_debug |   observed_positions.shape: (52, 2)
20:47:34.459 |    DEBUG |            log_debug |   num_features (from observed_positions): 52
20:47:34.459 |    DEBUG |            log_debug |   predicted_positions.shape: (54, 2)
20:47:34.459 |    DEBUG |            log_debug |   predicted_velocities.shape: (54, 2)
20:47:34.459 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (52, 4)
20:47:34.459 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=52 but predicted_positions has 54 rows
20:47:34.459 |    ERROR |            log_error |   This will cause index 51 to fail when array only goes to 53
20:47:34.459 |    DEBUG |            log_debug | Kalman update: 52 features, state_dim=4, prob_dim=2
20:47:34.460 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman update):
20:47:34.460 |     INFO |       log_parameters |   features_updated: 52
20:47:34.460 |     INFO |       log_parameters |   state_dim: 4
20:47:34.460 |     INFO |       log_parameters |   dt_used: 1.0
20:47:34.460 |     INFO |       log_parameters |   process_noise_scale: 1.0
20:47:34.460 |     INFO |       log_parameters |   measurement_noise_scale: 1.0
20:47:34.460 |     INFO |             log_info | Enhanced linking completed successfully for frame 18
20:47:34.460 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0050 seconds
20:47:34.656 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=19, prob_dim=2, num_features_frame1=52, num_features_frame2=52)
20:47:34.656 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:34.656 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:34.656 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:34.656 |     INFO |       log_parameters |   current_frame: 19
20:47:34.656 |     INFO |       log_parameters |   prob_dim: 2
20:47:34.656 |     INFO |       log_parameters |   num_features_frame1: 52
20:47:34.656 |     INFO |       log_parameters |   num_features_frame2: 52
20:47:34.656 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:34.656 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:34.656 |     INFO |       log_parameters |   linear_motion: 1
20:47:34.656 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:34.656 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:34.656 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:34.656 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:34.656 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:34.656 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:34.656 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:34.656 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:34.656 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:34.656 |     INFO |       log_parameters |   use_local_density: 0
20:47:34.656 |     INFO |       log_parameters |   nn_window: 5
20:47:34.656 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:34.656 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:34.656 |     INFO |       log_parameters |   len_for_classify: 5
20:47:34.656 |     INFO |       log_parameters |   res_limit: 0.1
20:47:34.656 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:34.656 |     INFO |       log_parameters |   strategy_bd: -1
20:47:34.656 |     INFO |       log_parameters |   lft_cdf: None
20:47:34.656 |     INFO |       log_parameters |   kalman_init_param: None
20:47:34.656 |     INFO |       log_parameters |   diagnostics: None
20:47:34.656 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:34.656 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:34.656 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:34.656 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:34.656 |     INFO |       log_parameters |   coords_shape: (52, 2)
20:47:34.656 |     INFO |       log_parameters |   uncertainties_shape: (52, 2)
20:47:34.656 |     INFO |       log_parameters |   mean_uncertainty: 0.3043214134615385
20:47:34.657 |     INFO |       log_parameters |   uncertainty_range: [0.217274, 0.354212]
20:47:34.657 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:34.657 |     INFO |       log_parameters |   coords_shape: (52, 2)
20:47:34.657 |     INFO |       log_parameters |   uncertainties_shape: (52, 2)
20:47:34.657 |     INFO |       log_parameters |   mean_uncertainty: 0.3055267596153846
20:47:34.657 |     INFO |       log_parameters |   uncertainty_range: [0.220021, 0.357225]
20:47:34.657 |    DEBUG |            log_debug | Initializing Kalman for 52 features, prob_dim=2, state_dim=4
20:47:34.657 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:34.657 |     INFO |       log_parameters |   num_features: 52
20:47:34.657 |     INFO |       log_parameters |   state_dim: 4
20:47:34.657 |     INFO |       log_parameters |   prob_dim: 2
20:47:34.657 |     INFO |       log_parameters |   state_vec_shape: (52, 4)
20:47:34.657 |     INFO |       log_parameters |   state_noise_var_shape: (52, 4, 4)
20:47:34.657 |    DEBUG |            log_debug | State vector shape: (52, 4), Expected: (52, 4)
20:47:34.657 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:34.657 |     INFO |       log_parameters |   num_features_predicted: 52
20:47:34.657 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:34.657 |     INFO |       log_parameters |   brownian_motion_features: 52
20:47:34.657 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:34.657 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:34.657 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:34.657 |     INFO |       log_parameters |   search_radii_shape: (52, 2)
20:47:34.657 |     INFO |       log_parameters |   min_radius: 0.1
20:47:34.657 |     INFO |       log_parameters |   max_radius: 0.1
20:47:34.657 |     INFO |       log_parameters |   mean_radius: 0.1
20:47:34.657 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:34.657 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.1
20:47:34.658 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:34.658 |     INFO |       log_parameters |   distance_matrix_shape: (52, 52)
20:47:34.658 |     INFO |       log_parameters |   cost_matrix_shape: (52, 52)
20:47:34.658 |     INFO |       log_parameters |   finite_costs: 2704
20:47:34.658 |     INFO |       log_parameters |   infinite_costs: 0
20:47:34.658 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:34.658 |     INFO |       log_parameters |   min_distance: 9.859017871337743
20:47:34.658 |     INFO |       log_parameters |   max_distance: 132.29810221424086
20:47:34.658 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:34.658 |     INFO |       log_parameters |   motion_costs_shape: (52, 52)
20:47:34.658 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:34.658 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:34.658 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:34.658 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:34.658 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:34.660 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:34.660 |     INFO |       log_parameters |   coords_shape: (52, 2)
20:47:34.660 |     INFO |       log_parameters |   uncertainties_shape: (52, 2)
20:47:34.660 |     INFO |       log_parameters |   mean_uncertainty: 0.3043214134615385
20:47:34.660 |     INFO |       log_parameters |   uncertainty_range: [0.217274, 0.354212]
20:47:34.660 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:34.660 |     INFO |       log_parameters |   coords_shape: (52, 2)
20:47:34.660 |     INFO |       log_parameters |   uncertainties_shape: (52, 2)
20:47:34.660 |     INFO |       log_parameters |   mean_uncertainty: 0.3055267596153846
20:47:34.660 |     INFO |       log_parameters |   uncertainty_range: [0.220021, 0.357225]
20:47:34.660 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:34.660 |     INFO |       log_parameters |   feature_costs_shape: (52, 52)
20:47:34.660 |     INFO |       log_parameters |   feature_costs_min: 1.0001302429761902
20:47:34.660 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:34.660 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:34.660 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:34.660 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:34.660 |     INFO |       log_parameters |   original_shape: (52, 52)
20:47:34.660 |     INFO |       log_parameters |   augmented_shape: (104, 104)
20:47:34.660 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:34.660 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:34.660 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:34.660 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:34.660 |    DEBUG |            log_debug |   observed_positions.shape: (52, 2)
20:47:34.660 |    DEBUG |            log_debug |   num_features (from observed_positions): 52
20:47:34.660 |    DEBUG |            log_debug |   predicted_positions.shape: (52, 2)
20:47:34.660 |    DEBUG |            log_debug |   predicted_velocities.shape: (52, 2)
20:47:34.660 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (52, 4)
20:47:34.660 |    DEBUG |            log_debug | Kalman update: 52 features, state_dim=4, prob_dim=2
20:47:34.661 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman update):
20:47:34.661 |     INFO |       log_parameters |   features_updated: 52
20:47:34.661 |     INFO |       log_parameters |   state_dim: 4
20:47:34.661 |     INFO |       log_parameters |   dt_used: 1.0
20:47:34.661 |     INFO |       log_parameters |   process_noise_scale: 1.0
20:47:34.661 |     INFO |       log_parameters |   measurement_noise_scale: 1.0
20:47:34.661 |     INFO |             log_info | Enhanced linking completed successfully for frame 19
20:47:34.661 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0049 seconds
20:47:34.854 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=20, prob_dim=2, num_features_frame1=52, num_features_frame2=56)
20:47:34.854 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:34.854 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:34.854 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:34.854 |     INFO |       log_parameters |   current_frame: 20
20:47:34.854 |     INFO |       log_parameters |   prob_dim: 2
20:47:34.854 |     INFO |       log_parameters |   num_features_frame1: 52
20:47:34.854 |     INFO |       log_parameters |   num_features_frame2: 56
20:47:34.854 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:34.854 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:34.854 |     INFO |       log_parameters |   linear_motion: 1
20:47:34.854 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:34.854 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:34.854 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:34.854 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:34.854 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:34.854 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:34.854 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:34.854 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:34.854 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:34.854 |     INFO |       log_parameters |   use_local_density: 0
20:47:34.854 |     INFO |       log_parameters |   nn_window: 5
20:47:34.854 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:34.854 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:34.854 |     INFO |       log_parameters |   len_for_classify: 5
20:47:34.854 |     INFO |       log_parameters |   res_limit: 0.1
20:47:34.854 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:34.854 |     INFO |       log_parameters |   strategy_bd: -1
20:47:34.854 |     INFO |       log_parameters |   lft_cdf: None
20:47:34.854 |     INFO |       log_parameters |   kalman_init_param: None
20:47:34.854 |     INFO |       log_parameters |   diagnostics: None
20:47:34.854 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:34.854 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:34.854 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:34.855 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:34.855 |     INFO |       log_parameters |   coords_shape: (52, 2)
20:47:34.855 |     INFO |       log_parameters |   uncertainties_shape: (52, 2)
20:47:34.855 |     INFO |       log_parameters |   mean_uncertainty: 0.3055267596153846
20:47:34.855 |     INFO |       log_parameters |   uncertainty_range: [0.220021, 0.357225]
20:47:34.855 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:34.855 |     INFO |       log_parameters |   coords_shape: (56, 2)
20:47:34.855 |     INFO |       log_parameters |   uncertainties_shape: (56, 2)
20:47:34.855 |     INFO |       log_parameters |   mean_uncertainty: 0.30962084821428576
20:47:34.855 |     INFO |       log_parameters |   uncertainty_range: [0.219031, 0.355357]
20:47:34.855 |    DEBUG |            log_debug | Initializing Kalman for 56 features, prob_dim=2, state_dim=4
20:47:34.855 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:34.855 |     INFO |       log_parameters |   num_features: 56
20:47:34.855 |     INFO |       log_parameters |   state_dim: 4
20:47:34.855 |     INFO |       log_parameters |   prob_dim: 2
20:47:34.855 |     INFO |       log_parameters |   state_vec_shape: (56, 4)
20:47:34.855 |     INFO |       log_parameters |   state_noise_var_shape: (56, 4, 4)
20:47:34.855 |    DEBUG |            log_debug | State vector shape: (52, 4), Expected: (52, 4)
20:47:34.855 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:34.855 |     INFO |       log_parameters |   num_features_predicted: 52
20:47:34.855 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:34.855 |     INFO |       log_parameters |   brownian_motion_features: 52
20:47:34.855 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:34.855 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:34.855 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:34.855 |     INFO |       log_parameters |   search_radii_shape: (52, 2)
20:47:34.855 |     INFO |       log_parameters |   min_radius: 0.1
20:47:34.855 |     INFO |       log_parameters |   max_radius: 0.1
20:47:34.855 |     INFO |       log_parameters |   mean_radius: 0.1
20:47:34.855 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:34.855 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.1
20:47:34.856 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:34.856 |     INFO |       log_parameters |   distance_matrix_shape: (52, 56)
20:47:34.856 |     INFO |       log_parameters |   cost_matrix_shape: (52, 56)
20:47:34.856 |     INFO |       log_parameters |   finite_costs: 2912
20:47:34.856 |     INFO |       log_parameters |   infinite_costs: 0
20:47:34.856 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:34.856 |     INFO |       log_parameters |   min_distance: 8.52138454507975
20:47:34.856 |     INFO |       log_parameters |   max_distance: 132.4284630743981
20:47:34.856 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:34.856 |     INFO |       log_parameters |   motion_costs_shape: (52, 56)
20:47:34.856 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:34.856 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:34.856 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:34.856 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:34.856 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:34.858 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:34.858 |     INFO |       log_parameters |   coords_shape: (52, 2)
20:47:34.858 |     INFO |       log_parameters |   uncertainties_shape: (52, 2)
20:47:34.858 |     INFO |       log_parameters |   mean_uncertainty: 0.3055267596153846
20:47:34.858 |     INFO |       log_parameters |   uncertainty_range: [0.220021, 0.357225]
20:47:34.858 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:34.858 |     INFO |       log_parameters |   coords_shape: (56, 2)
20:47:34.858 |     INFO |       log_parameters |   uncertainties_shape: (56, 2)
20:47:34.858 |     INFO |       log_parameters |   mean_uncertainty: 0.30962084821428576
20:47:34.858 |     INFO |       log_parameters |   uncertainty_range: [0.219031, 0.355357]
20:47:34.858 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:34.858 |     INFO |       log_parameters |   feature_costs_shape: (52, 56)
20:47:34.858 |     INFO |       log_parameters |   feature_costs_min: 1.0000381284605275
20:47:34.858 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:34.858 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:34.858 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:34.858 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:34.858 |     INFO |       log_parameters |   original_shape: (52, 56)
20:47:34.858 |     INFO |       log_parameters |   augmented_shape: (108, 108)
20:47:34.858 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:34.858 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:34.858 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:34.858 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:34.858 |    DEBUG |            log_debug |   observed_positions.shape: (56, 2)
20:47:34.858 |    DEBUG |            log_debug |   num_features (from observed_positions): 56
20:47:34.858 |    DEBUG |            log_debug |   predicted_positions.shape: (52, 2)
20:47:34.858 |    DEBUG |            log_debug |   predicted_velocities.shape: (52, 2)
20:47:34.858 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (56, 4)
20:47:34.858 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=56 but predicted_positions has 52 rows
20:47:34.858 |    ERROR |            log_error |   This will cause index 55 to fail when array only goes to 51
20:47:34.858 |    DEBUG |            log_debug | Kalman update: 56 features, state_dim=4, prob_dim=2
20:47:34.859 |    ERROR |            log_error | Error in enhanced linking: index 52 is out of bounds for axis 0 with size 52
20:47:34.859 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 52 is out of bounds for axis 0 with size 52
20:47:34.860 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0053 seconds
20:47:34.870 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=21, prob_dim=2, num_features_frame1=56, num_features_frame2=61)
20:47:34.870 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:34.870 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:34.870 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:34.870 |     INFO |       log_parameters |   current_frame: 21
20:47:34.870 |     INFO |       log_parameters |   prob_dim: 2
20:47:34.870 |     INFO |       log_parameters |   num_features_frame1: 56
20:47:34.870 |     INFO |       log_parameters |   num_features_frame2: 61
20:47:34.870 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:34.870 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:34.870 |     INFO |       log_parameters |   linear_motion: 1
20:47:34.870 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:34.870 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:34.870 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:34.870 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:34.870 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:34.870 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:34.870 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:34.870 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:34.870 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:34.870 |     INFO |       log_parameters |   use_local_density: 0
20:47:34.870 |     INFO |       log_parameters |   nn_window: 5
20:47:34.870 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:34.870 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:34.870 |     INFO |       log_parameters |   len_for_classify: 5
20:47:34.870 |     INFO |       log_parameters |   res_limit: 0.1
20:47:34.870 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:34.870 |     INFO |       log_parameters |   strategy_bd: -1
20:47:34.870 |     INFO |       log_parameters |   lft_cdf: None
20:47:34.870 |     INFO |       log_parameters |   kalman_init_param: None
20:47:34.870 |     INFO |       log_parameters |   diagnostics: None
20:47:34.870 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:34.870 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:34.870 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:34.870 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:34.870 |     INFO |       log_parameters |   coords_shape: (56, 2)
20:47:34.870 |     INFO |       log_parameters |   uncertainties_shape: (56, 2)
20:47:34.870 |     INFO |       log_parameters |   mean_uncertainty: 0.30962084821428576
20:47:34.870 |     INFO |       log_parameters |   uncertainty_range: [0.219031, 0.355357]
20:47:34.870 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:34.870 |     INFO |       log_parameters |   coords_shape: (61, 2)
20:47:34.870 |     INFO |       log_parameters |   uncertainties_shape: (61, 2)
20:47:34.870 |     INFO |       log_parameters |   mean_uncertainty: 0.31081200819672133
20:47:34.870 |     INFO |       log_parameters |   uncertainty_range: [0.217006, 0.358987]
20:47:34.870 |    DEBUG |            log_debug | Initializing Kalman for 61 features, prob_dim=2, state_dim=4
20:47:34.871 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:34.871 |     INFO |       log_parameters |   num_features: 61
20:47:34.871 |     INFO |       log_parameters |   state_dim: 4
20:47:34.871 |     INFO |       log_parameters |   prob_dim: 2
20:47:34.871 |     INFO |       log_parameters |   state_vec_shape: (61, 4)
20:47:34.871 |     INFO |       log_parameters |   state_noise_var_shape: (61, 4, 4)
20:47:34.871 |    DEBUG |            log_debug | State vector shape: (56, 4), Expected: (56, 4)
20:47:34.871 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:34.871 |     INFO |       log_parameters |   num_features_predicted: 56
20:47:34.871 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:34.871 |     INFO |       log_parameters |   brownian_motion_features: 56
20:47:34.871 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:34.871 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:34.871 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:34.871 |     INFO |       log_parameters |   search_radii_shape: (56, 2)
20:47:34.871 |     INFO |       log_parameters |   min_radius: 0.1
20:47:34.871 |     INFO |       log_parameters |   max_radius: 0.1
20:47:34.871 |     INFO |       log_parameters |   mean_radius: 0.1
20:47:34.871 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:34.871 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.1
20:47:34.872 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:34.872 |     INFO |       log_parameters |   distance_matrix_shape: (56, 61)
20:47:34.872 |     INFO |       log_parameters |   cost_matrix_shape: (56, 61)
20:47:34.872 |     INFO |       log_parameters |   finite_costs: 3416
20:47:34.872 |     INFO |       log_parameters |   infinite_costs: 0
20:47:34.872 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:34.872 |     INFO |       log_parameters |   min_distance: 8.096292161055269
20:47:34.872 |     INFO |       log_parameters |   max_distance: 132.3434771512912
20:47:34.872 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:34.872 |     INFO |       log_parameters |   motion_costs_shape: (56, 61)
20:47:34.872 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:34.872 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:34.872 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:34.872 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:34.872 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:34.874 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:34.874 |     INFO |       log_parameters |   coords_shape: (56, 2)
20:47:34.874 |     INFO |       log_parameters |   uncertainties_shape: (56, 2)
20:47:34.874 |     INFO |       log_parameters |   mean_uncertainty: 0.30962084821428576
20:47:34.874 |     INFO |       log_parameters |   uncertainty_range: [0.219031, 0.355357]
20:47:34.874 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:34.874 |     INFO |       log_parameters |   coords_shape: (61, 2)
20:47:34.874 |     INFO |       log_parameters |   uncertainties_shape: (61, 2)
20:47:34.874 |     INFO |       log_parameters |   mean_uncertainty: 0.31081200819672133
20:47:34.874 |     INFO |       log_parameters |   uncertainty_range: [0.217006, 0.358987]
20:47:34.874 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:34.874 |     INFO |       log_parameters |   feature_costs_shape: (56, 61)
20:47:34.874 |     INFO |       log_parameters |   feature_costs_min: 1.000002182683525
20:47:34.874 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:34.874 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:34.874 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:34.874 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:34.874 |     INFO |       log_parameters |   original_shape: (56, 61)
20:47:34.874 |     INFO |       log_parameters |   augmented_shape: (117, 117)
20:47:34.874 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:34.874 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:34.874 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:34.874 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:34.874 |    DEBUG |            log_debug |   observed_positions.shape: (61, 2)
20:47:34.874 |    DEBUG |            log_debug |   num_features (from observed_positions): 61
20:47:34.874 |    DEBUG |            log_debug |   predicted_positions.shape: (56, 2)
20:47:34.874 |    DEBUG |            log_debug |   predicted_velocities.shape: (56, 2)
20:47:34.874 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (61, 4)
20:47:34.874 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=61 but predicted_positions has 56 rows
20:47:34.874 |    ERROR |            log_error |   This will cause index 60 to fail when array only goes to 55
20:47:34.874 |    DEBUG |            log_debug | Kalman update: 61 features, state_dim=4, prob_dim=2
20:47:34.875 |    ERROR |            log_error | Error in enhanced linking: index 56 is out of bounds for axis 0 with size 56
20:47:34.875 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 56 is out of bounds for axis 0 with size 56
20:47:34.876 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0056 seconds
20:47:34.886 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=22, prob_dim=2, num_features_frame1=61, num_features_frame2=56)
20:47:34.886 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:34.886 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:34.886 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:34.886 |     INFO |       log_parameters |   current_frame: 22
20:47:34.886 |     INFO |       log_parameters |   prob_dim: 2
20:47:34.886 |     INFO |       log_parameters |   num_features_frame1: 61
20:47:34.886 |     INFO |       log_parameters |   num_features_frame2: 56
20:47:34.886 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:34.886 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:34.886 |     INFO |       log_parameters |   linear_motion: 1
20:47:34.886 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:34.886 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:34.886 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:34.886 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:34.886 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:34.886 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:34.886 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:34.886 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:34.886 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:34.886 |     INFO |       log_parameters |   use_local_density: 0
20:47:34.886 |     INFO |       log_parameters |   nn_window: 5
20:47:34.886 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:34.886 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:34.886 |     INFO |       log_parameters |   len_for_classify: 5
20:47:34.886 |     INFO |       log_parameters |   res_limit: 0.1
20:47:34.886 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:34.887 |     INFO |       log_parameters |   strategy_bd: -1
20:47:34.887 |     INFO |       log_parameters |   lft_cdf: None
20:47:34.887 |     INFO |       log_parameters |   kalman_init_param: None
20:47:34.887 |     INFO |       log_parameters |   diagnostics: None
20:47:34.887 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:34.887 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:34.887 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:34.887 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:34.887 |     INFO |       log_parameters |   coords_shape: (61, 2)
20:47:34.887 |     INFO |       log_parameters |   uncertainties_shape: (61, 2)
20:47:34.887 |     INFO |       log_parameters |   mean_uncertainty: 0.31081200819672133
20:47:34.887 |     INFO |       log_parameters |   uncertainty_range: [0.217006, 0.358987]
20:47:34.887 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:34.887 |     INFO |       log_parameters |   coords_shape: (56, 2)
20:47:34.887 |     INFO |       log_parameters |   uncertainties_shape: (56, 2)
20:47:34.887 |     INFO |       log_parameters |   mean_uncertainty: 0.3069514732142858
20:47:34.887 |     INFO |       log_parameters |   uncertainty_range: [0.217981, 0.356655]
20:47:34.887 |    DEBUG |            log_debug | Initializing Kalman for 56 features, prob_dim=2, state_dim=4
20:47:34.887 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:34.887 |     INFO |       log_parameters |   num_features: 56
20:47:34.887 |     INFO |       log_parameters |   state_dim: 4
20:47:34.887 |     INFO |       log_parameters |   prob_dim: 2
20:47:34.887 |     INFO |       log_parameters |   state_vec_shape: (56, 4)
20:47:34.887 |     INFO |       log_parameters |   state_noise_var_shape: (56, 4, 4)
20:47:34.887 |    DEBUG |            log_debug | State vector shape: (61, 4), Expected: (61, 4)
20:47:34.887 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:34.887 |     INFO |       log_parameters |   num_features_predicted: 61
20:47:34.887 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:34.887 |     INFO |       log_parameters |   brownian_motion_features: 61
20:47:34.887 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:34.887 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:34.887 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:34.887 |     INFO |       log_parameters |   search_radii_shape: (61, 2)
20:47:34.887 |     INFO |       log_parameters |   min_radius: 0.1
20:47:34.887 |     INFO |       log_parameters |   max_radius: 0.1
20:47:34.887 |     INFO |       log_parameters |   mean_radius: 0.1
20:47:34.888 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:34.888 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.1
20:47:34.888 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:34.888 |     INFO |       log_parameters |   distance_matrix_shape: (61, 56)
20:47:34.888 |     INFO |       log_parameters |   cost_matrix_shape: (61, 56)
20:47:34.888 |     INFO |       log_parameters |   finite_costs: 3416
20:47:34.888 |     INFO |       log_parameters |   infinite_costs: 0
20:47:34.888 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:34.888 |     INFO |       log_parameters |   min_distance: 13.145802317196049
20:47:34.888 |     INFO |       log_parameters |   max_distance: 132.2331457646102
20:47:34.888 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:34.888 |     INFO |       log_parameters |   motion_costs_shape: (61, 56)
20:47:34.888 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:34.888 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:34.888 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:34.888 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:34.888 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:34.890 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:34.890 |     INFO |       log_parameters |   coords_shape: (61, 2)
20:47:34.890 |     INFO |       log_parameters |   uncertainties_shape: (61, 2)
20:47:34.890 |     INFO |       log_parameters |   mean_uncertainty: 0.31081200819672133
20:47:34.890 |     INFO |       log_parameters |   uncertainty_range: [0.217006, 0.358987]
20:47:34.890 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:34.890 |     INFO |       log_parameters |   coords_shape: (56, 2)
20:47:34.890 |     INFO |       log_parameters |   uncertainties_shape: (56, 2)
20:47:34.890 |     INFO |       log_parameters |   mean_uncertainty: 0.3069514732142858
20:47:34.890 |     INFO |       log_parameters |   uncertainty_range: [0.217981, 0.356655]
20:47:34.891 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:34.891 |     INFO |       log_parameters |   feature_costs_shape: (61, 56)
20:47:34.891 |     INFO |       log_parameters |   feature_costs_min: 1.000020453451992
20:47:34.891 |     INFO |       log_parameters |   feature_costs_max: 5.0
20:47:34.891 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:34.891 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:34.891 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:34.891 |     INFO |       log_parameters |   original_shape: (61, 56)
20:47:34.891 |     INFO |       log_parameters |   augmented_shape: (117, 117)
20:47:34.891 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:34.891 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:34.891 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:34.891 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:34.891 |    DEBUG |            log_debug |   observed_positions.shape: (56, 2)
20:47:34.891 |    DEBUG |            log_debug |   num_features (from observed_positions): 56
20:47:34.891 |    DEBUG |            log_debug |   predicted_positions.shape: (61, 2)
20:47:34.891 |    DEBUG |            log_debug |   predicted_velocities.shape: (61, 2)
20:47:34.891 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (56, 4)
20:47:34.891 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=56 but predicted_positions has 61 rows
20:47:34.891 |    ERROR |            log_error |   This will cause index 55 to fail when array only goes to 60
20:47:34.891 |    DEBUG |            log_debug | Kalman update: 56 features, state_dim=4, prob_dim=2
20:47:34.892 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman update):
20:47:34.892 |     INFO |       log_parameters |   features_updated: 56
20:47:34.892 |     INFO |       log_parameters |   state_dim: 4
20:47:34.892 |     INFO |       log_parameters |   dt_used: 1.0
20:47:34.892 |     INFO |       log_parameters |   process_noise_scale: 1.0
20:47:34.892 |     INFO |       log_parameters |   measurement_noise_scale: 1.0
20:47:34.892 |     INFO |             log_info | Enhanced linking completed successfully for frame 22
20:47:34.892 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0055 seconds
20:47:35.121 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=23, prob_dim=2, num_features_frame1=56, num_features_frame2=63)
20:47:35.121 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:35.121 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:35.121 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:35.121 |     INFO |       log_parameters |   current_frame: 23
20:47:35.121 |     INFO |       log_parameters |   prob_dim: 2
20:47:35.121 |     INFO |       log_parameters |   num_features_frame1: 56
20:47:35.121 |     INFO |       log_parameters |   num_features_frame2: 63
20:47:35.121 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:35.121 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:35.121 |     INFO |       log_parameters |   linear_motion: 1
20:47:35.121 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:35.121 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:35.121 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:35.121 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:35.121 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:35.122 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:35.122 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:35.122 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:35.122 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:35.122 |     INFO |       log_parameters |   use_local_density: 0
20:47:35.122 |     INFO |       log_parameters |   nn_window: 5
20:47:35.122 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:35.122 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:35.122 |     INFO |       log_parameters |   len_for_classify: 5
20:47:35.122 |     INFO |       log_parameters |   res_limit: 0.1
20:47:35.122 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:35.122 |     INFO |       log_parameters |   strategy_bd: -1
20:47:35.122 |     INFO |       log_parameters |   lft_cdf: None
20:47:35.122 |     INFO |       log_parameters |   kalman_init_param: None
20:47:35.122 |     INFO |       log_parameters |   diagnostics: None
20:47:35.122 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:35.122 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:35.122 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:35.122 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:35.122 |     INFO |       log_parameters |   coords_shape: (56, 2)
20:47:35.122 |     INFO |       log_parameters |   uncertainties_shape: (56, 2)
20:47:35.122 |     INFO |       log_parameters |   mean_uncertainty: 0.3069514732142858
20:47:35.122 |     INFO |       log_parameters |   uncertainty_range: [0.217981, 0.356655]
20:47:35.122 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:35.122 |     INFO |       log_parameters |   coords_shape: (63, 2)
20:47:35.122 |     INFO |       log_parameters |   uncertainties_shape: (63, 2)
20:47:35.122 |     INFO |       log_parameters |   mean_uncertainty: 0.31283322222222226
20:47:35.122 |     INFO |       log_parameters |   uncertainty_range: [0.216557, 0.361333]
20:47:35.122 |    DEBUG |            log_debug | Initializing Kalman for 63 features, prob_dim=2, state_dim=4
20:47:35.122 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:35.122 |     INFO |       log_parameters |   num_features: 63
20:47:35.122 |     INFO |       log_parameters |   state_dim: 4
20:47:35.122 |     INFO |       log_parameters |   prob_dim: 2
20:47:35.122 |     INFO |       log_parameters |   state_vec_shape: (63, 4)
20:47:35.122 |     INFO |       log_parameters |   state_noise_var_shape: (63, 4, 4)
20:47:35.122 |    DEBUG |            log_debug | State vector shape: (56, 4), Expected: (56, 4)
20:47:35.122 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:35.122 |     INFO |       log_parameters |   num_features_predicted: 56
20:47:35.122 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:35.122 |     INFO |       log_parameters |   brownian_motion_features: 56
20:47:35.122 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:35.122 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:35.123 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:35.123 |     INFO |       log_parameters |   search_radii_shape: (56, 2)
20:47:35.123 |     INFO |       log_parameters |   min_radius: 0.1
20:47:35.123 |     INFO |       log_parameters |   max_radius: 0.1
20:47:35.123 |     INFO |       log_parameters |   mean_radius: 0.1
20:47:35.123 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:35.123 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.1
20:47:35.123 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:35.123 |     INFO |       log_parameters |   distance_matrix_shape: (56, 63)
20:47:35.123 |     INFO |       log_parameters |   cost_matrix_shape: (56, 63)
20:47:35.123 |     INFO |       log_parameters |   finite_costs: 3528
20:47:35.123 |     INFO |       log_parameters |   infinite_costs: 0
20:47:35.123 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:35.123 |     INFO |       log_parameters |   min_distance: 7.657378350211056
20:47:35.123 |     INFO |       log_parameters |   max_distance: 132.40751210497322
20:47:35.123 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:35.123 |     INFO |       log_parameters |   motion_costs_shape: (56, 63)
20:47:35.123 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:35.123 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:35.123 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:35.123 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:35.123 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:35.126 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:35.126 |     INFO |       log_parameters |   coords_shape: (56, 2)
20:47:35.126 |     INFO |       log_parameters |   uncertainties_shape: (56, 2)
20:47:35.126 |     INFO |       log_parameters |   mean_uncertainty: 0.3069514732142858
20:47:35.126 |     INFO |       log_parameters |   uncertainty_range: [0.217981, 0.356655]
20:47:35.126 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:35.126 |     INFO |       log_parameters |   coords_shape: (63, 2)
20:47:35.126 |     INFO |       log_parameters |   uncertainties_shape: (63, 2)
20:47:35.126 |     INFO |       log_parameters |   mean_uncertainty: 0.31283322222222226
20:47:35.126 |     INFO |       log_parameters |   uncertainty_range: [0.216557, 0.361333]
20:47:35.126 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:35.126 |     INFO |       log_parameters |   feature_costs_shape: (56, 63)
20:47:35.126 |     INFO |       log_parameters |   feature_costs_min: 1.0000114021600233
20:47:35.126 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:35.126 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:35.126 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:35.126 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:35.126 |     INFO |       log_parameters |   original_shape: (56, 63)
20:47:35.126 |     INFO |       log_parameters |   augmented_shape: (119, 119)
20:47:35.126 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:35.126 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:35.126 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:35.126 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:35.126 |    DEBUG |            log_debug |   observed_positions.shape: (63, 2)
20:47:35.126 |    DEBUG |            log_debug |   num_features (from observed_positions): 63
20:47:35.126 |    DEBUG |            log_debug |   predicted_positions.shape: (56, 2)
20:47:35.126 |    DEBUG |            log_debug |   predicted_velocities.shape: (56, 2)
20:47:35.126 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (63, 4)
20:47:35.126 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=63 but predicted_positions has 56 rows
20:47:35.126 |    ERROR |            log_error |   This will cause index 62 to fail when array only goes to 55
20:47:35.126 |    DEBUG |            log_debug | Kalman update: 63 features, state_dim=4, prob_dim=2
20:47:35.127 |    ERROR |            log_error | Error in enhanced linking: index 56 is out of bounds for axis 0 with size 56
20:47:35.127 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 56 is out of bounds for axis 0 with size 56
20:47:35.127 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0059 seconds
20:47:35.136 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=24, prob_dim=2, num_features_frame1=63, num_features_frame2=53)
20:47:35.136 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:35.136 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:35.136 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:35.136 |     INFO |       log_parameters |   current_frame: 24
20:47:35.136 |     INFO |       log_parameters |   prob_dim: 2
20:47:35.136 |     INFO |       log_parameters |   num_features_frame1: 63
20:47:35.136 |     INFO |       log_parameters |   num_features_frame2: 53
20:47:35.136 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:35.136 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:35.136 |     INFO |       log_parameters |   linear_motion: 1
20:47:35.136 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:35.136 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:35.137 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:35.137 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:35.137 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:35.137 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:35.137 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:35.137 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:35.137 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:35.137 |     INFO |       log_parameters |   use_local_density: 0
20:47:35.137 |     INFO |       log_parameters |   nn_window: 5
20:47:35.137 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:35.137 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:35.137 |     INFO |       log_parameters |   len_for_classify: 5
20:47:35.137 |     INFO |       log_parameters |   res_limit: 0.1
20:47:35.137 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:35.137 |     INFO |       log_parameters |   strategy_bd: -1
20:47:35.137 |     INFO |       log_parameters |   lft_cdf: None
20:47:35.137 |     INFO |       log_parameters |   kalman_init_param: None
20:47:35.137 |     INFO |       log_parameters |   diagnostics: None
20:47:35.137 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:35.137 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:35.137 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:35.137 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:35.137 |     INFO |       log_parameters |   coords_shape: (63, 2)
20:47:35.137 |     INFO |       log_parameters |   uncertainties_shape: (63, 2)
20:47:35.137 |     INFO |       log_parameters |   mean_uncertainty: 0.31283322222222226
20:47:35.137 |     INFO |       log_parameters |   uncertainty_range: [0.216557, 0.361333]
20:47:35.137 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:35.137 |     INFO |       log_parameters |   coords_shape: (53, 2)
20:47:35.137 |     INFO |       log_parameters |   uncertainties_shape: (53, 2)
20:47:35.137 |     INFO |       log_parameters |   mean_uncertainty: 0.30839475471698113
20:47:35.137 |     INFO |       log_parameters |   uncertainty_range: [0.219002, 0.352134]
20:47:35.137 |    DEBUG |            log_debug | Initializing Kalman for 53 features, prob_dim=2, state_dim=4
20:47:35.137 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:35.137 |     INFO |       log_parameters |   num_features: 53
20:47:35.137 |     INFO |       log_parameters |   state_dim: 4
20:47:35.137 |     INFO |       log_parameters |   prob_dim: 2
20:47:35.137 |     INFO |       log_parameters |   state_vec_shape: (53, 4)
20:47:35.137 |     INFO |       log_parameters |   state_noise_var_shape: (53, 4, 4)
20:47:35.137 |    DEBUG |            log_debug | State vector shape: (63, 4), Expected: (63, 4)
20:47:35.137 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:35.137 |     INFO |       log_parameters |   num_features_predicted: 63
20:47:35.137 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:35.137 |     INFO |       log_parameters |   brownian_motion_features: 63
20:47:35.137 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:35.137 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:35.138 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:35.138 |     INFO |       log_parameters |   search_radii_shape: (63, 2)
20:47:35.138 |     INFO |       log_parameters |   min_radius: 0.1
20:47:35.138 |     INFO |       log_parameters |   max_radius: 0.1
20:47:35.138 |     INFO |       log_parameters |   mean_radius: 0.09999999999999999
20:47:35.138 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:35.138 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999999
20:47:35.138 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:35.138 |     INFO |       log_parameters |   distance_matrix_shape: (63, 53)
20:47:35.138 |     INFO |       log_parameters |   cost_matrix_shape: (63, 53)
20:47:35.138 |     INFO |       log_parameters |   finite_costs: 3339
20:47:35.138 |     INFO |       log_parameters |   infinite_costs: 0
20:47:35.138 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:35.138 |     INFO |       log_parameters |   min_distance: 16.166770211634883
20:47:35.138 |     INFO |       log_parameters |   max_distance: 132.53445492840297
20:47:35.138 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:35.138 |     INFO |       log_parameters |   motion_costs_shape: (63, 53)
20:47:35.138 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:35.138 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:35.139 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:35.139 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:35.139 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:35.140 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:35.140 |     INFO |       log_parameters |   coords_shape: (63, 2)
20:47:35.140 |     INFO |       log_parameters |   uncertainties_shape: (63, 2)
20:47:35.140 |     INFO |       log_parameters |   mean_uncertainty: 0.31283322222222226
20:47:35.140 |     INFO |       log_parameters |   uncertainty_range: [0.216557, 0.361333]
20:47:35.140 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:35.140 |     INFO |       log_parameters |   coords_shape: (53, 2)
20:47:35.140 |     INFO |       log_parameters |   uncertainties_shape: (53, 2)
20:47:35.140 |     INFO |       log_parameters |   mean_uncertainty: 0.30839475471698113
20:47:35.140 |     INFO |       log_parameters |   uncertainty_range: [0.219002, 0.352134]
20:47:35.141 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:35.141 |     INFO |       log_parameters |   feature_costs_shape: (63, 53)
20:47:35.141 |     INFO |       log_parameters |   feature_costs_min: 1.0001255466358971
20:47:35.141 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:35.141 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:35.141 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:35.141 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:35.141 |     INFO |       log_parameters |   original_shape: (63, 53)
20:47:35.141 |     INFO |       log_parameters |   augmented_shape: (116, 116)
20:47:35.141 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:35.141 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:35.141 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:35.141 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:35.141 |    DEBUG |            log_debug |   observed_positions.shape: (53, 2)
20:47:35.141 |    DEBUG |            log_debug |   num_features (from observed_positions): 53
20:47:35.141 |    DEBUG |            log_debug |   predicted_positions.shape: (63, 2)
20:47:35.141 |    DEBUG |            log_debug |   predicted_velocities.shape: (63, 2)
20:47:35.141 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (53, 4)
20:47:35.141 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=53 but predicted_positions has 63 rows
20:47:35.141 |    ERROR |            log_error |   This will cause index 52 to fail when array only goes to 62
20:47:35.141 |    DEBUG |            log_debug | Kalman update: 53 features, state_dim=4, prob_dim=2
20:47:35.142 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman update):
20:47:35.142 |     INFO |       log_parameters |   features_updated: 53
20:47:35.142 |     INFO |       log_parameters |   state_dim: 4
20:47:35.142 |     INFO |       log_parameters |   dt_used: 1.0
20:47:35.142 |     INFO |       log_parameters |   process_noise_scale: 1.0
20:47:35.142 |     INFO |       log_parameters |   measurement_noise_scale: 1.0
20:47:35.142 |     INFO |             log_info | Enhanced linking completed successfully for frame 24
20:47:35.142 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0055 seconds
20:47:35.357 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=25, prob_dim=2, num_features_frame1=53, num_features_frame2=50)
20:47:35.357 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:35.357 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:35.357 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:35.357 |     INFO |       log_parameters |   current_frame: 25
20:47:35.357 |     INFO |       log_parameters |   prob_dim: 2
20:47:35.357 |     INFO |       log_parameters |   num_features_frame1: 53
20:47:35.357 |     INFO |       log_parameters |   num_features_frame2: 50
20:47:35.357 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:35.357 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:35.357 |     INFO |       log_parameters |   linear_motion: 1
20:47:35.357 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:35.357 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:35.357 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:35.357 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:35.357 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:35.357 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:35.357 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:35.357 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:35.357 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:35.357 |     INFO |       log_parameters |   use_local_density: 0
20:47:35.357 |     INFO |       log_parameters |   nn_window: 5
20:47:35.357 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:35.357 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:35.357 |     INFO |       log_parameters |   len_for_classify: 5
20:47:35.357 |     INFO |       log_parameters |   res_limit: 0.1
20:47:35.357 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:35.357 |     INFO |       log_parameters |   strategy_bd: -1
20:47:35.357 |     INFO |       log_parameters |   lft_cdf: None
20:47:35.357 |     INFO |       log_parameters |   kalman_init_param: None
20:47:35.357 |     INFO |       log_parameters |   diagnostics: None
20:47:35.357 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:35.357 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:35.357 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:35.357 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:35.357 |     INFO |       log_parameters |   coords_shape: (53, 2)
20:47:35.357 |     INFO |       log_parameters |   uncertainties_shape: (53, 2)
20:47:35.357 |     INFO |       log_parameters |   mean_uncertainty: 0.30839475471698113
20:47:35.357 |     INFO |       log_parameters |   uncertainty_range: [0.219002, 0.352134]
20:47:35.357 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:35.357 |     INFO |       log_parameters |   coords_shape: (50, 2)
20:47:35.357 |     INFO |       log_parameters |   uncertainties_shape: (50, 2)
20:47:35.357 |     INFO |       log_parameters |   mean_uncertainty: 0.30551974
20:47:35.357 |     INFO |       log_parameters |   uncertainty_range: [0.226658, 0.353912]
20:47:35.357 |    DEBUG |            log_debug | Initializing Kalman for 50 features, prob_dim=2, state_dim=4
20:47:35.357 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:35.357 |     INFO |       log_parameters |   num_features: 50
20:47:35.357 |     INFO |       log_parameters |   state_dim: 4
20:47:35.357 |     INFO |       log_parameters |   prob_dim: 2
20:47:35.357 |     INFO |       log_parameters |   state_vec_shape: (50, 4)
20:47:35.357 |     INFO |       log_parameters |   state_noise_var_shape: (50, 4, 4)
20:47:35.357 |    DEBUG |            log_debug | State vector shape: (53, 4), Expected: (53, 4)
20:47:35.358 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:35.358 |     INFO |       log_parameters |   num_features_predicted: 53
20:47:35.358 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:35.358 |     INFO |       log_parameters |   brownian_motion_features: 53
20:47:35.358 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:35.358 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:35.358 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:35.358 |     INFO |       log_parameters |   search_radii_shape: (53, 2)
20:47:35.358 |     INFO |       log_parameters |   min_radius: 0.1
20:47:35.358 |     INFO |       log_parameters |   max_radius: 0.1
20:47:35.358 |     INFO |       log_parameters |   mean_radius: 0.09999999999999999
20:47:35.358 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:35.358 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999999
20:47:35.359 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:35.359 |     INFO |       log_parameters |   distance_matrix_shape: (53, 50)
20:47:35.359 |     INFO |       log_parameters |   cost_matrix_shape: (53, 50)
20:47:35.359 |     INFO |       log_parameters |   finite_costs: 2650
20:47:35.359 |     INFO |       log_parameters |   infinite_costs: 0
20:47:35.359 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:35.359 |     INFO |       log_parameters |   min_distance: 17.95908764071129
20:47:35.359 |     INFO |       log_parameters |   max_distance: 132.53832056308735
20:47:35.359 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:35.359 |     INFO |       log_parameters |   motion_costs_shape: (53, 50)
20:47:35.359 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:35.359 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:35.359 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:35.359 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:35.359 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:35.360 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:35.360 |     INFO |       log_parameters |   coords_shape: (53, 2)
20:47:35.360 |     INFO |       log_parameters |   uncertainties_shape: (53, 2)
20:47:35.360 |     INFO |       log_parameters |   mean_uncertainty: 0.30839475471698113
20:47:35.360 |     INFO |       log_parameters |   uncertainty_range: [0.219002, 0.352134]
20:47:35.360 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:35.360 |     INFO |       log_parameters |   coords_shape: (50, 2)
20:47:35.360 |     INFO |       log_parameters |   uncertainties_shape: (50, 2)
20:47:35.360 |     INFO |       log_parameters |   mean_uncertainty: 0.30551974
20:47:35.360 |     INFO |       log_parameters |   uncertainty_range: [0.226658, 0.353912]
20:47:35.361 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:35.361 |     INFO |       log_parameters |   feature_costs_shape: (53, 50)
20:47:35.361 |     INFO |       log_parameters |   feature_costs_min: 1.000060797125353
20:47:35.361 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:35.361 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:35.361 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:35.361 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:35.361 |     INFO |       log_parameters |   original_shape: (53, 50)
20:47:35.361 |     INFO |       log_parameters |   augmented_shape: (103, 103)
20:47:35.361 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:35.361 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:35.361 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:35.361 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:35.361 |    DEBUG |            log_debug |   observed_positions.shape: (50, 2)
20:47:35.361 |    DEBUG |            log_debug |   num_features (from observed_positions): 50
20:47:35.361 |    DEBUG |            log_debug |   predicted_positions.shape: (53, 2)
20:47:35.361 |    DEBUG |            log_debug |   predicted_velocities.shape: (53, 2)
20:47:35.361 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (50, 4)
20:47:35.361 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=50 but predicted_positions has 53 rows
20:47:35.361 |    ERROR |            log_error |   This will cause index 49 to fail when array only goes to 52
20:47:35.361 |    DEBUG |            log_debug | Kalman update: 50 features, state_dim=4, prob_dim=2
20:47:35.362 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman update):
20:47:35.362 |     INFO |       log_parameters |   features_updated: 50
20:47:35.362 |     INFO |       log_parameters |   state_dim: 4
20:47:35.362 |     INFO |       log_parameters |   dt_used: 1.0
20:47:35.362 |     INFO |       log_parameters |   process_noise_scale: 1.0
20:47:35.362 |     INFO |       log_parameters |   measurement_noise_scale: 1.0
20:47:35.362 |     INFO |             log_info | Enhanced linking completed successfully for frame 25
20:47:35.362 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0048 seconds
20:47:35.549 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=26, prob_dim=2, num_features_frame1=50, num_features_frame2=57)
20:47:35.549 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:35.549 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:35.549 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:35.549 |     INFO |       log_parameters |   current_frame: 26
20:47:35.549 |     INFO |       log_parameters |   prob_dim: 2
20:47:35.549 |     INFO |       log_parameters |   num_features_frame1: 50
20:47:35.549 |     INFO |       log_parameters |   num_features_frame2: 57
20:47:35.549 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:35.549 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:35.549 |     INFO |       log_parameters |   linear_motion: 1
20:47:35.549 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:35.549 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:35.549 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:35.549 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:35.549 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:35.549 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:35.549 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:35.549 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:35.549 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:35.549 |     INFO |       log_parameters |   use_local_density: 0
20:47:35.549 |     INFO |       log_parameters |   nn_window: 5
20:47:35.549 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:35.549 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:35.549 |     INFO |       log_parameters |   len_for_classify: 5
20:47:35.549 |     INFO |       log_parameters |   res_limit: 0.1
20:47:35.549 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:35.549 |     INFO |       log_parameters |   strategy_bd: -1
20:47:35.549 |     INFO |       log_parameters |   lft_cdf: None
20:47:35.549 |     INFO |       log_parameters |   kalman_init_param: None
20:47:35.549 |     INFO |       log_parameters |   diagnostics: None
20:47:35.549 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:35.549 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:35.549 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:35.549 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:35.549 |     INFO |       log_parameters |   coords_shape: (50, 2)
20:47:35.549 |     INFO |       log_parameters |   uncertainties_shape: (50, 2)
20:47:35.549 |     INFO |       log_parameters |   mean_uncertainty: 0.30551974
20:47:35.549 |     INFO |       log_parameters |   uncertainty_range: [0.226658, 0.353912]
20:47:35.549 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:35.549 |     INFO |       log_parameters |   coords_shape: (57, 2)
20:47:35.549 |     INFO |       log_parameters |   uncertainties_shape: (57, 2)
20:47:35.549 |     INFO |       log_parameters |   mean_uncertainty: 0.3120523596491228
20:47:35.549 |     INFO |       log_parameters |   uncertainty_range: [0.216865, 0.359668]
20:47:35.549 |    DEBUG |            log_debug | Initializing Kalman for 57 features, prob_dim=2, state_dim=4
20:47:35.549 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:35.549 |     INFO |       log_parameters |   num_features: 57
20:47:35.549 |     INFO |       log_parameters |   state_dim: 4
20:47:35.549 |     INFO |       log_parameters |   prob_dim: 2
20:47:35.549 |     INFO |       log_parameters |   state_vec_shape: (57, 4)
20:47:35.549 |     INFO |       log_parameters |   state_noise_var_shape: (57, 4, 4)
20:47:35.549 |    DEBUG |            log_debug | State vector shape: (50, 4), Expected: (50, 4)
20:47:35.550 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:35.550 |     INFO |       log_parameters |   num_features_predicted: 50
20:47:35.550 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:35.550 |     INFO |       log_parameters |   brownian_motion_features: 50
20:47:35.550 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:35.550 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:35.550 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:35.550 |     INFO |       log_parameters |   search_radii_shape: (50, 2)
20:47:35.550 |     INFO |       log_parameters |   min_radius: 0.1
20:47:35.550 |     INFO |       log_parameters |   max_radius: 0.1
20:47:35.550 |     INFO |       log_parameters |   mean_radius: 0.09999999999999998
20:47:35.550 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:35.550 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999998
20:47:35.551 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:35.551 |     INFO |       log_parameters |   distance_matrix_shape: (50, 57)
20:47:35.551 |     INFO |       log_parameters |   cost_matrix_shape: (50, 57)
20:47:35.551 |     INFO |       log_parameters |   finite_costs: 2850
20:47:35.551 |     INFO |       log_parameters |   infinite_costs: 0
20:47:35.551 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:35.551 |     INFO |       log_parameters |   min_distance: 17.540792280214283
20:47:35.551 |     INFO |       log_parameters |   max_distance: 132.51633517381876
20:47:35.551 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:35.551 |     INFO |       log_parameters |   motion_costs_shape: (50, 57)
20:47:35.551 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:35.551 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:35.551 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:35.551 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:35.551 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:35.552 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:35.552 |     INFO |       log_parameters |   coords_shape: (50, 2)
20:47:35.552 |     INFO |       log_parameters |   uncertainties_shape: (50, 2)
20:47:35.552 |     INFO |       log_parameters |   mean_uncertainty: 0.30551974
20:47:35.552 |     INFO |       log_parameters |   uncertainty_range: [0.226658, 0.353912]
20:47:35.553 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:35.553 |     INFO |       log_parameters |   coords_shape: (57, 2)
20:47:35.553 |     INFO |       log_parameters |   uncertainties_shape: (57, 2)
20:47:35.553 |     INFO |       log_parameters |   mean_uncertainty: 0.3120523596491228
20:47:35.553 |     INFO |       log_parameters |   uncertainty_range: [0.216865, 0.359668]
20:47:35.553 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:35.553 |     INFO |       log_parameters |   feature_costs_shape: (50, 57)
20:47:35.553 |     INFO |       log_parameters |   feature_costs_min: 1.000014153602887
20:47:35.553 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:35.553 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:35.553 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:35.553 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:35.553 |     INFO |       log_parameters |   original_shape: (50, 57)
20:47:35.553 |     INFO |       log_parameters |   augmented_shape: (107, 107)
20:47:35.553 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:35.553 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:35.553 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:35.553 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:35.553 |    DEBUG |            log_debug |   observed_positions.shape: (57, 2)
20:47:35.553 |    DEBUG |            log_debug |   num_features (from observed_positions): 57
20:47:35.553 |    DEBUG |            log_debug |   predicted_positions.shape: (50, 2)
20:47:35.553 |    DEBUG |            log_debug |   predicted_velocities.shape: (50, 2)
20:47:35.553 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (57, 4)
20:47:35.553 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=57 but predicted_positions has 50 rows
20:47:35.553 |    ERROR |            log_error |   This will cause index 56 to fail when array only goes to 49
20:47:35.553 |    DEBUG |            log_debug | Kalman update: 57 features, state_dim=4, prob_dim=2
20:47:35.554 |    ERROR |            log_error | Error in enhanced linking: index 50 is out of bounds for axis 0 with size 50
20:47:35.554 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 50 is out of bounds for axis 0 with size 50
20:47:35.554 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0053 seconds
20:47:35.564 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=27, prob_dim=2, num_features_frame1=57, num_features_frame2=54)
20:47:35.564 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:35.564 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:35.564 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:35.564 |     INFO |       log_parameters |   current_frame: 27
20:47:35.564 |     INFO |       log_parameters |   prob_dim: 2
20:47:35.564 |     INFO |       log_parameters |   num_features_frame1: 57
20:47:35.564 |     INFO |       log_parameters |   num_features_frame2: 54
20:47:35.564 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:35.564 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:35.564 |     INFO |       log_parameters |   linear_motion: 1
20:47:35.564 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:35.564 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:35.564 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:35.564 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:35.564 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:35.564 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:35.564 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:35.564 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:35.564 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:35.564 |     INFO |       log_parameters |   use_local_density: 0
20:47:35.564 |     INFO |       log_parameters |   nn_window: 5
20:47:35.564 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:35.564 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:35.564 |     INFO |       log_parameters |   len_for_classify: 5
20:47:35.565 |     INFO |       log_parameters |   res_limit: 0.1
20:47:35.565 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:35.565 |     INFO |       log_parameters |   strategy_bd: -1
20:47:35.565 |     INFO |       log_parameters |   lft_cdf: None
20:47:35.565 |     INFO |       log_parameters |   kalman_init_param: None
20:47:35.565 |     INFO |       log_parameters |   diagnostics: None
20:47:35.565 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:35.565 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:35.565 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:35.565 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:35.565 |     INFO |       log_parameters |   coords_shape: (57, 2)
20:47:35.565 |     INFO |       log_parameters |   uncertainties_shape: (57, 2)
20:47:35.565 |     INFO |       log_parameters |   mean_uncertainty: 0.3120523596491228
20:47:35.565 |     INFO |       log_parameters |   uncertainty_range: [0.216865, 0.359668]
20:47:35.565 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:35.565 |     INFO |       log_parameters |   coords_shape: (54, 2)
20:47:35.565 |     INFO |       log_parameters |   uncertainties_shape: (54, 2)
20:47:35.565 |     INFO |       log_parameters |   mean_uncertainty: 0.30669265740740737
20:47:35.565 |     INFO |       log_parameters |   uncertainty_range: [0.217945, 0.356168]
20:47:35.565 |    DEBUG |            log_debug | Initializing Kalman for 54 features, prob_dim=2, state_dim=4
20:47:35.565 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:35.565 |     INFO |       log_parameters |   num_features: 54
20:47:35.565 |     INFO |       log_parameters |   state_dim: 4
20:47:35.565 |     INFO |       log_parameters |   prob_dim: 2
20:47:35.565 |     INFO |       log_parameters |   state_vec_shape: (54, 4)
20:47:35.565 |     INFO |       log_parameters |   state_noise_var_shape: (54, 4, 4)
20:47:35.565 |    DEBUG |            log_debug | State vector shape: (57, 4), Expected: (57, 4)
20:47:35.565 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:35.565 |     INFO |       log_parameters |   num_features_predicted: 57
20:47:35.565 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:35.565 |     INFO |       log_parameters |   brownian_motion_features: 57
20:47:35.565 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:35.565 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:35.565 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:35.566 |     INFO |       log_parameters |   search_radii_shape: (57, 2)
20:47:35.566 |     INFO |       log_parameters |   min_radius: 0.1
20:47:35.566 |     INFO |       log_parameters |   max_radius: 0.1
20:47:35.566 |     INFO |       log_parameters |   mean_radius: 0.1
20:47:35.566 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:35.566 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.1
20:47:35.566 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:35.566 |     INFO |       log_parameters |   distance_matrix_shape: (57, 54)
20:47:35.566 |     INFO |       log_parameters |   cost_matrix_shape: (57, 54)
20:47:35.566 |     INFO |       log_parameters |   finite_costs: 3078
20:47:35.566 |     INFO |       log_parameters |   infinite_costs: 0
20:47:35.566 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:35.566 |     INFO |       log_parameters |   min_distance: 17.643518991006896
20:47:35.566 |     INFO |       log_parameters |   max_distance: 132.34027017056542
20:47:35.566 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:35.566 |     INFO |       log_parameters |   motion_costs_shape: (57, 54)
20:47:35.566 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:35.566 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:35.566 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:35.566 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:35.566 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:35.568 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:35.568 |     INFO |       log_parameters |   coords_shape: (57, 2)
20:47:35.568 |     INFO |       log_parameters |   uncertainties_shape: (57, 2)
20:47:35.568 |     INFO |       log_parameters |   mean_uncertainty: 0.3120523596491228
20:47:35.568 |     INFO |       log_parameters |   uncertainty_range: [0.216865, 0.359668]
20:47:35.568 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:35.568 |     INFO |       log_parameters |   coords_shape: (54, 2)
20:47:35.568 |     INFO |       log_parameters |   uncertainties_shape: (54, 2)
20:47:35.568 |     INFO |       log_parameters |   mean_uncertainty: 0.30669265740740737
20:47:35.568 |     INFO |       log_parameters |   uncertainty_range: [0.217945, 0.356168]
20:47:35.568 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:35.568 |     INFO |       log_parameters |   feature_costs_shape: (57, 54)
20:47:35.568 |     INFO |       log_parameters |   feature_costs_min: 1.000070554323359
20:47:35.568 |     INFO |       log_parameters |   feature_costs_max: 5.0
20:47:35.568 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:35.568 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:35.568 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:35.568 |     INFO |       log_parameters |   original_shape: (57, 54)
20:47:35.568 |     INFO |       log_parameters |   augmented_shape: (111, 111)
20:47:35.568 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:35.568 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:35.568 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:35.568 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:35.568 |    DEBUG |            log_debug |   observed_positions.shape: (54, 2)
20:47:35.568 |    DEBUG |            log_debug |   num_features (from observed_positions): 54
20:47:35.568 |    DEBUG |            log_debug |   predicted_positions.shape: (57, 2)
20:47:35.568 |    DEBUG |            log_debug |   predicted_velocities.shape: (57, 2)
20:47:35.568 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (54, 4)
20:47:35.568 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=54 but predicted_positions has 57 rows
20:47:35.569 |    ERROR |            log_error |   This will cause index 53 to fail when array only goes to 56
20:47:35.569 |    DEBUG |            log_debug | Kalman update: 54 features, state_dim=4, prob_dim=2
20:47:35.569 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman update):
20:47:35.569 |     INFO |       log_parameters |   features_updated: 54
20:47:35.569 |     INFO |       log_parameters |   state_dim: 4
20:47:35.570 |     INFO |       log_parameters |   dt_used: 1.0
20:47:35.570 |     INFO |       log_parameters |   process_noise_scale: 1.0
20:47:35.570 |     INFO |       log_parameters |   measurement_noise_scale: 1.0
20:47:35.570 |     INFO |             log_info | Enhanced linking completed successfully for frame 27
20:47:35.570 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0052 seconds
20:47:35.781 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=28, prob_dim=2, num_features_frame1=54, num_features_frame2=52)
20:47:35.781 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:35.781 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:35.781 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:35.781 |     INFO |       log_parameters |   current_frame: 28
20:47:35.781 |     INFO |       log_parameters |   prob_dim: 2
20:47:35.781 |     INFO |       log_parameters |   num_features_frame1: 54
20:47:35.781 |     INFO |       log_parameters |   num_features_frame2: 52
20:47:35.781 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:35.781 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:35.781 |     INFO |       log_parameters |   linear_motion: 1
20:47:35.781 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:35.781 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:35.781 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:35.781 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:35.781 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:35.781 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:35.781 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:35.781 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:35.781 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:35.781 |     INFO |       log_parameters |   use_local_density: 0
20:47:35.781 |     INFO |       log_parameters |   nn_window: 5
20:47:35.781 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:35.781 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:35.781 |     INFO |       log_parameters |   len_for_classify: 5
20:47:35.781 |     INFO |       log_parameters |   res_limit: 0.1
20:47:35.781 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:35.781 |     INFO |       log_parameters |   strategy_bd: -1
20:47:35.781 |     INFO |       log_parameters |   lft_cdf: None
20:47:35.781 |     INFO |       log_parameters |   kalman_init_param: None
20:47:35.781 |     INFO |       log_parameters |   diagnostics: None
20:47:35.781 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:35.781 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:35.781 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:35.781 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:35.781 |     INFO |       log_parameters |   coords_shape: (54, 2)
20:47:35.782 |     INFO |       log_parameters |   uncertainties_shape: (54, 2)
20:47:35.782 |     INFO |       log_parameters |   mean_uncertainty: 0.30669265740740737
20:47:35.782 |     INFO |       log_parameters |   uncertainty_range: [0.217945, 0.356168]
20:47:35.782 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:35.782 |     INFO |       log_parameters |   coords_shape: (52, 2)
20:47:35.782 |     INFO |       log_parameters |   uncertainties_shape: (52, 2)
20:47:35.782 |     INFO |       log_parameters |   mean_uncertainty: 0.30530675
20:47:35.782 |     INFO |       log_parameters |   uncertainty_range: [0.221537, 0.36299]
20:47:35.782 |    DEBUG |            log_debug | Initializing Kalman for 52 features, prob_dim=2, state_dim=4
20:47:35.782 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:35.782 |     INFO |       log_parameters |   num_features: 52
20:47:35.782 |     INFO |       log_parameters |   state_dim: 4
20:47:35.782 |     INFO |       log_parameters |   prob_dim: 2
20:47:35.782 |     INFO |       log_parameters |   state_vec_shape: (52, 4)
20:47:35.782 |     INFO |       log_parameters |   state_noise_var_shape: (52, 4, 4)
20:47:35.782 |    DEBUG |            log_debug | State vector shape: (54, 4), Expected: (54, 4)
20:47:35.782 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:35.782 |     INFO |       log_parameters |   num_features_predicted: 54
20:47:35.782 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:35.782 |     INFO |       log_parameters |   brownian_motion_features: 54
20:47:35.782 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:35.782 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:35.782 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:35.782 |     INFO |       log_parameters |   search_radii_shape: (54, 2)
20:47:35.782 |     INFO |       log_parameters |   min_radius: 0.1
20:47:35.782 |     INFO |       log_parameters |   max_radius: 0.1
20:47:35.782 |     INFO |       log_parameters |   mean_radius: 0.09999999999999999
20:47:35.782 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:35.782 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999999
20:47:35.783 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:35.783 |     INFO |       log_parameters |   distance_matrix_shape: (54, 52)
20:47:35.783 |     INFO |       log_parameters |   cost_matrix_shape: (54, 52)
20:47:35.783 |     INFO |       log_parameters |   finite_costs: 2808
20:47:35.783 |     INFO |       log_parameters |   infinite_costs: 0
20:47:35.783 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:35.783 |     INFO |       log_parameters |   min_distance: 17.10840799117618
20:47:35.783 |     INFO |       log_parameters |   max_distance: 132.49408901929263
20:47:35.783 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:35.783 |     INFO |       log_parameters |   motion_costs_shape: (54, 52)
20:47:35.783 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:35.783 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:35.783 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:35.783 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:35.783 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:35.785 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:35.785 |     INFO |       log_parameters |   coords_shape: (54, 2)
20:47:35.785 |     INFO |       log_parameters |   uncertainties_shape: (54, 2)
20:47:35.785 |     INFO |       log_parameters |   mean_uncertainty: 0.30669265740740737
20:47:35.785 |     INFO |       log_parameters |   uncertainty_range: [0.217945, 0.356168]
20:47:35.785 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:35.785 |     INFO |       log_parameters |   coords_shape: (52, 2)
20:47:35.785 |     INFO |       log_parameters |   uncertainties_shape: (52, 2)
20:47:35.785 |     INFO |       log_parameters |   mean_uncertainty: 0.30530675
20:47:35.785 |     INFO |       log_parameters |   uncertainty_range: [0.221537, 0.36299]
20:47:35.785 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:35.785 |     INFO |       log_parameters |   feature_costs_shape: (54, 52)
20:47:35.785 |     INFO |       log_parameters |   feature_costs_min: 1.0004202378719982
20:47:35.785 |     INFO |       log_parameters |   feature_costs_max: 5.0
20:47:35.785 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:35.785 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:35.785 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:35.785 |     INFO |       log_parameters |   original_shape: (54, 52)
20:47:35.785 |     INFO |       log_parameters |   augmented_shape: (106, 106)
20:47:35.785 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:35.785 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:35.785 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:35.785 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:35.785 |    DEBUG |            log_debug |   observed_positions.shape: (52, 2)
20:47:35.785 |    DEBUG |            log_debug |   num_features (from observed_positions): 52
20:47:35.785 |    DEBUG |            log_debug |   predicted_positions.shape: (54, 2)
20:47:35.785 |    DEBUG |            log_debug |   predicted_velocities.shape: (54, 2)
20:47:35.785 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (52, 4)
20:47:35.785 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=52 but predicted_positions has 54 rows
20:47:35.785 |    ERROR |            log_error |   This will cause index 51 to fail when array only goes to 53
20:47:35.785 |    DEBUG |            log_debug | Kalman update: 52 features, state_dim=4, prob_dim=2
20:47:35.786 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman update):
20:47:35.786 |     INFO |       log_parameters |   features_updated: 52
20:47:35.786 |     INFO |       log_parameters |   state_dim: 4
20:47:35.786 |     INFO |       log_parameters |   dt_used: 1.0
20:47:35.786 |     INFO |       log_parameters |   process_noise_scale: 1.0
20:47:35.786 |     INFO |       log_parameters |   measurement_noise_scale: 1.0
20:47:35.786 |     INFO |             log_info | Enhanced linking completed successfully for frame 28
20:47:35.786 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0050 seconds
20:47:35.983 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=29, prob_dim=2, num_features_frame1=52, num_features_frame2=58)
20:47:35.983 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:35.983 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:35.983 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:35.983 |     INFO |       log_parameters |   current_frame: 29
20:47:35.983 |     INFO |       log_parameters |   prob_dim: 2
20:47:35.983 |     INFO |       log_parameters |   num_features_frame1: 52
20:47:35.983 |     INFO |       log_parameters |   num_features_frame2: 58
20:47:35.983 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:35.983 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:35.983 |     INFO |       log_parameters |   linear_motion: 1
20:47:35.983 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:35.983 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:35.983 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:35.983 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:35.983 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:35.983 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:35.983 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:35.983 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:35.983 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:35.983 |     INFO |       log_parameters |   use_local_density: 0
20:47:35.983 |     INFO |       log_parameters |   nn_window: 5
20:47:35.983 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:35.983 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:35.983 |     INFO |       log_parameters |   len_for_classify: 5
20:47:35.983 |     INFO |       log_parameters |   res_limit: 0.1
20:47:35.983 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:35.983 |     INFO |       log_parameters |   strategy_bd: -1
20:47:35.983 |     INFO |       log_parameters |   lft_cdf: None
20:47:35.983 |     INFO |       log_parameters |   kalman_init_param: None
20:47:35.983 |     INFO |       log_parameters |   diagnostics: None
20:47:35.983 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:35.983 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:35.983 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:35.983 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:35.983 |     INFO |       log_parameters |   coords_shape: (52, 2)
20:47:35.983 |     INFO |       log_parameters |   uncertainties_shape: (52, 2)
20:47:35.983 |     INFO |       log_parameters |   mean_uncertainty: 0.30530675
20:47:35.983 |     INFO |       log_parameters |   uncertainty_range: [0.221537, 0.36299]
20:47:35.983 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:35.983 |     INFO |       log_parameters |   coords_shape: (58, 2)
20:47:35.983 |     INFO |       log_parameters |   uncertainties_shape: (58, 2)
20:47:35.983 |     INFO |       log_parameters |   mean_uncertainty: 0.31193115517241377
20:47:35.983 |     INFO |       log_parameters |   uncertainty_range: [0.215693, 0.356948]
20:47:35.983 |    DEBUG |            log_debug | Initializing Kalman for 58 features, prob_dim=2, state_dim=4
20:47:35.983 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:35.983 |     INFO |       log_parameters |   num_features: 58
20:47:35.983 |     INFO |       log_parameters |   state_dim: 4
20:47:35.983 |     INFO |       log_parameters |   prob_dim: 2
20:47:35.983 |     INFO |       log_parameters |   state_vec_shape: (58, 4)
20:47:35.983 |     INFO |       log_parameters |   state_noise_var_shape: (58, 4, 4)
20:47:35.983 |    DEBUG |            log_debug | State vector shape: (52, 4), Expected: (52, 4)
20:47:35.984 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:35.984 |     INFO |       log_parameters |   num_features_predicted: 52
20:47:35.984 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:35.984 |     INFO |       log_parameters |   brownian_motion_features: 52
20:47:35.984 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:35.984 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:35.984 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:35.984 |     INFO |       log_parameters |   search_radii_shape: (52, 2)
20:47:35.984 |     INFO |       log_parameters |   min_radius: 0.1
20:47:35.984 |     INFO |       log_parameters |   max_radius: 0.1
20:47:35.984 |     INFO |       log_parameters |   mean_radius: 0.1
20:47:35.984 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:35.984 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.1
20:47:35.985 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:35.985 |     INFO |       log_parameters |   distance_matrix_shape: (52, 58)
20:47:35.985 |     INFO |       log_parameters |   cost_matrix_shape: (52, 58)
20:47:35.985 |     INFO |       log_parameters |   finite_costs: 3016
20:47:35.985 |     INFO |       log_parameters |   infinite_costs: 0
20:47:35.985 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:35.985 |     INFO |       log_parameters |   min_distance: 15.693677578016473
20:47:35.985 |     INFO |       log_parameters |   max_distance: 132.34755830882557
20:47:35.985 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:35.985 |     INFO |       log_parameters |   motion_costs_shape: (52, 58)
20:47:35.985 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:35.985 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:35.985 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:35.985 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:35.985 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:35.987 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:35.987 |     INFO |       log_parameters |   coords_shape: (52, 2)
20:47:35.987 |     INFO |       log_parameters |   uncertainties_shape: (52, 2)
20:47:35.987 |     INFO |       log_parameters |   mean_uncertainty: 0.30530675
20:47:35.987 |     INFO |       log_parameters |   uncertainty_range: [0.221537, 0.36299]
20:47:35.987 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:35.987 |     INFO |       log_parameters |   coords_shape: (58, 2)
20:47:35.987 |     INFO |       log_parameters |   uncertainties_shape: (58, 2)
20:47:35.987 |     INFO |       log_parameters |   mean_uncertainty: 0.31193115517241377
20:47:35.987 |     INFO |       log_parameters |   uncertainty_range: [0.215693, 0.356948]
20:47:35.987 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:35.987 |     INFO |       log_parameters |   feature_costs_shape: (52, 58)
20:47:35.987 |     INFO |       log_parameters |   feature_costs_min: 1.0000045146673653
20:47:35.987 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:35.987 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:35.987 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:35.987 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:35.987 |     INFO |       log_parameters |   original_shape: (52, 58)
20:47:35.987 |     INFO |       log_parameters |   augmented_shape: (110, 110)
20:47:35.987 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:35.987 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:35.987 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:35.987 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:35.987 |    DEBUG |            log_debug |   observed_positions.shape: (58, 2)
20:47:35.987 |    DEBUG |            log_debug |   num_features (from observed_positions): 58
20:47:35.987 |    DEBUG |            log_debug |   predicted_positions.shape: (52, 2)
20:47:35.987 |    DEBUG |            log_debug |   predicted_velocities.shape: (52, 2)
20:47:35.987 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (58, 4)
20:47:35.987 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=58 but predicted_positions has 52 rows
20:47:35.987 |    ERROR |            log_error |   This will cause index 57 to fail when array only goes to 51
20:47:35.987 |    DEBUG |            log_debug | Kalman update: 58 features, state_dim=4, prob_dim=2
20:47:35.988 |    ERROR |            log_error | Error in enhanced linking: index 52 is out of bounds for axis 0 with size 52
20:47:35.988 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 52 is out of bounds for axis 0 with size 52
20:47:35.988 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0054 seconds
20:47:35.999 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=30, prob_dim=2, num_features_frame1=58, num_features_frame2=52)
20:47:35.999 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:35.999 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:35.999 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:35.999 |     INFO |       log_parameters |   current_frame: 30
20:47:35.999 |     INFO |       log_parameters |   prob_dim: 2
20:47:35.999 |     INFO |       log_parameters |   num_features_frame1: 58
20:47:35.999 |     INFO |       log_parameters |   num_features_frame2: 52
20:47:35.999 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:35.999 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:35.999 |     INFO |       log_parameters |   linear_motion: 1
20:47:35.999 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:35.999 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:35.999 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:35.999 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:35.999 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:35.999 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:35.999 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:35.999 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:35.999 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:35.999 |     INFO |       log_parameters |   use_local_density: 0
20:47:35.999 |     INFO |       log_parameters |   nn_window: 5
20:47:35.999 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:35.999 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:35.999 |     INFO |       log_parameters |   len_for_classify: 5
20:47:35.999 |     INFO |       log_parameters |   res_limit: 0.1
20:47:35.999 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:35.999 |     INFO |       log_parameters |   strategy_bd: -1
20:47:35.999 |     INFO |       log_parameters |   lft_cdf: None
20:47:35.999 |     INFO |       log_parameters |   kalman_init_param: None
20:47:35.999 |     INFO |       log_parameters |   diagnostics: None
20:47:35.999 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:35.999 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:35.999 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:35.999 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:35.999 |     INFO |       log_parameters |   coords_shape: (58, 2)
20:47:35.999 |     INFO |       log_parameters |   uncertainties_shape: (58, 2)
20:47:35.999 |     INFO |       log_parameters |   mean_uncertainty: 0.31193115517241377
20:47:35.999 |     INFO |       log_parameters |   uncertainty_range: [0.215693, 0.356948]
20:47:35.999 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:35.999 |     INFO |       log_parameters |   coords_shape: (52, 2)
20:47:35.999 |     INFO |       log_parameters |   uncertainties_shape: (52, 2)
20:47:35.999 |     INFO |       log_parameters |   mean_uncertainty: 0.31083024038461543
20:47:35.999 |     INFO |       log_parameters |   uncertainty_range: [0.219571, 0.358249]
20:47:35.999 |    DEBUG |            log_debug | Initializing Kalman for 52 features, prob_dim=2, state_dim=4
20:47:35.999 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:35.999 |     INFO |       log_parameters |   num_features: 52
20:47:35.999 |     INFO |       log_parameters |   state_dim: 4
20:47:35.999 |     INFO |       log_parameters |   prob_dim: 2
20:47:35.999 |     INFO |       log_parameters |   state_vec_shape: (52, 4)
20:47:35.999 |     INFO |       log_parameters |   state_noise_var_shape: (52, 4, 4)
20:47:35.999 |    DEBUG |            log_debug | State vector shape: (58, 4), Expected: (58, 4)
20:47:36.000 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:36.000 |     INFO |       log_parameters |   num_features_predicted: 58
20:47:36.000 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:36.000 |     INFO |       log_parameters |   brownian_motion_features: 58
20:47:36.000 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:36.000 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:36.000 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:36.000 |     INFO |       log_parameters |   search_radii_shape: (58, 2)
20:47:36.000 |     INFO |       log_parameters |   min_radius: 0.1
20:47:36.000 |     INFO |       log_parameters |   max_radius: 0.1
20:47:36.000 |     INFO |       log_parameters |   mean_radius: 0.09999999999999999
20:47:36.000 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:36.000 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999999
20:47:36.000 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:36.000 |     INFO |       log_parameters |   distance_matrix_shape: (58, 52)
20:47:36.000 |     INFO |       log_parameters |   cost_matrix_shape: (58, 52)
20:47:36.000 |     INFO |       log_parameters |   finite_costs: 3016
20:47:36.000 |     INFO |       log_parameters |   infinite_costs: 0
20:47:36.000 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:36.000 |     INFO |       log_parameters |   min_distance: 16.07539117194294
20:47:36.000 |     INFO |       log_parameters |   max_distance: 132.74432104082044
20:47:36.001 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:36.001 |     INFO |       log_parameters |   motion_costs_shape: (58, 52)
20:47:36.001 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:36.001 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:36.001 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:36.001 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:36.001 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:36.002 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:36.002 |     INFO |       log_parameters |   coords_shape: (58, 2)
20:47:36.002 |     INFO |       log_parameters |   uncertainties_shape: (58, 2)
20:47:36.002 |     INFO |       log_parameters |   mean_uncertainty: 0.31193115517241377
20:47:36.002 |     INFO |       log_parameters |   uncertainty_range: [0.215693, 0.356948]
20:47:36.002 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:36.002 |     INFO |       log_parameters |   coords_shape: (52, 2)
20:47:36.002 |     INFO |       log_parameters |   uncertainties_shape: (52, 2)
20:47:36.002 |     INFO |       log_parameters |   mean_uncertainty: 0.31083024038461543
20:47:36.002 |     INFO |       log_parameters |   uncertainty_range: [0.219571, 0.358249]
20:47:36.003 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:36.003 |     INFO |       log_parameters |   feature_costs_shape: (58, 52)
20:47:36.003 |     INFO |       log_parameters |   feature_costs_min: 1.0000877742727843
20:47:36.003 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:36.003 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:36.003 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:36.003 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:36.003 |     INFO |       log_parameters |   original_shape: (58, 52)
20:47:36.003 |     INFO |       log_parameters |   augmented_shape: (110, 110)
20:47:36.003 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:36.003 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:36.003 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:36.003 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:36.003 |    DEBUG |            log_debug |   observed_positions.shape: (52, 2)
20:47:36.003 |    DEBUG |            log_debug |   num_features (from observed_positions): 52
20:47:36.003 |    DEBUG |            log_debug |   predicted_positions.shape: (58, 2)
20:47:36.003 |    DEBUG |            log_debug |   predicted_velocities.shape: (58, 2)
20:47:36.003 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (52, 4)
20:47:36.003 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=52 but predicted_positions has 58 rows
20:47:36.003 |    ERROR |            log_error |   This will cause index 51 to fail when array only goes to 57
20:47:36.003 |    DEBUG |            log_debug | Kalman update: 52 features, state_dim=4, prob_dim=2
20:47:36.004 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman update):
20:47:36.004 |     INFO |       log_parameters |   features_updated: 52
20:47:36.004 |     INFO |       log_parameters |   state_dim: 4
20:47:36.004 |     INFO |       log_parameters |   dt_used: 1.0
20:47:36.004 |     INFO |       log_parameters |   process_noise_scale: 1.0
20:47:36.004 |     INFO |       log_parameters |   measurement_noise_scale: 1.0
20:47:36.004 |     INFO |             log_info | Enhanced linking completed successfully for frame 30
20:47:36.004 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0051 seconds
20:47:36.206 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=31, prob_dim=2, num_features_frame1=52, num_features_frame2=53)
20:47:36.206 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:36.206 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:36.206 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:36.206 |     INFO |       log_parameters |   current_frame: 31
20:47:36.206 |     INFO |       log_parameters |   prob_dim: 2
20:47:36.206 |     INFO |       log_parameters |   num_features_frame1: 52
20:47:36.206 |     INFO |       log_parameters |   num_features_frame2: 53
20:47:36.206 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:36.206 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:36.206 |     INFO |       log_parameters |   linear_motion: 1
20:47:36.206 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:36.206 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:36.206 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:36.206 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:36.206 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:36.206 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:36.206 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:36.206 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:36.206 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:36.206 |     INFO |       log_parameters |   use_local_density: 0
20:47:36.206 |     INFO |       log_parameters |   nn_window: 5
20:47:36.206 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:36.206 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:36.206 |     INFO |       log_parameters |   len_for_classify: 5
20:47:36.206 |     INFO |       log_parameters |   res_limit: 0.1
20:47:36.206 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:36.206 |     INFO |       log_parameters |   strategy_bd: -1
20:47:36.206 |     INFO |       log_parameters |   lft_cdf: None
20:47:36.206 |     INFO |       log_parameters |   kalman_init_param: None
20:47:36.206 |     INFO |       log_parameters |   diagnostics: None
20:47:36.206 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:36.206 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:36.206 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:36.206 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:36.206 |     INFO |       log_parameters |   coords_shape: (52, 2)
20:47:36.206 |     INFO |       log_parameters |   uncertainties_shape: (52, 2)
20:47:36.206 |     INFO |       log_parameters |   mean_uncertainty: 0.31083024038461543
20:47:36.206 |     INFO |       log_parameters |   uncertainty_range: [0.219571, 0.358249]
20:47:36.206 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:36.206 |     INFO |       log_parameters |   coords_shape: (53, 2)
20:47:36.206 |     INFO |       log_parameters |   uncertainties_shape: (53, 2)
20:47:36.206 |     INFO |       log_parameters |   mean_uncertainty: 0.30859886792452823
20:47:36.206 |     INFO |       log_parameters |   uncertainty_range: [0.221251, 0.357782]
20:47:36.206 |    DEBUG |            log_debug | Initializing Kalman for 53 features, prob_dim=2, state_dim=4
20:47:36.206 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:36.206 |     INFO |       log_parameters |   num_features: 53
20:47:36.206 |     INFO |       log_parameters |   state_dim: 4
20:47:36.206 |     INFO |       log_parameters |   prob_dim: 2
20:47:36.206 |     INFO |       log_parameters |   state_vec_shape: (53, 4)
20:47:36.206 |     INFO |       log_parameters |   state_noise_var_shape: (53, 4, 4)
20:47:36.206 |    DEBUG |            log_debug | State vector shape: (52, 4), Expected: (52, 4)
20:47:36.207 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:36.207 |     INFO |       log_parameters |   num_features_predicted: 52
20:47:36.207 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:36.207 |     INFO |       log_parameters |   brownian_motion_features: 52
20:47:36.207 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:36.207 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:36.207 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:36.207 |     INFO |       log_parameters |   search_radii_shape: (52, 2)
20:47:36.207 |     INFO |       log_parameters |   min_radius: 0.1
20:47:36.207 |     INFO |       log_parameters |   max_radius: 0.1
20:47:36.207 |     INFO |       log_parameters |   mean_radius: 0.1
20:47:36.207 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:36.207 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.1
20:47:36.208 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:36.208 |     INFO |       log_parameters |   distance_matrix_shape: (52, 53)
20:47:36.208 |     INFO |       log_parameters |   cost_matrix_shape: (52, 53)
20:47:36.208 |     INFO |       log_parameters |   finite_costs: 2756
20:47:36.208 |     INFO |       log_parameters |   infinite_costs: 0
20:47:36.208 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:36.208 |     INFO |       log_parameters |   min_distance: 3.282771191712575
20:47:36.208 |     INFO |       log_parameters |   max_distance: 132.7476085392282
20:47:36.208 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:36.208 |     INFO |       log_parameters |   motion_costs_shape: (52, 53)
20:47:36.208 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:36.208 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:36.208 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:36.208 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:36.208 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:36.209 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:36.209 |     INFO |       log_parameters |   coords_shape: (52, 2)
20:47:36.209 |     INFO |       log_parameters |   uncertainties_shape: (52, 2)
20:47:36.209 |     INFO |       log_parameters |   mean_uncertainty: 0.31083024038461543
20:47:36.209 |     INFO |       log_parameters |   uncertainty_range: [0.219571, 0.358249]
20:47:36.209 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:36.209 |     INFO |       log_parameters |   coords_shape: (53, 2)
20:47:36.209 |     INFO |       log_parameters |   uncertainties_shape: (53, 2)
20:47:36.209 |     INFO |       log_parameters |   mean_uncertainty: 0.30859886792452823
20:47:36.209 |     INFO |       log_parameters |   uncertainty_range: [0.221251, 0.357782]
20:47:36.210 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:36.210 |     INFO |       log_parameters |   feature_costs_shape: (52, 53)
20:47:36.210 |     INFO |       log_parameters |   feature_costs_min: 1.0000719586770104
20:47:36.210 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:36.210 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:36.210 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:36.210 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:36.210 |     INFO |       log_parameters |   original_shape: (52, 53)
20:47:36.210 |     INFO |       log_parameters |   augmented_shape: (105, 105)
20:47:36.210 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:36.210 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:36.210 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:36.210 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:36.210 |    DEBUG |            log_debug |   observed_positions.shape: (53, 2)
20:47:36.210 |    DEBUG |            log_debug |   num_features (from observed_positions): 53
20:47:36.210 |    DEBUG |            log_debug |   predicted_positions.shape: (52, 2)
20:47:36.210 |    DEBUG |            log_debug |   predicted_velocities.shape: (52, 2)
20:47:36.210 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (53, 4)
20:47:36.210 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=53 but predicted_positions has 52 rows
20:47:36.210 |    ERROR |            log_error |   This will cause index 52 to fail when array only goes to 51
20:47:36.210 |    DEBUG |            log_debug | Kalman update: 53 features, state_dim=4, prob_dim=2
20:47:36.211 |    ERROR |            log_error | Error in enhanced linking: index 52 is out of bounds for axis 0 with size 52
20:47:36.211 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 52 is out of bounds for axis 0 with size 52
20:47:36.211 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0051 seconds
20:47:36.221 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=32, prob_dim=2, num_features_frame1=53, num_features_frame2=60)
20:47:36.221 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:36.221 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:36.221 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:36.221 |     INFO |       log_parameters |   current_frame: 32
20:47:36.221 |     INFO |       log_parameters |   prob_dim: 2
20:47:36.221 |     INFO |       log_parameters |   num_features_frame1: 53
20:47:36.221 |     INFO |       log_parameters |   num_features_frame2: 60
20:47:36.221 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:36.221 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:36.221 |     INFO |       log_parameters |   linear_motion: 1
20:47:36.221 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:36.221 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:36.221 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:36.221 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:36.221 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:36.221 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:36.221 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:36.221 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:36.221 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:36.221 |     INFO |       log_parameters |   use_local_density: 0
20:47:36.221 |     INFO |       log_parameters |   nn_window: 5
20:47:36.221 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:36.221 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:36.221 |     INFO |       log_parameters |   len_for_classify: 5
20:47:36.221 |     INFO |       log_parameters |   res_limit: 0.1
20:47:36.221 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:36.221 |     INFO |       log_parameters |   strategy_bd: -1
20:47:36.221 |     INFO |       log_parameters |   lft_cdf: None
20:47:36.221 |     INFO |       log_parameters |   kalman_init_param: None
20:47:36.221 |     INFO |       log_parameters |   diagnostics: None
20:47:36.221 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:36.221 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:36.221 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:36.221 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:36.221 |     INFO |       log_parameters |   coords_shape: (53, 2)
20:47:36.221 |     INFO |       log_parameters |   uncertainties_shape: (53, 2)
20:47:36.221 |     INFO |       log_parameters |   mean_uncertainty: 0.30859886792452823
20:47:36.221 |     INFO |       log_parameters |   uncertainty_range: [0.221251, 0.357782]
20:47:36.221 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:36.221 |     INFO |       log_parameters |   coords_shape: (60, 2)
20:47:36.221 |     INFO |       log_parameters |   uncertainties_shape: (60, 2)
20:47:36.221 |     INFO |       log_parameters |   mean_uncertainty: 0.31126304999999993
20:47:36.221 |     INFO |       log_parameters |   uncertainty_range: [0.215311, 0.353386]
20:47:36.221 |    DEBUG |            log_debug | Initializing Kalman for 60 features, prob_dim=2, state_dim=4
20:47:36.222 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:36.222 |     INFO |       log_parameters |   num_features: 60
20:47:36.222 |     INFO |       log_parameters |   state_dim: 4
20:47:36.222 |     INFO |       log_parameters |   prob_dim: 2
20:47:36.222 |     INFO |       log_parameters |   state_vec_shape: (60, 4)
20:47:36.222 |     INFO |       log_parameters |   state_noise_var_shape: (60, 4, 4)
20:47:36.222 |    DEBUG |            log_debug | State vector shape: (53, 4), Expected: (53, 4)
20:47:36.222 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:36.222 |     INFO |       log_parameters |   num_features_predicted: 53
20:47:36.222 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:36.222 |     INFO |       log_parameters |   brownian_motion_features: 53
20:47:36.222 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:36.222 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:36.222 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:36.222 |     INFO |       log_parameters |   search_radii_shape: (53, 2)
20:47:36.222 |     INFO |       log_parameters |   min_radius: 0.1
20:47:36.222 |     INFO |       log_parameters |   max_radius: 0.1
20:47:36.222 |     INFO |       log_parameters |   mean_radius: 0.09999999999999999
20:47:36.222 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:36.222 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999999
20:47:36.223 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:36.223 |     INFO |       log_parameters |   distance_matrix_shape: (53, 60)
20:47:36.223 |     INFO |       log_parameters |   cost_matrix_shape: (53, 60)
20:47:36.223 |     INFO |       log_parameters |   finite_costs: 3180
20:47:36.223 |     INFO |       log_parameters |   infinite_costs: 0
20:47:36.223 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:36.223 |     INFO |       log_parameters |   min_distance: 2.6879096815639096
20:47:36.223 |     INFO |       log_parameters |   max_distance: 132.78152327129604
20:47:36.223 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:36.223 |     INFO |       log_parameters |   motion_costs_shape: (53, 60)
20:47:36.223 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:36.223 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:36.223 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:36.223 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:36.223 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:36.225 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:36.225 |     INFO |       log_parameters |   coords_shape: (53, 2)
20:47:36.225 |     INFO |       log_parameters |   uncertainties_shape: (53, 2)
20:47:36.225 |     INFO |       log_parameters |   mean_uncertainty: 0.30859886792452823
20:47:36.225 |     INFO |       log_parameters |   uncertainty_range: [0.221251, 0.357782]
20:47:36.225 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:36.225 |     INFO |       log_parameters |   coords_shape: (60, 2)
20:47:36.225 |     INFO |       log_parameters |   uncertainties_shape: (60, 2)
20:47:36.225 |     INFO |       log_parameters |   mean_uncertainty: 0.31126304999999993
20:47:36.225 |     INFO |       log_parameters |   uncertainty_range: [0.215311, 0.353386]
20:47:36.225 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:36.225 |     INFO |       log_parameters |   feature_costs_shape: (53, 60)
20:47:36.225 |     INFO |       log_parameters |   feature_costs_min: 1.0000217461943435
20:47:36.225 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:36.225 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:36.225 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:36.225 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:36.225 |     INFO |       log_parameters |   original_shape: (53, 60)
20:47:36.225 |     INFO |       log_parameters |   augmented_shape: (113, 113)
20:47:36.225 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:36.225 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:36.225 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:36.225 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:36.225 |    DEBUG |            log_debug |   observed_positions.shape: (60, 2)
20:47:36.225 |    DEBUG |            log_debug |   num_features (from observed_positions): 60
20:47:36.225 |    DEBUG |            log_debug |   predicted_positions.shape: (53, 2)
20:47:36.225 |    DEBUG |            log_debug |   predicted_velocities.shape: (53, 2)
20:47:36.225 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (60, 4)
20:47:36.225 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=60 but predicted_positions has 53 rows
20:47:36.225 |    ERROR |            log_error |   This will cause index 59 to fail when array only goes to 52
20:47:36.225 |    DEBUG |            log_debug | Kalman update: 60 features, state_dim=4, prob_dim=2
20:47:36.226 |    ERROR |            log_error | Error in enhanced linking: index 53 is out of bounds for axis 0 with size 53
20:47:36.226 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 53 is out of bounds for axis 0 with size 53
20:47:36.227 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0055 seconds
20:47:36.237 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=33, prob_dim=2, num_features_frame1=60, num_features_frame2=54)
20:47:36.237 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:36.237 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:36.237 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:36.237 |     INFO |       log_parameters |   current_frame: 33
20:47:36.237 |     INFO |       log_parameters |   prob_dim: 2
20:47:36.237 |     INFO |       log_parameters |   num_features_frame1: 60
20:47:36.237 |     INFO |       log_parameters |   num_features_frame2: 54
20:47:36.237 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:36.237 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:36.237 |     INFO |       log_parameters |   linear_motion: 1
20:47:36.237 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:36.237 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:36.237 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:36.237 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:36.237 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:36.237 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:36.237 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:36.237 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:36.237 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:36.237 |     INFO |       log_parameters |   use_local_density: 0
20:47:36.237 |     INFO |       log_parameters |   nn_window: 5
20:47:36.237 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:36.237 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:36.237 |     INFO |       log_parameters |   len_for_classify: 5
20:47:36.237 |     INFO |       log_parameters |   res_limit: 0.1
20:47:36.237 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:36.237 |     INFO |       log_parameters |   strategy_bd: -1
20:47:36.237 |     INFO |       log_parameters |   lft_cdf: None
20:47:36.237 |     INFO |       log_parameters |   kalman_init_param: None
20:47:36.237 |     INFO |       log_parameters |   diagnostics: None
20:47:36.237 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:36.237 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:36.237 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:36.237 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:36.237 |     INFO |       log_parameters |   coords_shape: (60, 2)
20:47:36.237 |     INFO |       log_parameters |   uncertainties_shape: (60, 2)
20:47:36.237 |     INFO |       log_parameters |   mean_uncertainty: 0.31126304999999993
20:47:36.237 |     INFO |       log_parameters |   uncertainty_range: [0.215311, 0.353386]
20:47:36.237 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:36.237 |     INFO |       log_parameters |   coords_shape: (54, 2)
20:47:36.237 |     INFO |       log_parameters |   uncertainties_shape: (54, 2)
20:47:36.237 |     INFO |       log_parameters |   mean_uncertainty: 0.31017975925925934
20:47:36.237 |     INFO |       log_parameters |   uncertainty_range: [0.218909, 0.35443]
20:47:36.237 |    DEBUG |            log_debug | Initializing Kalman for 54 features, prob_dim=2, state_dim=4
20:47:36.237 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:36.237 |     INFO |       log_parameters |   num_features: 54
20:47:36.237 |     INFO |       log_parameters |   state_dim: 4
20:47:36.237 |     INFO |       log_parameters |   prob_dim: 2
20:47:36.237 |     INFO |       log_parameters |   state_vec_shape: (54, 4)
20:47:36.238 |     INFO |       log_parameters |   state_noise_var_shape: (54, 4, 4)
20:47:36.238 |    DEBUG |            log_debug | State vector shape: (60, 4), Expected: (60, 4)
20:47:36.238 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:36.238 |     INFO |       log_parameters |   num_features_predicted: 60
20:47:36.238 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:36.238 |     INFO |       log_parameters |   brownian_motion_features: 60
20:47:36.238 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:36.238 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:36.238 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:36.238 |     INFO |       log_parameters |   search_radii_shape: (60, 2)
20:47:36.238 |     INFO |       log_parameters |   min_radius: 0.1
20:47:36.238 |     INFO |       log_parameters |   max_radius: 0.1
20:47:36.238 |     INFO |       log_parameters |   mean_radius: 0.10000000000000002
20:47:36.238 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:36.238 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.10000000000000002
20:47:36.239 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:36.239 |     INFO |       log_parameters |   distance_matrix_shape: (60, 54)
20:47:36.239 |     INFO |       log_parameters |   cost_matrix_shape: (60, 54)
20:47:36.239 |     INFO |       log_parameters |   finite_costs: 3240
20:47:36.239 |     INFO |       log_parameters |   infinite_costs: 0
20:47:36.239 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:36.239 |     INFO |       log_parameters |   min_distance: 17.329355391735493
20:47:36.239 |     INFO |       log_parameters |   max_distance: 132.51543312756138
20:47:36.239 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:36.239 |     INFO |       log_parameters |   motion_costs_shape: (60, 54)
20:47:36.239 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:36.239 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:36.239 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:36.239 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:36.239 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:36.241 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:36.241 |     INFO |       log_parameters |   coords_shape: (60, 2)
20:47:36.241 |     INFO |       log_parameters |   uncertainties_shape: (60, 2)
20:47:36.241 |     INFO |       log_parameters |   mean_uncertainty: 0.31126304999999993
20:47:36.241 |     INFO |       log_parameters |   uncertainty_range: [0.215311, 0.353386]
20:47:36.241 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:36.241 |     INFO |       log_parameters |   coords_shape: (54, 2)
20:47:36.241 |     INFO |       log_parameters |   uncertainties_shape: (54, 2)
20:47:36.241 |     INFO |       log_parameters |   mean_uncertainty: 0.31017975925925934
20:47:36.241 |     INFO |       log_parameters |   uncertainty_range: [0.218909, 0.35443]
20:47:36.241 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:36.241 |     INFO |       log_parameters |   feature_costs_shape: (60, 54)
20:47:36.241 |     INFO |       log_parameters |   feature_costs_min: 1.0000117146582048
20:47:36.241 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:36.241 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:36.241 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:36.241 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:36.241 |     INFO |       log_parameters |   original_shape: (60, 54)
20:47:36.241 |     INFO |       log_parameters |   augmented_shape: (114, 114)
20:47:36.241 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:36.241 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:36.241 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:36.241 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:36.241 |    DEBUG |            log_debug |   observed_positions.shape: (54, 2)
20:47:36.241 |    DEBUG |            log_debug |   num_features (from observed_positions): 54
20:47:36.241 |    DEBUG |            log_debug |   predicted_positions.shape: (60, 2)
20:47:36.241 |    DEBUG |            log_debug |   predicted_velocities.shape: (60, 2)
20:47:36.241 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (54, 4)
20:47:36.241 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=54 but predicted_positions has 60 rows
20:47:36.241 |    ERROR |            log_error |   This will cause index 53 to fail when array only goes to 59
20:47:36.241 |    DEBUG |            log_debug | Kalman update: 54 features, state_dim=4, prob_dim=2
20:47:36.242 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman update):
20:47:36.242 |     INFO |       log_parameters |   features_updated: 54
20:47:36.242 |     INFO |       log_parameters |   state_dim: 4
20:47:36.242 |     INFO |       log_parameters |   dt_used: 1.0
20:47:36.242 |     INFO |       log_parameters |   process_noise_scale: 1.0
20:47:36.242 |     INFO |       log_parameters |   measurement_noise_scale: 1.0
20:47:36.242 |     INFO |             log_info | Enhanced linking completed successfully for frame 33
20:47:36.242 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0054 seconds
20:47:36.458 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=34, prob_dim=2, num_features_frame1=54, num_features_frame2=50)
20:47:36.458 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:36.458 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:36.458 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:36.458 |     INFO |       log_parameters |   current_frame: 34
20:47:36.458 |     INFO |       log_parameters |   prob_dim: 2
20:47:36.458 |     INFO |       log_parameters |   num_features_frame1: 54
20:47:36.458 |     INFO |       log_parameters |   num_features_frame2: 50
20:47:36.458 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:36.458 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:36.458 |     INFO |       log_parameters |   linear_motion: 1
20:47:36.458 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:36.458 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:36.458 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:36.458 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:36.458 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:36.458 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:36.458 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:36.458 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:36.458 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:36.458 |     INFO |       log_parameters |   use_local_density: 0
20:47:36.458 |     INFO |       log_parameters |   nn_window: 5
20:47:36.458 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:36.458 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:36.458 |     INFO |       log_parameters |   len_for_classify: 5
20:47:36.458 |     INFO |       log_parameters |   res_limit: 0.1
20:47:36.458 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:36.458 |     INFO |       log_parameters |   strategy_bd: -1
20:47:36.458 |     INFO |       log_parameters |   lft_cdf: None
20:47:36.458 |     INFO |       log_parameters |   kalman_init_param: None
20:47:36.458 |     INFO |       log_parameters |   diagnostics: None
20:47:36.458 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:36.458 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:36.458 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:36.458 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:36.458 |     INFO |       log_parameters |   coords_shape: (54, 2)
20:47:36.458 |     INFO |       log_parameters |   uncertainties_shape: (54, 2)
20:47:36.458 |     INFO |       log_parameters |   mean_uncertainty: 0.31017975925925934
20:47:36.458 |     INFO |       log_parameters |   uncertainty_range: [0.218909, 0.35443]
20:47:36.458 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:36.458 |     INFO |       log_parameters |   coords_shape: (50, 2)
20:47:36.458 |     INFO |       log_parameters |   uncertainties_shape: (50, 2)
20:47:36.458 |     INFO |       log_parameters |   mean_uncertainty: 0.30783786999999996
20:47:36.458 |     INFO |       log_parameters |   uncertainty_range: [0.222002, 0.360105]
20:47:36.458 |    DEBUG |            log_debug | Initializing Kalman for 50 features, prob_dim=2, state_dim=4
20:47:36.458 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:36.458 |     INFO |       log_parameters |   num_features: 50
20:47:36.458 |     INFO |       log_parameters |   state_dim: 4
20:47:36.458 |     INFO |       log_parameters |   prob_dim: 2
20:47:36.458 |     INFO |       log_parameters |   state_vec_shape: (50, 4)
20:47:36.458 |     INFO |       log_parameters |   state_noise_var_shape: (50, 4, 4)
20:47:36.458 |    DEBUG |            log_debug | State vector shape: (54, 4), Expected: (54, 4)
20:47:36.459 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:36.459 |     INFO |       log_parameters |   num_features_predicted: 54
20:47:36.459 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:36.459 |     INFO |       log_parameters |   brownian_motion_features: 54
20:47:36.459 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:36.459 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:36.459 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:36.459 |     INFO |       log_parameters |   search_radii_shape: (54, 2)
20:47:36.459 |     INFO |       log_parameters |   min_radius: 0.1
20:47:36.459 |     INFO |       log_parameters |   max_radius: 0.1
20:47:36.459 |     INFO |       log_parameters |   mean_radius: 0.09999999999999999
20:47:36.459 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:36.459 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999999
20:47:36.460 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:36.460 |     INFO |       log_parameters |   distance_matrix_shape: (54, 50)
20:47:36.460 |     INFO |       log_parameters |   cost_matrix_shape: (54, 50)
20:47:36.460 |     INFO |       log_parameters |   finite_costs: 2700
20:47:36.460 |     INFO |       log_parameters |   infinite_costs: 0
20:47:36.460 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:36.460 |     INFO |       log_parameters |   min_distance: 17.46636460197545
20:47:36.460 |     INFO |       log_parameters |   max_distance: 132.72467590402445
20:47:36.460 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:36.460 |     INFO |       log_parameters |   motion_costs_shape: (54, 50)
20:47:36.460 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:36.460 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:36.460 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:36.460 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:36.460 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:36.461 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:36.461 |     INFO |       log_parameters |   coords_shape: (54, 2)
20:47:36.461 |     INFO |       log_parameters |   uncertainties_shape: (54, 2)
20:47:36.461 |     INFO |       log_parameters |   mean_uncertainty: 0.31017975925925934
20:47:36.461 |     INFO |       log_parameters |   uncertainty_range: [0.218909, 0.35443]
20:47:36.461 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:36.461 |     INFO |       log_parameters |   coords_shape: (50, 2)
20:47:36.461 |     INFO |       log_parameters |   uncertainties_shape: (50, 2)
20:47:36.461 |     INFO |       log_parameters |   mean_uncertainty: 0.30783786999999996
20:47:36.461 |     INFO |       log_parameters |   uncertainty_range: [0.222002, 0.360105]
20:47:36.462 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:36.462 |     INFO |       log_parameters |   feature_costs_shape: (54, 50)
20:47:36.462 |     INFO |       log_parameters |   feature_costs_min: 1.0000406199939686
20:47:36.462 |     INFO |       log_parameters |   feature_costs_max: 5.0
20:47:36.462 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:36.462 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:36.462 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:36.462 |     INFO |       log_parameters |   original_shape: (54, 50)
20:47:36.462 |     INFO |       log_parameters |   augmented_shape: (104, 104)
20:47:36.462 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:36.462 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:36.462 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:36.462 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:36.462 |    DEBUG |            log_debug |   observed_positions.shape: (50, 2)
20:47:36.462 |    DEBUG |            log_debug |   num_features (from observed_positions): 50
20:47:36.462 |    DEBUG |            log_debug |   predicted_positions.shape: (54, 2)
20:47:36.462 |    DEBUG |            log_debug |   predicted_velocities.shape: (54, 2)
20:47:36.462 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (50, 4)
20:47:36.462 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=50 but predicted_positions has 54 rows
20:47:36.462 |    ERROR |            log_error |   This will cause index 49 to fail when array only goes to 53
20:47:36.462 |    DEBUG |            log_debug | Kalman update: 50 features, state_dim=4, prob_dim=2
20:47:36.463 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman update):
20:47:36.463 |     INFO |       log_parameters |   features_updated: 50
20:47:36.463 |     INFO |       log_parameters |   state_dim: 4
20:47:36.463 |     INFO |       log_parameters |   dt_used: 1.0
20:47:36.463 |     INFO |       log_parameters |   process_noise_scale: 1.0
20:47:36.463 |     INFO |       log_parameters |   measurement_noise_scale: 1.0
20:47:36.463 |     INFO |             log_info | Enhanced linking completed successfully for frame 34
20:47:36.463 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0048 seconds
20:47:36.650 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=35, prob_dim=2, num_features_frame1=50, num_features_frame2=54)
20:47:36.650 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:36.650 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:36.650 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:36.650 |     INFO |       log_parameters |   current_frame: 35
20:47:36.650 |     INFO |       log_parameters |   prob_dim: 2
20:47:36.650 |     INFO |       log_parameters |   num_features_frame1: 50
20:47:36.650 |     INFO |       log_parameters |   num_features_frame2: 54
20:47:36.650 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:36.650 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:36.650 |     INFO |       log_parameters |   linear_motion: 1
20:47:36.650 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:36.650 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:36.650 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:36.650 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:36.650 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:36.650 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:36.650 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:36.650 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:36.650 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:36.650 |     INFO |       log_parameters |   use_local_density: 0
20:47:36.650 |     INFO |       log_parameters |   nn_window: 5
20:47:36.650 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:36.650 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:36.650 |     INFO |       log_parameters |   len_for_classify: 5
20:47:36.650 |     INFO |       log_parameters |   res_limit: 0.1
20:47:36.650 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:36.650 |     INFO |       log_parameters |   strategy_bd: -1
20:47:36.650 |     INFO |       log_parameters |   lft_cdf: None
20:47:36.650 |     INFO |       log_parameters |   kalman_init_param: None
20:47:36.650 |     INFO |       log_parameters |   diagnostics: None
20:47:36.650 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:36.650 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:36.650 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:36.650 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:36.650 |     INFO |       log_parameters |   coords_shape: (50, 2)
20:47:36.650 |     INFO |       log_parameters |   uncertainties_shape: (50, 2)
20:47:36.650 |     INFO |       log_parameters |   mean_uncertainty: 0.30783786999999996
20:47:36.650 |     INFO |       log_parameters |   uncertainty_range: [0.222002, 0.360105]
20:47:36.650 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:36.650 |     INFO |       log_parameters |   coords_shape: (54, 2)
20:47:36.650 |     INFO |       log_parameters |   uncertainties_shape: (54, 2)
20:47:36.650 |     INFO |       log_parameters |   mean_uncertainty: 0.30845536111111116
20:47:36.650 |     INFO |       log_parameters |   uncertainty_range: [0.22132, 0.353065]
20:47:36.650 |    DEBUG |            log_debug | Initializing Kalman for 54 features, prob_dim=2, state_dim=4
20:47:36.650 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:36.650 |     INFO |       log_parameters |   num_features: 54
20:47:36.650 |     INFO |       log_parameters |   state_dim: 4
20:47:36.650 |     INFO |       log_parameters |   prob_dim: 2
20:47:36.650 |     INFO |       log_parameters |   state_vec_shape: (54, 4)
20:47:36.650 |     INFO |       log_parameters |   state_noise_var_shape: (54, 4, 4)
20:47:36.650 |    DEBUG |            log_debug | State vector shape: (50, 4), Expected: (50, 4)
20:47:36.651 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:36.651 |     INFO |       log_parameters |   num_features_predicted: 50
20:47:36.651 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:36.651 |     INFO |       log_parameters |   brownian_motion_features: 50
20:47:36.651 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:36.651 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:36.651 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:36.651 |     INFO |       log_parameters |   search_radii_shape: (50, 2)
20:47:36.651 |     INFO |       log_parameters |   min_radius: 0.1
20:47:36.651 |     INFO |       log_parameters |   max_radius: 0.1
20:47:36.651 |     INFO |       log_parameters |   mean_radius: 0.09999999999999998
20:47:36.651 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:36.651 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999998
20:47:36.652 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:36.652 |     INFO |       log_parameters |   distance_matrix_shape: (50, 54)
20:47:36.652 |     INFO |       log_parameters |   cost_matrix_shape: (50, 54)
20:47:36.652 |     INFO |       log_parameters |   finite_costs: 2700
20:47:36.652 |     INFO |       log_parameters |   infinite_costs: 0
20:47:36.652 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:36.652 |     INFO |       log_parameters |   min_distance: 15.144974569157256
20:47:36.652 |     INFO |       log_parameters |   max_distance: 132.47500931788102
20:47:36.652 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:36.652 |     INFO |       log_parameters |   motion_costs_shape: (50, 54)
20:47:36.652 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:36.652 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:36.652 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:36.652 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:36.652 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:36.653 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:36.653 |     INFO |       log_parameters |   coords_shape: (50, 2)
20:47:36.653 |     INFO |       log_parameters |   uncertainties_shape: (50, 2)
20:47:36.653 |     INFO |       log_parameters |   mean_uncertainty: 0.30783786999999996
20:47:36.653 |     INFO |       log_parameters |   uncertainty_range: [0.222002, 0.360105]
20:47:36.653 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:36.653 |     INFO |       log_parameters |   coords_shape: (54, 2)
20:47:36.653 |     INFO |       log_parameters |   uncertainties_shape: (54, 2)
20:47:36.653 |     INFO |       log_parameters |   mean_uncertainty: 0.30845536111111116
20:47:36.653 |     INFO |       log_parameters |   uncertainty_range: [0.22132, 0.353065]
20:47:36.654 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:36.654 |     INFO |       log_parameters |   feature_costs_shape: (50, 54)
20:47:36.654 |     INFO |       log_parameters |   feature_costs_min: 1.000234371132246
20:47:36.654 |     INFO |       log_parameters |   feature_costs_max: 5.0
20:47:36.654 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:36.654 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:36.654 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:36.654 |     INFO |       log_parameters |   original_shape: (50, 54)
20:47:36.654 |     INFO |       log_parameters |   augmented_shape: (104, 104)
20:47:36.654 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:36.654 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:36.654 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:36.654 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:36.654 |    DEBUG |            log_debug |   observed_positions.shape: (54, 2)
20:47:36.654 |    DEBUG |            log_debug |   num_features (from observed_positions): 54
20:47:36.654 |    DEBUG |            log_debug |   predicted_positions.shape: (50, 2)
20:47:36.654 |    DEBUG |            log_debug |   predicted_velocities.shape: (50, 2)
20:47:36.654 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (54, 4)
20:47:36.654 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=54 but predicted_positions has 50 rows
20:47:36.654 |    ERROR |            log_error |   This will cause index 53 to fail when array only goes to 49
20:47:36.654 |    DEBUG |            log_debug | Kalman update: 54 features, state_dim=4, prob_dim=2
20:47:36.655 |    ERROR |            log_error | Error in enhanced linking: index 50 is out of bounds for axis 0 with size 50
20:47:36.655 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 50 is out of bounds for axis 0 with size 50
20:47:36.655 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0050 seconds
20:47:36.665 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=36, prob_dim=2, num_features_frame1=54, num_features_frame2=56)
20:47:36.665 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:36.665 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:36.665 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:36.665 |     INFO |       log_parameters |   current_frame: 36
20:47:36.665 |     INFO |       log_parameters |   prob_dim: 2
20:47:36.665 |     INFO |       log_parameters |   num_features_frame1: 54
20:47:36.665 |     INFO |       log_parameters |   num_features_frame2: 56
20:47:36.665 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:36.665 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:36.665 |     INFO |       log_parameters |   linear_motion: 1
20:47:36.665 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:36.665 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:36.665 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:36.665 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:36.665 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:36.665 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:36.665 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:36.665 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:36.665 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:36.665 |     INFO |       log_parameters |   use_local_density: 0
20:47:36.665 |     INFO |       log_parameters |   nn_window: 5
20:47:36.665 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:36.665 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:36.665 |     INFO |       log_parameters |   len_for_classify: 5
20:47:36.665 |     INFO |       log_parameters |   res_limit: 0.1
20:47:36.665 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:36.665 |     INFO |       log_parameters |   strategy_bd: -1
20:47:36.665 |     INFO |       log_parameters |   lft_cdf: None
20:47:36.665 |     INFO |       log_parameters |   kalman_init_param: None
20:47:36.665 |     INFO |       log_parameters |   diagnostics: None
20:47:36.665 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:36.665 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:36.665 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:36.665 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:36.665 |     INFO |       log_parameters |   coords_shape: (54, 2)
20:47:36.665 |     INFO |       log_parameters |   uncertainties_shape: (54, 2)
20:47:36.665 |     INFO |       log_parameters |   mean_uncertainty: 0.30845536111111116
20:47:36.665 |     INFO |       log_parameters |   uncertainty_range: [0.22132, 0.353065]
20:47:36.665 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:36.665 |     INFO |       log_parameters |   coords_shape: (56, 2)
20:47:36.665 |     INFO |       log_parameters |   uncertainties_shape: (56, 2)
20:47:36.665 |     INFO |       log_parameters |   mean_uncertainty: 0.3119844464285714
20:47:36.665 |     INFO |       log_parameters |   uncertainty_range: [0.219437, 0.356985]
20:47:36.665 |    DEBUG |            log_debug | Initializing Kalman for 56 features, prob_dim=2, state_dim=4
20:47:36.665 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:36.665 |     INFO |       log_parameters |   num_features: 56
20:47:36.665 |     INFO |       log_parameters |   state_dim: 4
20:47:36.665 |     INFO |       log_parameters |   prob_dim: 2
20:47:36.665 |     INFO |       log_parameters |   state_vec_shape: (56, 4)
20:47:36.665 |     INFO |       log_parameters |   state_noise_var_shape: (56, 4, 4)
20:47:36.665 |    DEBUG |            log_debug | State vector shape: (54, 4), Expected: (54, 4)
20:47:36.666 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:36.666 |     INFO |       log_parameters |   num_features_predicted: 54
20:47:36.666 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:36.666 |     INFO |       log_parameters |   brownian_motion_features: 54
20:47:36.666 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:36.666 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:36.666 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:36.666 |     INFO |       log_parameters |   search_radii_shape: (54, 2)
20:47:36.666 |     INFO |       log_parameters |   min_radius: 0.1
20:47:36.666 |     INFO |       log_parameters |   max_radius: 0.1
20:47:36.666 |     INFO |       log_parameters |   mean_radius: 0.09999999999999999
20:47:36.666 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:36.666 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999999
20:47:36.667 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:36.667 |     INFO |       log_parameters |   distance_matrix_shape: (54, 56)
20:47:36.667 |     INFO |       log_parameters |   cost_matrix_shape: (54, 56)
20:47:36.667 |     INFO |       log_parameters |   finite_costs: 3024
20:47:36.667 |     INFO |       log_parameters |   infinite_costs: 0
20:47:36.667 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:36.667 |     INFO |       log_parameters |   min_distance: 11.5723697686524
20:47:36.667 |     INFO |       log_parameters |   max_distance: 132.43222956842376
20:47:36.667 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:36.667 |     INFO |       log_parameters |   motion_costs_shape: (54, 56)
20:47:36.667 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:36.667 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:36.667 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:36.667 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:36.667 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:36.669 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:36.669 |     INFO |       log_parameters |   coords_shape: (54, 2)
20:47:36.669 |     INFO |       log_parameters |   uncertainties_shape: (54, 2)
20:47:36.669 |     INFO |       log_parameters |   mean_uncertainty: 0.30845536111111116
20:47:36.669 |     INFO |       log_parameters |   uncertainty_range: [0.22132, 0.353065]
20:47:36.669 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:36.669 |     INFO |       log_parameters |   coords_shape: (56, 2)
20:47:36.669 |     INFO |       log_parameters |   uncertainties_shape: (56, 2)
20:47:36.669 |     INFO |       log_parameters |   mean_uncertainty: 0.3119844464285714
20:47:36.669 |     INFO |       log_parameters |   uncertainty_range: [0.219437, 0.356985]
20:47:36.669 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:36.669 |     INFO |       log_parameters |   feature_costs_shape: (54, 56)
20:47:36.669 |     INFO |       log_parameters |   feature_costs_min: 1.000005237199852
20:47:36.669 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:36.669 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:36.669 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:36.669 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:36.669 |     INFO |       log_parameters |   original_shape: (54, 56)
20:47:36.669 |     INFO |       log_parameters |   augmented_shape: (110, 110)
20:47:36.669 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:36.669 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:36.669 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:36.669 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:36.669 |    DEBUG |            log_debug |   observed_positions.shape: (56, 2)
20:47:36.669 |    DEBUG |            log_debug |   num_features (from observed_positions): 56
20:47:36.669 |    DEBUG |            log_debug |   predicted_positions.shape: (54, 2)
20:47:36.669 |    DEBUG |            log_debug |   predicted_velocities.shape: (54, 2)
20:47:36.669 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (56, 4)
20:47:36.669 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=56 but predicted_positions has 54 rows
20:47:36.669 |    ERROR |            log_error |   This will cause index 55 to fail when array only goes to 53
20:47:36.669 |    DEBUG |            log_debug | Kalman update: 56 features, state_dim=4, prob_dim=2
20:47:36.670 |    ERROR |            log_error | Error in enhanced linking: index 54 is out of bounds for axis 0 with size 54
20:47:36.670 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 54 is out of bounds for axis 0 with size 54
20:47:36.670 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0053 seconds
20:47:36.680 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=37, prob_dim=2, num_features_frame1=56, num_features_frame2=51)
20:47:36.680 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:36.680 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:36.680 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:36.680 |     INFO |       log_parameters |   current_frame: 37
20:47:36.680 |     INFO |       log_parameters |   prob_dim: 2
20:47:36.680 |     INFO |       log_parameters |   num_features_frame1: 56
20:47:36.680 |     INFO |       log_parameters |   num_features_frame2: 51
20:47:36.680 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:36.680 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:36.680 |     INFO |       log_parameters |   linear_motion: 1
20:47:36.680 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:36.680 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:36.680 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:36.680 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:36.680 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:36.680 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:36.680 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:36.680 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:36.680 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:36.680 |     INFO |       log_parameters |   use_local_density: 0
20:47:36.680 |     INFO |       log_parameters |   nn_window: 5
20:47:36.680 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:36.680 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:36.680 |     INFO |       log_parameters |   len_for_classify: 5
20:47:36.680 |     INFO |       log_parameters |   res_limit: 0.1
20:47:36.680 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:36.681 |     INFO |       log_parameters |   strategy_bd: -1
20:47:36.681 |     INFO |       log_parameters |   lft_cdf: None
20:47:36.681 |     INFO |       log_parameters |   kalman_init_param: None
20:47:36.681 |     INFO |       log_parameters |   diagnostics: None
20:47:36.681 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:36.681 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:36.681 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:36.681 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:36.681 |     INFO |       log_parameters |   coords_shape: (56, 2)
20:47:36.681 |     INFO |       log_parameters |   uncertainties_shape: (56, 2)
20:47:36.681 |     INFO |       log_parameters |   mean_uncertainty: 0.3119844464285714
20:47:36.681 |     INFO |       log_parameters |   uncertainty_range: [0.219437, 0.356985]
20:47:36.681 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:36.681 |     INFO |       log_parameters |   coords_shape: (51, 2)
20:47:36.681 |     INFO |       log_parameters |   uncertainties_shape: (51, 2)
20:47:36.681 |     INFO |       log_parameters |   mean_uncertainty: 0.30785550980392157
20:47:36.681 |     INFO |       log_parameters |   uncertainty_range: [0.207473, 0.355024]
20:47:36.681 |    DEBUG |            log_debug | Initializing Kalman for 51 features, prob_dim=2, state_dim=4
20:47:36.681 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:36.681 |     INFO |       log_parameters |   num_features: 51
20:47:36.681 |     INFO |       log_parameters |   state_dim: 4
20:47:36.681 |     INFO |       log_parameters |   prob_dim: 2
20:47:36.681 |     INFO |       log_parameters |   state_vec_shape: (51, 4)
20:47:36.681 |     INFO |       log_parameters |   state_noise_var_shape: (51, 4, 4)
20:47:36.681 |    DEBUG |            log_debug | State vector shape: (56, 4), Expected: (56, 4)
20:47:36.681 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:36.681 |     INFO |       log_parameters |   num_features_predicted: 56
20:47:36.681 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:36.681 |     INFO |       log_parameters |   brownian_motion_features: 56
20:47:36.681 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:36.681 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:36.681 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:36.681 |     INFO |       log_parameters |   search_radii_shape: (56, 2)
20:47:36.681 |     INFO |       log_parameters |   min_radius: 0.1
20:47:36.681 |     INFO |       log_parameters |   max_radius: 0.1
20:47:36.681 |     INFO |       log_parameters |   mean_radius: 0.1
20:47:36.681 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:36.681 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.1
20:47:36.682 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:36.682 |     INFO |       log_parameters |   distance_matrix_shape: (56, 51)
20:47:36.682 |     INFO |       log_parameters |   cost_matrix_shape: (56, 51)
20:47:36.682 |     INFO |       log_parameters |   finite_costs: 2856
20:47:36.682 |     INFO |       log_parameters |   infinite_costs: 0
20:47:36.682 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:36.682 |     INFO |       log_parameters |   min_distance: 20.584314814621596
20:47:36.682 |     INFO |       log_parameters |   max_distance: 132.3834669259783
20:47:36.682 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:36.682 |     INFO |       log_parameters |   motion_costs_shape: (56, 51)
20:47:36.682 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:36.682 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:36.682 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:36.682 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:36.682 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:36.684 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:36.684 |     INFO |       log_parameters |   coords_shape: (56, 2)
20:47:36.684 |     INFO |       log_parameters |   uncertainties_shape: (56, 2)
20:47:36.684 |     INFO |       log_parameters |   mean_uncertainty: 0.3119844464285714
20:47:36.684 |     INFO |       log_parameters |   uncertainty_range: [0.219437, 0.356985]
20:47:36.684 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:36.684 |     INFO |       log_parameters |   coords_shape: (51, 2)
20:47:36.684 |     INFO |       log_parameters |   uncertainties_shape: (51, 2)
20:47:36.684 |     INFO |       log_parameters |   mean_uncertainty: 0.30785550980392157
20:47:36.684 |     INFO |       log_parameters |   uncertainty_range: [0.207473, 0.355024]
20:47:36.684 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:36.684 |     INFO |       log_parameters |   feature_costs_shape: (56, 51)
20:47:36.684 |     INFO |       log_parameters |   feature_costs_min: 1.000010744373562
20:47:36.684 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:36.684 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:36.684 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:36.684 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:36.684 |     INFO |       log_parameters |   original_shape: (56, 51)
20:47:36.684 |     INFO |       log_parameters |   augmented_shape: (107, 107)
20:47:36.684 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:36.684 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:36.684 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:36.684 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:36.684 |    DEBUG |            log_debug |   observed_positions.shape: (51, 2)
20:47:36.684 |    DEBUG |            log_debug |   num_features (from observed_positions): 51
20:47:36.684 |    DEBUG |            log_debug |   predicted_positions.shape: (56, 2)
20:47:36.684 |    DEBUG |            log_debug |   predicted_velocities.shape: (56, 2)
20:47:36.684 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (51, 4)
20:47:36.684 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=51 but predicted_positions has 56 rows
20:47:36.684 |    ERROR |            log_error |   This will cause index 50 to fail when array only goes to 55
20:47:36.684 |    DEBUG |            log_debug | Kalman update: 51 features, state_dim=4, prob_dim=2
20:47:36.685 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman update):
20:47:36.685 |     INFO |       log_parameters |   features_updated: 51
20:47:36.685 |     INFO |       log_parameters |   state_dim: 4
20:47:36.685 |     INFO |       log_parameters |   dt_used: 1.0
20:47:36.685 |     INFO |       log_parameters |   process_noise_scale: 1.0
20:47:36.685 |     INFO |       log_parameters |   measurement_noise_scale: 1.0
20:47:36.685 |     INFO |             log_info | Enhanced linking completed successfully for frame 37
20:47:36.685 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0049 seconds
20:47:36.879 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=38, prob_dim=2, num_features_frame1=51, num_features_frame2=47)
20:47:36.879 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:36.879 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:36.879 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:36.879 |     INFO |       log_parameters |   current_frame: 38
20:47:36.879 |     INFO |       log_parameters |   prob_dim: 2
20:47:36.879 |     INFO |       log_parameters |   num_features_frame1: 51
20:47:36.879 |     INFO |       log_parameters |   num_features_frame2: 47
20:47:36.879 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:36.879 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:36.879 |     INFO |       log_parameters |   linear_motion: 1
20:47:36.879 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:36.879 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:36.879 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:36.879 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:36.879 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:36.880 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:36.880 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:36.880 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:36.880 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:36.880 |     INFO |       log_parameters |   use_local_density: 0
20:47:36.880 |     INFO |       log_parameters |   nn_window: 5
20:47:36.880 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:36.880 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:36.880 |     INFO |       log_parameters |   len_for_classify: 5
20:47:36.880 |     INFO |       log_parameters |   res_limit: 0.1
20:47:36.880 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:36.880 |     INFO |       log_parameters |   strategy_bd: -1
20:47:36.880 |     INFO |       log_parameters |   lft_cdf: None
20:47:36.880 |     INFO |       log_parameters |   kalman_init_param: None
20:47:36.880 |     INFO |       log_parameters |   diagnostics: None
20:47:36.880 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:36.880 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:36.880 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:36.880 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:36.880 |     INFO |       log_parameters |   coords_shape: (51, 2)
20:47:36.880 |     INFO |       log_parameters |   uncertainties_shape: (51, 2)
20:47:36.880 |     INFO |       log_parameters |   mean_uncertainty: 0.30785550980392157
20:47:36.880 |     INFO |       log_parameters |   uncertainty_range: [0.207473, 0.355024]
20:47:36.880 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:36.880 |     INFO |       log_parameters |   coords_shape: (47, 2)
20:47:36.880 |     INFO |       log_parameters |   uncertainties_shape: (47, 2)
20:47:36.880 |     INFO |       log_parameters |   mean_uncertainty: 0.30295906382978716
20:47:36.880 |     INFO |       log_parameters |   uncertainty_range: [0.202555, 0.357417]
20:47:36.880 |    DEBUG |            log_debug | Initializing Kalman for 47 features, prob_dim=2, state_dim=4
20:47:36.880 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:36.880 |     INFO |       log_parameters |   num_features: 47
20:47:36.880 |     INFO |       log_parameters |   state_dim: 4
20:47:36.880 |     INFO |       log_parameters |   prob_dim: 2
20:47:36.880 |     INFO |       log_parameters |   state_vec_shape: (47, 4)
20:47:36.880 |     INFO |       log_parameters |   state_noise_var_shape: (47, 4, 4)
20:47:36.880 |    DEBUG |            log_debug | State vector shape: (51, 4), Expected: (51, 4)
20:47:36.880 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:36.880 |     INFO |       log_parameters |   num_features_predicted: 51
20:47:36.880 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:36.880 |     INFO |       log_parameters |   brownian_motion_features: 51
20:47:36.880 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:36.880 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:36.880 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:36.881 |     INFO |       log_parameters |   search_radii_shape: (51, 2)
20:47:36.881 |     INFO |       log_parameters |   min_radius: 0.1
20:47:36.881 |     INFO |       log_parameters |   max_radius: 0.1
20:47:36.881 |     INFO |       log_parameters |   mean_radius: 0.09999999999999998
20:47:36.881 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:36.881 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999998
20:47:36.881 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:36.881 |     INFO |       log_parameters |   distance_matrix_shape: (51, 47)
20:47:36.881 |     INFO |       log_parameters |   cost_matrix_shape: (51, 47)
20:47:36.881 |     INFO |       log_parameters |   finite_costs: 2397
20:47:36.881 |     INFO |       log_parameters |   infinite_costs: 0
20:47:36.881 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:36.881 |     INFO |       log_parameters |   min_distance: 20.763208986716865
20:47:36.881 |     INFO |       log_parameters |   max_distance: 132.31519255552615
20:47:36.881 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:36.881 |     INFO |       log_parameters |   motion_costs_shape: (51, 47)
20:47:36.881 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:36.881 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:36.881 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:36.881 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:36.881 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:36.883 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:36.883 |     INFO |       log_parameters |   coords_shape: (51, 2)
20:47:36.883 |     INFO |       log_parameters |   uncertainties_shape: (51, 2)
20:47:36.883 |     INFO |       log_parameters |   mean_uncertainty: 0.30785550980392157
20:47:36.883 |     INFO |       log_parameters |   uncertainty_range: [0.207473, 0.355024]
20:47:36.883 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:36.883 |     INFO |       log_parameters |   coords_shape: (47, 2)
20:47:36.883 |     INFO |       log_parameters |   uncertainties_shape: (47, 2)
20:47:36.883 |     INFO |       log_parameters |   mean_uncertainty: 0.30295906382978716
20:47:36.883 |     INFO |       log_parameters |   uncertainty_range: [0.202555, 0.357417]
20:47:36.883 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:36.883 |     INFO |       log_parameters |   feature_costs_shape: (51, 47)
20:47:36.883 |     INFO |       log_parameters |   feature_costs_min: 1.0001406606517942
20:47:36.883 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:36.883 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:36.883 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:36.883 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:36.883 |     INFO |       log_parameters |   original_shape: (51, 47)
20:47:36.883 |     INFO |       log_parameters |   augmented_shape: (98, 98)
20:47:36.883 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:36.883 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:36.883 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:36.883 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:36.883 |    DEBUG |            log_debug |   observed_positions.shape: (47, 2)
20:47:36.883 |    DEBUG |            log_debug |   num_features (from observed_positions): 47
20:47:36.883 |    DEBUG |            log_debug |   predicted_positions.shape: (51, 2)
20:47:36.883 |    DEBUG |            log_debug |   predicted_velocities.shape: (51, 2)
20:47:36.883 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (47, 4)
20:47:36.883 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=47 but predicted_positions has 51 rows
20:47:36.883 |    ERROR |            log_error |   This will cause index 46 to fail when array only goes to 50
20:47:36.883 |    DEBUG |            log_debug | Kalman update: 47 features, state_dim=4, prob_dim=2
20:47:36.884 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman update):
20:47:36.884 |     INFO |       log_parameters |   features_updated: 47
20:47:36.884 |     INFO |       log_parameters |   state_dim: 4
20:47:36.884 |     INFO |       log_parameters |   dt_used: 1.0
20:47:36.884 |     INFO |       log_parameters |   process_noise_scale: 1.0
20:47:36.884 |     INFO |       log_parameters |   measurement_noise_scale: 1.0
20:47:36.884 |     INFO |             log_info | Enhanced linking completed successfully for frame 38
20:47:36.884 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0045 seconds
20:47:37.054 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=39, prob_dim=2, num_features_frame1=47, num_features_frame2=43)
20:47:37.054 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:37.054 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:37.054 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:37.054 |     INFO |       log_parameters |   current_frame: 39
20:47:37.054 |     INFO |       log_parameters |   prob_dim: 2
20:47:37.054 |     INFO |       log_parameters |   num_features_frame1: 47
20:47:37.054 |     INFO |       log_parameters |   num_features_frame2: 43
20:47:37.054 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:37.054 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:37.054 |     INFO |       log_parameters |   linear_motion: 1
20:47:37.054 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:37.054 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:37.054 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:37.054 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:37.054 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:37.054 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:37.054 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:37.054 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:37.054 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:37.054 |     INFO |       log_parameters |   use_local_density: 0
20:47:37.054 |     INFO |       log_parameters |   nn_window: 5
20:47:37.054 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:37.054 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:37.054 |     INFO |       log_parameters |   len_for_classify: 5
20:47:37.054 |     INFO |       log_parameters |   res_limit: 0.1
20:47:37.054 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:37.054 |     INFO |       log_parameters |   strategy_bd: -1
20:47:37.054 |     INFO |       log_parameters |   lft_cdf: None
20:47:37.054 |     INFO |       log_parameters |   kalman_init_param: None
20:47:37.054 |     INFO |       log_parameters |   diagnostics: None
20:47:37.054 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:37.054 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:37.054 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:37.054 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:37.054 |     INFO |       log_parameters |   coords_shape: (47, 2)
20:47:37.054 |     INFO |       log_parameters |   uncertainties_shape: (47, 2)
20:47:37.054 |     INFO |       log_parameters |   mean_uncertainty: 0.30295906382978716
20:47:37.054 |     INFO |       log_parameters |   uncertainty_range: [0.202555, 0.357417]
20:47:37.054 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:37.054 |     INFO |       log_parameters |   coords_shape: (43, 2)
20:47:37.054 |     INFO |       log_parameters |   uncertainties_shape: (43, 2)
20:47:37.054 |     INFO |       log_parameters |   mean_uncertainty: 0.3021858139534883
20:47:37.054 |     INFO |       log_parameters |   uncertainty_range: [0.199998, 0.356935]
20:47:37.054 |    DEBUG |            log_debug | Initializing Kalman for 43 features, prob_dim=2, state_dim=4
20:47:37.054 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:37.054 |     INFO |       log_parameters |   num_features: 43
20:47:37.054 |     INFO |       log_parameters |   state_dim: 4
20:47:37.054 |     INFO |       log_parameters |   prob_dim: 2
20:47:37.054 |     INFO |       log_parameters |   state_vec_shape: (43, 4)
20:47:37.054 |     INFO |       log_parameters |   state_noise_var_shape: (43, 4, 4)
20:47:37.054 |    DEBUG |            log_debug | State vector shape: (47, 4), Expected: (47, 4)
20:47:37.055 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:37.055 |     INFO |       log_parameters |   num_features_predicted: 47
20:47:37.055 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:37.055 |     INFO |       log_parameters |   brownian_motion_features: 47
20:47:37.055 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:37.055 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:37.055 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:37.055 |     INFO |       log_parameters |   search_radii_shape: (47, 2)
20:47:37.055 |     INFO |       log_parameters |   min_radius: 0.1
20:47:37.055 |     INFO |       log_parameters |   max_radius: 0.1
20:47:37.055 |     INFO |       log_parameters |   mean_radius: 0.09999999999999996
20:47:37.055 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:37.055 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999996
20:47:37.055 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:37.055 |     INFO |       log_parameters |   distance_matrix_shape: (47, 43)
20:47:37.055 |     INFO |       log_parameters |   cost_matrix_shape: (47, 43)
20:47:37.055 |     INFO |       log_parameters |   finite_costs: 2021
20:47:37.056 |     INFO |       log_parameters |   infinite_costs: 0
20:47:37.056 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:37.056 |     INFO |       log_parameters |   min_distance: 20.501087742882575
20:47:37.056 |     INFO |       log_parameters |   max_distance: 132.3474243827227
20:47:37.056 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:37.056 |     INFO |       log_parameters |   motion_costs_shape: (47, 43)
20:47:37.056 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:37.056 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:37.056 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:37.056 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:37.056 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:37.057 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:37.057 |     INFO |       log_parameters |   coords_shape: (47, 2)
20:47:37.057 |     INFO |       log_parameters |   uncertainties_shape: (47, 2)
20:47:37.057 |     INFO |       log_parameters |   mean_uncertainty: 0.30295906382978716
20:47:37.057 |     INFO |       log_parameters |   uncertainty_range: [0.202555, 0.357417]
20:47:37.057 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:37.057 |     INFO |       log_parameters |   coords_shape: (43, 2)
20:47:37.057 |     INFO |       log_parameters |   uncertainties_shape: (43, 2)
20:47:37.057 |     INFO |       log_parameters |   mean_uncertainty: 0.3021858139534883
20:47:37.057 |     INFO |       log_parameters |   uncertainty_range: [0.199998, 0.356935]
20:47:37.057 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:37.057 |     INFO |       log_parameters |   feature_costs_shape: (47, 43)
20:47:37.057 |     INFO |       log_parameters |   feature_costs_min: 1.0001324826836606
20:47:37.057 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:37.057 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:37.057 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:37.057 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:37.057 |     INFO |       log_parameters |   original_shape: (47, 43)
20:47:37.057 |     INFO |       log_parameters |   augmented_shape: (90, 90)
20:47:37.057 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:37.057 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:37.057 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:37.057 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:37.057 |    DEBUG |            log_debug |   observed_positions.shape: (43, 2)
20:47:37.057 |    DEBUG |            log_debug |   num_features (from observed_positions): 43
20:47:37.057 |    DEBUG |            log_debug |   predicted_positions.shape: (47, 2)
20:47:37.057 |    DEBUG |            log_debug |   predicted_velocities.shape: (47, 2)
20:47:37.057 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (43, 4)
20:47:37.057 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=43 but predicted_positions has 47 rows
20:47:37.057 |    ERROR |            log_error |   This will cause index 42 to fail when array only goes to 46
20:47:37.057 |    DEBUG |            log_debug | Kalman update: 43 features, state_dim=4, prob_dim=2
20:47:37.058 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman update):
20:47:37.058 |     INFO |       log_parameters |   features_updated: 43
20:47:37.058 |     INFO |       log_parameters |   state_dim: 4
20:47:37.058 |     INFO |       log_parameters |   dt_used: 1.0
20:47:37.058 |     INFO |       log_parameters |   process_noise_scale: 1.0
20:47:37.058 |     INFO |       log_parameters |   measurement_noise_scale: 1.0
20:47:37.058 |     INFO |             log_info | Enhanced linking completed successfully for frame 39
20:47:37.058 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0042 seconds
20:47:37.203 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=40, prob_dim=2, num_features_frame1=43, num_features_frame2=56)
20:47:37.203 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:37.203 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:37.203 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:37.203 |     INFO |       log_parameters |   current_frame: 40
20:47:37.203 |     INFO |       log_parameters |   prob_dim: 2
20:47:37.203 |     INFO |       log_parameters |   num_features_frame1: 43
20:47:37.203 |     INFO |       log_parameters |   num_features_frame2: 56
20:47:37.203 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:37.203 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:37.203 |     INFO |       log_parameters |   linear_motion: 1
20:47:37.203 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:37.203 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:37.203 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:37.203 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:37.203 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:37.203 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:37.203 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:37.203 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:37.203 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:37.203 |     INFO |       log_parameters |   use_local_density: 0
20:47:37.203 |     INFO |       log_parameters |   nn_window: 5
20:47:37.203 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:37.203 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:37.203 |     INFO |       log_parameters |   len_for_classify: 5
20:47:37.203 |     INFO |       log_parameters |   res_limit: 0.1
20:47:37.203 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:37.203 |     INFO |       log_parameters |   strategy_bd: -1
20:47:37.203 |     INFO |       log_parameters |   lft_cdf: None
20:47:37.203 |     INFO |       log_parameters |   kalman_init_param: None
20:47:37.203 |     INFO |       log_parameters |   diagnostics: None
20:47:37.203 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:37.203 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:37.203 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:37.203 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:37.203 |     INFO |       log_parameters |   coords_shape: (43, 2)
20:47:37.203 |     INFO |       log_parameters |   uncertainties_shape: (43, 2)
20:47:37.203 |     INFO |       log_parameters |   mean_uncertainty: 0.3021858139534883
20:47:37.203 |     INFO |       log_parameters |   uncertainty_range: [0.199998, 0.356935]
20:47:37.203 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:37.203 |     INFO |       log_parameters |   coords_shape: (56, 2)
20:47:37.203 |     INFO |       log_parameters |   uncertainties_shape: (56, 2)
20:47:37.203 |     INFO |       log_parameters |   mean_uncertainty: 0.3128911696428571
20:47:37.203 |     INFO |       log_parameters |   uncertainty_range: [0.200361, 0.360313]
20:47:37.203 |    DEBUG |            log_debug | Initializing Kalman for 56 features, prob_dim=2, state_dim=4
20:47:37.203 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:37.203 |     INFO |       log_parameters |   num_features: 56
20:47:37.203 |     INFO |       log_parameters |   state_dim: 4
20:47:37.203 |     INFO |       log_parameters |   prob_dim: 2
20:47:37.203 |     INFO |       log_parameters |   state_vec_shape: (56, 4)
20:47:37.203 |     INFO |       log_parameters |   state_noise_var_shape: (56, 4, 4)
20:47:37.203 |    DEBUG |            log_debug | State vector shape: (43, 4), Expected: (43, 4)
20:47:37.204 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:37.204 |     INFO |       log_parameters |   num_features_predicted: 43
20:47:37.204 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:37.204 |     INFO |       log_parameters |   brownian_motion_features: 43
20:47:37.204 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:37.204 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:37.204 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:37.204 |     INFO |       log_parameters |   search_radii_shape: (43, 2)
20:47:37.204 |     INFO |       log_parameters |   min_radius: 0.1
20:47:37.204 |     INFO |       log_parameters |   max_radius: 0.1
20:47:37.204 |     INFO |       log_parameters |   mean_radius: 0.09999999999999998
20:47:37.204 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:37.204 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999998
20:47:37.204 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:37.204 |     INFO |       log_parameters |   distance_matrix_shape: (43, 56)
20:47:37.204 |     INFO |       log_parameters |   cost_matrix_shape: (43, 56)
20:47:37.204 |     INFO |       log_parameters |   finite_costs: 2408
20:47:37.204 |     INFO |       log_parameters |   infinite_costs: 0
20:47:37.204 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:37.204 |     INFO |       log_parameters |   min_distance: 3.842254342203936
20:47:37.204 |     INFO |       log_parameters |   max_distance: 132.48169026727186
20:47:37.204 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:37.204 |     INFO |       log_parameters |   motion_costs_shape: (43, 56)
20:47:37.204 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:37.204 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:37.204 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:37.205 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:37.205 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:37.206 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:37.206 |     INFO |       log_parameters |   coords_shape: (43, 2)
20:47:37.206 |     INFO |       log_parameters |   uncertainties_shape: (43, 2)
20:47:37.206 |     INFO |       log_parameters |   mean_uncertainty: 0.3021858139534883
20:47:37.206 |     INFO |       log_parameters |   uncertainty_range: [0.199998, 0.356935]
20:47:37.206 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:37.206 |     INFO |       log_parameters |   coords_shape: (56, 2)
20:47:37.206 |     INFO |       log_parameters |   uncertainties_shape: (56, 2)
20:47:37.206 |     INFO |       log_parameters |   mean_uncertainty: 0.3128911696428571
20:47:37.206 |     INFO |       log_parameters |   uncertainty_range: [0.200361, 0.360313]
20:47:37.206 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:37.206 |     INFO |       log_parameters |   feature_costs_shape: (43, 56)
20:47:37.206 |     INFO |       log_parameters |   feature_costs_min: 1.0000425220877953
20:47:37.206 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:37.206 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:37.206 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:37.206 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:37.206 |     INFO |       log_parameters |   original_shape: (43, 56)
20:47:37.206 |     INFO |       log_parameters |   augmented_shape: (99, 99)
20:47:37.206 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:37.206 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:37.206 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:37.206 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:37.206 |    DEBUG |            log_debug |   observed_positions.shape: (56, 2)
20:47:37.206 |    DEBUG |            log_debug |   num_features (from observed_positions): 56
20:47:37.206 |    DEBUG |            log_debug |   predicted_positions.shape: (43, 2)
20:47:37.206 |    DEBUG |            log_debug |   predicted_velocities.shape: (43, 2)
20:47:37.206 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (56, 4)
20:47:37.206 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=56 but predicted_positions has 43 rows
20:47:37.206 |    ERROR |            log_error |   This will cause index 55 to fail when array only goes to 42
20:47:37.207 |    DEBUG |            log_debug | Kalman update: 56 features, state_dim=4, prob_dim=2
20:47:37.207 |    ERROR |            log_error | Error in enhanced linking: index 43 is out of bounds for axis 0 with size 43
20:47:37.207 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 43 is out of bounds for axis 0 with size 43
20:47:37.208 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0047 seconds
20:47:37.218 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=41, prob_dim=2, num_features_frame1=56, num_features_frame2=52)
20:47:37.218 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:37.218 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:37.218 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:37.218 |     INFO |       log_parameters |   current_frame: 41
20:47:37.218 |     INFO |       log_parameters |   prob_dim: 2
20:47:37.218 |     INFO |       log_parameters |   num_features_frame1: 56
20:47:37.218 |     INFO |       log_parameters |   num_features_frame2: 52
20:47:37.218 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:37.218 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:37.218 |     INFO |       log_parameters |   linear_motion: 1
20:47:37.218 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:37.218 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:37.218 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:37.218 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:37.218 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:37.218 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:37.218 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:37.218 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:37.218 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:37.218 |     INFO |       log_parameters |   use_local_density: 0
20:47:37.218 |     INFO |       log_parameters |   nn_window: 5
20:47:37.218 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:37.218 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:37.218 |     INFO |       log_parameters |   len_for_classify: 5
20:47:37.218 |     INFO |       log_parameters |   res_limit: 0.1
20:47:37.218 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:37.218 |     INFO |       log_parameters |   strategy_bd: -1
20:47:37.218 |     INFO |       log_parameters |   lft_cdf: None
20:47:37.218 |     INFO |       log_parameters |   kalman_init_param: None
20:47:37.218 |     INFO |       log_parameters |   diagnostics: None
20:47:37.218 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:37.218 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:37.218 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:37.218 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:37.218 |     INFO |       log_parameters |   coords_shape: (56, 2)
20:47:37.218 |     INFO |       log_parameters |   uncertainties_shape: (56, 2)
20:47:37.218 |     INFO |       log_parameters |   mean_uncertainty: 0.3128911696428571
20:47:37.218 |     INFO |       log_parameters |   uncertainty_range: [0.200361, 0.360313]
20:47:37.218 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:37.218 |     INFO |       log_parameters |   coords_shape: (52, 2)
20:47:37.218 |     INFO |       log_parameters |   uncertainties_shape: (52, 2)
20:47:37.218 |     INFO |       log_parameters |   mean_uncertainty: 0.30997360576923083
20:47:37.218 |     INFO |       log_parameters |   uncertainty_range: [0.201072, 0.352394]
20:47:37.218 |    DEBUG |            log_debug | Initializing Kalman for 52 features, prob_dim=2, state_dim=4
20:47:37.218 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:37.218 |     INFO |       log_parameters |   num_features: 52
20:47:37.218 |     INFO |       log_parameters |   state_dim: 4
20:47:37.218 |     INFO |       log_parameters |   prob_dim: 2
20:47:37.218 |     INFO |       log_parameters |   state_vec_shape: (52, 4)
20:47:37.218 |     INFO |       log_parameters |   state_noise_var_shape: (52, 4, 4)
20:47:37.218 |    DEBUG |            log_debug | State vector shape: (56, 4), Expected: (56, 4)
20:47:37.219 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:37.219 |     INFO |       log_parameters |   num_features_predicted: 56
20:47:37.219 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:37.219 |     INFO |       log_parameters |   brownian_motion_features: 56
20:47:37.219 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:37.219 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:37.219 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:37.219 |     INFO |       log_parameters |   search_radii_shape: (56, 2)
20:47:37.219 |     INFO |       log_parameters |   min_radius: 0.1
20:47:37.219 |     INFO |       log_parameters |   max_radius: 0.1
20:47:37.219 |     INFO |       log_parameters |   mean_radius: 0.1
20:47:37.219 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:37.219 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.1
20:47:37.219 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:37.219 |     INFO |       log_parameters |   distance_matrix_shape: (56, 52)
20:47:37.219 |     INFO |       log_parameters |   cost_matrix_shape: (56, 52)
20:47:37.219 |     INFO |       log_parameters |   finite_costs: 2912
20:47:37.219 |     INFO |       log_parameters |   infinite_costs: 0
20:47:37.219 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:37.219 |     INFO |       log_parameters |   min_distance: 5.785568596203834
20:47:37.219 |     INFO |       log_parameters |   max_distance: 126.2144067286636
20:47:37.219 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:37.220 |     INFO |       log_parameters |   motion_costs_shape: (56, 52)
20:47:37.220 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:37.220 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:37.220 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:37.220 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:37.220 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:37.221 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:37.221 |     INFO |       log_parameters |   coords_shape: (56, 2)
20:47:37.221 |     INFO |       log_parameters |   uncertainties_shape: (56, 2)
20:47:37.221 |     INFO |       log_parameters |   mean_uncertainty: 0.3128911696428571
20:47:37.221 |     INFO |       log_parameters |   uncertainty_range: [0.200361, 0.360313]
20:47:37.221 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:37.221 |     INFO |       log_parameters |   coords_shape: (52, 2)
20:47:37.221 |     INFO |       log_parameters |   uncertainties_shape: (52, 2)
20:47:37.221 |     INFO |       log_parameters |   mean_uncertainty: 0.30997360576923083
20:47:37.221 |     INFO |       log_parameters |   uncertainty_range: [0.201072, 0.352394]
20:47:37.222 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:37.222 |     INFO |       log_parameters |   feature_costs_shape: (56, 52)
20:47:37.222 |     INFO |       log_parameters |   feature_costs_min: 1.0003586686860948
20:47:37.222 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:37.222 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:37.222 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:37.222 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:37.222 |     INFO |       log_parameters |   original_shape: (56, 52)
20:47:37.222 |     INFO |       log_parameters |   augmented_shape: (108, 108)
20:47:37.222 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:37.222 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:37.222 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:37.222 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:37.222 |    DEBUG |            log_debug |   observed_positions.shape: (52, 2)
20:47:37.222 |    DEBUG |            log_debug |   num_features (from observed_positions): 52
20:47:37.222 |    DEBUG |            log_debug |   predicted_positions.shape: (56, 2)
20:47:37.222 |    DEBUG |            log_debug |   predicted_velocities.shape: (56, 2)
20:47:37.222 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (52, 4)
20:47:37.222 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=52 but predicted_positions has 56 rows
20:47:37.222 |    ERROR |            log_error |   This will cause index 51 to fail when array only goes to 55
20:47:37.222 |    DEBUG |            log_debug | Kalman update: 52 features, state_dim=4, prob_dim=2
20:47:37.223 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman update):
20:47:37.223 |     INFO |       log_parameters |   features_updated: 52
20:47:37.223 |     INFO |       log_parameters |   state_dim: 4
20:47:37.223 |     INFO |       log_parameters |   dt_used: 1.0
20:47:37.223 |     INFO |       log_parameters |   process_noise_scale: 1.0
20:47:37.223 |     INFO |       log_parameters |   measurement_noise_scale: 1.0
20:47:37.223 |     INFO |             log_info | Enhanced linking completed successfully for frame 41
20:47:37.223 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0050 seconds
20:47:37.424 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=42, prob_dim=2, num_features_frame1=52, num_features_frame2=57)
20:47:37.424 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:37.424 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:37.424 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:37.424 |     INFO |       log_parameters |   current_frame: 42
20:47:37.424 |     INFO |       log_parameters |   prob_dim: 2
20:47:37.424 |     INFO |       log_parameters |   num_features_frame1: 52
20:47:37.424 |     INFO |       log_parameters |   num_features_frame2: 57
20:47:37.424 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:37.424 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:37.424 |     INFO |       log_parameters |   linear_motion: 1
20:47:37.424 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:37.424 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:37.424 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:37.424 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:37.424 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:37.424 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:37.424 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:37.424 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:37.424 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:37.424 |     INFO |       log_parameters |   use_local_density: 0
20:47:37.424 |     INFO |       log_parameters |   nn_window: 5
20:47:37.424 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:37.424 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:37.424 |     INFO |       log_parameters |   len_for_classify: 5
20:47:37.424 |     INFO |       log_parameters |   res_limit: 0.1
20:47:37.424 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:37.424 |     INFO |       log_parameters |   strategy_bd: -1
20:47:37.424 |     INFO |       log_parameters |   lft_cdf: None
20:47:37.424 |     INFO |       log_parameters |   kalman_init_param: None
20:47:37.424 |     INFO |       log_parameters |   diagnostics: None
20:47:37.424 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:37.424 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:37.424 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:37.424 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:37.424 |     INFO |       log_parameters |   coords_shape: (52, 2)
20:47:37.424 |     INFO |       log_parameters |   uncertainties_shape: (52, 2)
20:47:37.424 |     INFO |       log_parameters |   mean_uncertainty: 0.30997360576923083
20:47:37.424 |     INFO |       log_parameters |   uncertainty_range: [0.201072, 0.352394]
20:47:37.424 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:37.424 |     INFO |       log_parameters |   coords_shape: (57, 2)
20:47:37.424 |     INFO |       log_parameters |   uncertainties_shape: (57, 2)
20:47:37.424 |     INFO |       log_parameters |   mean_uncertainty: 0.31403260526315785
20:47:37.424 |     INFO |       log_parameters |   uncertainty_range: [0.198528, 0.360013]
20:47:37.424 |    DEBUG |            log_debug | Initializing Kalman for 57 features, prob_dim=2, state_dim=4
20:47:37.424 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:37.424 |     INFO |       log_parameters |   num_features: 57
20:47:37.424 |     INFO |       log_parameters |   state_dim: 4
20:47:37.424 |     INFO |       log_parameters |   prob_dim: 2
20:47:37.424 |     INFO |       log_parameters |   state_vec_shape: (57, 4)
20:47:37.424 |     INFO |       log_parameters |   state_noise_var_shape: (57, 4, 4)
20:47:37.424 |    DEBUG |            log_debug | State vector shape: (52, 4), Expected: (52, 4)
20:47:37.425 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:37.425 |     INFO |       log_parameters |   num_features_predicted: 52
20:47:37.425 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:37.425 |     INFO |       log_parameters |   brownian_motion_features: 52
20:47:37.425 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:37.425 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:37.425 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:37.425 |     INFO |       log_parameters |   search_radii_shape: (52, 2)
20:47:37.425 |     INFO |       log_parameters |   min_radius: 0.1
20:47:37.425 |     INFO |       log_parameters |   max_radius: 0.1
20:47:37.425 |     INFO |       log_parameters |   mean_radius: 0.1
20:47:37.425 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:37.425 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.1
20:47:37.425 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:37.425 |     INFO |       log_parameters |   distance_matrix_shape: (52, 57)
20:47:37.425 |     INFO |       log_parameters |   cost_matrix_shape: (52, 57)
20:47:37.425 |     INFO |       log_parameters |   finite_costs: 2964
20:47:37.426 |     INFO |       log_parameters |   infinite_costs: 0
20:47:37.426 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:37.426 |     INFO |       log_parameters |   min_distance: 17.544168328854862
20:47:37.426 |     INFO |       log_parameters |   max_distance: 126.2158942306785
20:47:37.426 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:37.426 |     INFO |       log_parameters |   motion_costs_shape: (52, 57)
20:47:37.426 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:37.426 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:37.426 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:37.426 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:37.426 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:37.427 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:37.427 |     INFO |       log_parameters |   coords_shape: (52, 2)
20:47:37.427 |     INFO |       log_parameters |   uncertainties_shape: (52, 2)
20:47:37.427 |     INFO |       log_parameters |   mean_uncertainty: 0.30997360576923083
20:47:37.427 |     INFO |       log_parameters |   uncertainty_range: [0.201072, 0.352394]
20:47:37.427 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:37.427 |     INFO |       log_parameters |   coords_shape: (57, 2)
20:47:37.427 |     INFO |       log_parameters |   uncertainties_shape: (57, 2)
20:47:37.427 |     INFO |       log_parameters |   mean_uncertainty: 0.31403260526315785
20:47:37.427 |     INFO |       log_parameters |   uncertainty_range: [0.198528, 0.360013]
20:47:37.428 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:37.428 |     INFO |       log_parameters |   feature_costs_shape: (52, 57)
20:47:37.428 |     INFO |       log_parameters |   feature_costs_min: 1.0000313566723995
20:47:37.428 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:37.428 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:37.428 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:37.428 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:37.428 |     INFO |       log_parameters |   original_shape: (52, 57)
20:47:37.428 |     INFO |       log_parameters |   augmented_shape: (109, 109)
20:47:37.428 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:37.428 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:37.428 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:37.428 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:37.428 |    DEBUG |            log_debug |   observed_positions.shape: (57, 2)
20:47:37.428 |    DEBUG |            log_debug |   num_features (from observed_positions): 57
20:47:37.428 |    DEBUG |            log_debug |   predicted_positions.shape: (52, 2)
20:47:37.428 |    DEBUG |            log_debug |   predicted_velocities.shape: (52, 2)
20:47:37.428 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (57, 4)
20:47:37.428 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=57 but predicted_positions has 52 rows
20:47:37.428 |    ERROR |            log_error |   This will cause index 56 to fail when array only goes to 51
20:47:37.428 |    DEBUG |            log_debug | Kalman update: 57 features, state_dim=4, prob_dim=2
20:47:37.429 |    ERROR |            log_error | Error in enhanced linking: index 52 is out of bounds for axis 0 with size 52
20:47:37.429 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 52 is out of bounds for axis 0 with size 52
20:47:37.429 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0053 seconds
20:47:37.439 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=43, prob_dim=2, num_features_frame1=57, num_features_frame2=47)
20:47:37.439 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:37.439 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:37.439 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:37.439 |     INFO |       log_parameters |   current_frame: 43
20:47:37.439 |     INFO |       log_parameters |   prob_dim: 2
20:47:37.439 |     INFO |       log_parameters |   num_features_frame1: 57
20:47:37.439 |     INFO |       log_parameters |   num_features_frame2: 47
20:47:37.439 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:37.439 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:37.439 |     INFO |       log_parameters |   linear_motion: 1
20:47:37.439 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:37.439 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:37.439 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:37.439 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:37.439 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:37.439 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:37.439 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:37.439 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:37.439 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:37.439 |     INFO |       log_parameters |   use_local_density: 0
20:47:37.439 |     INFO |       log_parameters |   nn_window: 5
20:47:37.439 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:37.439 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:37.439 |     INFO |       log_parameters |   len_for_classify: 5
20:47:37.439 |     INFO |       log_parameters |   res_limit: 0.1
20:47:37.439 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:37.439 |     INFO |       log_parameters |   strategy_bd: -1
20:47:37.439 |     INFO |       log_parameters |   lft_cdf: None
20:47:37.439 |     INFO |       log_parameters |   kalman_init_param: None
20:47:37.439 |     INFO |       log_parameters |   diagnostics: None
20:47:37.439 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:37.439 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:37.439 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:37.439 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:37.439 |     INFO |       log_parameters |   coords_shape: (57, 2)
20:47:37.439 |     INFO |       log_parameters |   uncertainties_shape: (57, 2)
20:47:37.439 |     INFO |       log_parameters |   mean_uncertainty: 0.31403260526315785
20:47:37.439 |     INFO |       log_parameters |   uncertainty_range: [0.198528, 0.360013]
20:47:37.439 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:37.439 |     INFO |       log_parameters |   coords_shape: (47, 2)
20:47:37.439 |     INFO |       log_parameters |   uncertainties_shape: (47, 2)
20:47:37.439 |     INFO |       log_parameters |   mean_uncertainty: 0.3055050212765957
20:47:37.439 |     INFO |       log_parameters |   uncertainty_range: [0.201034, 0.354139]
20:47:37.439 |    DEBUG |            log_debug | Initializing Kalman for 47 features, prob_dim=2, state_dim=4
20:47:37.439 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:37.439 |     INFO |       log_parameters |   num_features: 47
20:47:37.439 |     INFO |       log_parameters |   state_dim: 4
20:47:37.439 |     INFO |       log_parameters |   prob_dim: 2
20:47:37.439 |     INFO |       log_parameters |   state_vec_shape: (47, 4)
20:47:37.439 |     INFO |       log_parameters |   state_noise_var_shape: (47, 4, 4)
20:47:37.439 |    DEBUG |            log_debug | State vector shape: (57, 4), Expected: (57, 4)
20:47:37.440 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:37.440 |     INFO |       log_parameters |   num_features_predicted: 57
20:47:37.440 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:37.440 |     INFO |       log_parameters |   brownian_motion_features: 57
20:47:37.440 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:37.440 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:37.440 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:37.440 |     INFO |       log_parameters |   search_radii_shape: (57, 2)
20:47:37.440 |     INFO |       log_parameters |   min_radius: 0.1
20:47:37.440 |     INFO |       log_parameters |   max_radius: 0.1
20:47:37.440 |     INFO |       log_parameters |   mean_radius: 0.1
20:47:37.440 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:37.440 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.1
20:47:37.441 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:37.441 |     INFO |       log_parameters |   distance_matrix_shape: (57, 47)
20:47:37.441 |     INFO |       log_parameters |   cost_matrix_shape: (57, 47)
20:47:37.441 |     INFO |       log_parameters |   finite_costs: 2679
20:47:37.441 |     INFO |       log_parameters |   infinite_costs: 0
20:47:37.441 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:37.441 |     INFO |       log_parameters |   min_distance: 17.02702851538016
20:47:37.441 |     INFO |       log_parameters |   max_distance: 133.86381621870504
20:47:37.441 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:37.441 |     INFO |       log_parameters |   motion_costs_shape: (57, 47)
20:47:37.441 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:37.441 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:37.441 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:37.441 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:37.441 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:37.442 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:37.442 |     INFO |       log_parameters |   coords_shape: (57, 2)
20:47:37.442 |     INFO |       log_parameters |   uncertainties_shape: (57, 2)
20:47:37.442 |     INFO |       log_parameters |   mean_uncertainty: 0.31403260526315785
20:47:37.442 |     INFO |       log_parameters |   uncertainty_range: [0.198528, 0.360013]
20:47:37.442 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:37.442 |     INFO |       log_parameters |   coords_shape: (47, 2)
20:47:37.442 |     INFO |       log_parameters |   uncertainties_shape: (47, 2)
20:47:37.442 |     INFO |       log_parameters |   mean_uncertainty: 0.3055050212765957
20:47:37.442 |     INFO |       log_parameters |   uncertainty_range: [0.201034, 0.354139]
20:47:37.443 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:37.443 |     INFO |       log_parameters |   feature_costs_shape: (57, 47)
20:47:37.443 |     INFO |       log_parameters |   feature_costs_min: 1.0002774385906086
20:47:37.443 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:37.443 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:37.443 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:37.443 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:37.443 |     INFO |       log_parameters |   original_shape: (57, 47)
20:47:37.443 |     INFO |       log_parameters |   augmented_shape: (104, 104)
20:47:37.443 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:37.443 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:37.443 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:37.443 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:37.443 |    DEBUG |            log_debug |   observed_positions.shape: (47, 2)
20:47:37.443 |    DEBUG |            log_debug |   num_features (from observed_positions): 47
20:47:37.443 |    DEBUG |            log_debug |   predicted_positions.shape: (57, 2)
20:47:37.443 |    DEBUG |            log_debug |   predicted_velocities.shape: (57, 2)
20:47:37.443 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (47, 4)
20:47:37.443 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=47 but predicted_positions has 57 rows
20:47:37.443 |    ERROR |            log_error |   This will cause index 46 to fail when array only goes to 56
20:47:37.443 |    DEBUG |            log_debug | Kalman update: 47 features, state_dim=4, prob_dim=2
20:47:37.444 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman update):
20:47:37.444 |     INFO |       log_parameters |   features_updated: 47
20:47:37.444 |     INFO |       log_parameters |   state_dim: 4
20:47:37.444 |     INFO |       log_parameters |   dt_used: 1.0
20:47:37.444 |     INFO |       log_parameters |   process_noise_scale: 1.0
20:47:37.444 |     INFO |       log_parameters |   measurement_noise_scale: 1.0
20:47:37.444 |     INFO |             log_info | Enhanced linking completed successfully for frame 43
20:47:37.444 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0047 seconds
20:47:37.620 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=44, prob_dim=2, num_features_frame1=47, num_features_frame2=59)
20:47:37.620 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:37.620 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:37.620 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:37.620 |     INFO |       log_parameters |   current_frame: 44
20:47:37.620 |     INFO |       log_parameters |   prob_dim: 2
20:47:37.620 |     INFO |       log_parameters |   num_features_frame1: 47
20:47:37.620 |     INFO |       log_parameters |   num_features_frame2: 59
20:47:37.620 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:37.620 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:37.620 |     INFO |       log_parameters |   linear_motion: 1
20:47:37.620 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:37.620 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:37.620 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:37.620 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:37.620 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:37.620 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:37.621 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:37.621 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:37.621 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:37.621 |     INFO |       log_parameters |   use_local_density: 0
20:47:37.621 |     INFO |       log_parameters |   nn_window: 5
20:47:37.621 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:37.621 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:37.621 |     INFO |       log_parameters |   len_for_classify: 5
20:47:37.621 |     INFO |       log_parameters |   res_limit: 0.1
20:47:37.621 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:37.621 |     INFO |       log_parameters |   strategy_bd: -1
20:47:37.621 |     INFO |       log_parameters |   lft_cdf: None
20:47:37.621 |     INFO |       log_parameters |   kalman_init_param: None
20:47:37.621 |     INFO |       log_parameters |   diagnostics: None
20:47:37.621 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:37.621 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:37.621 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:37.621 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:37.621 |     INFO |       log_parameters |   coords_shape: (47, 2)
20:47:37.621 |     INFO |       log_parameters |   uncertainties_shape: (47, 2)
20:47:37.621 |     INFO |       log_parameters |   mean_uncertainty: 0.3055050212765957
20:47:37.621 |     INFO |       log_parameters |   uncertainty_range: [0.201034, 0.354139]
20:47:37.621 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:37.621 |     INFO |       log_parameters |   coords_shape: (59, 2)
20:47:37.621 |     INFO |       log_parameters |   uncertainties_shape: (59, 2)
20:47:37.621 |     INFO |       log_parameters |   mean_uncertainty: 0.3165247457627119
20:47:37.621 |     INFO |       log_parameters |   uncertainty_range: [0.196857, 0.356472]
20:47:37.621 |    DEBUG |            log_debug | Initializing Kalman for 59 features, prob_dim=2, state_dim=4
20:47:37.621 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:37.621 |     INFO |       log_parameters |   num_features: 59
20:47:37.621 |     INFO |       log_parameters |   state_dim: 4
20:47:37.621 |     INFO |       log_parameters |   prob_dim: 2
20:47:37.621 |     INFO |       log_parameters |   state_vec_shape: (59, 4)
20:47:37.621 |     INFO |       log_parameters |   state_noise_var_shape: (59, 4, 4)
20:47:37.621 |    DEBUG |            log_debug | State vector shape: (47, 4), Expected: (47, 4)
20:47:37.621 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:37.621 |     INFO |       log_parameters |   num_features_predicted: 47
20:47:37.621 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:37.621 |     INFO |       log_parameters |   brownian_motion_features: 47
20:47:37.621 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:37.621 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:37.621 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:37.621 |     INFO |       log_parameters |   search_radii_shape: (47, 2)
20:47:37.621 |     INFO |       log_parameters |   min_radius: 0.1
20:47:37.621 |     INFO |       log_parameters |   max_radius: 0.1
20:47:37.621 |     INFO |       log_parameters |   mean_radius: 0.09999999999999996
20:47:37.621 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:37.621 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999996
20:47:37.622 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:37.622 |     INFO |       log_parameters |   distance_matrix_shape: (47, 59)
20:47:37.622 |     INFO |       log_parameters |   cost_matrix_shape: (47, 59)
20:47:37.622 |     INFO |       log_parameters |   finite_costs: 2773
20:47:37.622 |     INFO |       log_parameters |   infinite_costs: 0
20:47:37.622 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:37.622 |     INFO |       log_parameters |   min_distance: 10.297997940814563
20:47:37.622 |     INFO |       log_parameters |   max_distance: 129.5377587990037
20:47:37.622 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:37.622 |     INFO |       log_parameters |   motion_costs_shape: (47, 59)
20:47:37.622 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:37.622 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:37.622 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:37.622 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:37.622 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:37.624 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:37.624 |     INFO |       log_parameters |   coords_shape: (47, 2)
20:47:37.624 |     INFO |       log_parameters |   uncertainties_shape: (47, 2)
20:47:37.624 |     INFO |       log_parameters |   mean_uncertainty: 0.3055050212765957
20:47:37.624 |     INFO |       log_parameters |   uncertainty_range: [0.201034, 0.354139]
20:47:37.624 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:37.624 |     INFO |       log_parameters |   coords_shape: (59, 2)
20:47:37.624 |     INFO |       log_parameters |   uncertainties_shape: (59, 2)
20:47:37.624 |     INFO |       log_parameters |   mean_uncertainty: 0.3165247457627119
20:47:37.624 |     INFO |       log_parameters |   uncertainty_range: [0.196857, 0.356472]
20:47:37.624 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:37.624 |     INFO |       log_parameters |   feature_costs_shape: (47, 59)
20:47:37.624 |     INFO |       log_parameters |   feature_costs_min: 1.000066291229404
20:47:37.624 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:37.624 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:37.624 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:37.624 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:37.624 |     INFO |       log_parameters |   original_shape: (47, 59)
20:47:37.624 |     INFO |       log_parameters |   augmented_shape: (106, 106)
20:47:37.624 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:37.624 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:37.624 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:37.624 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:37.624 |    DEBUG |            log_debug |   observed_positions.shape: (59, 2)
20:47:37.624 |    DEBUG |            log_debug |   num_features (from observed_positions): 59
20:47:37.624 |    DEBUG |            log_debug |   predicted_positions.shape: (47, 2)
20:47:37.624 |    DEBUG |            log_debug |   predicted_velocities.shape: (47, 2)
20:47:37.624 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (59, 4)
20:47:37.624 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=59 but predicted_positions has 47 rows
20:47:37.624 |    ERROR |            log_error |   This will cause index 58 to fail when array only goes to 46
20:47:37.624 |    DEBUG |            log_debug | Kalman update: 59 features, state_dim=4, prob_dim=2
20:47:37.625 |    ERROR |            log_error | Error in enhanced linking: index 47 is out of bounds for axis 0 with size 47
20:47:37.625 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 47 is out of bounds for axis 0 with size 47
20:47:37.625 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0051 seconds
20:47:37.636 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=45, prob_dim=2, num_features_frame1=59, num_features_frame2=50)
20:47:37.636 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:37.636 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:37.636 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:37.636 |     INFO |       log_parameters |   current_frame: 45
20:47:37.636 |     INFO |       log_parameters |   prob_dim: 2
20:47:37.636 |     INFO |       log_parameters |   num_features_frame1: 59
20:47:37.636 |     INFO |       log_parameters |   num_features_frame2: 50
20:47:37.636 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:37.636 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:37.636 |     INFO |       log_parameters |   linear_motion: 1
20:47:37.636 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:37.636 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:37.636 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:37.636 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:37.636 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:37.636 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:37.636 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:37.636 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:37.636 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:37.636 |     INFO |       log_parameters |   use_local_density: 0
20:47:37.636 |     INFO |       log_parameters |   nn_window: 5
20:47:37.636 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:37.636 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:37.636 |     INFO |       log_parameters |   len_for_classify: 5
20:47:37.636 |     INFO |       log_parameters |   res_limit: 0.1
20:47:37.636 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:37.636 |     INFO |       log_parameters |   strategy_bd: -1
20:47:37.636 |     INFO |       log_parameters |   lft_cdf: None
20:47:37.636 |     INFO |       log_parameters |   kalman_init_param: None
20:47:37.636 |     INFO |       log_parameters |   diagnostics: None
20:47:37.636 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:37.636 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:37.636 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:37.636 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:37.636 |     INFO |       log_parameters |   coords_shape: (59, 2)
20:47:37.636 |     INFO |       log_parameters |   uncertainties_shape: (59, 2)
20:47:37.636 |     INFO |       log_parameters |   mean_uncertainty: 0.3165247457627119
20:47:37.636 |     INFO |       log_parameters |   uncertainty_range: [0.196857, 0.356472]
20:47:37.636 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:37.636 |     INFO |       log_parameters |   coords_shape: (50, 2)
20:47:37.636 |     INFO |       log_parameters |   uncertainties_shape: (50, 2)
20:47:37.636 |     INFO |       log_parameters |   mean_uncertainty: 0.31096941
20:47:37.636 |     INFO |       log_parameters |   uncertainty_range: [0.198761, 0.358105]
20:47:37.636 |    DEBUG |            log_debug | Initializing Kalman for 50 features, prob_dim=2, state_dim=4
20:47:37.636 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:37.636 |     INFO |       log_parameters |   num_features: 50
20:47:37.636 |     INFO |       log_parameters |   state_dim: 4
20:47:37.636 |     INFO |       log_parameters |   prob_dim: 2
20:47:37.636 |     INFO |       log_parameters |   state_vec_shape: (50, 4)
20:47:37.636 |     INFO |       log_parameters |   state_noise_var_shape: (50, 4, 4)
20:47:37.636 |    DEBUG |            log_debug | State vector shape: (59, 4), Expected: (59, 4)
20:47:37.637 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:37.637 |     INFO |       log_parameters |   num_features_predicted: 59
20:47:37.637 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:37.637 |     INFO |       log_parameters |   brownian_motion_features: 59
20:47:37.637 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:37.637 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:37.637 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:37.637 |     INFO |       log_parameters |   search_radii_shape: (59, 2)
20:47:37.637 |     INFO |       log_parameters |   min_radius: 0.1
20:47:37.637 |     INFO |       log_parameters |   max_radius: 0.1
20:47:37.637 |     INFO |       log_parameters |   mean_radius: 0.09999999999999999
20:47:37.637 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:37.637 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999999
20:47:37.637 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:37.637 |     INFO |       log_parameters |   distance_matrix_shape: (59, 50)
20:47:37.637 |     INFO |       log_parameters |   cost_matrix_shape: (59, 50)
20:47:37.637 |     INFO |       log_parameters |   finite_costs: 2950
20:47:37.637 |     INFO |       log_parameters |   infinite_costs: 0
20:47:37.637 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:37.637 |     INFO |       log_parameters |   min_distance: 20.477307832224845
20:47:37.637 |     INFO |       log_parameters |   max_distance: 126.20130729127159
20:47:37.638 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:37.638 |     INFO |       log_parameters |   motion_costs_shape: (59, 50)
20:47:37.638 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:37.638 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:37.638 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:37.638 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:37.638 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:37.639 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:37.639 |     INFO |       log_parameters |   coords_shape: (59, 2)
20:47:37.639 |     INFO |       log_parameters |   uncertainties_shape: (59, 2)
20:47:37.639 |     INFO |       log_parameters |   mean_uncertainty: 0.3165247457627119
20:47:37.639 |     INFO |       log_parameters |   uncertainty_range: [0.196857, 0.356472]
20:47:37.639 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:37.639 |     INFO |       log_parameters |   coords_shape: (50, 2)
20:47:37.639 |     INFO |       log_parameters |   uncertainties_shape: (50, 2)
20:47:37.639 |     INFO |       log_parameters |   mean_uncertainty: 0.31096941
20:47:37.639 |     INFO |       log_parameters |   uncertainty_range: [0.198761, 0.358105]
20:47:37.640 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:37.640 |     INFO |       log_parameters |   feature_costs_shape: (59, 50)
20:47:37.640 |     INFO |       log_parameters |   feature_costs_min: 1.0000010458908533
20:47:37.640 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:37.640 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:37.640 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:37.640 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:37.640 |     INFO |       log_parameters |   original_shape: (59, 50)
20:47:37.640 |     INFO |       log_parameters |   augmented_shape: (109, 109)
20:47:37.640 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:37.640 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:37.640 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:37.640 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:37.640 |    DEBUG |            log_debug |   observed_positions.shape: (50, 2)
20:47:37.640 |    DEBUG |            log_debug |   num_features (from observed_positions): 50
20:47:37.640 |    DEBUG |            log_debug |   predicted_positions.shape: (59, 2)
20:47:37.640 |    DEBUG |            log_debug |   predicted_velocities.shape: (59, 2)
20:47:37.640 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (50, 4)
20:47:37.640 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=50 but predicted_positions has 59 rows
20:47:37.640 |    ERROR |            log_error |   This will cause index 49 to fail when array only goes to 58
20:47:37.640 |    DEBUG |            log_debug | Kalman update: 50 features, state_dim=4, prob_dim=2
20:47:37.641 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman update):
20:47:37.641 |     INFO |       log_parameters |   features_updated: 50
20:47:37.641 |     INFO |       log_parameters |   state_dim: 4
20:47:37.641 |     INFO |       log_parameters |   dt_used: 1.0
20:47:37.641 |     INFO |       log_parameters |   process_noise_scale: 1.0
20:47:37.641 |     INFO |       log_parameters |   measurement_noise_scale: 1.0
20:47:37.641 |     INFO |             log_info | Enhanced linking completed successfully for frame 45
20:47:37.641 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0051 seconds
20:47:37.835 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=46, prob_dim=2, num_features_frame1=50, num_features_frame2=60)
20:47:37.835 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:37.835 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:37.835 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:37.835 |     INFO |       log_parameters |   current_frame: 46
20:47:37.835 |     INFO |       log_parameters |   prob_dim: 2
20:47:37.835 |     INFO |       log_parameters |   num_features_frame1: 50
20:47:37.835 |     INFO |       log_parameters |   num_features_frame2: 60
20:47:37.835 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:37.835 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:37.835 |     INFO |       log_parameters |   linear_motion: 1
20:47:37.835 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:37.835 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:37.835 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:37.835 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:37.835 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:37.835 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:37.835 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:37.835 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:37.835 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:37.835 |     INFO |       log_parameters |   use_local_density: 0
20:47:37.835 |     INFO |       log_parameters |   nn_window: 5
20:47:37.835 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:37.835 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:37.835 |     INFO |       log_parameters |   len_for_classify: 5
20:47:37.835 |     INFO |       log_parameters |   res_limit: 0.1
20:47:37.835 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:37.835 |     INFO |       log_parameters |   strategy_bd: -1
20:47:37.835 |     INFO |       log_parameters |   lft_cdf: None
20:47:37.835 |     INFO |       log_parameters |   kalman_init_param: None
20:47:37.835 |     INFO |       log_parameters |   diagnostics: None
20:47:37.835 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:37.835 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:37.835 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:37.835 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:37.835 |     INFO |       log_parameters |   coords_shape: (50, 2)
20:47:37.835 |     INFO |       log_parameters |   uncertainties_shape: (50, 2)
20:47:37.835 |     INFO |       log_parameters |   mean_uncertainty: 0.31096941
20:47:37.835 |     INFO |       log_parameters |   uncertainty_range: [0.198761, 0.358105]
20:47:37.835 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:37.835 |     INFO |       log_parameters |   coords_shape: (60, 2)
20:47:37.835 |     INFO |       log_parameters |   uncertainties_shape: (60, 2)
20:47:37.835 |     INFO |       log_parameters |   mean_uncertainty: 0.31581695
20:47:37.835 |     INFO |       log_parameters |   uncertainty_range: [0.206263, 0.356305]
20:47:37.835 |    DEBUG |            log_debug | Initializing Kalman for 60 features, prob_dim=2, state_dim=4
20:47:37.835 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:37.835 |     INFO |       log_parameters |   num_features: 60
20:47:37.835 |     INFO |       log_parameters |   state_dim: 4
20:47:37.835 |     INFO |       log_parameters |   prob_dim: 2
20:47:37.835 |     INFO |       log_parameters |   state_vec_shape: (60, 4)
20:47:37.835 |     INFO |       log_parameters |   state_noise_var_shape: (60, 4, 4)
20:47:37.835 |    DEBUG |            log_debug | State vector shape: (50, 4), Expected: (50, 4)
20:47:37.836 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:37.836 |     INFO |       log_parameters |   num_features_predicted: 50
20:47:37.836 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:37.836 |     INFO |       log_parameters |   brownian_motion_features: 50
20:47:37.836 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:37.836 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:37.836 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:37.836 |     INFO |       log_parameters |   search_radii_shape: (50, 2)
20:47:37.836 |     INFO |       log_parameters |   min_radius: 0.1
20:47:37.836 |     INFO |       log_parameters |   max_radius: 0.1
20:47:37.836 |     INFO |       log_parameters |   mean_radius: 0.09999999999999998
20:47:37.836 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:37.836 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999998
20:47:37.836 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:37.836 |     INFO |       log_parameters |   distance_matrix_shape: (50, 60)
20:47:37.836 |     INFO |       log_parameters |   cost_matrix_shape: (50, 60)
20:47:37.836 |     INFO |       log_parameters |   finite_costs: 3000
20:47:37.836 |     INFO |       log_parameters |   infinite_costs: 0
20:47:37.836 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:37.836 |     INFO |       log_parameters |   min_distance: 17.924851510672134
20:47:37.836 |     INFO |       log_parameters |   max_distance: 134.2170325749458
20:47:37.836 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:37.836 |     INFO |       log_parameters |   motion_costs_shape: (50, 60)
20:47:37.837 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:37.837 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:37.837 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:37.837 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:37.837 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:37.838 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:37.838 |     INFO |       log_parameters |   coords_shape: (50, 2)
20:47:37.838 |     INFO |       log_parameters |   uncertainties_shape: (50, 2)
20:47:37.838 |     INFO |       log_parameters |   mean_uncertainty: 0.31096941
20:47:37.838 |     INFO |       log_parameters |   uncertainty_range: [0.198761, 0.358105]
20:47:37.838 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:37.838 |     INFO |       log_parameters |   coords_shape: (60, 2)
20:47:37.838 |     INFO |       log_parameters |   uncertainties_shape: (60, 2)
20:47:37.838 |     INFO |       log_parameters |   mean_uncertainty: 0.31581695
20:47:37.838 |     INFO |       log_parameters |   uncertainty_range: [0.206263, 0.356305]
20:47:37.839 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:37.839 |     INFO |       log_parameters |   feature_costs_shape: (50, 60)
20:47:37.839 |     INFO |       log_parameters |   feature_costs_min: 1.0000599587501864
20:47:37.839 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:37.839 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:37.839 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:37.839 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:37.839 |     INFO |       log_parameters |   original_shape: (50, 60)
20:47:37.839 |     INFO |       log_parameters |   augmented_shape: (110, 110)
20:47:37.839 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:37.839 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:37.839 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:37.839 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:37.839 |    DEBUG |            log_debug |   observed_positions.shape: (60, 2)
20:47:37.839 |    DEBUG |            log_debug |   num_features (from observed_positions): 60
20:47:37.839 |    DEBUG |            log_debug |   predicted_positions.shape: (50, 2)
20:47:37.839 |    DEBUG |            log_debug |   predicted_velocities.shape: (50, 2)
20:47:37.839 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (60, 4)
20:47:37.839 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=60 but predicted_positions has 50 rows
20:47:37.839 |    ERROR |            log_error |   This will cause index 59 to fail when array only goes to 49
20:47:37.839 |    DEBUG |            log_debug | Kalman update: 60 features, state_dim=4, prob_dim=2
20:47:37.840 |    ERROR |            log_error | Error in enhanced linking: index 50 is out of bounds for axis 0 with size 50
20:47:37.840 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 50 is out of bounds for axis 0 with size 50
20:47:37.840 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0052 seconds
20:47:37.850 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=47, prob_dim=2, num_features_frame1=60, num_features_frame2=46)
20:47:37.850 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:37.850 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:37.850 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:37.850 |     INFO |       log_parameters |   current_frame: 47
20:47:37.850 |     INFO |       log_parameters |   prob_dim: 2
20:47:37.850 |     INFO |       log_parameters |   num_features_frame1: 60
20:47:37.850 |     INFO |       log_parameters |   num_features_frame2: 46
20:47:37.850 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:37.850 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:37.850 |     INFO |       log_parameters |   linear_motion: 1
20:47:37.850 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:37.850 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:37.850 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:37.850 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:37.850 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:37.850 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:37.850 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:37.850 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:37.850 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:37.850 |     INFO |       log_parameters |   use_local_density: 0
20:47:37.850 |     INFO |       log_parameters |   nn_window: 5
20:47:37.850 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:37.850 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:37.850 |     INFO |       log_parameters |   len_for_classify: 5
20:47:37.850 |     INFO |       log_parameters |   res_limit: 0.1
20:47:37.850 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:37.850 |     INFO |       log_parameters |   strategy_bd: -1
20:47:37.850 |     INFO |       log_parameters |   lft_cdf: None
20:47:37.850 |     INFO |       log_parameters |   kalman_init_param: None
20:47:37.850 |     INFO |       log_parameters |   diagnostics: None
20:47:37.850 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:37.850 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:37.850 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:37.850 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:37.850 |     INFO |       log_parameters |   coords_shape: (60, 2)
20:47:37.850 |     INFO |       log_parameters |   uncertainties_shape: (60, 2)
20:47:37.850 |     INFO |       log_parameters |   mean_uncertainty: 0.31581695
20:47:37.850 |     INFO |       log_parameters |   uncertainty_range: [0.206263, 0.356305]
20:47:37.850 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:37.850 |     INFO |       log_parameters |   coords_shape: (46, 2)
20:47:37.850 |     INFO |       log_parameters |   uncertainties_shape: (46, 2)
20:47:37.850 |     INFO |       log_parameters |   mean_uncertainty: 0.3069466086956522
20:47:37.850 |     INFO |       log_parameters |   uncertainty_range: [0.194877, 0.353532]
20:47:37.850 |    DEBUG |            log_debug | Initializing Kalman for 46 features, prob_dim=2, state_dim=4
20:47:37.850 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:37.850 |     INFO |       log_parameters |   num_features: 46
20:47:37.850 |     INFO |       log_parameters |   state_dim: 4
20:47:37.850 |     INFO |       log_parameters |   prob_dim: 2
20:47:37.850 |     INFO |       log_parameters |   state_vec_shape: (46, 4)
20:47:37.850 |     INFO |       log_parameters |   state_noise_var_shape: (46, 4, 4)
20:47:37.850 |    DEBUG |            log_debug | State vector shape: (60, 4), Expected: (60, 4)
20:47:37.851 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:37.851 |     INFO |       log_parameters |   num_features_predicted: 60
20:47:37.851 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:37.851 |     INFO |       log_parameters |   brownian_motion_features: 60
20:47:37.851 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:37.851 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:37.851 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:37.851 |     INFO |       log_parameters |   search_radii_shape: (60, 2)
20:47:37.851 |     INFO |       log_parameters |   min_radius: 0.1
20:47:37.851 |     INFO |       log_parameters |   max_radius: 0.1
20:47:37.851 |     INFO |       log_parameters |   mean_radius: 0.10000000000000002
20:47:37.851 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:37.851 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.10000000000000002
20:47:37.852 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:37.852 |     INFO |       log_parameters |   distance_matrix_shape: (60, 46)
20:47:37.852 |     INFO |       log_parameters |   cost_matrix_shape: (60, 46)
20:47:37.852 |     INFO |       log_parameters |   finite_costs: 2760
20:47:37.852 |     INFO |       log_parameters |   infinite_costs: 0
20:47:37.852 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:37.852 |     INFO |       log_parameters |   min_distance: 20.402882217280233
20:47:37.852 |     INFO |       log_parameters |   max_distance: 127.86700342917203
20:47:37.852 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:37.852 |     INFO |       log_parameters |   motion_costs_shape: (60, 46)
20:47:37.852 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:37.852 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:37.852 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:37.852 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:37.852 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:37.853 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:37.853 |     INFO |       log_parameters |   coords_shape: (60, 2)
20:47:37.853 |     INFO |       log_parameters |   uncertainties_shape: (60, 2)
20:47:37.853 |     INFO |       log_parameters |   mean_uncertainty: 0.31581695
20:47:37.853 |     INFO |       log_parameters |   uncertainty_range: [0.206263, 0.356305]
20:47:37.853 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:37.853 |     INFO |       log_parameters |   coords_shape: (46, 2)
20:47:37.853 |     INFO |       log_parameters |   uncertainties_shape: (46, 2)
20:47:37.853 |     INFO |       log_parameters |   mean_uncertainty: 0.3069466086956522
20:47:37.853 |     INFO |       log_parameters |   uncertainty_range: [0.194877, 0.353532]
20:47:37.854 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:37.854 |     INFO |       log_parameters |   feature_costs_shape: (60, 46)
20:47:37.854 |     INFO |       log_parameters |   feature_costs_min: 1.0000413205807805
20:47:37.854 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:37.854 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:37.854 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:37.854 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:37.854 |     INFO |       log_parameters |   original_shape: (60, 46)
20:47:37.854 |     INFO |       log_parameters |   augmented_shape: (106, 106)
20:47:37.854 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:37.854 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:37.854 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:37.854 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:37.854 |    DEBUG |            log_debug |   observed_positions.shape: (46, 2)
20:47:37.854 |    DEBUG |            log_debug |   num_features (from observed_positions): 46
20:47:37.854 |    DEBUG |            log_debug |   predicted_positions.shape: (60, 2)
20:47:37.854 |    DEBUG |            log_debug |   predicted_velocities.shape: (60, 2)
20:47:37.854 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (46, 4)
20:47:37.854 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=46 but predicted_positions has 60 rows
20:47:37.854 |    ERROR |            log_error |   This will cause index 45 to fail when array only goes to 59
20:47:37.854 |    DEBUG |            log_debug | Kalman update: 46 features, state_dim=4, prob_dim=2
20:47:37.855 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman update):
20:47:37.855 |     INFO |       log_parameters |   features_updated: 46
20:47:37.855 |     INFO |       log_parameters |   state_dim: 4
20:47:37.855 |     INFO |       log_parameters |   dt_used: 1.0
20:47:37.855 |     INFO |       log_parameters |   process_noise_scale: 1.0
20:47:37.855 |     INFO |       log_parameters |   measurement_noise_scale: 1.0
20:47:37.855 |     INFO |             log_info | Enhanced linking completed successfully for frame 47
20:47:37.855 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0048 seconds
20:47:38.030 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=48, prob_dim=2, num_features_frame1=46, num_features_frame2=57)
20:47:38.030 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:38.030 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:38.030 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:38.030 |     INFO |       log_parameters |   current_frame: 48
20:47:38.030 |     INFO |       log_parameters |   prob_dim: 2
20:47:38.030 |     INFO |       log_parameters |   num_features_frame1: 46
20:47:38.030 |     INFO |       log_parameters |   num_features_frame2: 57
20:47:38.030 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:38.030 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:38.030 |     INFO |       log_parameters |   linear_motion: 1
20:47:38.030 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:38.030 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:38.030 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:38.030 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:38.030 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:38.030 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:38.030 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:38.030 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:38.030 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:38.030 |     INFO |       log_parameters |   use_local_density: 0
20:47:38.030 |     INFO |       log_parameters |   nn_window: 5
20:47:38.030 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:38.030 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:38.030 |     INFO |       log_parameters |   len_for_classify: 5
20:47:38.030 |     INFO |       log_parameters |   res_limit: 0.1
20:47:38.030 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:38.030 |     INFO |       log_parameters |   strategy_bd: -1
20:47:38.030 |     INFO |       log_parameters |   lft_cdf: None
20:47:38.030 |     INFO |       log_parameters |   kalman_init_param: None
20:47:38.030 |     INFO |       log_parameters |   diagnostics: None
20:47:38.030 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:38.030 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:38.030 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:38.030 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:38.031 |     INFO |       log_parameters |   coords_shape: (46, 2)
20:47:38.031 |     INFO |       log_parameters |   uncertainties_shape: (46, 2)
20:47:38.031 |     INFO |       log_parameters |   mean_uncertainty: 0.3069466086956522
20:47:38.031 |     INFO |       log_parameters |   uncertainty_range: [0.194877, 0.353532]
20:47:38.031 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:38.031 |     INFO |       log_parameters |   coords_shape: (57, 2)
20:47:38.031 |     INFO |       log_parameters |   uncertainties_shape: (57, 2)
20:47:38.031 |     INFO |       log_parameters |   mean_uncertainty: 0.3109914473684211
20:47:38.031 |     INFO |       log_parameters |   uncertainty_range: [0.204672, 0.358032]
20:47:38.031 |    DEBUG |            log_debug | Initializing Kalman for 57 features, prob_dim=2, state_dim=4
20:47:38.031 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:38.031 |     INFO |       log_parameters |   num_features: 57
20:47:38.031 |     INFO |       log_parameters |   state_dim: 4
20:47:38.031 |     INFO |       log_parameters |   prob_dim: 2
20:47:38.031 |     INFO |       log_parameters |   state_vec_shape: (57, 4)
20:47:38.031 |     INFO |       log_parameters |   state_noise_var_shape: (57, 4, 4)
20:47:38.031 |    DEBUG |            log_debug | State vector shape: (46, 4), Expected: (46, 4)
20:47:38.031 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:38.031 |     INFO |       log_parameters |   num_features_predicted: 46
20:47:38.031 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:38.031 |     INFO |       log_parameters |   brownian_motion_features: 46
20:47:38.031 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:38.031 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:38.031 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:38.031 |     INFO |       log_parameters |   search_radii_shape: (46, 2)
20:47:38.031 |     INFO |       log_parameters |   min_radius: 0.1
20:47:38.031 |     INFO |       log_parameters |   max_radius: 0.1
20:47:38.031 |     INFO |       log_parameters |   mean_radius: 0.09999999999999998
20:47:38.031 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:38.031 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999998
20:47:38.032 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:38.032 |     INFO |       log_parameters |   distance_matrix_shape: (46, 57)
20:47:38.032 |     INFO |       log_parameters |   cost_matrix_shape: (46, 57)
20:47:38.032 |     INFO |       log_parameters |   finite_costs: 2622
20:47:38.032 |     INFO |       log_parameters |   infinite_costs: 0
20:47:38.032 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:38.032 |     INFO |       log_parameters |   min_distance: 20.539787478465325
20:47:38.032 |     INFO |       log_parameters |   max_distance: 126.32866472953482
20:47:38.032 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:38.032 |     INFO |       log_parameters |   motion_costs_shape: (46, 57)
20:47:38.032 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:38.032 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:38.032 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:38.032 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:38.032 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:38.034 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:38.034 |     INFO |       log_parameters |   coords_shape: (46, 2)
20:47:38.034 |     INFO |       log_parameters |   uncertainties_shape: (46, 2)
20:47:38.034 |     INFO |       log_parameters |   mean_uncertainty: 0.3069466086956522
20:47:38.034 |     INFO |       log_parameters |   uncertainty_range: [0.194877, 0.353532]
20:47:38.034 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:38.034 |     INFO |       log_parameters |   coords_shape: (57, 2)
20:47:38.034 |     INFO |       log_parameters |   uncertainties_shape: (57, 2)
20:47:38.034 |     INFO |       log_parameters |   mean_uncertainty: 0.3109914473684211
20:47:38.034 |     INFO |       log_parameters |   uncertainty_range: [0.204672, 0.358032]
20:47:38.034 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:38.034 |     INFO |       log_parameters |   feature_costs_shape: (46, 57)
20:47:38.034 |     INFO |       log_parameters |   feature_costs_min: 1.0000045669767257
20:47:38.034 |     INFO |       log_parameters |   feature_costs_max: 5.0
20:47:38.034 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:38.034 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:38.034 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:38.034 |     INFO |       log_parameters |   original_shape: (46, 57)
20:47:38.034 |     INFO |       log_parameters |   augmented_shape: (103, 103)
20:47:38.034 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:38.034 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:38.034 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:38.034 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:38.034 |    DEBUG |            log_debug |   observed_positions.shape: (57, 2)
20:47:38.034 |    DEBUG |            log_debug |   num_features (from observed_positions): 57
20:47:38.034 |    DEBUG |            log_debug |   predicted_positions.shape: (46, 2)
20:47:38.034 |    DEBUG |            log_debug |   predicted_velocities.shape: (46, 2)
20:47:38.034 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (57, 4)
20:47:38.034 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=57 but predicted_positions has 46 rows
20:47:38.034 |    ERROR |            log_error |   This will cause index 56 to fail when array only goes to 45
20:47:38.034 |    DEBUG |            log_debug | Kalman update: 57 features, state_dim=4, prob_dim=2
20:47:38.035 |    ERROR |            log_error | Error in enhanced linking: index 46 is out of bounds for axis 0 with size 46
20:47:38.035 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 46 is out of bounds for axis 0 with size 46
20:47:38.035 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0049 seconds
20:47:38.046 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=49, prob_dim=2, num_features_frame1=57, num_features_frame2=60)
20:47:38.046 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:38.046 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:38.046 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:38.046 |     INFO |       log_parameters |   current_frame: 49
20:47:38.046 |     INFO |       log_parameters |   prob_dim: 2
20:47:38.046 |     INFO |       log_parameters |   num_features_frame1: 57
20:47:38.046 |     INFO |       log_parameters |   num_features_frame2: 60
20:47:38.046 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:38.046 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:38.046 |     INFO |       log_parameters |   linear_motion: 1
20:47:38.046 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:38.046 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:38.046 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:38.046 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:38.046 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:38.046 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:38.046 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:38.046 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:38.046 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:38.046 |     INFO |       log_parameters |   use_local_density: 0
20:47:38.046 |     INFO |       log_parameters |   nn_window: 5
20:47:38.046 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:38.046 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:38.046 |     INFO |       log_parameters |   len_for_classify: 5
20:47:38.046 |     INFO |       log_parameters |   res_limit: 0.1
20:47:38.046 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:38.046 |     INFO |       log_parameters |   strategy_bd: -1
20:47:38.046 |     INFO |       log_parameters |   lft_cdf: None
20:47:38.046 |     INFO |       log_parameters |   kalman_init_param: None
20:47:38.046 |     INFO |       log_parameters |   diagnostics: None
20:47:38.046 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:38.046 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:38.046 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:38.046 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:38.046 |     INFO |       log_parameters |   coords_shape: (57, 2)
20:47:38.046 |     INFO |       log_parameters |   uncertainties_shape: (57, 2)
20:47:38.046 |     INFO |       log_parameters |   mean_uncertainty: 0.3109914473684211
20:47:38.046 |     INFO |       log_parameters |   uncertainty_range: [0.204672, 0.358032]
20:47:38.046 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:38.046 |     INFO |       log_parameters |   coords_shape: (60, 2)
20:47:38.046 |     INFO |       log_parameters |   uncertainties_shape: (60, 2)
20:47:38.046 |     INFO |       log_parameters |   mean_uncertainty: 0.3139705833333333
20:47:38.046 |     INFO |       log_parameters |   uncertainty_range: [0.20171, 0.358979]
20:47:38.046 |    DEBUG |            log_debug | Initializing Kalman for 60 features, prob_dim=2, state_dim=4
20:47:38.046 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:38.046 |     INFO |       log_parameters |   num_features: 60
20:47:38.046 |     INFO |       log_parameters |   state_dim: 4
20:47:38.046 |     INFO |       log_parameters |   prob_dim: 2
20:47:38.046 |     INFO |       log_parameters |   state_vec_shape: (60, 4)
20:47:38.046 |     INFO |       log_parameters |   state_noise_var_shape: (60, 4, 4)
20:47:38.046 |    DEBUG |            log_debug | State vector shape: (57, 4), Expected: (57, 4)
20:47:38.047 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:38.047 |     INFO |       log_parameters |   num_features_predicted: 57
20:47:38.047 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:38.047 |     INFO |       log_parameters |   brownian_motion_features: 57
20:47:38.047 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:38.047 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:38.047 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:38.047 |     INFO |       log_parameters |   search_radii_shape: (57, 2)
20:47:38.047 |     INFO |       log_parameters |   min_radius: 0.1
20:47:38.047 |     INFO |       log_parameters |   max_radius: 0.1
20:47:38.047 |     INFO |       log_parameters |   mean_radius: 0.1
20:47:38.047 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:38.047 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.1
20:47:38.047 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:38.047 |     INFO |       log_parameters |   distance_matrix_shape: (57, 60)
20:47:38.047 |     INFO |       log_parameters |   cost_matrix_shape: (57, 60)
20:47:38.047 |     INFO |       log_parameters |   finite_costs: 3420
20:47:38.047 |     INFO |       log_parameters |   infinite_costs: 0
20:47:38.047 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:38.047 |     INFO |       log_parameters |   min_distance: 11.850873174986559
20:47:38.048 |     INFO |       log_parameters |   max_distance: 128.7716788471492
20:47:38.048 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:38.048 |     INFO |       log_parameters |   motion_costs_shape: (57, 60)
20:47:38.048 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:38.048 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:38.048 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:38.048 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:38.048 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:38.050 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:38.050 |     INFO |       log_parameters |   coords_shape: (57, 2)
20:47:38.050 |     INFO |       log_parameters |   uncertainties_shape: (57, 2)
20:47:38.050 |     INFO |       log_parameters |   mean_uncertainty: 0.3109914473684211
20:47:38.050 |     INFO |       log_parameters |   uncertainty_range: [0.204672, 0.358032]
20:47:38.050 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:38.050 |     INFO |       log_parameters |   coords_shape: (60, 2)
20:47:38.050 |     INFO |       log_parameters |   uncertainties_shape: (60, 2)
20:47:38.050 |     INFO |       log_parameters |   mean_uncertainty: 0.3139705833333333
20:47:38.050 |     INFO |       log_parameters |   uncertainty_range: [0.20171, 0.358979]
20:47:38.050 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:38.050 |     INFO |       log_parameters |   feature_costs_shape: (57, 60)
20:47:38.050 |     INFO |       log_parameters |   feature_costs_min: 1.0000886996985767
20:47:38.050 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:38.050 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:38.050 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:38.050 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:38.050 |     INFO |       log_parameters |   original_shape: (57, 60)
20:47:38.050 |     INFO |       log_parameters |   augmented_shape: (117, 117)
20:47:38.050 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:38.050 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:38.050 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:38.050 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:38.050 |    DEBUG |            log_debug |   observed_positions.shape: (60, 2)
20:47:38.050 |    DEBUG |            log_debug |   num_features (from observed_positions): 60
20:47:38.050 |    DEBUG |            log_debug |   predicted_positions.shape: (57, 2)
20:47:38.050 |    DEBUG |            log_debug |   predicted_velocities.shape: (57, 2)
20:47:38.050 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (60, 4)
20:47:38.050 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=60 but predicted_positions has 57 rows
20:47:38.050 |    ERROR |            log_error |   This will cause index 59 to fail when array only goes to 56
20:47:38.050 |    DEBUG |            log_debug | Kalman update: 60 features, state_dim=4, prob_dim=2
20:47:38.051 |    ERROR |            log_error | Error in enhanced linking: index 57 is out of bounds for axis 0 with size 57
20:47:38.051 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 57 is out of bounds for axis 0 with size 57
20:47:38.051 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0057 seconds
20:47:38.062 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=50, prob_dim=2, num_features_frame1=60, num_features_frame2=54)
20:47:38.062 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:38.062 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:38.062 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:38.062 |     INFO |       log_parameters |   current_frame: 50
20:47:38.062 |     INFO |       log_parameters |   prob_dim: 2
20:47:38.062 |     INFO |       log_parameters |   num_features_frame1: 60
20:47:38.062 |     INFO |       log_parameters |   num_features_frame2: 54
20:47:38.062 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:38.062 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:38.062 |     INFO |       log_parameters |   linear_motion: 1
20:47:38.062 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:38.062 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:38.062 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:38.062 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:38.062 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:38.062 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:38.062 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:38.062 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:38.062 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:38.062 |     INFO |       log_parameters |   use_local_density: 0
20:47:38.062 |     INFO |       log_parameters |   nn_window: 5
20:47:38.062 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:38.062 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:38.062 |     INFO |       log_parameters |   len_for_classify: 5
20:47:38.062 |     INFO |       log_parameters |   res_limit: 0.1
20:47:38.062 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:38.062 |     INFO |       log_parameters |   strategy_bd: -1
20:47:38.062 |     INFO |       log_parameters |   lft_cdf: None
20:47:38.062 |     INFO |       log_parameters |   kalman_init_param: None
20:47:38.062 |     INFO |       log_parameters |   diagnostics: None
20:47:38.062 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:38.062 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:38.062 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:38.062 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:38.062 |     INFO |       log_parameters |   coords_shape: (60, 2)
20:47:38.062 |     INFO |       log_parameters |   uncertainties_shape: (60, 2)
20:47:38.062 |     INFO |       log_parameters |   mean_uncertainty: 0.3139705833333333
20:47:38.062 |     INFO |       log_parameters |   uncertainty_range: [0.20171, 0.358979]
20:47:38.062 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:38.062 |     INFO |       log_parameters |   coords_shape: (54, 2)
20:47:38.062 |     INFO |       log_parameters |   uncertainties_shape: (54, 2)
20:47:38.062 |     INFO |       log_parameters |   mean_uncertainty: 0.3123809351851853
20:47:38.062 |     INFO |       log_parameters |   uncertainty_range: [0.205372, 0.357481]
20:47:38.062 |    DEBUG |            log_debug | Initializing Kalman for 54 features, prob_dim=2, state_dim=4
20:47:38.062 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:38.062 |     INFO |       log_parameters |   num_features: 54
20:47:38.062 |     INFO |       log_parameters |   state_dim: 4
20:47:38.062 |     INFO |       log_parameters |   prob_dim: 2
20:47:38.062 |     INFO |       log_parameters |   state_vec_shape: (54, 4)
20:47:38.062 |     INFO |       log_parameters |   state_noise_var_shape: (54, 4, 4)
20:47:38.062 |    DEBUG |            log_debug | State vector shape: (60, 4), Expected: (60, 4)
20:47:38.063 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:38.063 |     INFO |       log_parameters |   num_features_predicted: 60
20:47:38.063 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:38.063 |     INFO |       log_parameters |   brownian_motion_features: 60
20:47:38.063 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:38.063 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:38.063 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:38.063 |     INFO |       log_parameters |   search_radii_shape: (60, 2)
20:47:38.063 |     INFO |       log_parameters |   min_radius: 0.1
20:47:38.063 |     INFO |       log_parameters |   max_radius: 0.1
20:47:38.063 |     INFO |       log_parameters |   mean_radius: 0.10000000000000002
20:47:38.063 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:38.063 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.10000000000000002
20:47:38.064 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:38.064 |     INFO |       log_parameters |   distance_matrix_shape: (60, 54)
20:47:38.064 |     INFO |       log_parameters |   cost_matrix_shape: (60, 54)
20:47:38.064 |     INFO |       log_parameters |   finite_costs: 3240
20:47:38.064 |     INFO |       log_parameters |   infinite_costs: 0
20:47:38.064 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:38.064 |     INFO |       log_parameters |   min_distance: 20.56872916498601
20:47:38.064 |     INFO |       log_parameters |   max_distance: 133.62522681797253
20:47:38.064 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:38.064 |     INFO |       log_parameters |   motion_costs_shape: (60, 54)
20:47:38.064 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:38.064 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:38.064 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:38.064 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:38.064 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:38.066 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:38.066 |     INFO |       log_parameters |   coords_shape: (60, 2)
20:47:38.066 |     INFO |       log_parameters |   uncertainties_shape: (60, 2)
20:47:38.066 |     INFO |       log_parameters |   mean_uncertainty: 0.3139705833333333
20:47:38.066 |     INFO |       log_parameters |   uncertainty_range: [0.20171, 0.358979]
20:47:38.066 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:38.066 |     INFO |       log_parameters |   coords_shape: (54, 2)
20:47:38.066 |     INFO |       log_parameters |   uncertainties_shape: (54, 2)
20:47:38.066 |     INFO |       log_parameters |   mean_uncertainty: 0.3123809351851853
20:47:38.066 |     INFO |       log_parameters |   uncertainty_range: [0.205372, 0.357481]
20:47:38.066 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:38.066 |     INFO |       log_parameters |   feature_costs_shape: (60, 54)
20:47:38.066 |     INFO |       log_parameters |   feature_costs_min: 1.0000739634063676
20:47:38.066 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:38.066 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:38.066 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:38.066 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:38.066 |     INFO |       log_parameters |   original_shape: (60, 54)
20:47:38.066 |     INFO |       log_parameters |   augmented_shape: (114, 114)
20:47:38.066 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:38.066 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:38.066 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:38.066 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:38.066 |    DEBUG |            log_debug |   observed_positions.shape: (54, 2)
20:47:38.066 |    DEBUG |            log_debug |   num_features (from observed_positions): 54
20:47:38.066 |    DEBUG |            log_debug |   predicted_positions.shape: (60, 2)
20:47:38.066 |    DEBUG |            log_debug |   predicted_velocities.shape: (60, 2)
20:47:38.066 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (54, 4)
20:47:38.066 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=54 but predicted_positions has 60 rows
20:47:38.066 |    ERROR |            log_error |   This will cause index 53 to fail when array only goes to 59
20:47:38.066 |    DEBUG |            log_debug | Kalman update: 54 features, state_dim=4, prob_dim=2
20:47:38.067 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman update):
20:47:38.067 |     INFO |       log_parameters |   features_updated: 54
20:47:38.067 |     INFO |       log_parameters |   state_dim: 4
20:47:38.067 |     INFO |       log_parameters |   dt_used: 1.0
20:47:38.067 |     INFO |       log_parameters |   process_noise_scale: 1.0
20:47:38.067 |     INFO |       log_parameters |   measurement_noise_scale: 1.0
20:47:38.067 |     INFO |             log_info | Enhanced linking completed successfully for frame 50
20:47:38.067 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0054 seconds
20:47:38.283 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=51, prob_dim=2, num_features_frame1=54, num_features_frame2=50)
20:47:38.283 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:38.283 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:38.283 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:38.283 |     INFO |       log_parameters |   current_frame: 51
20:47:38.283 |     INFO |       log_parameters |   prob_dim: 2
20:47:38.283 |     INFO |       log_parameters |   num_features_frame1: 54
20:47:38.283 |     INFO |       log_parameters |   num_features_frame2: 50
20:47:38.283 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:38.283 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:38.283 |     INFO |       log_parameters |   linear_motion: 1
20:47:38.283 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:38.283 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:38.283 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:38.283 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:38.283 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:38.283 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:38.283 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:38.283 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:38.283 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:38.283 |     INFO |       log_parameters |   use_local_density: 0
20:47:38.283 |     INFO |       log_parameters |   nn_window: 5
20:47:38.283 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:38.283 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:38.283 |     INFO |       log_parameters |   len_for_classify: 5
20:47:38.283 |     INFO |       log_parameters |   res_limit: 0.1
20:47:38.283 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:38.283 |     INFO |       log_parameters |   strategy_bd: -1
20:47:38.283 |     INFO |       log_parameters |   lft_cdf: None
20:47:38.283 |     INFO |       log_parameters |   kalman_init_param: None
20:47:38.283 |     INFO |       log_parameters |   diagnostics: None
20:47:38.283 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:38.283 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:38.283 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:38.283 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:38.283 |     INFO |       log_parameters |   coords_shape: (54, 2)
20:47:38.283 |     INFO |       log_parameters |   uncertainties_shape: (54, 2)
20:47:38.283 |     INFO |       log_parameters |   mean_uncertainty: 0.3123809351851853
20:47:38.283 |     INFO |       log_parameters |   uncertainty_range: [0.205372, 0.357481]
20:47:38.283 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:38.283 |     INFO |       log_parameters |   coords_shape: (50, 2)
20:47:38.283 |     INFO |       log_parameters |   uncertainties_shape: (50, 2)
20:47:38.283 |     INFO |       log_parameters |   mean_uncertainty: 0.30800732
20:47:38.283 |     INFO |       log_parameters |   uncertainty_range: [0.206898, 0.358335]
20:47:38.283 |    DEBUG |            log_debug | Initializing Kalman for 50 features, prob_dim=2, state_dim=4
20:47:38.284 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:38.284 |     INFO |       log_parameters |   num_features: 50
20:47:38.284 |     INFO |       log_parameters |   state_dim: 4
20:47:38.284 |     INFO |       log_parameters |   prob_dim: 2
20:47:38.284 |     INFO |       log_parameters |   state_vec_shape: (50, 4)
20:47:38.284 |     INFO |       log_parameters |   state_noise_var_shape: (50, 4, 4)
20:47:38.284 |    DEBUG |            log_debug | State vector shape: (54, 4), Expected: (54, 4)
20:47:38.284 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:38.284 |     INFO |       log_parameters |   num_features_predicted: 54
20:47:38.284 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:38.284 |     INFO |       log_parameters |   brownian_motion_features: 54
20:47:38.284 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:38.284 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:38.284 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:38.284 |     INFO |       log_parameters |   search_radii_shape: (54, 2)
20:47:38.284 |     INFO |       log_parameters |   min_radius: 0.1
20:47:38.284 |     INFO |       log_parameters |   max_radius: 0.1
20:47:38.284 |     INFO |       log_parameters |   mean_radius: 0.09999999999999999
20:47:38.284 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:38.284 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999999
20:47:38.285 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:38.285 |     INFO |       log_parameters |   distance_matrix_shape: (54, 50)
20:47:38.285 |     INFO |       log_parameters |   cost_matrix_shape: (54, 50)
20:47:38.285 |     INFO |       log_parameters |   finite_costs: 2700
20:47:38.285 |     INFO |       log_parameters |   infinite_costs: 0
20:47:38.285 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:38.285 |     INFO |       log_parameters |   min_distance: 14.427665248331936
20:47:38.285 |     INFO |       log_parameters |   max_distance: 133.6461690480092
20:47:38.285 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:38.285 |     INFO |       log_parameters |   motion_costs_shape: (54, 50)
20:47:38.285 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:38.285 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:38.285 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:38.285 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:38.285 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:38.286 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:38.286 |     INFO |       log_parameters |   coords_shape: (54, 2)
20:47:38.286 |     INFO |       log_parameters |   uncertainties_shape: (54, 2)
20:47:38.287 |     INFO |       log_parameters |   mean_uncertainty: 0.3123809351851853
20:47:38.287 |     INFO |       log_parameters |   uncertainty_range: [0.205372, 0.357481]
20:47:38.287 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:38.287 |     INFO |       log_parameters |   coords_shape: (50, 2)
20:47:38.287 |     INFO |       log_parameters |   uncertainties_shape: (50, 2)
20:47:38.287 |     INFO |       log_parameters |   mean_uncertainty: 0.30800732
20:47:38.287 |     INFO |       log_parameters |   uncertainty_range: [0.206898, 0.358335]
20:47:38.287 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:38.287 |     INFO |       log_parameters |   feature_costs_shape: (54, 50)
20:47:38.287 |     INFO |       log_parameters |   feature_costs_min: 1.0000477174122286
20:47:38.287 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:38.287 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:38.287 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:38.287 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:38.287 |     INFO |       log_parameters |   original_shape: (54, 50)
20:47:38.287 |     INFO |       log_parameters |   augmented_shape: (104, 104)
20:47:38.287 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:38.287 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:38.287 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:38.287 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:38.287 |    DEBUG |            log_debug |   observed_positions.shape: (50, 2)
20:47:38.287 |    DEBUG |            log_debug |   num_features (from observed_positions): 50
20:47:38.287 |    DEBUG |            log_debug |   predicted_positions.shape: (54, 2)
20:47:38.287 |    DEBUG |            log_debug |   predicted_velocities.shape: (54, 2)
20:47:38.287 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (50, 4)
20:47:38.287 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=50 but predicted_positions has 54 rows
20:47:38.287 |    ERROR |            log_error |   This will cause index 49 to fail when array only goes to 53
20:47:38.287 |    DEBUG |            log_debug | Kalman update: 50 features, state_dim=4, prob_dim=2
20:47:38.288 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman update):
20:47:38.288 |     INFO |       log_parameters |   features_updated: 50
20:47:38.288 |     INFO |       log_parameters |   state_dim: 4
20:47:38.288 |     INFO |       log_parameters |   dt_used: 1.0
20:47:38.288 |     INFO |       log_parameters |   process_noise_scale: 1.0
20:47:38.288 |     INFO |       log_parameters |   measurement_noise_scale: 1.0
20:47:38.288 |     INFO |             log_info | Enhanced linking completed successfully for frame 51
20:47:38.288 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0048 seconds
20:47:38.476 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=52, prob_dim=2, num_features_frame1=50, num_features_frame2=53)
20:47:38.476 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:38.476 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:38.476 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:38.476 |     INFO |       log_parameters |   current_frame: 52
20:47:38.476 |     INFO |       log_parameters |   prob_dim: 2
20:47:38.476 |     INFO |       log_parameters |   num_features_frame1: 50
20:47:38.476 |     INFO |       log_parameters |   num_features_frame2: 53
20:47:38.476 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:38.476 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:38.476 |     INFO |       log_parameters |   linear_motion: 1
20:47:38.476 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:38.476 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:38.476 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:38.476 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:38.476 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:38.476 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:38.476 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:38.476 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:38.476 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:38.476 |     INFO |       log_parameters |   use_local_density: 0
20:47:38.476 |     INFO |       log_parameters |   nn_window: 5
20:47:38.476 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:38.476 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:38.476 |     INFO |       log_parameters |   len_for_classify: 5
20:47:38.476 |     INFO |       log_parameters |   res_limit: 0.1
20:47:38.476 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:38.476 |     INFO |       log_parameters |   strategy_bd: -1
20:47:38.476 |     INFO |       log_parameters |   lft_cdf: None
20:47:38.476 |     INFO |       log_parameters |   kalman_init_param: None
20:47:38.476 |     INFO |       log_parameters |   diagnostics: None
20:47:38.476 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:38.476 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:38.476 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:38.476 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:38.476 |     INFO |       log_parameters |   coords_shape: (50, 2)
20:47:38.476 |     INFO |       log_parameters |   uncertainties_shape: (50, 2)
20:47:38.476 |     INFO |       log_parameters |   mean_uncertainty: 0.30800732
20:47:38.476 |     INFO |       log_parameters |   uncertainty_range: [0.206898, 0.358335]
20:47:38.476 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:38.476 |     INFO |       log_parameters |   coords_shape: (53, 2)
20:47:38.476 |     INFO |       log_parameters |   uncertainties_shape: (53, 2)
20:47:38.476 |     INFO |       log_parameters |   mean_uncertainty: 0.3099371509433962
20:47:38.476 |     INFO |       log_parameters |   uncertainty_range: [0.205342, 0.360492]
20:47:38.476 |    DEBUG |            log_debug | Initializing Kalman for 53 features, prob_dim=2, state_dim=4
20:47:38.476 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:38.476 |     INFO |       log_parameters |   num_features: 53
20:47:38.476 |     INFO |       log_parameters |   state_dim: 4
20:47:38.476 |     INFO |       log_parameters |   prob_dim: 2
20:47:38.476 |     INFO |       log_parameters |   state_vec_shape: (53, 4)
20:47:38.476 |     INFO |       log_parameters |   state_noise_var_shape: (53, 4, 4)
20:47:38.476 |    DEBUG |            log_debug | State vector shape: (50, 4), Expected: (50, 4)
20:47:38.477 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:38.477 |     INFO |       log_parameters |   num_features_predicted: 50
20:47:38.477 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:38.477 |     INFO |       log_parameters |   brownian_motion_features: 50
20:47:38.477 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:38.477 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:38.477 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:38.477 |     INFO |       log_parameters |   search_radii_shape: (50, 2)
20:47:38.477 |     INFO |       log_parameters |   min_radius: 0.1
20:47:38.477 |     INFO |       log_parameters |   max_radius: 0.1
20:47:38.477 |     INFO |       log_parameters |   mean_radius: 0.09999999999999998
20:47:38.477 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:38.477 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999998
20:47:38.477 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:38.477 |     INFO |       log_parameters |   distance_matrix_shape: (50, 53)
20:47:38.477 |     INFO |       log_parameters |   cost_matrix_shape: (50, 53)
20:47:38.477 |     INFO |       log_parameters |   finite_costs: 2650
20:47:38.477 |     INFO |       log_parameters |   infinite_costs: 0
20:47:38.477 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:38.477 |     INFO |       log_parameters |   min_distance: 18.938535663341373
20:47:38.477 |     INFO |       log_parameters |   max_distance: 126.33463315047052
20:47:38.477 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:38.478 |     INFO |       log_parameters |   motion_costs_shape: (50, 53)
20:47:38.478 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:38.478 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:38.478 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:38.478 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:38.478 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:38.479 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:38.479 |     INFO |       log_parameters |   coords_shape: (50, 2)
20:47:38.479 |     INFO |       log_parameters |   uncertainties_shape: (50, 2)
20:47:38.479 |     INFO |       log_parameters |   mean_uncertainty: 0.30800732
20:47:38.479 |     INFO |       log_parameters |   uncertainty_range: [0.206898, 0.358335]
20:47:38.479 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:38.479 |     INFO |       log_parameters |   coords_shape: (53, 2)
20:47:38.479 |     INFO |       log_parameters |   uncertainties_shape: (53, 2)
20:47:38.479 |     INFO |       log_parameters |   mean_uncertainty: 0.3099371509433962
20:47:38.479 |     INFO |       log_parameters |   uncertainty_range: [0.205342, 0.360492]
20:47:38.479 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:38.479 |     INFO |       log_parameters |   feature_costs_shape: (50, 53)
20:47:38.479 |     INFO |       log_parameters |   feature_costs_min: 1.0000589542360183
20:47:38.479 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:38.479 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:38.479 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:38.479 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:38.479 |     INFO |       log_parameters |   original_shape: (50, 53)
20:47:38.479 |     INFO |       log_parameters |   augmented_shape: (103, 103)
20:47:38.479 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:38.479 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:38.480 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:38.480 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:38.480 |    DEBUG |            log_debug |   observed_positions.shape: (53, 2)
20:47:38.480 |    DEBUG |            log_debug |   num_features (from observed_positions): 53
20:47:38.480 |    DEBUG |            log_debug |   predicted_positions.shape: (50, 2)
20:47:38.480 |    DEBUG |            log_debug |   predicted_velocities.shape: (50, 2)
20:47:38.480 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (53, 4)
20:47:38.480 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=53 but predicted_positions has 50 rows
20:47:38.480 |    ERROR |            log_error |   This will cause index 52 to fail when array only goes to 49
20:47:38.480 |    DEBUG |            log_debug | Kalman update: 53 features, state_dim=4, prob_dim=2
20:47:38.480 |    ERROR |            log_error | Error in enhanced linking: index 50 is out of bounds for axis 0 with size 50
20:47:38.480 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 50 is out of bounds for axis 0 with size 50
20:47:38.481 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0050 seconds
20:47:38.491 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=53, prob_dim=2, num_features_frame1=53, num_features_frame2=54)
20:47:38.491 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:38.491 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:38.491 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:38.491 |     INFO |       log_parameters |   current_frame: 53
20:47:38.491 |     INFO |       log_parameters |   prob_dim: 2
20:47:38.491 |     INFO |       log_parameters |   num_features_frame1: 53
20:47:38.491 |     INFO |       log_parameters |   num_features_frame2: 54
20:47:38.491 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:38.491 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:38.491 |     INFO |       log_parameters |   linear_motion: 1
20:47:38.491 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:38.491 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:38.491 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:38.491 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:38.491 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:38.491 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:38.491 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:38.491 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:38.491 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:38.491 |     INFO |       log_parameters |   use_local_density: 0
20:47:38.491 |     INFO |       log_parameters |   nn_window: 5
20:47:38.491 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:38.491 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:38.491 |     INFO |       log_parameters |   len_for_classify: 5
20:47:38.491 |     INFO |       log_parameters |   res_limit: 0.1
20:47:38.491 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:38.491 |     INFO |       log_parameters |   strategy_bd: -1
20:47:38.491 |     INFO |       log_parameters |   lft_cdf: None
20:47:38.491 |     INFO |       log_parameters |   kalman_init_param: None
20:47:38.491 |     INFO |       log_parameters |   diagnostics: None
20:47:38.491 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:38.491 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:38.491 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:38.491 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:38.491 |     INFO |       log_parameters |   coords_shape: (53, 2)
20:47:38.491 |     INFO |       log_parameters |   uncertainties_shape: (53, 2)
20:47:38.491 |     INFO |       log_parameters |   mean_uncertainty: 0.3099371509433962
20:47:38.491 |     INFO |       log_parameters |   uncertainty_range: [0.205342, 0.360492]
20:47:38.491 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:38.491 |     INFO |       log_parameters |   coords_shape: (54, 2)
20:47:38.491 |     INFO |       log_parameters |   uncertainties_shape: (54, 2)
20:47:38.491 |     INFO |       log_parameters |   mean_uncertainty: 0.3097231111111111
20:47:38.491 |     INFO |       log_parameters |   uncertainty_range: [0.204565, 0.354698]
20:47:38.491 |    DEBUG |            log_debug | Initializing Kalman for 54 features, prob_dim=2, state_dim=4
20:47:38.491 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:38.491 |     INFO |       log_parameters |   num_features: 54
20:47:38.491 |     INFO |       log_parameters |   state_dim: 4
20:47:38.491 |     INFO |       log_parameters |   prob_dim: 2
20:47:38.491 |     INFO |       log_parameters |   state_vec_shape: (54, 4)
20:47:38.491 |     INFO |       log_parameters |   state_noise_var_shape: (54, 4, 4)
20:47:38.491 |    DEBUG |            log_debug | State vector shape: (53, 4), Expected: (53, 4)
20:47:38.492 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:38.492 |     INFO |       log_parameters |   num_features_predicted: 53
20:47:38.492 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:38.492 |     INFO |       log_parameters |   brownian_motion_features: 53
20:47:38.492 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:38.492 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:38.492 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:38.492 |     INFO |       log_parameters |   search_radii_shape: (53, 2)
20:47:38.492 |     INFO |       log_parameters |   min_radius: 0.1
20:47:38.492 |     INFO |       log_parameters |   max_radius: 0.1
20:47:38.492 |     INFO |       log_parameters |   mean_radius: 0.09999999999999999
20:47:38.492 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:38.492 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999999
20:47:38.492 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:38.492 |     INFO |       log_parameters |   distance_matrix_shape: (53, 54)
20:47:38.492 |     INFO |       log_parameters |   cost_matrix_shape: (53, 54)
20:47:38.492 |     INFO |       log_parameters |   finite_costs: 2862
20:47:38.492 |     INFO |       log_parameters |   infinite_costs: 0
20:47:38.492 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:38.492 |     INFO |       log_parameters |   min_distance: 20.648752481337002
20:47:38.492 |     INFO |       log_parameters |   max_distance: 126.36718244264698
20:47:38.492 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:38.492 |     INFO |       log_parameters |   motion_costs_shape: (53, 54)
20:47:38.492 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:38.492 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:38.492 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:38.493 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:38.493 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:38.494 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:38.494 |     INFO |       log_parameters |   coords_shape: (53, 2)
20:47:38.494 |     INFO |       log_parameters |   uncertainties_shape: (53, 2)
20:47:38.494 |     INFO |       log_parameters |   mean_uncertainty: 0.3099371509433962
20:47:38.494 |     INFO |       log_parameters |   uncertainty_range: [0.205342, 0.360492]
20:47:38.494 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:38.494 |     INFO |       log_parameters |   coords_shape: (54, 2)
20:47:38.494 |     INFO |       log_parameters |   uncertainties_shape: (54, 2)
20:47:38.494 |     INFO |       log_parameters |   mean_uncertainty: 0.3097231111111111
20:47:38.494 |     INFO |       log_parameters |   uncertainty_range: [0.204565, 0.354698]
20:47:38.494 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:38.494 |     INFO |       log_parameters |   feature_costs_shape: (53, 54)
20:47:38.494 |     INFO |       log_parameters |   feature_costs_min: 1.0000493810309519
20:47:38.495 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:38.495 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:38.495 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:38.495 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:38.495 |     INFO |       log_parameters |   original_shape: (53, 54)
20:47:38.495 |     INFO |       log_parameters |   augmented_shape: (107, 107)
20:47:38.495 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:38.495 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:38.495 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:38.495 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:38.495 |    DEBUG |            log_debug |   observed_positions.shape: (54, 2)
20:47:38.495 |    DEBUG |            log_debug |   num_features (from observed_positions): 54
20:47:38.495 |    DEBUG |            log_debug |   predicted_positions.shape: (53, 2)
20:47:38.495 |    DEBUG |            log_debug |   predicted_velocities.shape: (53, 2)
20:47:38.495 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (54, 4)
20:47:38.495 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=54 but predicted_positions has 53 rows
20:47:38.495 |    ERROR |            log_error |   This will cause index 53 to fail when array only goes to 52
20:47:38.495 |    DEBUG |            log_debug | Kalman update: 54 features, state_dim=4, prob_dim=2
20:47:38.496 |    ERROR |            log_error | Error in enhanced linking: index 53 is out of bounds for axis 0 with size 53
20:47:38.496 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 53 is out of bounds for axis 0 with size 53
20:47:38.496 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0051 seconds
20:47:38.506 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=54, prob_dim=2, num_features_frame1=54, num_features_frame2=55)
20:47:38.506 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:38.506 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:38.506 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:38.506 |     INFO |       log_parameters |   current_frame: 54
20:47:38.506 |     INFO |       log_parameters |   prob_dim: 2
20:47:38.506 |     INFO |       log_parameters |   num_features_frame1: 54
20:47:38.506 |     INFO |       log_parameters |   num_features_frame2: 55
20:47:38.506 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:38.506 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:38.506 |     INFO |       log_parameters |   linear_motion: 1
20:47:38.506 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:38.506 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:38.506 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:38.506 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:38.506 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:38.506 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:38.506 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:38.506 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:38.506 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:38.506 |     INFO |       log_parameters |   use_local_density: 0
20:47:38.506 |     INFO |       log_parameters |   nn_window: 5
20:47:38.506 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:38.506 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:38.506 |     INFO |       log_parameters |   len_for_classify: 5
20:47:38.506 |     INFO |       log_parameters |   res_limit: 0.1
20:47:38.506 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:38.506 |     INFO |       log_parameters |   strategy_bd: -1
20:47:38.506 |     INFO |       log_parameters |   lft_cdf: None
20:47:38.506 |     INFO |       log_parameters |   kalman_init_param: None
20:47:38.506 |     INFO |       log_parameters |   diagnostics: None
20:47:38.506 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:38.506 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:38.506 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:38.506 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:38.506 |     INFO |       log_parameters |   coords_shape: (54, 2)
20:47:38.506 |     INFO |       log_parameters |   uncertainties_shape: (54, 2)
20:47:38.506 |     INFO |       log_parameters |   mean_uncertainty: 0.3097231111111111
20:47:38.506 |     INFO |       log_parameters |   uncertainty_range: [0.204565, 0.354698]
20:47:38.506 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:38.506 |     INFO |       log_parameters |   coords_shape: (55, 2)
20:47:38.506 |     INFO |       log_parameters |   uncertainties_shape: (55, 2)
20:47:38.506 |     INFO |       log_parameters |   mean_uncertainty: 0.31275882727272725
20:47:38.506 |     INFO |       log_parameters |   uncertainty_range: [0.200251, 0.353834]
20:47:38.506 |    DEBUG |            log_debug | Initializing Kalman for 55 features, prob_dim=2, state_dim=4
20:47:38.506 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:38.506 |     INFO |       log_parameters |   num_features: 55
20:47:38.506 |     INFO |       log_parameters |   state_dim: 4
20:47:38.506 |     INFO |       log_parameters |   prob_dim: 2
20:47:38.506 |     INFO |       log_parameters |   state_vec_shape: (55, 4)
20:47:38.506 |     INFO |       log_parameters |   state_noise_var_shape: (55, 4, 4)
20:47:38.506 |    DEBUG |            log_debug | State vector shape: (54, 4), Expected: (54, 4)
20:47:38.507 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:38.507 |     INFO |       log_parameters |   num_features_predicted: 54
20:47:38.507 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:38.507 |     INFO |       log_parameters |   brownian_motion_features: 54
20:47:38.507 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:38.507 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:38.507 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:38.507 |     INFO |       log_parameters |   search_radii_shape: (54, 2)
20:47:38.507 |     INFO |       log_parameters |   min_radius: 0.1
20:47:38.507 |     INFO |       log_parameters |   max_radius: 0.1
20:47:38.507 |     INFO |       log_parameters |   mean_radius: 0.09999999999999999
20:47:38.507 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:38.507 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999999
20:47:38.508 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:38.508 |     INFO |       log_parameters |   distance_matrix_shape: (54, 55)
20:47:38.508 |     INFO |       log_parameters |   cost_matrix_shape: (54, 55)
20:47:38.508 |     INFO |       log_parameters |   finite_costs: 2970
20:47:38.508 |     INFO |       log_parameters |   infinite_costs: 0
20:47:38.508 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:38.508 |     INFO |       log_parameters |   min_distance: 3.2005047414845365
20:47:38.508 |     INFO |       log_parameters |   max_distance: 133.4086354173603
20:47:38.508 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:38.508 |     INFO |       log_parameters |   motion_costs_shape: (54, 55)
20:47:38.508 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:38.508 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:38.508 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:38.508 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:38.508 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:38.510 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:38.510 |     INFO |       log_parameters |   coords_shape: (54, 2)
20:47:38.510 |     INFO |       log_parameters |   uncertainties_shape: (54, 2)
20:47:38.510 |     INFO |       log_parameters |   mean_uncertainty: 0.3097231111111111
20:47:38.510 |     INFO |       log_parameters |   uncertainty_range: [0.204565, 0.354698]
20:47:38.510 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:38.510 |     INFO |       log_parameters |   coords_shape: (55, 2)
20:47:38.510 |     INFO |       log_parameters |   uncertainties_shape: (55, 2)
20:47:38.510 |     INFO |       log_parameters |   mean_uncertainty: 0.31275882727272725
20:47:38.510 |     INFO |       log_parameters |   uncertainty_range: [0.200251, 0.353834]
20:47:38.510 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:38.510 |     INFO |       log_parameters |   feature_costs_shape: (54, 55)
20:47:38.510 |     INFO |       log_parameters |   feature_costs_min: 1.0000567003466951
20:47:38.510 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:38.510 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:38.510 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:38.510 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:38.510 |     INFO |       log_parameters |   original_shape: (54, 55)
20:47:38.510 |     INFO |       log_parameters |   augmented_shape: (109, 109)
20:47:38.510 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:38.510 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:38.510 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:38.510 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:38.510 |    DEBUG |            log_debug |   observed_positions.shape: (55, 2)
20:47:38.510 |    DEBUG |            log_debug |   num_features (from observed_positions): 55
20:47:38.510 |    DEBUG |            log_debug |   predicted_positions.shape: (54, 2)
20:47:38.510 |    DEBUG |            log_debug |   predicted_velocities.shape: (54, 2)
20:47:38.510 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (55, 4)
20:47:38.510 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=55 but predicted_positions has 54 rows
20:47:38.510 |    ERROR |            log_error |   This will cause index 54 to fail when array only goes to 53
20:47:38.510 |    DEBUG |            log_debug | Kalman update: 55 features, state_dim=4, prob_dim=2
20:47:38.511 |    ERROR |            log_error | Error in enhanced linking: index 54 is out of bounds for axis 0 with size 54
20:47:38.511 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 54 is out of bounds for axis 0 with size 54
20:47:38.511 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0053 seconds
20:47:38.521 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=55, prob_dim=2, num_features_frame1=55, num_features_frame2=57)
20:47:38.521 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:38.521 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:38.521 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:38.521 |     INFO |       log_parameters |   current_frame: 55
20:47:38.522 |     INFO |       log_parameters |   prob_dim: 2
20:47:38.522 |     INFO |       log_parameters |   num_features_frame1: 55
20:47:38.522 |     INFO |       log_parameters |   num_features_frame2: 57
20:47:38.522 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:38.522 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:38.522 |     INFO |       log_parameters |   linear_motion: 1
20:47:38.522 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:38.522 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:38.522 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:38.522 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:38.522 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:38.522 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:38.522 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:38.522 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:38.522 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:38.522 |     INFO |       log_parameters |   use_local_density: 0
20:47:38.522 |     INFO |       log_parameters |   nn_window: 5
20:47:38.522 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:38.522 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:38.522 |     INFO |       log_parameters |   len_for_classify: 5
20:47:38.522 |     INFO |       log_parameters |   res_limit: 0.1
20:47:38.522 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:38.522 |     INFO |       log_parameters |   strategy_bd: -1
20:47:38.522 |     INFO |       log_parameters |   lft_cdf: None
20:47:38.522 |     INFO |       log_parameters |   kalman_init_param: None
20:47:38.522 |     INFO |       log_parameters |   diagnostics: None
20:47:38.522 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:38.522 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:38.522 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:38.522 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:38.522 |     INFO |       log_parameters |   coords_shape: (55, 2)
20:47:38.522 |     INFO |       log_parameters |   uncertainties_shape: (55, 2)
20:47:38.522 |     INFO |       log_parameters |   mean_uncertainty: 0.31275882727272725
20:47:38.522 |     INFO |       log_parameters |   uncertainty_range: [0.200251, 0.353834]
20:47:38.522 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:38.522 |     INFO |       log_parameters |   coords_shape: (57, 2)
20:47:38.522 |     INFO |       log_parameters |   uncertainties_shape: (57, 2)
20:47:38.522 |     INFO |       log_parameters |   mean_uncertainty: 0.3156309385964912
20:47:38.522 |     INFO |       log_parameters |   uncertainty_range: [0.202601, 0.357544]
20:47:38.522 |    DEBUG |            log_debug | Initializing Kalman for 57 features, prob_dim=2, state_dim=4
20:47:38.522 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:38.522 |     INFO |       log_parameters |   num_features: 57
20:47:38.522 |     INFO |       log_parameters |   state_dim: 4
20:47:38.522 |     INFO |       log_parameters |   prob_dim: 2
20:47:38.522 |     INFO |       log_parameters |   state_vec_shape: (57, 4)
20:47:38.522 |     INFO |       log_parameters |   state_noise_var_shape: (57, 4, 4)
20:47:38.522 |    DEBUG |            log_debug | State vector shape: (55, 4), Expected: (55, 4)
20:47:38.522 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:38.522 |     INFO |       log_parameters |   num_features_predicted: 55
20:47:38.522 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:38.522 |     INFO |       log_parameters |   brownian_motion_features: 55
20:47:38.523 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:38.523 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:38.523 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:38.523 |     INFO |       log_parameters |   search_radii_shape: (55, 2)
20:47:38.523 |     INFO |       log_parameters |   min_radius: 0.1
20:47:38.523 |     INFO |       log_parameters |   max_radius: 0.1
20:47:38.523 |     INFO |       log_parameters |   mean_radius: 0.09999999999999998
20:47:38.523 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:38.523 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999998
20:47:38.523 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:38.523 |     INFO |       log_parameters |   distance_matrix_shape: (55, 57)
20:47:38.523 |     INFO |       log_parameters |   cost_matrix_shape: (55, 57)
20:47:38.523 |     INFO |       log_parameters |   finite_costs: 3135
20:47:38.523 |     INFO |       log_parameters |   infinite_costs: 0
20:47:38.523 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:38.523 |     INFO |       log_parameters |   min_distance: 3.0286672122519502
20:47:38.523 |     INFO |       log_parameters |   max_distance: 132.61096134785024
20:47:38.523 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:38.523 |     INFO |       log_parameters |   motion_costs_shape: (55, 57)
20:47:38.523 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:38.523 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:38.523 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:38.523 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:38.523 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:38.525 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:38.525 |     INFO |       log_parameters |   coords_shape: (55, 2)
20:47:38.525 |     INFO |       log_parameters |   uncertainties_shape: (55, 2)
20:47:38.525 |     INFO |       log_parameters |   mean_uncertainty: 0.31275882727272725
20:47:38.525 |     INFO |       log_parameters |   uncertainty_range: [0.200251, 0.353834]
20:47:38.525 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:38.525 |     INFO |       log_parameters |   coords_shape: (57, 2)
20:47:38.525 |     INFO |       log_parameters |   uncertainties_shape: (57, 2)
20:47:38.525 |     INFO |       log_parameters |   mean_uncertainty: 0.3156309385964912
20:47:38.525 |     INFO |       log_parameters |   uncertainty_range: [0.202601, 0.357544]
20:47:38.526 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:38.526 |     INFO |       log_parameters |   feature_costs_shape: (55, 57)
20:47:38.526 |     INFO |       log_parameters |   feature_costs_min: 1.000010117514768
20:47:38.526 |     INFO |       log_parameters |   feature_costs_max: 5.0
20:47:38.526 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:38.526 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:38.526 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:38.526 |     INFO |       log_parameters |   original_shape: (55, 57)
20:47:38.526 |     INFO |       log_parameters |   augmented_shape: (112, 112)
20:47:38.526 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:38.526 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:38.526 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:38.526 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:38.526 |    DEBUG |            log_debug |   observed_positions.shape: (57, 2)
20:47:38.526 |    DEBUG |            log_debug |   num_features (from observed_positions): 57
20:47:38.526 |    DEBUG |            log_debug |   predicted_positions.shape: (55, 2)
20:47:38.526 |    DEBUG |            log_debug |   predicted_velocities.shape: (55, 2)
20:47:38.526 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (57, 4)
20:47:38.526 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=57 but predicted_positions has 55 rows
20:47:38.526 |    ERROR |            log_error |   This will cause index 56 to fail when array only goes to 54
20:47:38.526 |    DEBUG |            log_debug | Kalman update: 57 features, state_dim=4, prob_dim=2
20:47:38.527 |    ERROR |            log_error | Error in enhanced linking: index 55 is out of bounds for axis 0 with size 55
20:47:38.527 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 55 is out of bounds for axis 0 with size 55
20:47:38.527 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0055 seconds
20:47:38.537 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=56, prob_dim=2, num_features_frame1=57, num_features_frame2=52)
20:47:38.537 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:38.537 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:38.537 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:38.537 |     INFO |       log_parameters |   current_frame: 56
20:47:38.537 |     INFO |       log_parameters |   prob_dim: 2
20:47:38.537 |     INFO |       log_parameters |   num_features_frame1: 57
20:47:38.537 |     INFO |       log_parameters |   num_features_frame2: 52
20:47:38.537 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:38.537 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:38.537 |     INFO |       log_parameters |   linear_motion: 1
20:47:38.537 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:38.537 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:38.537 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:38.537 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:38.537 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:38.537 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:38.537 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:38.537 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:38.537 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:38.537 |     INFO |       log_parameters |   use_local_density: 0
20:47:38.537 |     INFO |       log_parameters |   nn_window: 5
20:47:38.537 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:38.537 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:38.537 |     INFO |       log_parameters |   len_for_classify: 5
20:47:38.537 |     INFO |       log_parameters |   res_limit: 0.1
20:47:38.537 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:38.537 |     INFO |       log_parameters |   strategy_bd: -1
20:47:38.537 |     INFO |       log_parameters |   lft_cdf: None
20:47:38.537 |     INFO |       log_parameters |   kalman_init_param: None
20:47:38.537 |     INFO |       log_parameters |   diagnostics: None
20:47:38.537 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:38.537 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:38.537 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:38.537 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:38.537 |     INFO |       log_parameters |   coords_shape: (57, 2)
20:47:38.537 |     INFO |       log_parameters |   uncertainties_shape: (57, 2)
20:47:38.537 |     INFO |       log_parameters |   mean_uncertainty: 0.3156309385964912
20:47:38.538 |     INFO |       log_parameters |   uncertainty_range: [0.202601, 0.357544]
20:47:38.538 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:38.538 |     INFO |       log_parameters |   coords_shape: (52, 2)
20:47:38.538 |     INFO |       log_parameters |   uncertainties_shape: (52, 2)
20:47:38.538 |     INFO |       log_parameters |   mean_uncertainty: 0.31285625961538466
20:47:38.538 |     INFO |       log_parameters |   uncertainty_range: [0.200596, 0.356743]
20:47:38.538 |    DEBUG |            log_debug | Initializing Kalman for 52 features, prob_dim=2, state_dim=4
20:47:38.538 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:38.538 |     INFO |       log_parameters |   num_features: 52
20:47:38.538 |     INFO |       log_parameters |   state_dim: 4
20:47:38.538 |     INFO |       log_parameters |   prob_dim: 2
20:47:38.538 |     INFO |       log_parameters |   state_vec_shape: (52, 4)
20:47:38.538 |     INFO |       log_parameters |   state_noise_var_shape: (52, 4, 4)
20:47:38.538 |    DEBUG |            log_debug | State vector shape: (57, 4), Expected: (57, 4)
20:47:38.538 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:38.538 |     INFO |       log_parameters |   num_features_predicted: 57
20:47:38.538 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:38.538 |     INFO |       log_parameters |   brownian_motion_features: 57
20:47:38.538 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:38.538 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:38.538 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:38.538 |     INFO |       log_parameters |   search_radii_shape: (57, 2)
20:47:38.538 |     INFO |       log_parameters |   min_radius: 0.1
20:47:38.538 |     INFO |       log_parameters |   max_radius: 0.1
20:47:38.538 |     INFO |       log_parameters |   mean_radius: 0.1
20:47:38.538 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:38.538 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.1
20:47:38.539 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:38.539 |     INFO |       log_parameters |   distance_matrix_shape: (57, 52)
20:47:38.539 |     INFO |       log_parameters |   cost_matrix_shape: (57, 52)
20:47:38.539 |     INFO |       log_parameters |   finite_costs: 2964
20:47:38.539 |     INFO |       log_parameters |   infinite_costs: 0
20:47:38.539 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:38.539 |     INFO |       log_parameters |   min_distance: 5.577950786219703
20:47:38.539 |     INFO |       log_parameters |   max_distance: 128.7846066283002
20:47:38.539 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:38.539 |     INFO |       log_parameters |   motion_costs_shape: (57, 52)
20:47:38.539 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:38.539 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:38.539 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:38.539 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:38.539 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:38.541 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:38.541 |     INFO |       log_parameters |   coords_shape: (57, 2)
20:47:38.541 |     INFO |       log_parameters |   uncertainties_shape: (57, 2)
20:47:38.541 |     INFO |       log_parameters |   mean_uncertainty: 0.3156309385964912
20:47:38.541 |     INFO |       log_parameters |   uncertainty_range: [0.202601, 0.357544]
20:47:38.541 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:38.541 |     INFO |       log_parameters |   coords_shape: (52, 2)
20:47:38.541 |     INFO |       log_parameters |   uncertainties_shape: (52, 2)
20:47:38.541 |     INFO |       log_parameters |   mean_uncertainty: 0.31285625961538466
20:47:38.541 |     INFO |       log_parameters |   uncertainty_range: [0.200596, 0.356743]
20:47:38.541 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:38.541 |     INFO |       log_parameters |   feature_costs_shape: (57, 52)
20:47:38.541 |     INFO |       log_parameters |   feature_costs_min: 1.0000622974796372
20:47:38.541 |     INFO |       log_parameters |   feature_costs_max: 5.0
20:47:38.541 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:38.541 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:38.541 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:38.541 |     INFO |       log_parameters |   original_shape: (57, 52)
20:47:38.541 |     INFO |       log_parameters |   augmented_shape: (109, 109)
20:47:38.541 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:38.541 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:38.541 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:38.541 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:38.541 |    DEBUG |            log_debug |   observed_positions.shape: (52, 2)
20:47:38.541 |    DEBUG |            log_debug |   num_features (from observed_positions): 52
20:47:38.541 |    DEBUG |            log_debug |   predicted_positions.shape: (57, 2)
20:47:38.541 |    DEBUG |            log_debug |   predicted_velocities.shape: (57, 2)
20:47:38.541 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (52, 4)
20:47:38.541 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=52 but predicted_positions has 57 rows
20:47:38.541 |    ERROR |            log_error |   This will cause index 51 to fail when array only goes to 56
20:47:38.541 |    DEBUG |            log_debug | Kalman update: 52 features, state_dim=4, prob_dim=2
20:47:38.542 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman update):
20:47:38.542 |     INFO |       log_parameters |   features_updated: 52
20:47:38.542 |     INFO |       log_parameters |   state_dim: 4
20:47:38.542 |     INFO |       log_parameters |   dt_used: 1.0
20:47:38.542 |     INFO |       log_parameters |   process_noise_scale: 1.0
20:47:38.542 |     INFO |       log_parameters |   measurement_noise_scale: 1.0
20:47:38.542 |     INFO |             log_info | Enhanced linking completed successfully for frame 56
20:47:38.542 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0052 seconds
20:47:38.744 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=57, prob_dim=2, num_features_frame1=52, num_features_frame2=47)
20:47:38.744 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:38.744 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:38.744 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:38.744 |     INFO |       log_parameters |   current_frame: 57
20:47:38.744 |     INFO |       log_parameters |   prob_dim: 2
20:47:38.744 |     INFO |       log_parameters |   num_features_frame1: 52
20:47:38.744 |     INFO |       log_parameters |   num_features_frame2: 47
20:47:38.745 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:38.745 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:38.745 |     INFO |       log_parameters |   linear_motion: 1
20:47:38.745 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:38.745 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:38.745 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:38.745 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:38.745 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:38.745 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:38.745 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:38.745 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:38.745 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:38.745 |     INFO |       log_parameters |   use_local_density: 0
20:47:38.745 |     INFO |       log_parameters |   nn_window: 5
20:47:38.745 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:38.745 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:38.745 |     INFO |       log_parameters |   len_for_classify: 5
20:47:38.745 |     INFO |       log_parameters |   res_limit: 0.1
20:47:38.745 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:38.745 |     INFO |       log_parameters |   strategy_bd: -1
20:47:38.745 |     INFO |       log_parameters |   lft_cdf: None
20:47:38.745 |     INFO |       log_parameters |   kalman_init_param: None
20:47:38.745 |     INFO |       log_parameters |   diagnostics: None
20:47:38.745 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:38.745 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:38.745 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:38.745 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:38.745 |     INFO |       log_parameters |   coords_shape: (52, 2)
20:47:38.745 |     INFO |       log_parameters |   uncertainties_shape: (52, 2)
20:47:38.745 |     INFO |       log_parameters |   mean_uncertainty: 0.31285625961538466
20:47:38.745 |     INFO |       log_parameters |   uncertainty_range: [0.200596, 0.356743]
20:47:38.745 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:38.745 |     INFO |       log_parameters |   coords_shape: (47, 2)
20:47:38.745 |     INFO |       log_parameters |   uncertainties_shape: (47, 2)
20:47:38.745 |     INFO |       log_parameters |   mean_uncertainty: 0.3126275744680851
20:47:38.745 |     INFO |       log_parameters |   uncertainty_range: [0.188624, 0.354435]
20:47:38.745 |    DEBUG |            log_debug | Initializing Kalman for 47 features, prob_dim=2, state_dim=4
20:47:38.745 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:38.745 |     INFO |       log_parameters |   num_features: 47
20:47:38.745 |     INFO |       log_parameters |   state_dim: 4
20:47:38.745 |     INFO |       log_parameters |   prob_dim: 2
20:47:38.745 |     INFO |       log_parameters |   state_vec_shape: (47, 4)
20:47:38.745 |     INFO |       log_parameters |   state_noise_var_shape: (47, 4, 4)
20:47:38.745 |    DEBUG |            log_debug | State vector shape: (52, 4), Expected: (52, 4)
20:47:38.745 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:38.745 |     INFO |       log_parameters |   num_features_predicted: 52
20:47:38.745 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:38.745 |     INFO |       log_parameters |   brownian_motion_features: 52
20:47:38.745 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:38.745 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:38.746 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:38.746 |     INFO |       log_parameters |   search_radii_shape: (52, 2)
20:47:38.746 |     INFO |       log_parameters |   min_radius: 0.1
20:47:38.746 |     INFO |       log_parameters |   max_radius: 0.1
20:47:38.746 |     INFO |       log_parameters |   mean_radius: 0.1
20:47:38.746 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:38.746 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.1
20:47:38.746 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:38.746 |     INFO |       log_parameters |   distance_matrix_shape: (52, 47)
20:47:38.746 |     INFO |       log_parameters |   cost_matrix_shape: (52, 47)
20:47:38.746 |     INFO |       log_parameters |   finite_costs: 2444
20:47:38.746 |     INFO |       log_parameters |   infinite_costs: 0
20:47:38.746 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:38.746 |     INFO |       log_parameters |   min_distance: 20.64096696934618
20:47:38.746 |     INFO |       log_parameters |   max_distance: 128.67723479816993
20:47:38.746 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:38.746 |     INFO |       log_parameters |   motion_costs_shape: (52, 47)
20:47:38.746 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:38.746 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:38.746 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:38.746 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:38.746 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:38.748 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:38.748 |     INFO |       log_parameters |   coords_shape: (52, 2)
20:47:38.748 |     INFO |       log_parameters |   uncertainties_shape: (52, 2)
20:47:38.748 |     INFO |       log_parameters |   mean_uncertainty: 0.31285625961538466
20:47:38.748 |     INFO |       log_parameters |   uncertainty_range: [0.200596, 0.356743]
20:47:38.748 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:38.748 |     INFO |       log_parameters |   coords_shape: (47, 2)
20:47:38.748 |     INFO |       log_parameters |   uncertainties_shape: (47, 2)
20:47:38.748 |     INFO |       log_parameters |   mean_uncertainty: 0.3126275744680851
20:47:38.748 |     INFO |       log_parameters |   uncertainty_range: [0.188624, 0.354435]
20:47:38.748 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:38.748 |     INFO |       log_parameters |   feature_costs_shape: (52, 47)
20:47:38.748 |     INFO |       log_parameters |   feature_costs_min: 1.0000338434961604
20:47:38.748 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:38.748 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:38.748 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:38.748 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:38.748 |     INFO |       log_parameters |   original_shape: (52, 47)
20:47:38.748 |     INFO |       log_parameters |   augmented_shape: (99, 99)
20:47:38.748 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:38.748 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:38.748 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:38.748 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:38.748 |    DEBUG |            log_debug |   observed_positions.shape: (47, 2)
20:47:38.748 |    DEBUG |            log_debug |   num_features (from observed_positions): 47
20:47:38.748 |    DEBUG |            log_debug |   predicted_positions.shape: (52, 2)
20:47:38.748 |    DEBUG |            log_debug |   predicted_velocities.shape: (52, 2)
20:47:38.748 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (47, 4)
20:47:38.748 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=47 but predicted_positions has 52 rows
20:47:38.748 |    ERROR |            log_error |   This will cause index 46 to fail when array only goes to 51
20:47:38.748 |    DEBUG |            log_debug | Kalman update: 47 features, state_dim=4, prob_dim=2
20:47:38.749 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman update):
20:47:38.749 |     INFO |       log_parameters |   features_updated: 47
20:47:38.749 |     INFO |       log_parameters |   state_dim: 4
20:47:38.749 |     INFO |       log_parameters |   dt_used: 1.0
20:47:38.749 |     INFO |       log_parameters |   process_noise_scale: 1.0
20:47:38.749 |     INFO |       log_parameters |   measurement_noise_scale: 1.0
20:47:38.749 |     INFO |             log_info | Enhanced linking completed successfully for frame 57
20:47:38.749 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0046 seconds
20:47:38.919 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=58, prob_dim=2, num_features_frame1=47, num_features_frame2=55)
20:47:38.919 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:38.919 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:38.919 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:38.919 |     INFO |       log_parameters |   current_frame: 58
20:47:38.919 |     INFO |       log_parameters |   prob_dim: 2
20:47:38.919 |     INFO |       log_parameters |   num_features_frame1: 47
20:47:38.919 |     INFO |       log_parameters |   num_features_frame2: 55
20:47:38.919 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:38.919 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:38.919 |     INFO |       log_parameters |   linear_motion: 1
20:47:38.919 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:38.919 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:38.919 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:38.919 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:38.919 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:38.919 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:38.919 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:38.919 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:38.919 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:38.919 |     INFO |       log_parameters |   use_local_density: 0
20:47:38.919 |     INFO |       log_parameters |   nn_window: 5
20:47:38.919 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:38.919 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:38.919 |     INFO |       log_parameters |   len_for_classify: 5
20:47:38.920 |     INFO |       log_parameters |   res_limit: 0.1
20:47:38.920 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:38.920 |     INFO |       log_parameters |   strategy_bd: -1
20:47:38.920 |     INFO |       log_parameters |   lft_cdf: None
20:47:38.920 |     INFO |       log_parameters |   kalman_init_param: None
20:47:38.920 |     INFO |       log_parameters |   diagnostics: None
20:47:38.920 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:38.920 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:38.920 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:38.920 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:38.920 |     INFO |       log_parameters |   coords_shape: (47, 2)
20:47:38.920 |     INFO |       log_parameters |   uncertainties_shape: (47, 2)
20:47:38.920 |     INFO |       log_parameters |   mean_uncertainty: 0.3126275744680851
20:47:38.920 |     INFO |       log_parameters |   uncertainty_range: [0.188624, 0.354435]
20:47:38.920 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:38.920 |     INFO |       log_parameters |   coords_shape: (55, 2)
20:47:38.920 |     INFO |       log_parameters |   uncertainties_shape: (55, 2)
20:47:38.920 |     INFO |       log_parameters |   mean_uncertainty: 0.3172404272727273
20:47:38.920 |     INFO |       log_parameters |   uncertainty_range: [0.187916, 0.359965]
20:47:38.920 |    DEBUG |            log_debug | Initializing Kalman for 55 features, prob_dim=2, state_dim=4
20:47:38.920 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:38.920 |     INFO |       log_parameters |   num_features: 55
20:47:38.920 |     INFO |       log_parameters |   state_dim: 4
20:47:38.920 |     INFO |       log_parameters |   prob_dim: 2
20:47:38.920 |     INFO |       log_parameters |   state_vec_shape: (55, 4)
20:47:38.920 |     INFO |       log_parameters |   state_noise_var_shape: (55, 4, 4)
20:47:38.920 |    DEBUG |            log_debug | State vector shape: (47, 4), Expected: (47, 4)
20:47:38.920 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:38.920 |     INFO |       log_parameters |   num_features_predicted: 47
20:47:38.920 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:38.920 |     INFO |       log_parameters |   brownian_motion_features: 47
20:47:38.920 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:38.920 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:38.920 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:38.920 |     INFO |       log_parameters |   search_radii_shape: (47, 2)
20:47:38.920 |     INFO |       log_parameters |   min_radius: 0.1
20:47:38.920 |     INFO |       log_parameters |   max_radius: 0.1
20:47:38.920 |     INFO |       log_parameters |   mean_radius: 0.09999999999999996
20:47:38.920 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:38.920 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999996
20:47:38.921 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:38.921 |     INFO |       log_parameters |   distance_matrix_shape: (47, 55)
20:47:38.921 |     INFO |       log_parameters |   cost_matrix_shape: (47, 55)
20:47:38.921 |     INFO |       log_parameters |   finite_costs: 2585
20:47:38.921 |     INFO |       log_parameters |   infinite_costs: 0
20:47:38.921 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:38.921 |     INFO |       log_parameters |   min_distance: 17.67576631767217
20:47:38.921 |     INFO |       log_parameters |   max_distance: 126.45339432675704
20:47:38.921 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:38.921 |     INFO |       log_parameters |   motion_costs_shape: (47, 55)
20:47:38.921 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:38.921 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:38.921 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:38.921 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:38.921 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:38.923 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:38.923 |     INFO |       log_parameters |   coords_shape: (47, 2)
20:47:38.923 |     INFO |       log_parameters |   uncertainties_shape: (47, 2)
20:47:38.923 |     INFO |       log_parameters |   mean_uncertainty: 0.3126275744680851
20:47:38.923 |     INFO |       log_parameters |   uncertainty_range: [0.188624, 0.354435]
20:47:38.923 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:38.923 |     INFO |       log_parameters |   coords_shape: (55, 2)
20:47:38.923 |     INFO |       log_parameters |   uncertainties_shape: (55, 2)
20:47:38.923 |     INFO |       log_parameters |   mean_uncertainty: 0.3172404272727273
20:47:38.923 |     INFO |       log_parameters |   uncertainty_range: [0.187916, 0.359965]
20:47:38.923 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:38.923 |     INFO |       log_parameters |   feature_costs_shape: (47, 55)
20:47:38.923 |     INFO |       log_parameters |   feature_costs_min: 1.0001732979156703
20:47:38.923 |     INFO |       log_parameters |   feature_costs_max: 5.0
20:47:38.923 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:38.923 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:38.923 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:38.923 |     INFO |       log_parameters |   original_shape: (47, 55)
20:47:38.923 |     INFO |       log_parameters |   augmented_shape: (102, 102)
20:47:38.923 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:38.923 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:38.923 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:38.923 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:38.923 |    DEBUG |            log_debug |   observed_positions.shape: (55, 2)
20:47:38.923 |    DEBUG |            log_debug |   num_features (from observed_positions): 55
20:47:38.923 |    DEBUG |            log_debug |   predicted_positions.shape: (47, 2)
20:47:38.923 |    DEBUG |            log_debug |   predicted_velocities.shape: (47, 2)
20:47:38.923 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (55, 4)
20:47:38.923 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=55 but predicted_positions has 47 rows
20:47:38.923 |    ERROR |            log_error |   This will cause index 54 to fail when array only goes to 46
20:47:38.923 |    DEBUG |            log_debug | Kalman update: 55 features, state_dim=4, prob_dim=2
20:47:38.924 |    ERROR |            log_error | Error in enhanced linking: index 47 is out of bounds for axis 0 with size 47
20:47:38.924 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 47 is out of bounds for axis 0 with size 47
20:47:38.924 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0049 seconds
20:47:38.934 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=59, prob_dim=2, num_features_frame1=55, num_features_frame2=51)
20:47:38.934 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:38.934 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:38.934 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:38.934 |     INFO |       log_parameters |   current_frame: 59
20:47:38.934 |     INFO |       log_parameters |   prob_dim: 2
20:47:38.934 |     INFO |       log_parameters |   num_features_frame1: 55
20:47:38.934 |     INFO |       log_parameters |   num_features_frame2: 51
20:47:38.934 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:38.934 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:38.934 |     INFO |       log_parameters |   linear_motion: 1
20:47:38.934 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:38.934 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:38.934 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:38.934 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:38.934 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:38.934 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:38.934 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:38.934 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:38.934 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:38.934 |     INFO |       log_parameters |   use_local_density: 0
20:47:38.934 |     INFO |       log_parameters |   nn_window: 5
20:47:38.934 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:38.934 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:38.934 |     INFO |       log_parameters |   len_for_classify: 5
20:47:38.934 |     INFO |       log_parameters |   res_limit: 0.1
20:47:38.934 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:38.934 |     INFO |       log_parameters |   strategy_bd: -1
20:47:38.934 |     INFO |       log_parameters |   lft_cdf: None
20:47:38.934 |     INFO |       log_parameters |   kalman_init_param: None
20:47:38.934 |     INFO |       log_parameters |   diagnostics: None
20:47:38.934 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:38.934 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:38.934 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:38.934 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:38.934 |     INFO |       log_parameters |   coords_shape: (55, 2)
20:47:38.934 |     INFO |       log_parameters |   uncertainties_shape: (55, 2)
20:47:38.934 |     INFO |       log_parameters |   mean_uncertainty: 0.3172404272727273
20:47:38.934 |     INFO |       log_parameters |   uncertainty_range: [0.187916, 0.359965]
20:47:38.934 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:38.934 |     INFO |       log_parameters |   coords_shape: (51, 2)
20:47:38.934 |     INFO |       log_parameters |   uncertainties_shape: (51, 2)
20:47:38.934 |     INFO |       log_parameters |   mean_uncertainty: 0.31138550000000004
20:47:38.934 |     INFO |       log_parameters |   uncertainty_range: [0.195765, 0.35205]
20:47:38.934 |    DEBUG |            log_debug | Initializing Kalman for 51 features, prob_dim=2, state_dim=4
20:47:38.935 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:38.935 |     INFO |       log_parameters |   num_features: 51
20:47:38.935 |     INFO |       log_parameters |   state_dim: 4
20:47:38.935 |     INFO |       log_parameters |   prob_dim: 2
20:47:38.935 |     INFO |       log_parameters |   state_vec_shape: (51, 4)
20:47:38.935 |     INFO |       log_parameters |   state_noise_var_shape: (51, 4, 4)
20:47:38.935 |    DEBUG |            log_debug | State vector shape: (55, 4), Expected: (55, 4)
20:47:38.935 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:38.935 |     INFO |       log_parameters |   num_features_predicted: 55
20:47:38.935 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:38.935 |     INFO |       log_parameters |   brownian_motion_features: 55
20:47:38.935 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:38.935 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:38.935 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:38.935 |     INFO |       log_parameters |   search_radii_shape: (55, 2)
20:47:38.935 |     INFO |       log_parameters |   min_radius: 0.1
20:47:38.935 |     INFO |       log_parameters |   max_radius: 0.1
20:47:38.935 |     INFO |       log_parameters |   mean_radius: 0.09999999999999998
20:47:38.935 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:38.935 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999998
20:47:38.936 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:38.936 |     INFO |       log_parameters |   distance_matrix_shape: (55, 51)
20:47:38.936 |     INFO |       log_parameters |   cost_matrix_shape: (55, 51)
20:47:38.936 |     INFO |       log_parameters |   finite_costs: 2805
20:47:38.936 |     INFO |       log_parameters |   infinite_costs: 0
20:47:38.936 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:38.936 |     INFO |       log_parameters |   min_distance: 20.710422197210587
20:47:38.936 |     INFO |       log_parameters |   max_distance: 126.50146846627374
20:47:38.936 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:38.936 |     INFO |       log_parameters |   motion_costs_shape: (55, 51)
20:47:38.936 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:38.936 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:38.936 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:38.936 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:38.936 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:38.938 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:38.938 |     INFO |       log_parameters |   coords_shape: (55, 2)
20:47:38.938 |     INFO |       log_parameters |   uncertainties_shape: (55, 2)
20:47:38.938 |     INFO |       log_parameters |   mean_uncertainty: 0.3172404272727273
20:47:38.938 |     INFO |       log_parameters |   uncertainty_range: [0.187916, 0.359965]
20:47:38.938 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:38.938 |     INFO |       log_parameters |   coords_shape: (51, 2)
20:47:38.938 |     INFO |       log_parameters |   uncertainties_shape: (51, 2)
20:47:38.938 |     INFO |       log_parameters |   mean_uncertainty: 0.31138550000000004
20:47:38.938 |     INFO |       log_parameters |   uncertainty_range: [0.195765, 0.35205]
20:47:38.938 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:38.938 |     INFO |       log_parameters |   feature_costs_shape: (55, 51)
20:47:38.938 |     INFO |       log_parameters |   feature_costs_min: 1.0000284775227917
20:47:38.938 |     INFO |       log_parameters |   feature_costs_max: 5.0
20:47:38.938 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:38.938 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:38.938 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:38.938 |     INFO |       log_parameters |   original_shape: (55, 51)
20:47:38.938 |     INFO |       log_parameters |   augmented_shape: (106, 106)
20:47:38.938 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:38.938 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:38.938 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:38.938 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:38.938 |    DEBUG |            log_debug |   observed_positions.shape: (51, 2)
20:47:38.938 |    DEBUG |            log_debug |   num_features (from observed_positions): 51
20:47:38.938 |    DEBUG |            log_debug |   predicted_positions.shape: (55, 2)
20:47:38.938 |    DEBUG |            log_debug |   predicted_velocities.shape: (55, 2)
20:47:38.938 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (51, 4)
20:47:38.938 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=51 but predicted_positions has 55 rows
20:47:38.938 |    ERROR |            log_error |   This will cause index 50 to fail when array only goes to 54
20:47:38.938 |    DEBUG |            log_debug | Kalman update: 51 features, state_dim=4, prob_dim=2
20:47:38.939 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman update):
20:47:38.939 |     INFO |       log_parameters |   features_updated: 51
20:47:38.939 |     INFO |       log_parameters |   state_dim: 4
20:47:38.939 |     INFO |       log_parameters |   dt_used: 1.0
20:47:38.939 |     INFO |       log_parameters |   process_noise_scale: 1.0
20:47:38.939 |     INFO |       log_parameters |   measurement_noise_scale: 1.0
20:47:38.939 |     INFO |             log_info | Enhanced linking completed successfully for frame 59
20:47:38.939 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0049 seconds
20:47:39.134 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=60, prob_dim=2, num_features_frame1=51, num_features_frame2=53)
20:47:39.134 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:39.134 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:39.134 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:39.134 |     INFO |       log_parameters |   current_frame: 60
20:47:39.134 |     INFO |       log_parameters |   prob_dim: 2
20:47:39.134 |     INFO |       log_parameters |   num_features_frame1: 51
20:47:39.134 |     INFO |       log_parameters |   num_features_frame2: 53
20:47:39.134 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:39.134 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:39.134 |     INFO |       log_parameters |   linear_motion: 1
20:47:39.134 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:39.134 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:39.134 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:39.134 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:39.134 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:39.135 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:39.135 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:39.135 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:39.135 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:39.135 |     INFO |       log_parameters |   use_local_density: 0
20:47:39.135 |     INFO |       log_parameters |   nn_window: 5
20:47:39.135 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:39.135 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:39.135 |     INFO |       log_parameters |   len_for_classify: 5
20:47:39.135 |     INFO |       log_parameters |   res_limit: 0.1
20:47:39.135 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:39.135 |     INFO |       log_parameters |   strategy_bd: -1
20:47:39.135 |     INFO |       log_parameters |   lft_cdf: None
20:47:39.135 |     INFO |       log_parameters |   kalman_init_param: None
20:47:39.135 |     INFO |       log_parameters |   diagnostics: None
20:47:39.135 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:39.135 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:39.135 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:39.135 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:39.135 |     INFO |       log_parameters |   coords_shape: (51, 2)
20:47:39.135 |     INFO |       log_parameters |   uncertainties_shape: (51, 2)
20:47:39.135 |     INFO |       log_parameters |   mean_uncertainty: 0.31138550000000004
20:47:39.135 |     INFO |       log_parameters |   uncertainty_range: [0.195765, 0.35205]
20:47:39.135 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:39.135 |     INFO |       log_parameters |   coords_shape: (53, 2)
20:47:39.135 |     INFO |       log_parameters |   uncertainties_shape: (53, 2)
20:47:39.135 |     INFO |       log_parameters |   mean_uncertainty: 0.3111234339622641
20:47:39.135 |     INFO |       log_parameters |   uncertainty_range: [0.196345, 0.356932]
20:47:39.135 |    DEBUG |            log_debug | Initializing Kalman for 53 features, prob_dim=2, state_dim=4
20:47:39.135 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:39.135 |     INFO |       log_parameters |   num_features: 53
20:47:39.135 |     INFO |       log_parameters |   state_dim: 4
20:47:39.135 |     INFO |       log_parameters |   prob_dim: 2
20:47:39.135 |     INFO |       log_parameters |   state_vec_shape: (53, 4)
20:47:39.135 |     INFO |       log_parameters |   state_noise_var_shape: (53, 4, 4)
20:47:39.135 |    DEBUG |            log_debug | State vector shape: (51, 4), Expected: (51, 4)
20:47:39.135 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:39.135 |     INFO |       log_parameters |   num_features_predicted: 51
20:47:39.135 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:39.135 |     INFO |       log_parameters |   brownian_motion_features: 51
20:47:39.135 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:39.135 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:39.136 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:39.136 |     INFO |       log_parameters |   search_radii_shape: (51, 2)
20:47:39.136 |     INFO |       log_parameters |   min_radius: 0.1
20:47:39.136 |     INFO |       log_parameters |   max_radius: 0.1
20:47:39.136 |     INFO |       log_parameters |   mean_radius: 0.09999999999999998
20:47:39.136 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:39.136 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999998
20:47:39.136 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:39.136 |     INFO |       log_parameters |   distance_matrix_shape: (51, 53)
20:47:39.136 |     INFO |       log_parameters |   cost_matrix_shape: (51, 53)
20:47:39.136 |     INFO |       log_parameters |   finite_costs: 2703
20:47:39.136 |     INFO |       log_parameters |   infinite_costs: 0
20:47:39.136 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:39.136 |     INFO |       log_parameters |   min_distance: 12.989546192680676
20:47:39.136 |     INFO |       log_parameters |   max_distance: 126.4292458917121
20:47:39.136 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:39.136 |     INFO |       log_parameters |   motion_costs_shape: (51, 53)
20:47:39.136 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:39.136 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:39.136 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:39.136 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:39.136 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:39.138 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:39.138 |     INFO |       log_parameters |   coords_shape: (51, 2)
20:47:39.138 |     INFO |       log_parameters |   uncertainties_shape: (51, 2)
20:47:39.138 |     INFO |       log_parameters |   mean_uncertainty: 0.31138550000000004
20:47:39.138 |     INFO |       log_parameters |   uncertainty_range: [0.195765, 0.35205]
20:47:39.138 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:39.138 |     INFO |       log_parameters |   coords_shape: (53, 2)
20:47:39.138 |     INFO |       log_parameters |   uncertainties_shape: (53, 2)
20:47:39.138 |     INFO |       log_parameters |   mean_uncertainty: 0.3111234339622641
20:47:39.138 |     INFO |       log_parameters |   uncertainty_range: [0.196345, 0.356932]
20:47:39.138 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:39.138 |     INFO |       log_parameters |   feature_costs_shape: (51, 53)
20:47:39.138 |     INFO |       log_parameters |   feature_costs_min: 1.000003056239153
20:47:39.138 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:39.138 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:39.138 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:39.138 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:39.138 |     INFO |       log_parameters |   original_shape: (51, 53)
20:47:39.138 |     INFO |       log_parameters |   augmented_shape: (104, 104)
20:47:39.138 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:39.138 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:39.138 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:39.138 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:39.138 |    DEBUG |            log_debug |   observed_positions.shape: (53, 2)
20:47:39.138 |    DEBUG |            log_debug |   num_features (from observed_positions): 53
20:47:39.138 |    DEBUG |            log_debug |   predicted_positions.shape: (51, 2)
20:47:39.138 |    DEBUG |            log_debug |   predicted_velocities.shape: (51, 2)
20:47:39.138 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (53, 4)
20:47:39.138 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=53 but predicted_positions has 51 rows
20:47:39.138 |    ERROR |            log_error |   This will cause index 52 to fail when array only goes to 50
20:47:39.138 |    DEBUG |            log_debug | Kalman update: 53 features, state_dim=4, prob_dim=2
20:47:39.139 |    ERROR |            log_error | Error in enhanced linking: index 51 is out of bounds for axis 0 with size 51
20:47:39.139 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 51 is out of bounds for axis 0 with size 51
20:47:39.139 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0050 seconds
20:47:39.149 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=61, prob_dim=2, num_features_frame1=53, num_features_frame2=52)
20:47:39.149 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:39.149 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:39.149 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:39.149 |     INFO |       log_parameters |   current_frame: 61
20:47:39.149 |     INFO |       log_parameters |   prob_dim: 2
20:47:39.149 |     INFO |       log_parameters |   num_features_frame1: 53
20:47:39.149 |     INFO |       log_parameters |   num_features_frame2: 52
20:47:39.149 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:39.149 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:39.149 |     INFO |       log_parameters |   linear_motion: 1
20:47:39.149 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:39.149 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:39.149 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:39.149 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:39.149 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:39.150 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:39.150 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:39.150 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:39.150 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:39.150 |     INFO |       log_parameters |   use_local_density: 0
20:47:39.150 |     INFO |       log_parameters |   nn_window: 5
20:47:39.150 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:39.150 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:39.150 |     INFO |       log_parameters |   len_for_classify: 5
20:47:39.150 |     INFO |       log_parameters |   res_limit: 0.1
20:47:39.150 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:39.150 |     INFO |       log_parameters |   strategy_bd: -1
20:47:39.150 |     INFO |       log_parameters |   lft_cdf: None
20:47:39.150 |     INFO |       log_parameters |   kalman_init_param: None
20:47:39.150 |     INFO |       log_parameters |   diagnostics: None
20:47:39.150 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:39.150 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:39.150 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:39.150 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:39.150 |     INFO |       log_parameters |   coords_shape: (53, 2)
20:47:39.150 |     INFO |       log_parameters |   uncertainties_shape: (53, 2)
20:47:39.150 |     INFO |       log_parameters |   mean_uncertainty: 0.3111234339622641
20:47:39.150 |     INFO |       log_parameters |   uncertainty_range: [0.196345, 0.356932]
20:47:39.150 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:39.150 |     INFO |       log_parameters |   coords_shape: (52, 2)
20:47:39.150 |     INFO |       log_parameters |   uncertainties_shape: (52, 2)
20:47:39.150 |     INFO |       log_parameters |   mean_uncertainty: 0.3117899711538461
20:47:39.150 |     INFO |       log_parameters |   uncertainty_range: [0.191388, 0.357659]
20:47:39.150 |    DEBUG |            log_debug | Initializing Kalman for 52 features, prob_dim=2, state_dim=4
20:47:39.150 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:39.150 |     INFO |       log_parameters |   num_features: 52
20:47:39.150 |     INFO |       log_parameters |   state_dim: 4
20:47:39.150 |     INFO |       log_parameters |   prob_dim: 2
20:47:39.150 |     INFO |       log_parameters |   state_vec_shape: (52, 4)
20:47:39.150 |     INFO |       log_parameters |   state_noise_var_shape: (52, 4, 4)
20:47:39.150 |    DEBUG |            log_debug | State vector shape: (53, 4), Expected: (53, 4)
20:47:39.150 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:39.150 |     INFO |       log_parameters |   num_features_predicted: 53
20:47:39.150 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:39.150 |     INFO |       log_parameters |   brownian_motion_features: 53
20:47:39.150 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:39.150 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:39.151 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:39.151 |     INFO |       log_parameters |   search_radii_shape: (53, 2)
20:47:39.151 |     INFO |       log_parameters |   min_radius: 0.1
20:47:39.151 |     INFO |       log_parameters |   max_radius: 0.1
20:47:39.151 |     INFO |       log_parameters |   mean_radius: 0.09999999999999999
20:47:39.151 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:39.151 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999999
20:47:39.151 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:39.151 |     INFO |       log_parameters |   distance_matrix_shape: (53, 52)
20:47:39.151 |     INFO |       log_parameters |   cost_matrix_shape: (53, 52)
20:47:39.151 |     INFO |       log_parameters |   finite_costs: 2756
20:47:39.151 |     INFO |       log_parameters |   infinite_costs: 0
20:47:39.151 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:39.151 |     INFO |       log_parameters |   min_distance: 5.954647720538638
20:47:39.151 |     INFO |       log_parameters |   max_distance: 128.95202007665367
20:47:39.151 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:39.151 |     INFO |       log_parameters |   motion_costs_shape: (53, 52)
20:47:39.151 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:39.151 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:39.151 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:39.151 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:39.151 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:39.153 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:39.153 |     INFO |       log_parameters |   coords_shape: (53, 2)
20:47:39.153 |     INFO |       log_parameters |   uncertainties_shape: (53, 2)
20:47:39.153 |     INFO |       log_parameters |   mean_uncertainty: 0.3111234339622641
20:47:39.153 |     INFO |       log_parameters |   uncertainty_range: [0.196345, 0.356932]
20:47:39.153 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:39.153 |     INFO |       log_parameters |   coords_shape: (52, 2)
20:47:39.153 |     INFO |       log_parameters |   uncertainties_shape: (52, 2)
20:47:39.153 |     INFO |       log_parameters |   mean_uncertainty: 0.3117899711538461
20:47:39.153 |     INFO |       log_parameters |   uncertainty_range: [0.191388, 0.357659]
20:47:39.153 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:39.153 |     INFO |       log_parameters |   feature_costs_shape: (53, 52)
20:47:39.153 |     INFO |       log_parameters |   feature_costs_min: 1.0000998966067833
20:47:39.153 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:39.153 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:39.153 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:39.153 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:39.153 |     INFO |       log_parameters |   original_shape: (53, 52)
20:47:39.153 |     INFO |       log_parameters |   augmented_shape: (105, 105)
20:47:39.153 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:39.153 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:39.153 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:39.153 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:39.153 |    DEBUG |            log_debug |   observed_positions.shape: (52, 2)
20:47:39.153 |    DEBUG |            log_debug |   num_features (from observed_positions): 52
20:47:39.153 |    DEBUG |            log_debug |   predicted_positions.shape: (53, 2)
20:47:39.153 |    DEBUG |            log_debug |   predicted_velocities.shape: (53, 2)
20:47:39.153 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (52, 4)
20:47:39.153 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=52 but predicted_positions has 53 rows
20:47:39.153 |    ERROR |            log_error |   This will cause index 51 to fail when array only goes to 52
20:47:39.153 |    DEBUG |            log_debug | Kalman update: 52 features, state_dim=4, prob_dim=2
20:47:39.154 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman update):
20:47:39.154 |     INFO |       log_parameters |   features_updated: 52
20:47:39.154 |     INFO |       log_parameters |   state_dim: 4
20:47:39.154 |     INFO |       log_parameters |   dt_used: 1.0
20:47:39.154 |     INFO |       log_parameters |   process_noise_scale: 1.0
20:47:39.154 |     INFO |       log_parameters |   measurement_noise_scale: 1.0
20:47:39.154 |     INFO |             log_info | Enhanced linking completed successfully for frame 61
20:47:39.154 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0050 seconds
20:47:39.349 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=62, prob_dim=2, num_features_frame1=52, num_features_frame2=56)
20:47:39.349 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:39.349 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:39.350 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:39.350 |     INFO |       log_parameters |   current_frame: 62
20:47:39.350 |     INFO |       log_parameters |   prob_dim: 2
20:47:39.350 |     INFO |       log_parameters |   num_features_frame1: 52
20:47:39.350 |     INFO |       log_parameters |   num_features_frame2: 56
20:47:39.350 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:39.350 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:39.350 |     INFO |       log_parameters |   linear_motion: 1
20:47:39.350 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:39.350 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:39.350 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:39.350 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:39.350 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:39.350 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:39.350 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:39.350 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:39.350 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:39.350 |     INFO |       log_parameters |   use_local_density: 0
20:47:39.350 |     INFO |       log_parameters |   nn_window: 5
20:47:39.350 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:39.350 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:39.350 |     INFO |       log_parameters |   len_for_classify: 5
20:47:39.350 |     INFO |       log_parameters |   res_limit: 0.1
20:47:39.350 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:39.350 |     INFO |       log_parameters |   strategy_bd: -1
20:47:39.350 |     INFO |       log_parameters |   lft_cdf: None
20:47:39.350 |     INFO |       log_parameters |   kalman_init_param: None
20:47:39.350 |     INFO |       log_parameters |   diagnostics: None
20:47:39.350 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:39.350 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:39.350 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:39.350 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:39.350 |     INFO |       log_parameters |   coords_shape: (52, 2)
20:47:39.350 |     INFO |       log_parameters |   uncertainties_shape: (52, 2)
20:47:39.350 |     INFO |       log_parameters |   mean_uncertainty: 0.3117899711538461
20:47:39.350 |     INFO |       log_parameters |   uncertainty_range: [0.191388, 0.357659]
20:47:39.350 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:39.350 |     INFO |       log_parameters |   coords_shape: (56, 2)
20:47:39.350 |     INFO |       log_parameters |   uncertainties_shape: (56, 2)
20:47:39.350 |     INFO |       log_parameters |   mean_uncertainty: 0.31183889285714284
20:47:39.350 |     INFO |       log_parameters |   uncertainty_range: [0.195961, 0.353745]
20:47:39.350 |    DEBUG |            log_debug | Initializing Kalman for 56 features, prob_dim=2, state_dim=4
20:47:39.350 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:39.350 |     INFO |       log_parameters |   num_features: 56
20:47:39.350 |     INFO |       log_parameters |   state_dim: 4
20:47:39.350 |     INFO |       log_parameters |   prob_dim: 2
20:47:39.350 |     INFO |       log_parameters |   state_vec_shape: (56, 4)
20:47:39.350 |     INFO |       log_parameters |   state_noise_var_shape: (56, 4, 4)
20:47:39.350 |    DEBUG |            log_debug | State vector shape: (52, 4), Expected: (52, 4)
20:47:39.350 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:39.350 |     INFO |       log_parameters |   num_features_predicted: 52
20:47:39.350 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:39.350 |     INFO |       log_parameters |   brownian_motion_features: 52
20:47:39.350 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:39.351 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:39.351 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:39.351 |     INFO |       log_parameters |   search_radii_shape: (52, 2)
20:47:39.351 |     INFO |       log_parameters |   min_radius: 0.1
20:47:39.351 |     INFO |       log_parameters |   max_radius: 0.1
20:47:39.351 |     INFO |       log_parameters |   mean_radius: 0.1
20:47:39.351 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:39.351 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.1
20:47:39.351 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:39.351 |     INFO |       log_parameters |   distance_matrix_shape: (52, 56)
20:47:39.351 |     INFO |       log_parameters |   cost_matrix_shape: (52, 56)
20:47:39.351 |     INFO |       log_parameters |   finite_costs: 2912
20:47:39.351 |     INFO |       log_parameters |   infinite_costs: 0
20:47:39.351 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:39.351 |     INFO |       log_parameters |   min_distance: 7.580016521969132
20:47:39.351 |     INFO |       log_parameters |   max_distance: 128.88905038261376
20:47:39.351 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:39.351 |     INFO |       log_parameters |   motion_costs_shape: (52, 56)
20:47:39.351 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:39.351 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:39.351 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:39.351 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:39.351 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:39.353 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:39.353 |     INFO |       log_parameters |   coords_shape: (52, 2)
20:47:39.353 |     INFO |       log_parameters |   uncertainties_shape: (52, 2)
20:47:39.353 |     INFO |       log_parameters |   mean_uncertainty: 0.3117899711538461
20:47:39.353 |     INFO |       log_parameters |   uncertainty_range: [0.191388, 0.357659]
20:47:39.353 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:39.353 |     INFO |       log_parameters |   coords_shape: (56, 2)
20:47:39.353 |     INFO |       log_parameters |   uncertainties_shape: (56, 2)
20:47:39.353 |     INFO |       log_parameters |   mean_uncertainty: 0.31183889285714284
20:47:39.353 |     INFO |       log_parameters |   uncertainty_range: [0.195961, 0.353745]
20:47:39.353 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:39.353 |     INFO |       log_parameters |   feature_costs_shape: (52, 56)
20:47:39.353 |     INFO |       log_parameters |   feature_costs_min: 1.0002735248780739
20:47:39.354 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:39.354 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:39.354 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:39.354 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:39.354 |     INFO |       log_parameters |   original_shape: (52, 56)
20:47:39.354 |     INFO |       log_parameters |   augmented_shape: (108, 108)
20:47:39.354 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:39.354 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:39.354 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:39.354 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:39.354 |    DEBUG |            log_debug |   observed_positions.shape: (56, 2)
20:47:39.354 |    DEBUG |            log_debug |   num_features (from observed_positions): 56
20:47:39.354 |    DEBUG |            log_debug |   predicted_positions.shape: (52, 2)
20:47:39.354 |    DEBUG |            log_debug |   predicted_velocities.shape: (52, 2)
20:47:39.354 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (56, 4)
20:47:39.354 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=56 but predicted_positions has 52 rows
20:47:39.354 |    ERROR |            log_error |   This will cause index 55 to fail when array only goes to 51
20:47:39.354 |    DEBUG |            log_debug | Kalman update: 56 features, state_dim=4, prob_dim=2
20:47:39.355 |    ERROR |            log_error | Error in enhanced linking: index 52 is out of bounds for axis 0 with size 52
20:47:39.355 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 52 is out of bounds for axis 0 with size 52
20:47:39.355 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0052 seconds
20:47:39.365 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=63, prob_dim=2, num_features_frame1=56, num_features_frame2=57)
20:47:39.365 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:39.365 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:39.365 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:39.365 |     INFO |       log_parameters |   current_frame: 63
20:47:39.365 |     INFO |       log_parameters |   prob_dim: 2
20:47:39.365 |     INFO |       log_parameters |   num_features_frame1: 56
20:47:39.365 |     INFO |       log_parameters |   num_features_frame2: 57
20:47:39.365 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:39.365 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:39.365 |     INFO |       log_parameters |   linear_motion: 1
20:47:39.365 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:39.365 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:39.365 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:39.365 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:39.365 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:39.365 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:39.365 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:39.365 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:39.365 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:39.365 |     INFO |       log_parameters |   use_local_density: 0
20:47:39.365 |     INFO |       log_parameters |   nn_window: 5
20:47:39.365 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:39.365 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:39.365 |     INFO |       log_parameters |   len_for_classify: 5
20:47:39.365 |     INFO |       log_parameters |   res_limit: 0.1
20:47:39.365 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:39.365 |     INFO |       log_parameters |   strategy_bd: -1
20:47:39.365 |     INFO |       log_parameters |   lft_cdf: None
20:47:39.365 |     INFO |       log_parameters |   kalman_init_param: None
20:47:39.365 |     INFO |       log_parameters |   diagnostics: None
20:47:39.365 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:39.365 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:39.365 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:39.365 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:39.365 |     INFO |       log_parameters |   coords_shape: (56, 2)
20:47:39.365 |     INFO |       log_parameters |   uncertainties_shape: (56, 2)
20:47:39.365 |     INFO |       log_parameters |   mean_uncertainty: 0.31183889285714284
20:47:39.365 |     INFO |       log_parameters |   uncertainty_range: [0.195961, 0.353745]
20:47:39.366 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:39.366 |     INFO |       log_parameters |   coords_shape: (57, 2)
20:47:39.366 |     INFO |       log_parameters |   uncertainties_shape: (57, 2)
20:47:39.366 |     INFO |       log_parameters |   mean_uncertainty: 0.3120010614035088
20:47:39.366 |     INFO |       log_parameters |   uncertainty_range: [0.195561, 0.359842]
20:47:39.366 |    DEBUG |            log_debug | Initializing Kalman for 57 features, prob_dim=2, state_dim=4
20:47:39.366 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:39.366 |     INFO |       log_parameters |   num_features: 57
20:47:39.366 |     INFO |       log_parameters |   state_dim: 4
20:47:39.366 |     INFO |       log_parameters |   prob_dim: 2
20:47:39.366 |     INFO |       log_parameters |   state_vec_shape: (57, 4)
20:47:39.366 |     INFO |       log_parameters |   state_noise_var_shape: (57, 4, 4)
20:47:39.366 |    DEBUG |            log_debug | State vector shape: (56, 4), Expected: (56, 4)
20:47:39.366 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:39.366 |     INFO |       log_parameters |   num_features_predicted: 56
20:47:39.366 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:39.366 |     INFO |       log_parameters |   brownian_motion_features: 56
20:47:39.366 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:39.366 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:39.366 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:39.366 |     INFO |       log_parameters |   search_radii_shape: (56, 2)
20:47:39.366 |     INFO |       log_parameters |   min_radius: 0.1
20:47:39.366 |     INFO |       log_parameters |   max_radius: 0.1
20:47:39.366 |     INFO |       log_parameters |   mean_radius: 0.1
20:47:39.366 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:39.366 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.1
20:47:39.367 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:39.367 |     INFO |       log_parameters |   distance_matrix_shape: (56, 57)
20:47:39.367 |     INFO |       log_parameters |   cost_matrix_shape: (56, 57)
20:47:39.367 |     INFO |       log_parameters |   finite_costs: 3192
20:47:39.367 |     INFO |       log_parameters |   infinite_costs: 0
20:47:39.367 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:39.367 |     INFO |       log_parameters |   min_distance: 7.48808802978878
20:47:39.367 |     INFO |       log_parameters |   max_distance: 126.49591975064715
20:47:39.367 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:39.367 |     INFO |       log_parameters |   motion_costs_shape: (56, 57)
20:47:39.367 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:39.367 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:39.367 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:39.367 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:39.367 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:39.369 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:39.369 |     INFO |       log_parameters |   coords_shape: (56, 2)
20:47:39.369 |     INFO |       log_parameters |   uncertainties_shape: (56, 2)
20:47:39.369 |     INFO |       log_parameters |   mean_uncertainty: 0.31183889285714284
20:47:39.369 |     INFO |       log_parameters |   uncertainty_range: [0.195961, 0.353745]
20:47:39.369 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:39.369 |     INFO |       log_parameters |   coords_shape: (57, 2)
20:47:39.369 |     INFO |       log_parameters |   uncertainties_shape: (57, 2)
20:47:39.369 |     INFO |       log_parameters |   mean_uncertainty: 0.3120010614035088
20:47:39.369 |     INFO |       log_parameters |   uncertainty_range: [0.195561, 0.359842]
20:47:39.369 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:39.369 |     INFO |       log_parameters |   feature_costs_shape: (56, 57)
20:47:39.369 |     INFO |       log_parameters |   feature_costs_min: 1.0001457793479267
20:47:39.369 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:39.369 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:39.369 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:39.369 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:39.369 |     INFO |       log_parameters |   original_shape: (56, 57)
20:47:39.369 |     INFO |       log_parameters |   augmented_shape: (113, 113)
20:47:39.369 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:39.369 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:39.369 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:39.369 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:39.369 |    DEBUG |            log_debug |   observed_positions.shape: (57, 2)
20:47:39.369 |    DEBUG |            log_debug |   num_features (from observed_positions): 57
20:47:39.369 |    DEBUG |            log_debug |   predicted_positions.shape: (56, 2)
20:47:39.370 |    DEBUG |            log_debug |   predicted_velocities.shape: (56, 2)
20:47:39.370 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (57, 4)
20:47:39.370 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=57 but predicted_positions has 56 rows
20:47:39.370 |    ERROR |            log_error |   This will cause index 56 to fail when array only goes to 55
20:47:39.370 |    DEBUG |            log_debug | Kalman update: 57 features, state_dim=4, prob_dim=2
20:47:39.371 |    ERROR |            log_error | Error in enhanced linking: index 56 is out of bounds for axis 0 with size 56
20:47:39.371 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 56 is out of bounds for axis 0 with size 56
20:47:39.371 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0055 seconds
20:47:39.381 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=64, prob_dim=2, num_features_frame1=57, num_features_frame2=58)
20:47:39.381 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:39.381 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:39.381 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:39.381 |     INFO |       log_parameters |   current_frame: 64
20:47:39.381 |     INFO |       log_parameters |   prob_dim: 2
20:47:39.381 |     INFO |       log_parameters |   num_features_frame1: 57
20:47:39.381 |     INFO |       log_parameters |   num_features_frame2: 58
20:47:39.381 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:39.381 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:39.381 |     INFO |       log_parameters |   linear_motion: 1
20:47:39.381 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:39.381 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:39.381 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:39.381 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:39.381 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:39.381 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:39.381 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:39.381 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:39.381 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:39.381 |     INFO |       log_parameters |   use_local_density: 0
20:47:39.381 |     INFO |       log_parameters |   nn_window: 5
20:47:39.381 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:39.381 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:39.381 |     INFO |       log_parameters |   len_for_classify: 5
20:47:39.381 |     INFO |       log_parameters |   res_limit: 0.1
20:47:39.381 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:39.381 |     INFO |       log_parameters |   strategy_bd: -1
20:47:39.381 |     INFO |       log_parameters |   lft_cdf: None
20:47:39.381 |     INFO |       log_parameters |   kalman_init_param: None
20:47:39.381 |     INFO |       log_parameters |   diagnostics: None
20:47:39.381 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:39.381 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:39.381 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:39.381 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:39.381 |     INFO |       log_parameters |   coords_shape: (57, 2)
20:47:39.381 |     INFO |       log_parameters |   uncertainties_shape: (57, 2)
20:47:39.381 |     INFO |       log_parameters |   mean_uncertainty: 0.3120010614035088
20:47:39.381 |     INFO |       log_parameters |   uncertainty_range: [0.195561, 0.359842]
20:47:39.381 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:39.381 |     INFO |       log_parameters |   coords_shape: (58, 2)
20:47:39.381 |     INFO |       log_parameters |   uncertainties_shape: (58, 2)
20:47:39.381 |     INFO |       log_parameters |   mean_uncertainty: 0.3153381034482758
20:47:39.381 |     INFO |       log_parameters |   uncertainty_range: [0.190483, 0.354578]
20:47:39.381 |    DEBUG |            log_debug | Initializing Kalman for 58 features, prob_dim=2, state_dim=4
20:47:39.382 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:39.382 |     INFO |       log_parameters |   num_features: 58
20:47:39.382 |     INFO |       log_parameters |   state_dim: 4
20:47:39.382 |     INFO |       log_parameters |   prob_dim: 2
20:47:39.382 |     INFO |       log_parameters |   state_vec_shape: (58, 4)
20:47:39.382 |     INFO |       log_parameters |   state_noise_var_shape: (58, 4, 4)
20:47:39.382 |    DEBUG |            log_debug | State vector shape: (57, 4), Expected: (57, 4)
20:47:39.382 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:39.382 |     INFO |       log_parameters |   num_features_predicted: 57
20:47:39.382 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:39.382 |     INFO |       log_parameters |   brownian_motion_features: 57
20:47:39.382 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:39.382 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:39.382 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:39.382 |     INFO |       log_parameters |   search_radii_shape: (57, 2)
20:47:39.382 |     INFO |       log_parameters |   min_radius: 0.1
20:47:39.382 |     INFO |       log_parameters |   max_radius: 0.1
20:47:39.382 |     INFO |       log_parameters |   mean_radius: 0.1
20:47:39.382 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:39.382 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.1
20:47:39.383 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:39.383 |     INFO |       log_parameters |   distance_matrix_shape: (57, 58)
20:47:39.383 |     INFO |       log_parameters |   cost_matrix_shape: (57, 58)
20:47:39.383 |     INFO |       log_parameters |   finite_costs: 3306
20:47:39.383 |     INFO |       log_parameters |   infinite_costs: 0
20:47:39.383 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:39.383 |     INFO |       log_parameters |   min_distance: 7.6006362763175295
20:47:39.383 |     INFO |       log_parameters |   max_distance: 126.4847386305103
20:47:39.383 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:39.383 |     INFO |       log_parameters |   motion_costs_shape: (57, 58)
20:47:39.383 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:39.383 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:39.383 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:39.383 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:39.383 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:39.385 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:39.385 |     INFO |       log_parameters |   coords_shape: (57, 2)
20:47:39.385 |     INFO |       log_parameters |   uncertainties_shape: (57, 2)
20:47:39.385 |     INFO |       log_parameters |   mean_uncertainty: 0.3120010614035088
20:47:39.385 |     INFO |       log_parameters |   uncertainty_range: [0.195561, 0.359842]
20:47:39.385 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:39.385 |     INFO |       log_parameters |   coords_shape: (58, 2)
20:47:39.385 |     INFO |       log_parameters |   uncertainties_shape: (58, 2)
20:47:39.385 |     INFO |       log_parameters |   mean_uncertainty: 0.3153381034482758
20:47:39.385 |     INFO |       log_parameters |   uncertainty_range: [0.190483, 0.354578]
20:47:39.385 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:39.385 |     INFO |       log_parameters |   feature_costs_shape: (57, 58)
20:47:39.385 |     INFO |       log_parameters |   feature_costs_min: 1.0000056027706907
20:47:39.385 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:39.385 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:39.385 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:39.385 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:39.385 |     INFO |       log_parameters |   original_shape: (57, 58)
20:47:39.385 |     INFO |       log_parameters |   augmented_shape: (115, 115)
20:47:39.385 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:39.385 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:39.385 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:39.385 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:39.385 |    DEBUG |            log_debug |   observed_positions.shape: (58, 2)
20:47:39.386 |    DEBUG |            log_debug |   num_features (from observed_positions): 58
20:47:39.386 |    DEBUG |            log_debug |   predicted_positions.shape: (57, 2)
20:47:39.386 |    DEBUG |            log_debug |   predicted_velocities.shape: (57, 2)
20:47:39.386 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (58, 4)
20:47:39.386 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=58 but predicted_positions has 57 rows
20:47:39.386 |    ERROR |            log_error |   This will cause index 57 to fail when array only goes to 56
20:47:39.386 |    DEBUG |            log_debug | Kalman update: 58 features, state_dim=4, prob_dim=2
20:47:39.387 |    ERROR |            log_error | Error in enhanced linking: index 57 is out of bounds for axis 0 with size 57
20:47:39.387 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 57 is out of bounds for axis 0 with size 57
20:47:39.387 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0056 seconds
20:47:39.397 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=65, prob_dim=2, num_features_frame1=58, num_features_frame2=61)
20:47:39.397 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:39.397 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:39.397 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:39.397 |     INFO |       log_parameters |   current_frame: 65
20:47:39.397 |     INFO |       log_parameters |   prob_dim: 2
20:47:39.397 |     INFO |       log_parameters |   num_features_frame1: 58
20:47:39.397 |     INFO |       log_parameters |   num_features_frame2: 61
20:47:39.397 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:39.397 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:39.397 |     INFO |       log_parameters |   linear_motion: 1
20:47:39.397 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:39.397 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:39.397 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:39.397 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:39.397 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:39.397 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:39.397 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:39.397 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:39.397 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:39.397 |     INFO |       log_parameters |   use_local_density: 0
20:47:39.397 |     INFO |       log_parameters |   nn_window: 5
20:47:39.397 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:39.397 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:39.398 |     INFO |       log_parameters |   len_for_classify: 5
20:47:39.398 |     INFO |       log_parameters |   res_limit: 0.1
20:47:39.398 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:39.398 |     INFO |       log_parameters |   strategy_bd: -1
20:47:39.398 |     INFO |       log_parameters |   lft_cdf: None
20:47:39.398 |     INFO |       log_parameters |   kalman_init_param: None
20:47:39.398 |     INFO |       log_parameters |   diagnostics: None
20:47:39.398 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:39.398 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:39.398 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:39.398 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:39.398 |     INFO |       log_parameters |   coords_shape: (58, 2)
20:47:39.398 |     INFO |       log_parameters |   uncertainties_shape: (58, 2)
20:47:39.398 |     INFO |       log_parameters |   mean_uncertainty: 0.3153381034482758
20:47:39.398 |     INFO |       log_parameters |   uncertainty_range: [0.190483, 0.354578]
20:47:39.398 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:39.398 |     INFO |       log_parameters |   coords_shape: (61, 2)
20:47:39.398 |     INFO |       log_parameters |   uncertainties_shape: (61, 2)
20:47:39.398 |     INFO |       log_parameters |   mean_uncertainty: 0.31664983606557373
20:47:39.398 |     INFO |       log_parameters |   uncertainty_range: [0.19941, 0.355183]
20:47:39.398 |    DEBUG |            log_debug | Initializing Kalman for 61 features, prob_dim=2, state_dim=4
20:47:39.398 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:39.398 |     INFO |       log_parameters |   num_features: 61
20:47:39.398 |     INFO |       log_parameters |   state_dim: 4
20:47:39.398 |     INFO |       log_parameters |   prob_dim: 2
20:47:39.398 |     INFO |       log_parameters |   state_vec_shape: (61, 4)
20:47:39.398 |     INFO |       log_parameters |   state_noise_var_shape: (61, 4, 4)
20:47:39.398 |    DEBUG |            log_debug | State vector shape: (58, 4), Expected: (58, 4)
20:47:39.398 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:39.398 |     INFO |       log_parameters |   num_features_predicted: 58
20:47:39.398 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:39.398 |     INFO |       log_parameters |   brownian_motion_features: 58
20:47:39.398 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:39.398 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:39.398 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:39.398 |     INFO |       log_parameters |   search_radii_shape: (58, 2)
20:47:39.398 |     INFO |       log_parameters |   min_radius: 0.1
20:47:39.398 |     INFO |       log_parameters |   max_radius: 0.1
20:47:39.399 |     INFO |       log_parameters |   mean_radius: 0.09999999999999999
20:47:39.399 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:39.399 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999999
20:47:39.399 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:39.399 |     INFO |       log_parameters |   distance_matrix_shape: (58, 61)
20:47:39.399 |     INFO |       log_parameters |   cost_matrix_shape: (58, 61)
20:47:39.399 |     INFO |       log_parameters |   finite_costs: 3538
20:47:39.399 |     INFO |       log_parameters |   infinite_costs: 0
20:47:39.399 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:39.399 |     INFO |       log_parameters |   min_distance: 7.587207008365727
20:47:39.399 |     INFO |       log_parameters |   max_distance: 126.44117603988816
20:47:39.399 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:39.399 |     INFO |       log_parameters |   motion_costs_shape: (58, 61)
20:47:39.399 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:39.399 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:39.399 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:39.399 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:39.399 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:39.401 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:39.401 |     INFO |       log_parameters |   coords_shape: (58, 2)
20:47:39.401 |     INFO |       log_parameters |   uncertainties_shape: (58, 2)
20:47:39.401 |     INFO |       log_parameters |   mean_uncertainty: 0.3153381034482758
20:47:39.401 |     INFO |       log_parameters |   uncertainty_range: [0.190483, 0.354578]
20:47:39.401 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:39.401 |     INFO |       log_parameters |   coords_shape: (61, 2)
20:47:39.401 |     INFO |       log_parameters |   uncertainties_shape: (61, 2)
20:47:39.401 |     INFO |       log_parameters |   mean_uncertainty: 0.31664983606557373
20:47:39.401 |     INFO |       log_parameters |   uncertainty_range: [0.19941, 0.355183]
20:47:39.402 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:39.402 |     INFO |       log_parameters |   feature_costs_shape: (58, 61)
20:47:39.402 |     INFO |       log_parameters |   feature_costs_min: 1.0001126125168067
20:47:39.402 |     INFO |       log_parameters |   feature_costs_max: 5.0
20:47:39.402 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:39.402 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:39.402 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:39.402 |     INFO |       log_parameters |   original_shape: (58, 61)
20:47:39.402 |     INFO |       log_parameters |   augmented_shape: (119, 119)
20:47:39.402 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:39.402 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:39.402 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:39.402 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:39.402 |    DEBUG |            log_debug |   observed_positions.shape: (61, 2)
20:47:39.402 |    DEBUG |            log_debug |   num_features (from observed_positions): 61
20:47:39.402 |    DEBUG |            log_debug |   predicted_positions.shape: (58, 2)
20:47:39.402 |    DEBUG |            log_debug |   predicted_velocities.shape: (58, 2)
20:47:39.402 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (61, 4)
20:47:39.402 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=61 but predicted_positions has 58 rows
20:47:39.402 |    ERROR |            log_error |   This will cause index 60 to fail when array only goes to 57
20:47:39.402 |    DEBUG |            log_debug | Kalman update: 61 features, state_dim=4, prob_dim=2
20:47:39.403 |    ERROR |            log_error | Error in enhanced linking: index 58 is out of bounds for axis 0 with size 58
20:47:39.403 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 58 is out of bounds for axis 0 with size 58
20:47:39.403 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0058 seconds
20:47:39.414 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=66, prob_dim=2, num_features_frame1=61, num_features_frame2=56)
20:47:39.414 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:39.414 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:39.414 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:39.414 |     INFO |       log_parameters |   current_frame: 66
20:47:39.414 |     INFO |       log_parameters |   prob_dim: 2
20:47:39.414 |     INFO |       log_parameters |   num_features_frame1: 61
20:47:39.414 |     INFO |       log_parameters |   num_features_frame2: 56
20:47:39.414 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:39.414 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:39.414 |     INFO |       log_parameters |   linear_motion: 1
20:47:39.414 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:39.414 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:39.414 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:39.414 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:39.414 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:39.414 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:39.414 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:39.414 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:39.414 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:39.414 |     INFO |       log_parameters |   use_local_density: 0
20:47:39.414 |     INFO |       log_parameters |   nn_window: 5
20:47:39.414 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:39.414 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:39.414 |     INFO |       log_parameters |   len_for_classify: 5
20:47:39.414 |     INFO |       log_parameters |   res_limit: 0.1
20:47:39.414 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:39.414 |     INFO |       log_parameters |   strategy_bd: -1
20:47:39.414 |     INFO |       log_parameters |   lft_cdf: None
20:47:39.414 |     INFO |       log_parameters |   kalman_init_param: None
20:47:39.414 |     INFO |       log_parameters |   diagnostics: None
20:47:39.414 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:39.414 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:39.414 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:39.414 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:39.414 |     INFO |       log_parameters |   coords_shape: (61, 2)
20:47:39.414 |     INFO |       log_parameters |   uncertainties_shape: (61, 2)
20:47:39.414 |     INFO |       log_parameters |   mean_uncertainty: 0.31664983606557373
20:47:39.414 |     INFO |       log_parameters |   uncertainty_range: [0.19941, 0.355183]
20:47:39.414 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:39.414 |     INFO |       log_parameters |   coords_shape: (56, 2)
20:47:39.414 |     INFO |       log_parameters |   uncertainties_shape: (56, 2)
20:47:39.414 |     INFO |       log_parameters |   mean_uncertainty: 0.314654875
20:47:39.414 |     INFO |       log_parameters |   uncertainty_range: [0.197252, 0.358245]
20:47:39.414 |    DEBUG |            log_debug | Initializing Kalman for 56 features, prob_dim=2, state_dim=4
20:47:39.414 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:39.414 |     INFO |       log_parameters |   num_features: 56
20:47:39.414 |     INFO |       log_parameters |   state_dim: 4
20:47:39.414 |     INFO |       log_parameters |   prob_dim: 2
20:47:39.414 |     INFO |       log_parameters |   state_vec_shape: (56, 4)
20:47:39.414 |     INFO |       log_parameters |   state_noise_var_shape: (56, 4, 4)
20:47:39.414 |    DEBUG |            log_debug | State vector shape: (61, 4), Expected: (61, 4)
20:47:39.415 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:39.415 |     INFO |       log_parameters |   num_features_predicted: 61
20:47:39.415 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:39.415 |     INFO |       log_parameters |   brownian_motion_features: 61
20:47:39.415 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:39.415 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:39.415 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:39.415 |     INFO |       log_parameters |   search_radii_shape: (61, 2)
20:47:39.415 |     INFO |       log_parameters |   min_radius: 0.1
20:47:39.415 |     INFO |       log_parameters |   max_radius: 0.1
20:47:39.415 |     INFO |       log_parameters |   mean_radius: 0.1
20:47:39.415 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:39.415 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.1
20:47:39.416 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:39.416 |     INFO |       log_parameters |   distance_matrix_shape: (61, 56)
20:47:39.416 |     INFO |       log_parameters |   cost_matrix_shape: (61, 56)
20:47:39.416 |     INFO |       log_parameters |   finite_costs: 3416
20:47:39.416 |     INFO |       log_parameters |   infinite_costs: 0
20:47:39.416 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:39.416 |     INFO |       log_parameters |   min_distance: 7.779234299762542
20:47:39.416 |     INFO |       log_parameters |   max_distance: 129.13367756383795
20:47:39.416 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:39.416 |     INFO |       log_parameters |   motion_costs_shape: (61, 56)
20:47:39.416 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:39.416 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:39.416 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:39.416 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:39.416 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:39.418 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:39.418 |     INFO |       log_parameters |   coords_shape: (61, 2)
20:47:39.418 |     INFO |       log_parameters |   uncertainties_shape: (61, 2)
20:47:39.418 |     INFO |       log_parameters |   mean_uncertainty: 0.31664983606557373
20:47:39.418 |     INFO |       log_parameters |   uncertainty_range: [0.19941, 0.355183]
20:47:39.418 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:39.418 |     INFO |       log_parameters |   coords_shape: (56, 2)
20:47:39.418 |     INFO |       log_parameters |   uncertainties_shape: (56, 2)
20:47:39.418 |     INFO |       log_parameters |   mean_uncertainty: 0.314654875
20:47:39.418 |     INFO |       log_parameters |   uncertainty_range: [0.197252, 0.358245]
20:47:39.418 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:39.418 |     INFO |       log_parameters |   feature_costs_shape: (61, 56)
20:47:39.418 |     INFO |       log_parameters |   feature_costs_min: 1.0000120496698146
20:47:39.418 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:39.418 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:39.418 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:39.418 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:39.418 |     INFO |       log_parameters |   original_shape: (61, 56)
20:47:39.418 |     INFO |       log_parameters |   augmented_shape: (117, 117)
20:47:39.418 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:39.418 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:39.418 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:39.418 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:39.418 |    DEBUG |            log_debug |   observed_positions.shape: (56, 2)
20:47:39.418 |    DEBUG |            log_debug |   num_features (from observed_positions): 56
20:47:39.418 |    DEBUG |            log_debug |   predicted_positions.shape: (61, 2)
20:47:39.418 |    DEBUG |            log_debug |   predicted_velocities.shape: (61, 2)
20:47:39.418 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (56, 4)
20:47:39.418 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=56 but predicted_positions has 61 rows
20:47:39.418 |    ERROR |            log_error |   This will cause index 55 to fail when array only goes to 60
20:47:39.418 |    DEBUG |            log_debug | Kalman update: 56 features, state_dim=4, prob_dim=2
20:47:39.419 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman update):
20:47:39.419 |     INFO |       log_parameters |   features_updated: 56
20:47:39.419 |     INFO |       log_parameters |   state_dim: 4
20:47:39.419 |     INFO |       log_parameters |   dt_used: 1.0
20:47:39.419 |     INFO |       log_parameters |   process_noise_scale: 1.0
20:47:39.419 |     INFO |       log_parameters |   measurement_noise_scale: 1.0
20:47:39.419 |     INFO |             log_info | Enhanced linking completed successfully for frame 66
20:47:39.419 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0056 seconds
20:47:39.648 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=67, prob_dim=2, num_features_frame1=56, num_features_frame2=54)
20:47:39.648 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:39.648 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:39.648 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:39.648 |     INFO |       log_parameters |   current_frame: 67
20:47:39.648 |     INFO |       log_parameters |   prob_dim: 2
20:47:39.648 |     INFO |       log_parameters |   num_features_frame1: 56
20:47:39.648 |     INFO |       log_parameters |   num_features_frame2: 54
20:47:39.648 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:39.648 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:39.648 |     INFO |       log_parameters |   linear_motion: 1
20:47:39.648 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:39.648 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:39.648 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:39.648 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:39.648 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:39.648 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:39.648 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:39.648 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:39.648 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:39.648 |     INFO |       log_parameters |   use_local_density: 0
20:47:39.648 |     INFO |       log_parameters |   nn_window: 5
20:47:39.648 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:39.648 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:39.648 |     INFO |       log_parameters |   len_for_classify: 5
20:47:39.648 |     INFO |       log_parameters |   res_limit: 0.1
20:47:39.648 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:39.648 |     INFO |       log_parameters |   strategy_bd: -1
20:47:39.648 |     INFO |       log_parameters |   lft_cdf: None
20:47:39.648 |     INFO |       log_parameters |   kalman_init_param: None
20:47:39.648 |     INFO |       log_parameters |   diagnostics: None
20:47:39.648 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:39.648 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:39.648 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:39.648 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:39.648 |     INFO |       log_parameters |   coords_shape: (56, 2)
20:47:39.648 |     INFO |       log_parameters |   uncertainties_shape: (56, 2)
20:47:39.648 |     INFO |       log_parameters |   mean_uncertainty: 0.314654875
20:47:39.648 |     INFO |       log_parameters |   uncertainty_range: [0.197252, 0.358245]
20:47:39.648 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:39.648 |     INFO |       log_parameters |   coords_shape: (54, 2)
20:47:39.648 |     INFO |       log_parameters |   uncertainties_shape: (54, 2)
20:47:39.648 |     INFO |       log_parameters |   mean_uncertainty: 0.31597949999999997
20:47:39.648 |     INFO |       log_parameters |   uncertainty_range: [0.190262, 0.355528]
20:47:39.648 |    DEBUG |            log_debug | Initializing Kalman for 54 features, prob_dim=2, state_dim=4
20:47:39.648 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:39.648 |     INFO |       log_parameters |   num_features: 54
20:47:39.648 |     INFO |       log_parameters |   state_dim: 4
20:47:39.648 |     INFO |       log_parameters |   prob_dim: 2
20:47:39.648 |     INFO |       log_parameters |   state_vec_shape: (54, 4)
20:47:39.648 |     INFO |       log_parameters |   state_noise_var_shape: (54, 4, 4)
20:47:39.648 |    DEBUG |            log_debug | State vector shape: (56, 4), Expected: (56, 4)
20:47:39.649 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:39.649 |     INFO |       log_parameters |   num_features_predicted: 56
20:47:39.649 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:39.649 |     INFO |       log_parameters |   brownian_motion_features: 56
20:47:39.649 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:39.649 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:39.649 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:39.649 |     INFO |       log_parameters |   search_radii_shape: (56, 2)
20:47:39.649 |     INFO |       log_parameters |   min_radius: 0.1
20:47:39.649 |     INFO |       log_parameters |   max_radius: 0.1
20:47:39.649 |     INFO |       log_parameters |   mean_radius: 0.1
20:47:39.649 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:39.649 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.1
20:47:39.650 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:39.650 |     INFO |       log_parameters |   distance_matrix_shape: (56, 54)
20:47:39.650 |     INFO |       log_parameters |   cost_matrix_shape: (56, 54)
20:47:39.650 |     INFO |       log_parameters |   finite_costs: 3024
20:47:39.650 |     INFO |       log_parameters |   infinite_costs: 0
20:47:39.650 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:39.650 |     INFO |       log_parameters |   min_distance: 7.584567111159345
20:47:39.650 |     INFO |       log_parameters |   max_distance: 126.54918411007628
20:47:39.650 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:39.650 |     INFO |       log_parameters |   motion_costs_shape: (56, 54)
20:47:39.650 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:39.650 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:39.650 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:39.650 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:39.650 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:39.652 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:39.652 |     INFO |       log_parameters |   coords_shape: (56, 2)
20:47:39.652 |     INFO |       log_parameters |   uncertainties_shape: (56, 2)
20:47:39.652 |     INFO |       log_parameters |   mean_uncertainty: 0.314654875
20:47:39.652 |     INFO |       log_parameters |   uncertainty_range: [0.197252, 0.358245]
20:47:39.652 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:39.652 |     INFO |       log_parameters |   coords_shape: (54, 2)
20:47:39.652 |     INFO |       log_parameters |   uncertainties_shape: (54, 2)
20:47:39.652 |     INFO |       log_parameters |   mean_uncertainty: 0.31597949999999997
20:47:39.652 |     INFO |       log_parameters |   uncertainty_range: [0.190262, 0.355528]
20:47:39.652 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:39.652 |     INFO |       log_parameters |   feature_costs_shape: (56, 54)
20:47:39.652 |     INFO |       log_parameters |   feature_costs_min: 1.0000207385576467
20:47:39.652 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:39.652 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:39.652 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:39.652 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:39.652 |     INFO |       log_parameters |   original_shape: (56, 54)
20:47:39.652 |     INFO |       log_parameters |   augmented_shape: (110, 110)
20:47:39.652 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:39.652 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:39.652 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:39.652 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:39.652 |    DEBUG |            log_debug |   observed_positions.shape: (54, 2)
20:47:39.652 |    DEBUG |            log_debug |   num_features (from observed_positions): 54
20:47:39.652 |    DEBUG |            log_debug |   predicted_positions.shape: (56, 2)
20:47:39.652 |    DEBUG |            log_debug |   predicted_velocities.shape: (56, 2)
20:47:39.652 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (54, 4)
20:47:39.652 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=54 but predicted_positions has 56 rows
20:47:39.652 |    ERROR |            log_error |   This will cause index 53 to fail when array only goes to 55
20:47:39.652 |    DEBUG |            log_debug | Kalman update: 54 features, state_dim=4, prob_dim=2
20:47:39.653 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman update):
20:47:39.653 |     INFO |       log_parameters |   features_updated: 54
20:47:39.653 |     INFO |       log_parameters |   state_dim: 4
20:47:39.653 |     INFO |       log_parameters |   dt_used: 1.0
20:47:39.653 |     INFO |       log_parameters |   process_noise_scale: 1.0
20:47:39.653 |     INFO |       log_parameters |   measurement_noise_scale: 1.0
20:47:39.653 |     INFO |             log_info | Enhanced linking completed successfully for frame 67
20:47:39.653 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0053 seconds
20:47:39.864 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=68, prob_dim=2, num_features_frame1=54, num_features_frame2=60)
20:47:39.864 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:39.864 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:39.864 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:39.864 |     INFO |       log_parameters |   current_frame: 68
20:47:39.864 |     INFO |       log_parameters |   prob_dim: 2
20:47:39.864 |     INFO |       log_parameters |   num_features_frame1: 54
20:47:39.864 |     INFO |       log_parameters |   num_features_frame2: 60
20:47:39.864 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:39.864 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:39.864 |     INFO |       log_parameters |   linear_motion: 1
20:47:39.864 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:39.864 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:39.864 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:39.864 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:39.864 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:39.864 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:39.864 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:39.864 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:39.864 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:39.864 |     INFO |       log_parameters |   use_local_density: 0
20:47:39.864 |     INFO |       log_parameters |   nn_window: 5
20:47:39.864 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:39.864 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:39.864 |     INFO |       log_parameters |   len_for_classify: 5
20:47:39.864 |     INFO |       log_parameters |   res_limit: 0.1
20:47:39.864 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:39.864 |     INFO |       log_parameters |   strategy_bd: -1
20:47:39.864 |     INFO |       log_parameters |   lft_cdf: None
20:47:39.864 |     INFO |       log_parameters |   kalman_init_param: None
20:47:39.864 |     INFO |       log_parameters |   diagnostics: None
20:47:39.864 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:39.864 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:39.864 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:39.864 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:39.864 |     INFO |       log_parameters |   coords_shape: (54, 2)
20:47:39.864 |     INFO |       log_parameters |   uncertainties_shape: (54, 2)
20:47:39.864 |     INFO |       log_parameters |   mean_uncertainty: 0.31597949999999997
20:47:39.864 |     INFO |       log_parameters |   uncertainty_range: [0.190262, 0.355528]
20:47:39.864 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:39.864 |     INFO |       log_parameters |   coords_shape: (60, 2)
20:47:39.864 |     INFO |       log_parameters |   uncertainties_shape: (60, 2)
20:47:39.864 |     INFO |       log_parameters |   mean_uncertainty: 0.31814126666666664
20:47:39.864 |     INFO |       log_parameters |   uncertainty_range: [0.189498, 0.356223]
20:47:39.864 |    DEBUG |            log_debug | Initializing Kalman for 60 features, prob_dim=2, state_dim=4
20:47:39.864 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:39.864 |     INFO |       log_parameters |   num_features: 60
20:47:39.864 |     INFO |       log_parameters |   state_dim: 4
20:47:39.864 |     INFO |       log_parameters |   prob_dim: 2
20:47:39.864 |     INFO |       log_parameters |   state_vec_shape: (60, 4)
20:47:39.864 |     INFO |       log_parameters |   state_noise_var_shape: (60, 4, 4)
20:47:39.864 |    DEBUG |            log_debug | State vector shape: (54, 4), Expected: (54, 4)
20:47:39.865 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:39.865 |     INFO |       log_parameters |   num_features_predicted: 54
20:47:39.865 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:39.865 |     INFO |       log_parameters |   brownian_motion_features: 54
20:47:39.865 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:39.865 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:39.865 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:39.865 |     INFO |       log_parameters |   search_radii_shape: (54, 2)
20:47:39.865 |     INFO |       log_parameters |   min_radius: 0.1
20:47:39.865 |     INFO |       log_parameters |   max_radius: 0.1
20:47:39.865 |     INFO |       log_parameters |   mean_radius: 0.09999999999999999
20:47:39.865 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:39.865 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999999
20:47:39.865 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:39.865 |     INFO |       log_parameters |   distance_matrix_shape: (54, 60)
20:47:39.865 |     INFO |       log_parameters |   cost_matrix_shape: (54, 60)
20:47:39.865 |     INFO |       log_parameters |   finite_costs: 3240
20:47:39.865 |     INFO |       log_parameters |   infinite_costs: 0
20:47:39.865 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:39.865 |     INFO |       log_parameters |   min_distance: 7.322673766700385
20:47:39.865 |     INFO |       log_parameters |   max_distance: 126.5828590328847
20:47:39.865 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:39.866 |     INFO |       log_parameters |   motion_costs_shape: (54, 60)
20:47:39.866 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:39.866 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:39.866 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:39.866 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:39.866 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:39.867 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:39.867 |     INFO |       log_parameters |   coords_shape: (54, 2)
20:47:39.867 |     INFO |       log_parameters |   uncertainties_shape: (54, 2)
20:47:39.867 |     INFO |       log_parameters |   mean_uncertainty: 0.31597949999999997
20:47:39.867 |     INFO |       log_parameters |   uncertainty_range: [0.190262, 0.355528]
20:47:39.867 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:39.867 |     INFO |       log_parameters |   coords_shape: (60, 2)
20:47:39.867 |     INFO |       log_parameters |   uncertainties_shape: (60, 2)
20:47:39.867 |     INFO |       log_parameters |   mean_uncertainty: 0.31814126666666664
20:47:39.868 |     INFO |       log_parameters |   uncertainty_range: [0.189498, 0.356223]
20:47:39.868 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:39.868 |     INFO |       log_parameters |   feature_costs_shape: (54, 60)
20:47:39.868 |     INFO |       log_parameters |   feature_costs_min: 1.0000129923231365
20:47:39.868 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:39.868 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:39.868 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:39.868 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:39.868 |     INFO |       log_parameters |   original_shape: (54, 60)
20:47:39.868 |     INFO |       log_parameters |   augmented_shape: (114, 114)
20:47:39.868 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:39.868 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:39.868 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:39.868 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:39.868 |    DEBUG |            log_debug |   observed_positions.shape: (60, 2)
20:47:39.868 |    DEBUG |            log_debug |   num_features (from observed_positions): 60
20:47:39.868 |    DEBUG |            log_debug |   predicted_positions.shape: (54, 2)
20:47:39.868 |    DEBUG |            log_debug |   predicted_velocities.shape: (54, 2)
20:47:39.868 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (60, 4)
20:47:39.868 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=60 but predicted_positions has 54 rows
20:47:39.868 |    ERROR |            log_error |   This will cause index 59 to fail when array only goes to 53
20:47:39.868 |    DEBUG |            log_debug | Kalman update: 60 features, state_dim=4, prob_dim=2
20:47:39.869 |    ERROR |            log_error | Error in enhanced linking: index 54 is out of bounds for axis 0 with size 54
20:47:39.869 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 54 is out of bounds for axis 0 with size 54
20:47:39.869 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0055 seconds
20:47:39.880 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=69, prob_dim=2, num_features_frame1=60, num_features_frame2=56)
20:47:39.880 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:39.880 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:39.880 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:39.880 |     INFO |       log_parameters |   current_frame: 69
20:47:39.880 |     INFO |       log_parameters |   prob_dim: 2
20:47:39.880 |     INFO |       log_parameters |   num_features_frame1: 60
20:47:39.880 |     INFO |       log_parameters |   num_features_frame2: 56
20:47:39.880 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:39.880 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:39.880 |     INFO |       log_parameters |   linear_motion: 1
20:47:39.880 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:39.880 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:39.880 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:39.880 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:39.880 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:39.880 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:39.880 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:39.880 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:39.880 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:39.880 |     INFO |       log_parameters |   use_local_density: 0
20:47:39.880 |     INFO |       log_parameters |   nn_window: 5
20:47:39.880 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:39.880 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:39.880 |     INFO |       log_parameters |   len_for_classify: 5
20:47:39.880 |     INFO |       log_parameters |   res_limit: 0.1
20:47:39.880 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:39.880 |     INFO |       log_parameters |   strategy_bd: -1
20:47:39.880 |     INFO |       log_parameters |   lft_cdf: None
20:47:39.880 |     INFO |       log_parameters |   kalman_init_param: None
20:47:39.880 |     INFO |       log_parameters |   diagnostics: None
20:47:39.880 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:39.880 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:39.880 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:39.880 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:39.880 |     INFO |       log_parameters |   coords_shape: (60, 2)
20:47:39.880 |     INFO |       log_parameters |   uncertainties_shape: (60, 2)
20:47:39.880 |     INFO |       log_parameters |   mean_uncertainty: 0.31814126666666664
20:47:39.880 |     INFO |       log_parameters |   uncertainty_range: [0.189498, 0.356223]
20:47:39.880 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:39.880 |     INFO |       log_parameters |   coords_shape: (56, 2)
20:47:39.880 |     INFO |       log_parameters |   uncertainties_shape: (56, 2)
20:47:39.880 |     INFO |       log_parameters |   mean_uncertainty: 0.31583975
20:47:39.880 |     INFO |       log_parameters |   uncertainty_range: [0.188569, 0.356255]
20:47:39.880 |    DEBUG |            log_debug | Initializing Kalman for 56 features, prob_dim=2, state_dim=4
20:47:39.880 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:39.880 |     INFO |       log_parameters |   num_features: 56
20:47:39.880 |     INFO |       log_parameters |   state_dim: 4
20:47:39.880 |     INFO |       log_parameters |   prob_dim: 2
20:47:39.880 |     INFO |       log_parameters |   state_vec_shape: (56, 4)
20:47:39.880 |     INFO |       log_parameters |   state_noise_var_shape: (56, 4, 4)
20:47:39.880 |    DEBUG |            log_debug | State vector shape: (60, 4), Expected: (60, 4)
20:47:39.881 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:39.881 |     INFO |       log_parameters |   num_features_predicted: 60
20:47:39.881 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:39.881 |     INFO |       log_parameters |   brownian_motion_features: 60
20:47:39.881 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:39.881 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:39.881 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:39.881 |     INFO |       log_parameters |   search_radii_shape: (60, 2)
20:47:39.881 |     INFO |       log_parameters |   min_radius: 0.1
20:47:39.881 |     INFO |       log_parameters |   max_radius: 0.1
20:47:39.881 |     INFO |       log_parameters |   mean_radius: 0.10000000000000002
20:47:39.881 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:39.881 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.10000000000000002
20:47:39.882 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:39.882 |     INFO |       log_parameters |   distance_matrix_shape: (60, 56)
20:47:39.882 |     INFO |       log_parameters |   cost_matrix_shape: (60, 56)
20:47:39.882 |     INFO |       log_parameters |   finite_costs: 3360
20:47:39.882 |     INFO |       log_parameters |   infinite_costs: 0
20:47:39.882 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:39.882 |     INFO |       log_parameters |   min_distance: 20.785391613590757
20:47:39.882 |     INFO |       log_parameters |   max_distance: 128.59047039573053
20:47:39.882 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:39.882 |     INFO |       log_parameters |   motion_costs_shape: (60, 56)
20:47:39.882 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:39.882 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:39.882 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:39.882 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:39.882 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:39.884 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:39.884 |     INFO |       log_parameters |   coords_shape: (60, 2)
20:47:39.884 |     INFO |       log_parameters |   uncertainties_shape: (60, 2)
20:47:39.884 |     INFO |       log_parameters |   mean_uncertainty: 0.31814126666666664
20:47:39.884 |     INFO |       log_parameters |   uncertainty_range: [0.189498, 0.356223]
20:47:39.884 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:39.884 |     INFO |       log_parameters |   coords_shape: (56, 2)
20:47:39.884 |     INFO |       log_parameters |   uncertainties_shape: (56, 2)
20:47:39.884 |     INFO |       log_parameters |   mean_uncertainty: 0.31583975
20:47:39.884 |     INFO |       log_parameters |   uncertainty_range: [0.188569, 0.356255]
20:47:39.884 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:39.884 |     INFO |       log_parameters |   feature_costs_shape: (60, 56)
20:47:39.884 |     INFO |       log_parameters |   feature_costs_min: 1.0000123406375427
20:47:39.884 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:39.884 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:39.884 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:39.884 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:39.884 |     INFO |       log_parameters |   original_shape: (60, 56)
20:47:39.884 |     INFO |       log_parameters |   augmented_shape: (116, 116)
20:47:39.884 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:39.884 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:39.884 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:39.884 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:39.884 |    DEBUG |            log_debug |   observed_positions.shape: (56, 2)
20:47:39.884 |    DEBUG |            log_debug |   num_features (from observed_positions): 56
20:47:39.884 |    DEBUG |            log_debug |   predicted_positions.shape: (60, 2)
20:47:39.884 |    DEBUG |            log_debug |   predicted_velocities.shape: (60, 2)
20:47:39.884 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (56, 4)
20:47:39.884 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=56 but predicted_positions has 60 rows
20:47:39.884 |    ERROR |            log_error |   This will cause index 55 to fail when array only goes to 59
20:47:39.884 |    DEBUG |            log_debug | Kalman update: 56 features, state_dim=4, prob_dim=2
20:47:39.885 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman update):
20:47:39.885 |     INFO |       log_parameters |   features_updated: 56
20:47:39.885 |     INFO |       log_parameters |   state_dim: 4
20:47:39.885 |     INFO |       log_parameters |   dt_used: 1.0
20:47:39.885 |     INFO |       log_parameters |   process_noise_scale: 1.0
20:47:39.885 |     INFO |       log_parameters |   measurement_noise_scale: 1.0
20:47:39.885 |     INFO |             log_info | Enhanced linking completed successfully for frame 69
20:47:39.885 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0055 seconds
20:47:40.115 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=70, prob_dim=2, num_features_frame1=56, num_features_frame2=58)
20:47:40.115 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:40.115 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:40.115 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:40.115 |     INFO |       log_parameters |   current_frame: 70
20:47:40.115 |     INFO |       log_parameters |   prob_dim: 2
20:47:40.115 |     INFO |       log_parameters |   num_features_frame1: 56
20:47:40.115 |     INFO |       log_parameters |   num_features_frame2: 58
20:47:40.115 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:40.115 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:40.115 |     INFO |       log_parameters |   linear_motion: 1
20:47:40.115 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:40.115 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:40.115 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:40.115 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:40.115 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:40.115 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:40.115 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:40.115 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:40.115 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:40.115 |     INFO |       log_parameters |   use_local_density: 0
20:47:40.115 |     INFO |       log_parameters |   nn_window: 5
20:47:40.115 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:40.115 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:40.115 |     INFO |       log_parameters |   len_for_classify: 5
20:47:40.115 |     INFO |       log_parameters |   res_limit: 0.1
20:47:40.115 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:40.115 |     INFO |       log_parameters |   strategy_bd: -1
20:47:40.115 |     INFO |       log_parameters |   lft_cdf: None
20:47:40.115 |     INFO |       log_parameters |   kalman_init_param: None
20:47:40.115 |     INFO |       log_parameters |   diagnostics: None
20:47:40.115 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:40.115 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:40.115 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:40.115 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:40.115 |     INFO |       log_parameters |   coords_shape: (56, 2)
20:47:40.115 |     INFO |       log_parameters |   uncertainties_shape: (56, 2)
20:47:40.115 |     INFO |       log_parameters |   mean_uncertainty: 0.31583975
20:47:40.115 |     INFO |       log_parameters |   uncertainty_range: [0.188569, 0.356255]
20:47:40.115 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:40.115 |     INFO |       log_parameters |   coords_shape: (58, 2)
20:47:40.115 |     INFO |       log_parameters |   uncertainties_shape: (58, 2)
20:47:40.115 |     INFO |       log_parameters |   mean_uncertainty: 0.31896134482758615
20:47:40.115 |     INFO |       log_parameters |   uncertainty_range: [0.191569, 0.359477]
20:47:40.115 |    DEBUG |            log_debug | Initializing Kalman for 58 features, prob_dim=2, state_dim=4
20:47:40.116 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:40.116 |     INFO |       log_parameters |   num_features: 58
20:47:40.116 |     INFO |       log_parameters |   state_dim: 4
20:47:40.116 |     INFO |       log_parameters |   prob_dim: 2
20:47:40.116 |     INFO |       log_parameters |   state_vec_shape: (58, 4)
20:47:40.116 |     INFO |       log_parameters |   state_noise_var_shape: (58, 4, 4)
20:47:40.116 |    DEBUG |            log_debug | State vector shape: (56, 4), Expected: (56, 4)
20:47:40.116 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:40.116 |     INFO |       log_parameters |   num_features_predicted: 56
20:47:40.116 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:40.116 |     INFO |       log_parameters |   brownian_motion_features: 56
20:47:40.116 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:40.116 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:40.116 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:40.116 |     INFO |       log_parameters |   search_radii_shape: (56, 2)
20:47:40.116 |     INFO |       log_parameters |   min_radius: 0.1
20:47:40.116 |     INFO |       log_parameters |   max_radius: 0.1
20:47:40.116 |     INFO |       log_parameters |   mean_radius: 0.1
20:47:40.116 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:40.116 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.1
20:47:40.117 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:40.117 |     INFO |       log_parameters |   distance_matrix_shape: (56, 58)
20:47:40.117 |     INFO |       log_parameters |   cost_matrix_shape: (56, 58)
20:47:40.117 |     INFO |       log_parameters |   finite_costs: 3248
20:47:40.117 |     INFO |       log_parameters |   infinite_costs: 0
20:47:40.117 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:40.117 |     INFO |       log_parameters |   min_distance: 7.4297824653143785
20:47:40.117 |     INFO |       log_parameters |   max_distance: 126.60111923063995
20:47:40.117 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:40.117 |     INFO |       log_parameters |   motion_costs_shape: (56, 58)
20:47:40.117 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:40.117 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:40.117 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:40.117 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:40.117 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:40.119 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:40.119 |     INFO |       log_parameters |   coords_shape: (56, 2)
20:47:40.119 |     INFO |       log_parameters |   uncertainties_shape: (56, 2)
20:47:40.119 |     INFO |       log_parameters |   mean_uncertainty: 0.31583975
20:47:40.119 |     INFO |       log_parameters |   uncertainty_range: [0.188569, 0.356255]
20:47:40.119 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:40.119 |     INFO |       log_parameters |   coords_shape: (58, 2)
20:47:40.119 |     INFO |       log_parameters |   uncertainties_shape: (58, 2)
20:47:40.119 |     INFO |       log_parameters |   mean_uncertainty: 0.31896134482758615
20:47:40.119 |     INFO |       log_parameters |   uncertainty_range: [0.191569, 0.359477]
20:47:40.119 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:40.119 |     INFO |       log_parameters |   feature_costs_shape: (56, 58)
20:47:40.119 |     INFO |       log_parameters |   feature_costs_min: 1.000027867997424
20:47:40.119 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:40.119 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:40.119 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:40.119 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:40.119 |     INFO |       log_parameters |   original_shape: (56, 58)
20:47:40.119 |     INFO |       log_parameters |   augmented_shape: (114, 114)
20:47:40.119 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:40.119 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:40.119 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:40.119 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:40.120 |    DEBUG |            log_debug |   observed_positions.shape: (58, 2)
20:47:40.120 |    DEBUG |            log_debug |   num_features (from observed_positions): 58
20:47:40.120 |    DEBUG |            log_debug |   predicted_positions.shape: (56, 2)
20:47:40.120 |    DEBUG |            log_debug |   predicted_velocities.shape: (56, 2)
20:47:40.120 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (58, 4)
20:47:40.120 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=58 but predicted_positions has 56 rows
20:47:40.120 |    ERROR |            log_error |   This will cause index 57 to fail when array only goes to 55
20:47:40.120 |    DEBUG |            log_debug | Kalman update: 58 features, state_dim=4, prob_dim=2
20:47:40.121 |    ERROR |            log_error | Error in enhanced linking: index 56 is out of bounds for axis 0 with size 56
20:47:40.121 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 56 is out of bounds for axis 0 with size 56
20:47:40.121 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0056 seconds
20:47:40.131 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=71, prob_dim=2, num_features_frame1=58, num_features_frame2=62)
20:47:40.131 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:40.131 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:40.131 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:40.131 |     INFO |       log_parameters |   current_frame: 71
20:47:40.131 |     INFO |       log_parameters |   prob_dim: 2
20:47:40.131 |     INFO |       log_parameters |   num_features_frame1: 58
20:47:40.131 |     INFO |       log_parameters |   num_features_frame2: 62
20:47:40.131 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:40.132 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:40.132 |     INFO |       log_parameters |   linear_motion: 1
20:47:40.132 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:40.132 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:40.132 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:40.132 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:40.132 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:40.132 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:40.132 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:40.132 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:40.132 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:40.132 |     INFO |       log_parameters |   use_local_density: 0
20:47:40.132 |     INFO |       log_parameters |   nn_window: 5
20:47:40.132 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:40.132 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:40.132 |     INFO |       log_parameters |   len_for_classify: 5
20:47:40.132 |     INFO |       log_parameters |   res_limit: 0.1
20:47:40.132 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:40.132 |     INFO |       log_parameters |   strategy_bd: -1
20:47:40.132 |     INFO |       log_parameters |   lft_cdf: None
20:47:40.132 |     INFO |       log_parameters |   kalman_init_param: None
20:47:40.132 |     INFO |       log_parameters |   diagnostics: None
20:47:40.132 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:40.132 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:40.132 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:40.132 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:40.132 |     INFO |       log_parameters |   coords_shape: (58, 2)
20:47:40.132 |     INFO |       log_parameters |   uncertainties_shape: (58, 2)
20:47:40.132 |     INFO |       log_parameters |   mean_uncertainty: 0.31896134482758615
20:47:40.132 |     INFO |       log_parameters |   uncertainty_range: [0.191569, 0.359477]
20:47:40.132 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:40.132 |     INFO |       log_parameters |   coords_shape: (62, 2)
20:47:40.132 |     INFO |       log_parameters |   uncertainties_shape: (62, 2)
20:47:40.132 |     INFO |       log_parameters |   mean_uncertainty: 0.32122236290322576
20:47:40.132 |     INFO |       log_parameters |   uncertainty_range: [0.235465, 0.360709]
20:47:40.132 |    DEBUG |            log_debug | Initializing Kalman for 62 features, prob_dim=2, state_dim=4
20:47:40.132 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:40.132 |     INFO |       log_parameters |   num_features: 62
20:47:40.132 |     INFO |       log_parameters |   state_dim: 4
20:47:40.132 |     INFO |       log_parameters |   prob_dim: 2
20:47:40.132 |     INFO |       log_parameters |   state_vec_shape: (62, 4)
20:47:40.132 |     INFO |       log_parameters |   state_noise_var_shape: (62, 4, 4)
20:47:40.132 |    DEBUG |            log_debug | State vector shape: (58, 4), Expected: (58, 4)
20:47:40.132 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:40.132 |     INFO |       log_parameters |   num_features_predicted: 58
20:47:40.132 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:40.132 |     INFO |       log_parameters |   brownian_motion_features: 58
20:47:40.132 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:40.133 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:40.133 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:40.133 |     INFO |       log_parameters |   search_radii_shape: (58, 2)
20:47:40.133 |     INFO |       log_parameters |   min_radius: 0.1
20:47:40.133 |     INFO |       log_parameters |   max_radius: 0.1
20:47:40.133 |     INFO |       log_parameters |   mean_radius: 0.09999999999999999
20:47:40.133 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:40.133 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999999
20:47:40.133 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:40.133 |     INFO |       log_parameters |   distance_matrix_shape: (58, 62)
20:47:40.133 |     INFO |       log_parameters |   cost_matrix_shape: (58, 62)
20:47:40.133 |     INFO |       log_parameters |   finite_costs: 3596
20:47:40.133 |     INFO |       log_parameters |   infinite_costs: 0
20:47:40.133 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:40.133 |     INFO |       log_parameters |   min_distance: 3.063768084528919
20:47:40.133 |     INFO |       log_parameters |   max_distance: 126.97148723120584
20:47:40.133 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:40.134 |     INFO |       log_parameters |   motion_costs_shape: (58, 62)
20:47:40.134 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:40.134 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:40.134 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:40.134 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:40.134 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:40.136 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:40.136 |     INFO |       log_parameters |   coords_shape: (58, 2)
20:47:40.136 |     INFO |       log_parameters |   uncertainties_shape: (58, 2)
20:47:40.136 |     INFO |       log_parameters |   mean_uncertainty: 0.31896134482758615
20:47:40.136 |     INFO |       log_parameters |   uncertainty_range: [0.191569, 0.359477]
20:47:40.136 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:40.136 |     INFO |       log_parameters |   coords_shape: (62, 2)
20:47:40.136 |     INFO |       log_parameters |   uncertainties_shape: (62, 2)
20:47:40.136 |     INFO |       log_parameters |   mean_uncertainty: 0.32122236290322576
20:47:40.136 |     INFO |       log_parameters |   uncertainty_range: [0.235465, 0.360709]
20:47:40.136 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:40.136 |     INFO |       log_parameters |   feature_costs_shape: (58, 62)
20:47:40.136 |     INFO |       log_parameters |   feature_costs_min: 1.0000690694689542
20:47:40.136 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:40.136 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:40.136 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:40.136 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:40.136 |     INFO |       log_parameters |   original_shape: (58, 62)
20:47:40.136 |     INFO |       log_parameters |   augmented_shape: (120, 120)
20:47:40.136 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:40.136 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:40.136 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:40.136 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:40.136 |    DEBUG |            log_debug |   observed_positions.shape: (62, 2)
20:47:40.136 |    DEBUG |            log_debug |   num_features (from observed_positions): 62
20:47:40.136 |    DEBUG |            log_debug |   predicted_positions.shape: (58, 2)
20:47:40.136 |    DEBUG |            log_debug |   predicted_velocities.shape: (58, 2)
20:47:40.136 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (62, 4)
20:47:40.136 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=62 but predicted_positions has 58 rows
20:47:40.136 |    ERROR |            log_error |   This will cause index 61 to fail when array only goes to 57
20:47:40.136 |    DEBUG |            log_debug | Kalman update: 62 features, state_dim=4, prob_dim=2
20:47:40.137 |    ERROR |            log_error | Error in enhanced linking: index 58 is out of bounds for axis 0 with size 58
20:47:40.137 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 58 is out of bounds for axis 0 with size 58
20:47:40.137 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0059 seconds
20:47:40.148 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=72, prob_dim=2, num_features_frame1=62, num_features_frame2=57)
20:47:40.148 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:40.148 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:40.148 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:40.148 |     INFO |       log_parameters |   current_frame: 72
20:47:40.148 |     INFO |       log_parameters |   prob_dim: 2
20:47:40.148 |     INFO |       log_parameters |   num_features_frame1: 62
20:47:40.148 |     INFO |       log_parameters |   num_features_frame2: 57
20:47:40.148 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:40.148 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:40.148 |     INFO |       log_parameters |   linear_motion: 1
20:47:40.148 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:40.148 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:40.148 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:40.148 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:40.148 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:40.148 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:40.148 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:40.148 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:40.148 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:40.148 |     INFO |       log_parameters |   use_local_density: 0
20:47:40.148 |     INFO |       log_parameters |   nn_window: 5
20:47:40.148 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:40.148 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:40.148 |     INFO |       log_parameters |   len_for_classify: 5
20:47:40.148 |     INFO |       log_parameters |   res_limit: 0.1
20:47:40.148 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:40.148 |     INFO |       log_parameters |   strategy_bd: -1
20:47:40.148 |     INFO |       log_parameters |   lft_cdf: None
20:47:40.148 |     INFO |       log_parameters |   kalman_init_param: None
20:47:40.148 |     INFO |       log_parameters |   diagnostics: None
20:47:40.148 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:40.148 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:40.148 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:40.148 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:40.148 |     INFO |       log_parameters |   coords_shape: (62, 2)
20:47:40.148 |     INFO |       log_parameters |   uncertainties_shape: (62, 2)
20:47:40.148 |     INFO |       log_parameters |   mean_uncertainty: 0.32122236290322576
20:47:40.149 |     INFO |       log_parameters |   uncertainty_range: [0.235465, 0.360709]
20:47:40.149 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:40.149 |     INFO |       log_parameters |   coords_shape: (57, 2)
20:47:40.149 |     INFO |       log_parameters |   uncertainties_shape: (57, 2)
20:47:40.149 |     INFO |       log_parameters |   mean_uncertainty: 0.31610972807017546
20:47:40.149 |     INFO |       log_parameters |   uncertainty_range: [0.202154, 0.355462]
20:47:40.149 |    DEBUG |            log_debug | Initializing Kalman for 57 features, prob_dim=2, state_dim=4
20:47:40.149 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:40.149 |     INFO |       log_parameters |   num_features: 57
20:47:40.149 |     INFO |       log_parameters |   state_dim: 4
20:47:40.149 |     INFO |       log_parameters |   prob_dim: 2
20:47:40.149 |     INFO |       log_parameters |   state_vec_shape: (57, 4)
20:47:40.149 |     INFO |       log_parameters |   state_noise_var_shape: (57, 4, 4)
20:47:40.149 |    DEBUG |            log_debug | State vector shape: (62, 4), Expected: (62, 4)
20:47:40.149 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:40.149 |     INFO |       log_parameters |   num_features_predicted: 62
20:47:40.149 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:40.149 |     INFO |       log_parameters |   brownian_motion_features: 62
20:47:40.149 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:40.149 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:40.149 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:40.149 |     INFO |       log_parameters |   search_radii_shape: (62, 2)
20:47:40.149 |     INFO |       log_parameters |   min_radius: 0.1
20:47:40.149 |     INFO |       log_parameters |   max_radius: 0.1
20:47:40.149 |     INFO |       log_parameters |   mean_radius: 0.1
20:47:40.149 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:40.149 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.1
20:47:40.150 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:40.150 |     INFO |       log_parameters |   distance_matrix_shape: (62, 57)
20:47:40.150 |     INFO |       log_parameters |   cost_matrix_shape: (62, 57)
20:47:40.150 |     INFO |       log_parameters |   finite_costs: 3534
20:47:40.150 |     INFO |       log_parameters |   infinite_costs: 0
20:47:40.150 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:40.150 |     INFO |       log_parameters |   min_distance: 4.228503168661577
20:47:40.150 |     INFO |       log_parameters |   max_distance: 126.55613354342539
20:47:40.150 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:40.150 |     INFO |       log_parameters |   motion_costs_shape: (62, 57)
20:47:40.150 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:40.150 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:40.150 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:40.150 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:40.150 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:40.152 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:40.152 |     INFO |       log_parameters |   coords_shape: (62, 2)
20:47:40.152 |     INFO |       log_parameters |   uncertainties_shape: (62, 2)
20:47:40.152 |     INFO |       log_parameters |   mean_uncertainty: 0.32122236290322576
20:47:40.152 |     INFO |       log_parameters |   uncertainty_range: [0.235465, 0.360709]
20:47:40.152 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:40.152 |     INFO |       log_parameters |   coords_shape: (57, 2)
20:47:40.152 |     INFO |       log_parameters |   uncertainties_shape: (57, 2)
20:47:40.152 |     INFO |       log_parameters |   mean_uncertainty: 0.31610972807017546
20:47:40.152 |     INFO |       log_parameters |   uncertainty_range: [0.202154, 0.355462]
20:47:40.153 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:40.153 |     INFO |       log_parameters |   feature_costs_shape: (62, 57)
20:47:40.153 |     INFO |       log_parameters |   feature_costs_min: 1.000271214633691
20:47:40.153 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:40.153 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:40.153 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:40.153 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:40.153 |     INFO |       log_parameters |   original_shape: (62, 57)
20:47:40.153 |     INFO |       log_parameters |   augmented_shape: (119, 119)
20:47:40.153 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:40.153 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:40.153 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:40.153 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:40.153 |    DEBUG |            log_debug |   observed_positions.shape: (57, 2)
20:47:40.153 |    DEBUG |            log_debug |   num_features (from observed_positions): 57
20:47:40.153 |    DEBUG |            log_debug |   predicted_positions.shape: (62, 2)
20:47:40.153 |    DEBUG |            log_debug |   predicted_velocities.shape: (62, 2)
20:47:40.153 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (57, 4)
20:47:40.153 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=57 but predicted_positions has 62 rows
20:47:40.153 |    ERROR |            log_error |   This will cause index 56 to fail when array only goes to 61
20:47:40.153 |    DEBUG |            log_debug | Kalman update: 57 features, state_dim=4, prob_dim=2
20:47:40.154 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman update):
20:47:40.154 |     INFO |       log_parameters |   features_updated: 57
20:47:40.154 |     INFO |       log_parameters |   state_dim: 4
20:47:40.154 |     INFO |       log_parameters |   dt_used: 1.0
20:47:40.154 |     INFO |       log_parameters |   process_noise_scale: 1.0
20:47:40.154 |     INFO |       log_parameters |   measurement_noise_scale: 1.0
20:47:40.154 |     INFO |             log_info | Enhanced linking completed successfully for frame 72
20:47:40.154 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0056 seconds
20:47:40.390 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=73, prob_dim=2, num_features_frame1=57, num_features_frame2=59)
20:47:40.390 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:40.390 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:40.390 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:40.390 |     INFO |       log_parameters |   current_frame: 73
20:47:40.390 |     INFO |       log_parameters |   prob_dim: 2
20:47:40.390 |     INFO |       log_parameters |   num_features_frame1: 57
20:47:40.390 |     INFO |       log_parameters |   num_features_frame2: 59
20:47:40.390 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:40.390 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:40.390 |     INFO |       log_parameters |   linear_motion: 1
20:47:40.390 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:40.390 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:40.390 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:40.390 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:40.390 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:40.390 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:40.390 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:40.390 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:40.390 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:40.390 |     INFO |       log_parameters |   use_local_density: 0
20:47:40.390 |     INFO |       log_parameters |   nn_window: 5
20:47:40.390 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:40.390 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:40.390 |     INFO |       log_parameters |   len_for_classify: 5
20:47:40.390 |     INFO |       log_parameters |   res_limit: 0.1
20:47:40.390 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:40.390 |     INFO |       log_parameters |   strategy_bd: -1
20:47:40.390 |     INFO |       log_parameters |   lft_cdf: None
20:47:40.390 |     INFO |       log_parameters |   kalman_init_param: None
20:47:40.390 |     INFO |       log_parameters |   diagnostics: None
20:47:40.390 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:40.390 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:40.390 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:40.390 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:40.390 |     INFO |       log_parameters |   coords_shape: (57, 2)
20:47:40.390 |     INFO |       log_parameters |   uncertainties_shape: (57, 2)
20:47:40.390 |     INFO |       log_parameters |   mean_uncertainty: 0.31610972807017546
20:47:40.390 |     INFO |       log_parameters |   uncertainty_range: [0.202154, 0.355462]
20:47:40.390 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:40.390 |     INFO |       log_parameters |   coords_shape: (59, 2)
20:47:40.390 |     INFO |       log_parameters |   uncertainties_shape: (59, 2)
20:47:40.390 |     INFO |       log_parameters |   mean_uncertainty: 0.31594484745762713
20:47:40.390 |     INFO |       log_parameters |   uncertainty_range: [0.205386, 0.356946]
20:47:40.390 |    DEBUG |            log_debug | Initializing Kalman for 59 features, prob_dim=2, state_dim=4
20:47:40.390 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:40.390 |     INFO |       log_parameters |   num_features: 59
20:47:40.390 |     INFO |       log_parameters |   state_dim: 4
20:47:40.390 |     INFO |       log_parameters |   prob_dim: 2
20:47:40.390 |     INFO |       log_parameters |   state_vec_shape: (59, 4)
20:47:40.390 |     INFO |       log_parameters |   state_noise_var_shape: (59, 4, 4)
20:47:40.390 |    DEBUG |            log_debug | State vector shape: (57, 4), Expected: (57, 4)
20:47:40.391 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:40.391 |     INFO |       log_parameters |   num_features_predicted: 57
20:47:40.391 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:40.391 |     INFO |       log_parameters |   brownian_motion_features: 57
20:47:40.391 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:40.391 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:40.391 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:40.391 |     INFO |       log_parameters |   search_radii_shape: (57, 2)
20:47:40.391 |     INFO |       log_parameters |   min_radius: 0.1
20:47:40.391 |     INFO |       log_parameters |   max_radius: 0.1
20:47:40.391 |     INFO |       log_parameters |   mean_radius: 0.1
20:47:40.391 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:40.391 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.1
20:47:40.391 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:40.391 |     INFO |       log_parameters |   distance_matrix_shape: (57, 59)
20:47:40.391 |     INFO |       log_parameters |   cost_matrix_shape: (57, 59)
20:47:40.391 |     INFO |       log_parameters |   finite_costs: 3363
20:47:40.391 |     INFO |       log_parameters |   infinite_costs: 0
20:47:40.391 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:40.391 |     INFO |       log_parameters |   min_distance: 15.68551756366021
20:47:40.392 |     INFO |       log_parameters |   max_distance: 134.0959342323367
20:47:40.392 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:40.392 |     INFO |       log_parameters |   motion_costs_shape: (57, 59)
20:47:40.392 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:40.392 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:40.392 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:40.392 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:40.392 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:40.393 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:40.393 |     INFO |       log_parameters |   coords_shape: (57, 2)
20:47:40.393 |     INFO |       log_parameters |   uncertainties_shape: (57, 2)
20:47:40.393 |     INFO |       log_parameters |   mean_uncertainty: 0.31610972807017546
20:47:40.393 |     INFO |       log_parameters |   uncertainty_range: [0.202154, 0.355462]
20:47:40.394 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:40.394 |     INFO |       log_parameters |   coords_shape: (59, 2)
20:47:40.394 |     INFO |       log_parameters |   uncertainties_shape: (59, 2)
20:47:40.394 |     INFO |       log_parameters |   mean_uncertainty: 0.31594484745762713
20:47:40.394 |     INFO |       log_parameters |   uncertainty_range: [0.205386, 0.356946]
20:47:40.394 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:40.394 |     INFO |       log_parameters |   feature_costs_shape: (57, 59)
20:47:40.394 |     INFO |       log_parameters |   feature_costs_min: 1.0000712447896365
20:47:40.394 |     INFO |       log_parameters |   feature_costs_max: 5.0
20:47:40.394 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:40.394 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:40.394 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:40.394 |     INFO |       log_parameters |   original_shape: (57, 59)
20:47:40.394 |     INFO |       log_parameters |   augmented_shape: (116, 116)
20:47:40.394 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:40.394 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:40.394 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:40.394 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:40.394 |    DEBUG |            log_debug |   observed_positions.shape: (59, 2)
20:47:40.394 |    DEBUG |            log_debug |   num_features (from observed_positions): 59
20:47:40.394 |    DEBUG |            log_debug |   predicted_positions.shape: (57, 2)
20:47:40.394 |    DEBUG |            log_debug |   predicted_velocities.shape: (57, 2)
20:47:40.394 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (59, 4)
20:47:40.394 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=59 but predicted_positions has 57 rows
20:47:40.394 |    ERROR |            log_error |   This will cause index 58 to fail when array only goes to 56
20:47:40.394 |    DEBUG |            log_debug | Kalman update: 59 features, state_dim=4, prob_dim=2
20:47:40.395 |    ERROR |            log_error | Error in enhanced linking: index 57 is out of bounds for axis 0 with size 57
20:47:40.395 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 57 is out of bounds for axis 0 with size 57
20:47:40.395 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0057 seconds
20:47:40.406 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=74, prob_dim=2, num_features_frame1=59, num_features_frame2=55)
20:47:40.406 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:40.406 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:40.406 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:40.406 |     INFO |       log_parameters |   current_frame: 74
20:47:40.406 |     INFO |       log_parameters |   prob_dim: 2
20:47:40.406 |     INFO |       log_parameters |   num_features_frame1: 59
20:47:40.406 |     INFO |       log_parameters |   num_features_frame2: 55
20:47:40.406 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:40.406 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:40.406 |     INFO |       log_parameters |   linear_motion: 1
20:47:40.406 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:40.406 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:40.406 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:40.406 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:40.406 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:40.406 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:40.406 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:40.406 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:40.406 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:40.406 |     INFO |       log_parameters |   use_local_density: 0
20:47:40.406 |     INFO |       log_parameters |   nn_window: 5
20:47:40.406 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:40.406 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:40.406 |     INFO |       log_parameters |   len_for_classify: 5
20:47:40.406 |     INFO |       log_parameters |   res_limit: 0.1
20:47:40.406 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:40.406 |     INFO |       log_parameters |   strategy_bd: -1
20:47:40.406 |     INFO |       log_parameters |   lft_cdf: None
20:47:40.406 |     INFO |       log_parameters |   kalman_init_param: None
20:47:40.406 |     INFO |       log_parameters |   diagnostics: None
20:47:40.406 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:40.406 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:40.406 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:40.406 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:40.406 |     INFO |       log_parameters |   coords_shape: (59, 2)
20:47:40.406 |     INFO |       log_parameters |   uncertainties_shape: (59, 2)
20:47:40.406 |     INFO |       log_parameters |   mean_uncertainty: 0.31594484745762713
20:47:40.406 |     INFO |       log_parameters |   uncertainty_range: [0.205386, 0.356946]
20:47:40.406 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:40.406 |     INFO |       log_parameters |   coords_shape: (55, 2)
20:47:40.406 |     INFO |       log_parameters |   uncertainties_shape: (55, 2)
20:47:40.406 |     INFO |       log_parameters |   mean_uncertainty: 0.3156003
20:47:40.406 |     INFO |       log_parameters |   uncertainty_range: [0.202547, 0.35611]
20:47:40.406 |    DEBUG |            log_debug | Initializing Kalman for 55 features, prob_dim=2, state_dim=4
20:47:40.406 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:40.406 |     INFO |       log_parameters |   num_features: 55
20:47:40.406 |     INFO |       log_parameters |   state_dim: 4
20:47:40.406 |     INFO |       log_parameters |   prob_dim: 2
20:47:40.406 |     INFO |       log_parameters |   state_vec_shape: (55, 4)
20:47:40.406 |     INFO |       log_parameters |   state_noise_var_shape: (55, 4, 4)
20:47:40.406 |    DEBUG |            log_debug | State vector shape: (59, 4), Expected: (59, 4)
20:47:40.407 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:40.407 |     INFO |       log_parameters |   num_features_predicted: 59
20:47:40.407 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:40.407 |     INFO |       log_parameters |   brownian_motion_features: 59
20:47:40.407 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:40.407 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:40.407 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:40.407 |     INFO |       log_parameters |   search_radii_shape: (59, 2)
20:47:40.407 |     INFO |       log_parameters |   min_radius: 0.1
20:47:40.407 |     INFO |       log_parameters |   max_radius: 0.1
20:47:40.407 |     INFO |       log_parameters |   mean_radius: 0.09999999999999999
20:47:40.407 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:40.407 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999999
20:47:40.408 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:40.408 |     INFO |       log_parameters |   distance_matrix_shape: (59, 55)
20:47:40.408 |     INFO |       log_parameters |   cost_matrix_shape: (59, 55)
20:47:40.408 |     INFO |       log_parameters |   finite_costs: 3245
20:47:40.408 |     INFO |       log_parameters |   infinite_costs: 0
20:47:40.408 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:40.408 |     INFO |       log_parameters |   min_distance: 6.976754997376718
20:47:40.408 |     INFO |       log_parameters |   max_distance: 126.62903721237802
20:47:40.408 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:40.408 |     INFO |       log_parameters |   motion_costs_shape: (59, 55)
20:47:40.408 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:40.408 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:40.408 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:40.408 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:40.408 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:40.410 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:40.410 |     INFO |       log_parameters |   coords_shape: (59, 2)
20:47:40.410 |     INFO |       log_parameters |   uncertainties_shape: (59, 2)
20:47:40.410 |     INFO |       log_parameters |   mean_uncertainty: 0.31594484745762713
20:47:40.410 |     INFO |       log_parameters |   uncertainty_range: [0.205386, 0.356946]
20:47:40.410 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:40.410 |     INFO |       log_parameters |   coords_shape: (55, 2)
20:47:40.410 |     INFO |       log_parameters |   uncertainties_shape: (55, 2)
20:47:40.410 |     INFO |       log_parameters |   mean_uncertainty: 0.3156003
20:47:40.410 |     INFO |       log_parameters |   uncertainty_range: [0.202547, 0.35611]
20:47:40.410 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:40.410 |     INFO |       log_parameters |   feature_costs_shape: (59, 55)
20:47:40.410 |     INFO |       log_parameters |   feature_costs_min: 1.0001103877396875
20:47:40.410 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:40.410 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:40.410 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:40.410 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:40.410 |     INFO |       log_parameters |   original_shape: (59, 55)
20:47:40.410 |     INFO |       log_parameters |   augmented_shape: (114, 114)
20:47:40.410 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:40.410 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:40.410 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:40.410 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:40.410 |    DEBUG |            log_debug |   observed_positions.shape: (55, 2)
20:47:40.410 |    DEBUG |            log_debug |   num_features (from observed_positions): 55
20:47:40.410 |    DEBUG |            log_debug |   predicted_positions.shape: (59, 2)
20:47:40.410 |    DEBUG |            log_debug |   predicted_velocities.shape: (59, 2)
20:47:40.410 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (55, 4)
20:47:40.410 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=55 but predicted_positions has 59 rows
20:47:40.410 |    ERROR |            log_error |   This will cause index 54 to fail when array only goes to 58
20:47:40.410 |    DEBUG |            log_debug | Kalman update: 55 features, state_dim=4, prob_dim=2
20:47:40.411 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman update):
20:47:40.411 |     INFO |       log_parameters |   features_updated: 55
20:47:40.411 |     INFO |       log_parameters |   state_dim: 4
20:47:40.411 |     INFO |       log_parameters |   dt_used: 1.0
20:47:40.411 |     INFO |       log_parameters |   process_noise_scale: 1.0
20:47:40.411 |     INFO |       log_parameters |   measurement_noise_scale: 1.0
20:47:40.411 |     INFO |             log_info | Enhanced linking completed successfully for frame 74
20:47:40.411 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0055 seconds
20:47:40.632 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=75, prob_dim=2, num_features_frame1=55, num_features_frame2=59)
20:47:40.632 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:40.632 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:40.632 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:40.632 |     INFO |       log_parameters |   current_frame: 75
20:47:40.632 |     INFO |       log_parameters |   prob_dim: 2
20:47:40.633 |     INFO |       log_parameters |   num_features_frame1: 55
20:47:40.633 |     INFO |       log_parameters |   num_features_frame2: 59
20:47:40.633 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:40.633 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:40.633 |     INFO |       log_parameters |   linear_motion: 1
20:47:40.633 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:40.633 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:40.633 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:40.633 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:40.633 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:40.633 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:40.633 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:40.633 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:40.633 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:40.633 |     INFO |       log_parameters |   use_local_density: 0
20:47:40.633 |     INFO |       log_parameters |   nn_window: 5
20:47:40.633 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:40.633 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:40.633 |     INFO |       log_parameters |   len_for_classify: 5
20:47:40.633 |     INFO |       log_parameters |   res_limit: 0.1
20:47:40.633 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:40.633 |     INFO |       log_parameters |   strategy_bd: -1
20:47:40.633 |     INFO |       log_parameters |   lft_cdf: None
20:47:40.633 |     INFO |       log_parameters |   kalman_init_param: None
20:47:40.633 |     INFO |       log_parameters |   diagnostics: None
20:47:40.633 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:40.633 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:40.633 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:40.633 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:40.633 |     INFO |       log_parameters |   coords_shape: (55, 2)
20:47:40.633 |     INFO |       log_parameters |   uncertainties_shape: (55, 2)
20:47:40.633 |     INFO |       log_parameters |   mean_uncertainty: 0.3156003
20:47:40.633 |     INFO |       log_parameters |   uncertainty_range: [0.202547, 0.35611]
20:47:40.633 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:40.633 |     INFO |       log_parameters |   coords_shape: (59, 2)
20:47:40.633 |     INFO |       log_parameters |   uncertainties_shape: (59, 2)
20:47:40.633 |     INFO |       log_parameters |   mean_uncertainty: 0.31910884745762713
20:47:40.633 |     INFO |       log_parameters |   uncertainty_range: [0.201107, 0.355916]
20:47:40.633 |    DEBUG |            log_debug | Initializing Kalman for 59 features, prob_dim=2, state_dim=4
20:47:40.633 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:40.633 |     INFO |       log_parameters |   num_features: 59
20:47:40.633 |     INFO |       log_parameters |   state_dim: 4
20:47:40.633 |     INFO |       log_parameters |   prob_dim: 2
20:47:40.633 |     INFO |       log_parameters |   state_vec_shape: (59, 4)
20:47:40.633 |     INFO |       log_parameters |   state_noise_var_shape: (59, 4, 4)
20:47:40.633 |    DEBUG |            log_debug | State vector shape: (55, 4), Expected: (55, 4)
20:47:40.633 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:40.633 |     INFO |       log_parameters |   num_features_predicted: 55
20:47:40.633 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:40.633 |     INFO |       log_parameters |   brownian_motion_features: 55
20:47:40.634 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:40.634 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:40.634 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:40.634 |     INFO |       log_parameters |   search_radii_shape: (55, 2)
20:47:40.634 |     INFO |       log_parameters |   min_radius: 0.1
20:47:40.634 |     INFO |       log_parameters |   max_radius: 0.1
20:47:40.634 |     INFO |       log_parameters |   mean_radius: 0.09999999999999998
20:47:40.634 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:40.634 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999998
20:47:40.634 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:40.634 |     INFO |       log_parameters |   distance_matrix_shape: (55, 59)
20:47:40.634 |     INFO |       log_parameters |   cost_matrix_shape: (55, 59)
20:47:40.634 |     INFO |       log_parameters |   finite_costs: 3245
20:47:40.634 |     INFO |       log_parameters |   infinite_costs: 0
20:47:40.634 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:40.634 |     INFO |       log_parameters |   min_distance: 7.027873305926409
20:47:40.634 |     INFO |       log_parameters |   max_distance: 135.01467984053957
20:47:40.634 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:40.634 |     INFO |       log_parameters |   motion_costs_shape: (55, 59)
20:47:40.634 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:40.634 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:40.634 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:40.635 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:40.635 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:40.636 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:40.636 |     INFO |       log_parameters |   coords_shape: (55, 2)
20:47:40.636 |     INFO |       log_parameters |   uncertainties_shape: (55, 2)
20:47:40.636 |     INFO |       log_parameters |   mean_uncertainty: 0.3156003
20:47:40.636 |     INFO |       log_parameters |   uncertainty_range: [0.202547, 0.35611]
20:47:40.636 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:40.636 |     INFO |       log_parameters |   coords_shape: (59, 2)
20:47:40.636 |     INFO |       log_parameters |   uncertainties_shape: (59, 2)
20:47:40.636 |     INFO |       log_parameters |   mean_uncertainty: 0.31910884745762713
20:47:40.636 |     INFO |       log_parameters |   uncertainty_range: [0.201107, 0.355916]
20:47:40.637 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:40.637 |     INFO |       log_parameters |   feature_costs_shape: (55, 59)
20:47:40.637 |     INFO |       log_parameters |   feature_costs_min: 1.0000419228194666
20:47:40.637 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:40.637 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:40.637 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:40.637 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:40.637 |     INFO |       log_parameters |   original_shape: (55, 59)
20:47:40.637 |     INFO |       log_parameters |   augmented_shape: (114, 114)
20:47:40.637 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:40.637 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:40.637 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:40.637 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:40.637 |    DEBUG |            log_debug |   observed_positions.shape: (59, 2)
20:47:40.637 |    DEBUG |            log_debug |   num_features (from observed_positions): 59
20:47:40.637 |    DEBUG |            log_debug |   predicted_positions.shape: (55, 2)
20:47:40.637 |    DEBUG |            log_debug |   predicted_velocities.shape: (55, 2)
20:47:40.637 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (59, 4)
20:47:40.637 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=59 but predicted_positions has 55 rows
20:47:40.637 |    ERROR |            log_error |   This will cause index 58 to fail when array only goes to 54
20:47:40.637 |    DEBUG |            log_debug | Kalman update: 59 features, state_dim=4, prob_dim=2
20:47:40.638 |    ERROR |            log_error | Error in enhanced linking: index 55 is out of bounds for axis 0 with size 55
20:47:40.638 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 55 is out of bounds for axis 0 with size 55
20:47:40.638 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0056 seconds
20:47:40.649 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=76, prob_dim=2, num_features_frame1=59, num_features_frame2=61)
20:47:40.649 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:40.649 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:40.649 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:40.649 |     INFO |       log_parameters |   current_frame: 76
20:47:40.649 |     INFO |       log_parameters |   prob_dim: 2
20:47:40.649 |     INFO |       log_parameters |   num_features_frame1: 59
20:47:40.649 |     INFO |       log_parameters |   num_features_frame2: 61
20:47:40.649 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:40.649 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:40.649 |     INFO |       log_parameters |   linear_motion: 1
20:47:40.649 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:40.649 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:40.649 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:40.649 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:40.649 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:40.649 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:40.649 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:40.649 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:40.649 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:40.649 |     INFO |       log_parameters |   use_local_density: 0
20:47:40.649 |     INFO |       log_parameters |   nn_window: 5
20:47:40.649 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:40.649 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:40.649 |     INFO |       log_parameters |   len_for_classify: 5
20:47:40.649 |     INFO |       log_parameters |   res_limit: 0.1
20:47:40.649 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:40.649 |     INFO |       log_parameters |   strategy_bd: -1
20:47:40.649 |     INFO |       log_parameters |   lft_cdf: None
20:47:40.649 |     INFO |       log_parameters |   kalman_init_param: None
20:47:40.649 |     INFO |       log_parameters |   diagnostics: None
20:47:40.649 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:40.649 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:40.649 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:40.649 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:40.649 |     INFO |       log_parameters |   coords_shape: (59, 2)
20:47:40.649 |     INFO |       log_parameters |   uncertainties_shape: (59, 2)
20:47:40.649 |     INFO |       log_parameters |   mean_uncertainty: 0.31910884745762713
20:47:40.649 |     INFO |       log_parameters |   uncertainty_range: [0.201107, 0.355916]
20:47:40.649 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:40.649 |     INFO |       log_parameters |   coords_shape: (61, 2)
20:47:40.649 |     INFO |       log_parameters |   uncertainties_shape: (61, 2)
20:47:40.649 |     INFO |       log_parameters |   mean_uncertainty: 0.32002928688524596
20:47:40.649 |     INFO |       log_parameters |   uncertainty_range: [0.196907, 0.353997]
20:47:40.649 |    DEBUG |            log_debug | Initializing Kalman for 61 features, prob_dim=2, state_dim=4
20:47:40.649 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:40.649 |     INFO |       log_parameters |   num_features: 61
20:47:40.649 |     INFO |       log_parameters |   state_dim: 4
20:47:40.649 |     INFO |       log_parameters |   prob_dim: 2
20:47:40.650 |     INFO |       log_parameters |   state_vec_shape: (61, 4)
20:47:40.650 |     INFO |       log_parameters |   state_noise_var_shape: (61, 4, 4)
20:47:40.650 |    DEBUG |            log_debug | State vector shape: (59, 4), Expected: (59, 4)
20:47:40.650 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:40.650 |     INFO |       log_parameters |   num_features_predicted: 59
20:47:40.650 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:40.650 |     INFO |       log_parameters |   brownian_motion_features: 59
20:47:40.650 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:40.650 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:40.650 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:40.650 |     INFO |       log_parameters |   search_radii_shape: (59, 2)
20:47:40.650 |     INFO |       log_parameters |   min_radius: 0.1
20:47:40.650 |     INFO |       log_parameters |   max_radius: 0.1
20:47:40.650 |     INFO |       log_parameters |   mean_radius: 0.09999999999999999
20:47:40.650 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:40.650 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999999
20:47:40.651 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:40.651 |     INFO |       log_parameters |   distance_matrix_shape: (59, 61)
20:47:40.651 |     INFO |       log_parameters |   cost_matrix_shape: (59, 61)
20:47:40.651 |     INFO |       log_parameters |   finite_costs: 3599
20:47:40.651 |     INFO |       log_parameters |   infinite_costs: 0
20:47:40.651 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:40.651 |     INFO |       log_parameters |   min_distance: 3.0039880641420664
20:47:40.651 |     INFO |       log_parameters |   max_distance: 126.54177660172978
20:47:40.651 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:40.651 |     INFO |       log_parameters |   motion_costs_shape: (59, 61)
20:47:40.651 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:40.651 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:40.651 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:40.651 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:40.651 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:40.653 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:40.653 |     INFO |       log_parameters |   coords_shape: (59, 2)
20:47:40.653 |     INFO |       log_parameters |   uncertainties_shape: (59, 2)
20:47:40.653 |     INFO |       log_parameters |   mean_uncertainty: 0.31910884745762713
20:47:40.653 |     INFO |       log_parameters |   uncertainty_range: [0.201107, 0.355916]
20:47:40.653 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:40.653 |     INFO |       log_parameters |   coords_shape: (61, 2)
20:47:40.653 |     INFO |       log_parameters |   uncertainties_shape: (61, 2)
20:47:40.653 |     INFO |       log_parameters |   mean_uncertainty: 0.32002928688524596
20:47:40.653 |     INFO |       log_parameters |   uncertainty_range: [0.196907, 0.353997]
20:47:40.653 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:40.653 |     INFO |       log_parameters |   feature_costs_shape: (59, 61)
20:47:40.654 |     INFO |       log_parameters |   feature_costs_min: 1.0000518241483178
20:47:40.654 |     INFO |       log_parameters |   feature_costs_max: 5.0
20:47:40.654 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:40.654 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:40.654 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:40.654 |     INFO |       log_parameters |   original_shape: (59, 61)
20:47:40.654 |     INFO |       log_parameters |   augmented_shape: (120, 120)
20:47:40.654 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:40.654 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:40.654 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:40.654 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:40.654 |    DEBUG |            log_debug |   observed_positions.shape: (61, 2)
20:47:40.654 |    DEBUG |            log_debug |   num_features (from observed_positions): 61
20:47:40.654 |    DEBUG |            log_debug |   predicted_positions.shape: (59, 2)
20:47:40.654 |    DEBUG |            log_debug |   predicted_velocities.shape: (59, 2)
20:47:40.654 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (61, 4)
20:47:40.654 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=61 but predicted_positions has 59 rows
20:47:40.654 |    ERROR |            log_error |   This will cause index 60 to fail when array only goes to 58
20:47:40.654 |    DEBUG |            log_debug | Kalman update: 61 features, state_dim=4, prob_dim=2
20:47:40.655 |    ERROR |            log_error | Error in enhanced linking: index 59 is out of bounds for axis 0 with size 59
20:47:40.655 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 59 is out of bounds for axis 0 with size 59
20:47:40.655 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0059 seconds
20:47:40.756 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=77, prob_dim=2, num_features_frame1=61, num_features_frame2=53)
20:47:40.756 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:40.756 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:40.756 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:40.756 |     INFO |       log_parameters |   current_frame: 77
20:47:40.756 |     INFO |       log_parameters |   prob_dim: 2
20:47:40.756 |     INFO |       log_parameters |   num_features_frame1: 61
20:47:40.756 |     INFO |       log_parameters |   num_features_frame2: 53
20:47:40.756 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:40.756 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:40.756 |     INFO |       log_parameters |   linear_motion: 1
20:47:40.756 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:40.756 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:40.756 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:40.756 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:40.756 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:40.756 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:40.756 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:40.756 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:40.756 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:40.756 |     INFO |       log_parameters |   use_local_density: 0
20:47:40.756 |     INFO |       log_parameters |   nn_window: 5
20:47:40.756 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:40.756 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:40.756 |     INFO |       log_parameters |   len_for_classify: 5
20:47:40.756 |     INFO |       log_parameters |   res_limit: 0.1
20:47:40.756 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:40.756 |     INFO |       log_parameters |   strategy_bd: -1
20:47:40.756 |     INFO |       log_parameters |   lft_cdf: None
20:47:40.756 |     INFO |       log_parameters |   kalman_init_param: None
20:47:40.756 |     INFO |       log_parameters |   diagnostics: None
20:47:40.756 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:40.756 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:40.756 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:40.757 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:40.757 |     INFO |       log_parameters |   coords_shape: (61, 2)
20:47:40.757 |     INFO |       log_parameters |   uncertainties_shape: (61, 2)
20:47:40.757 |     INFO |       log_parameters |   mean_uncertainty: 0.32002928688524596
20:47:40.757 |     INFO |       log_parameters |   uncertainty_range: [0.196907, 0.353997]
20:47:40.757 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:40.757 |     INFO |       log_parameters |   coords_shape: (53, 2)
20:47:40.757 |     INFO |       log_parameters |   uncertainties_shape: (53, 2)
20:47:40.757 |     INFO |       log_parameters |   mean_uncertainty: 0.31858709433962257
20:47:40.757 |     INFO |       log_parameters |   uncertainty_range: [0.204474, 0.353299]
20:47:40.757 |    DEBUG |            log_debug | Initializing Kalman for 53 features, prob_dim=2, state_dim=4
20:47:40.757 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:40.757 |     INFO |       log_parameters |   num_features: 53
20:47:40.757 |     INFO |       log_parameters |   state_dim: 4
20:47:40.757 |     INFO |       log_parameters |   prob_dim: 2
20:47:40.757 |     INFO |       log_parameters |   state_vec_shape: (53, 4)
20:47:40.757 |     INFO |       log_parameters |   state_noise_var_shape: (53, 4, 4)
20:47:40.757 |    DEBUG |            log_debug | State vector shape: (61, 4), Expected: (61, 4)
20:47:40.757 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:40.757 |     INFO |       log_parameters |   num_features_predicted: 61
20:47:40.757 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:40.757 |     INFO |       log_parameters |   brownian_motion_features: 61
20:47:40.757 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:40.757 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:40.757 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:40.757 |     INFO |       log_parameters |   search_radii_shape: (61, 2)
20:47:40.757 |     INFO |       log_parameters |   min_radius: 0.1
20:47:40.758 |     INFO |       log_parameters |   max_radius: 0.1
20:47:40.758 |     INFO |       log_parameters |   mean_radius: 0.1
20:47:40.758 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:40.758 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.1
20:47:40.758 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:40.758 |     INFO |       log_parameters |   distance_matrix_shape: (61, 53)
20:47:40.758 |     INFO |       log_parameters |   cost_matrix_shape: (61, 53)
20:47:40.758 |     INFO |       log_parameters |   finite_costs: 3233
20:47:40.758 |     INFO |       log_parameters |   infinite_costs: 0
20:47:40.758 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:40.758 |     INFO |       log_parameters |   min_distance: 2.9206890983410063
20:47:40.758 |     INFO |       log_parameters |   max_distance: 126.91831958715639
20:47:40.758 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:40.758 |     INFO |       log_parameters |   motion_costs_shape: (61, 53)
20:47:40.758 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:40.758 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:40.758 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:40.758 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:40.758 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:40.760 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:40.760 |     INFO |       log_parameters |   coords_shape: (61, 2)
20:47:40.760 |     INFO |       log_parameters |   uncertainties_shape: (61, 2)
20:47:40.760 |     INFO |       log_parameters |   mean_uncertainty: 0.32002928688524596
20:47:40.760 |     INFO |       log_parameters |   uncertainty_range: [0.196907, 0.353997]
20:47:40.760 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:40.760 |     INFO |       log_parameters |   coords_shape: (53, 2)
20:47:40.760 |     INFO |       log_parameters |   uncertainties_shape: (53, 2)
20:47:40.760 |     INFO |       log_parameters |   mean_uncertainty: 0.31858709433962257
20:47:40.760 |     INFO |       log_parameters |   uncertainty_range: [0.204474, 0.353299]
20:47:40.761 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:40.761 |     INFO |       log_parameters |   feature_costs_shape: (61, 53)
20:47:40.761 |     INFO |       log_parameters |   feature_costs_min: 1.0000278033943268
20:47:40.761 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:40.761 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:40.761 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:40.761 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:40.761 |     INFO |       log_parameters |   original_shape: (61, 53)
20:47:40.761 |     INFO |       log_parameters |   augmented_shape: (114, 114)
20:47:40.761 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:40.761 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:40.761 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:40.761 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:40.761 |    DEBUG |            log_debug |   observed_positions.shape: (53, 2)
20:47:40.761 |    DEBUG |            log_debug |   num_features (from observed_positions): 53
20:47:40.761 |    DEBUG |            log_debug |   predicted_positions.shape: (61, 2)
20:47:40.761 |    DEBUG |            log_debug |   predicted_velocities.shape: (61, 2)
20:47:40.761 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (53, 4)
20:47:40.761 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=53 but predicted_positions has 61 rows
20:47:40.761 |    ERROR |            log_error |   This will cause index 52 to fail when array only goes to 60
20:47:40.761 |    DEBUG |            log_debug | Kalman update: 53 features, state_dim=4, prob_dim=2
20:47:40.762 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman update):
20:47:40.762 |     INFO |       log_parameters |   features_updated: 53
20:47:40.762 |     INFO |       log_parameters |   state_dim: 4
20:47:40.762 |     INFO |       log_parameters |   dt_used: 1.0
20:47:40.762 |     INFO |       log_parameters |   process_noise_scale: 1.0
20:47:40.762 |     INFO |       log_parameters |   measurement_noise_scale: 1.0
20:47:40.762 |     INFO |             log_info | Enhanced linking completed successfully for frame 77
20:47:40.762 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0056 seconds
20:47:40.975 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=78, prob_dim=2, num_features_frame1=53, num_features_frame2=58)
20:47:40.975 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:40.975 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:40.975 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:40.975 |     INFO |       log_parameters |   current_frame: 78
20:47:40.975 |     INFO |       log_parameters |   prob_dim: 2
20:47:40.975 |     INFO |       log_parameters |   num_features_frame1: 53
20:47:40.975 |     INFO |       log_parameters |   num_features_frame2: 58
20:47:40.975 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:40.975 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:40.975 |     INFO |       log_parameters |   linear_motion: 1
20:47:40.975 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:40.975 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:40.975 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:40.975 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:40.975 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:40.975 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:40.975 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:40.975 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:40.975 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:40.975 |     INFO |       log_parameters |   use_local_density: 0
20:47:40.975 |     INFO |       log_parameters |   nn_window: 5
20:47:40.975 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:40.975 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:40.975 |     INFO |       log_parameters |   len_for_classify: 5
20:47:40.975 |     INFO |       log_parameters |   res_limit: 0.1
20:47:40.975 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:40.975 |     INFO |       log_parameters |   strategy_bd: -1
20:47:40.975 |     INFO |       log_parameters |   lft_cdf: None
20:47:40.975 |     INFO |       log_parameters |   kalman_init_param: None
20:47:40.975 |     INFO |       log_parameters |   diagnostics: None
20:47:40.975 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:40.975 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:40.975 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:40.975 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:40.975 |     INFO |       log_parameters |   coords_shape: (53, 2)
20:47:40.975 |     INFO |       log_parameters |   uncertainties_shape: (53, 2)
20:47:40.975 |     INFO |       log_parameters |   mean_uncertainty: 0.31858709433962257
20:47:40.975 |     INFO |       log_parameters |   uncertainty_range: [0.204474, 0.353299]
20:47:40.975 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:40.975 |     INFO |       log_parameters |   coords_shape: (58, 2)
20:47:40.975 |     INFO |       log_parameters |   uncertainties_shape: (58, 2)
20:47:40.975 |     INFO |       log_parameters |   mean_uncertainty: 0.3195676637931034
20:47:40.975 |     INFO |       log_parameters |   uncertainty_range: [0.200397, 0.356341]
20:47:40.975 |    DEBUG |            log_debug | Initializing Kalman for 58 features, prob_dim=2, state_dim=4
20:47:40.975 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:40.975 |     INFO |       log_parameters |   num_features: 58
20:47:40.975 |     INFO |       log_parameters |   state_dim: 4
20:47:40.975 |     INFO |       log_parameters |   prob_dim: 2
20:47:40.975 |     INFO |       log_parameters |   state_vec_shape: (58, 4)
20:47:40.975 |     INFO |       log_parameters |   state_noise_var_shape: (58, 4, 4)
20:47:40.975 |    DEBUG |            log_debug | State vector shape: (53, 4), Expected: (53, 4)
20:47:40.976 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:40.976 |     INFO |       log_parameters |   num_features_predicted: 53
20:47:40.976 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:40.976 |     INFO |       log_parameters |   brownian_motion_features: 53
20:47:40.976 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:40.976 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:40.976 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:40.976 |     INFO |       log_parameters |   search_radii_shape: (53, 2)
20:47:40.976 |     INFO |       log_parameters |   min_radius: 0.1
20:47:40.976 |     INFO |       log_parameters |   max_radius: 0.1
20:47:40.976 |     INFO |       log_parameters |   mean_radius: 0.09999999999999999
20:47:40.976 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:40.976 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999999
20:47:40.977 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:40.977 |     INFO |       log_parameters |   distance_matrix_shape: (53, 58)
20:47:40.977 |     INFO |       log_parameters |   cost_matrix_shape: (53, 58)
20:47:40.977 |     INFO |       log_parameters |   finite_costs: 3074
20:47:40.977 |     INFO |       log_parameters |   infinite_costs: 0
20:47:40.977 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:40.977 |     INFO |       log_parameters |   min_distance: 7.256643281050819
20:47:40.977 |     INFO |       log_parameters |   max_distance: 126.60782949176846
20:47:40.977 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:40.977 |     INFO |       log_parameters |   motion_costs_shape: (53, 58)
20:47:40.977 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:40.977 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:40.977 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:40.977 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:40.977 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:40.978 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:40.978 |     INFO |       log_parameters |   coords_shape: (53, 2)
20:47:40.979 |     INFO |       log_parameters |   uncertainties_shape: (53, 2)
20:47:40.979 |     INFO |       log_parameters |   mean_uncertainty: 0.31858709433962257
20:47:40.979 |     INFO |       log_parameters |   uncertainty_range: [0.204474, 0.353299]
20:47:40.979 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:40.979 |     INFO |       log_parameters |   coords_shape: (58, 2)
20:47:40.979 |     INFO |       log_parameters |   uncertainties_shape: (58, 2)
20:47:40.979 |     INFO |       log_parameters |   mean_uncertainty: 0.3195676637931034
20:47:40.979 |     INFO |       log_parameters |   uncertainty_range: [0.200397, 0.356341]
20:47:40.979 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:40.979 |     INFO |       log_parameters |   feature_costs_shape: (53, 58)
20:47:40.979 |     INFO |       log_parameters |   feature_costs_min: 1.0000445376379556
20:47:40.979 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:40.979 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:40.979 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:40.979 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:40.979 |     INFO |       log_parameters |   original_shape: (53, 58)
20:47:40.979 |     INFO |       log_parameters |   augmented_shape: (111, 111)
20:47:40.979 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:40.979 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:40.979 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:40.979 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:40.979 |    DEBUG |            log_debug |   observed_positions.shape: (58, 2)
20:47:40.979 |    DEBUG |            log_debug |   num_features (from observed_positions): 58
20:47:40.979 |    DEBUG |            log_debug |   predicted_positions.shape: (53, 2)
20:47:40.979 |    DEBUG |            log_debug |   predicted_velocities.shape: (53, 2)
20:47:40.979 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (58, 4)
20:47:40.979 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=58 but predicted_positions has 53 rows
20:47:40.979 |    ERROR |            log_error |   This will cause index 57 to fail when array only goes to 52
20:47:40.979 |    DEBUG |            log_debug | Kalman update: 58 features, state_dim=4, prob_dim=2
20:47:40.980 |    ERROR |            log_error | Error in enhanced linking: index 53 is out of bounds for axis 0 with size 53
20:47:40.980 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 53 is out of bounds for axis 0 with size 53
20:47:40.980 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0054 seconds
20:47:40.991 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=79, prob_dim=2, num_features_frame1=58, num_features_frame2=58)
20:47:40.991 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:40.991 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:40.991 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:40.991 |     INFO |       log_parameters |   current_frame: 79
20:47:40.991 |     INFO |       log_parameters |   prob_dim: 2
20:47:40.991 |     INFO |       log_parameters |   num_features_frame1: 58
20:47:40.991 |     INFO |       log_parameters |   num_features_frame2: 58
20:47:40.991 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:40.991 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:40.991 |     INFO |       log_parameters |   linear_motion: 1
20:47:40.991 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:40.991 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:40.991 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:40.991 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:40.991 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:40.991 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:40.991 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:40.991 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:40.991 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:40.991 |     INFO |       log_parameters |   use_local_density: 0
20:47:40.991 |     INFO |       log_parameters |   nn_window: 5
20:47:40.991 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:40.991 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:40.991 |     INFO |       log_parameters |   len_for_classify: 5
20:47:40.991 |     INFO |       log_parameters |   res_limit: 0.1
20:47:40.991 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:40.991 |     INFO |       log_parameters |   strategy_bd: -1
20:47:40.991 |     INFO |       log_parameters |   lft_cdf: None
20:47:40.991 |     INFO |       log_parameters |   kalman_init_param: None
20:47:40.991 |     INFO |       log_parameters |   diagnostics: None
20:47:40.991 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:40.991 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:40.991 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:40.991 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:40.991 |     INFO |       log_parameters |   coords_shape: (58, 2)
20:47:40.991 |     INFO |       log_parameters |   uncertainties_shape: (58, 2)
20:47:40.991 |     INFO |       log_parameters |   mean_uncertainty: 0.3195676637931034
20:47:40.991 |     INFO |       log_parameters |   uncertainty_range: [0.200397, 0.356341]
20:47:40.991 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:40.991 |     INFO |       log_parameters |   coords_shape: (58, 2)
20:47:40.991 |     INFO |       log_parameters |   uncertainties_shape: (58, 2)
20:47:40.991 |     INFO |       log_parameters |   mean_uncertainty: 0.31689497413793094
20:47:40.991 |     INFO |       log_parameters |   uncertainty_range: [0.202613, 0.357333]
20:47:40.991 |    DEBUG |            log_debug | Initializing Kalman for 58 features, prob_dim=2, state_dim=4
20:47:40.991 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:40.991 |     INFO |       log_parameters |   num_features: 58
20:47:40.991 |     INFO |       log_parameters |   state_dim: 4
20:47:40.991 |     INFO |       log_parameters |   prob_dim: 2
20:47:40.991 |     INFO |       log_parameters |   state_vec_shape: (58, 4)
20:47:40.991 |     INFO |       log_parameters |   state_noise_var_shape: (58, 4, 4)
20:47:40.991 |    DEBUG |            log_debug | State vector shape: (58, 4), Expected: (58, 4)
20:47:40.992 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:40.992 |     INFO |       log_parameters |   num_features_predicted: 58
20:47:40.992 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:40.992 |     INFO |       log_parameters |   brownian_motion_features: 58
20:47:40.992 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:40.992 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:40.992 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:40.992 |     INFO |       log_parameters |   search_radii_shape: (58, 2)
20:47:40.992 |     INFO |       log_parameters |   min_radius: 0.1
20:47:40.992 |     INFO |       log_parameters |   max_radius: 0.1
20:47:40.992 |     INFO |       log_parameters |   mean_radius: 0.09999999999999999
20:47:40.992 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:40.992 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999999
20:47:40.993 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:40.993 |     INFO |       log_parameters |   distance_matrix_shape: (58, 58)
20:47:40.993 |     INFO |       log_parameters |   cost_matrix_shape: (58, 58)
20:47:40.993 |     INFO |       log_parameters |   finite_costs: 3364
20:47:40.993 |     INFO |       log_parameters |   infinite_costs: 0
20:47:40.993 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:40.993 |     INFO |       log_parameters |   min_distance: 7.581899810536473
20:47:40.993 |     INFO |       log_parameters |   max_distance: 126.60749689393518
20:47:40.993 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:40.993 |     INFO |       log_parameters |   motion_costs_shape: (58, 58)
20:47:40.993 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:40.993 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:40.993 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:40.993 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:40.993 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:40.995 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:40.995 |     INFO |       log_parameters |   coords_shape: (58, 2)
20:47:40.995 |     INFO |       log_parameters |   uncertainties_shape: (58, 2)
20:47:40.995 |     INFO |       log_parameters |   mean_uncertainty: 0.3195676637931034
20:47:40.995 |     INFO |       log_parameters |   uncertainty_range: [0.200397, 0.356341]
20:47:40.995 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:40.995 |     INFO |       log_parameters |   coords_shape: (58, 2)
20:47:40.995 |     INFO |       log_parameters |   uncertainties_shape: (58, 2)
20:47:40.995 |     INFO |       log_parameters |   mean_uncertainty: 0.31689497413793094
20:47:40.995 |     INFO |       log_parameters |   uncertainty_range: [0.202613, 0.357333]
20:47:40.995 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:40.995 |     INFO |       log_parameters |   feature_costs_shape: (58, 58)
20:47:40.995 |     INFO |       log_parameters |   feature_costs_min: 1.0000234337608143
20:47:40.995 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:40.995 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:40.995 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:40.995 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:40.995 |     INFO |       log_parameters |   original_shape: (58, 58)
20:47:40.995 |     INFO |       log_parameters |   augmented_shape: (116, 116)
20:47:40.995 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:40.995 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:40.995 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:40.995 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:40.995 |    DEBUG |            log_debug |   observed_positions.shape: (58, 2)
20:47:40.995 |    DEBUG |            log_debug |   num_features (from observed_positions): 58
20:47:40.995 |    DEBUG |            log_debug |   predicted_positions.shape: (58, 2)
20:47:40.995 |    DEBUG |            log_debug |   predicted_velocities.shape: (58, 2)
20:47:40.995 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (58, 4)
20:47:40.995 |    DEBUG |            log_debug | Kalman update: 58 features, state_dim=4, prob_dim=2
20:47:40.996 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman update):
20:47:40.996 |     INFO |       log_parameters |   features_updated: 58
20:47:40.996 |     INFO |       log_parameters |   state_dim: 4
20:47:40.996 |     INFO |       log_parameters |   dt_used: 1.0
20:47:40.996 |     INFO |       log_parameters |   process_noise_scale: 1.0
20:47:40.996 |     INFO |       log_parameters |   measurement_noise_scale: 1.0
20:47:40.996 |     INFO |             log_info | Enhanced linking completed successfully for frame 79
20:47:40.996 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0055 seconds
20:47:41.232 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=80, prob_dim=2, num_features_frame1=58, num_features_frame2=50)
20:47:41.232 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:41.232 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:41.232 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:41.232 |     INFO |       log_parameters |   current_frame: 80
20:47:41.232 |     INFO |       log_parameters |   prob_dim: 2
20:47:41.232 |     INFO |       log_parameters |   num_features_frame1: 58
20:47:41.232 |     INFO |       log_parameters |   num_features_frame2: 50
20:47:41.232 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:41.232 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:41.232 |     INFO |       log_parameters |   linear_motion: 1
20:47:41.232 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:41.232 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:41.232 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:41.232 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:41.232 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:41.232 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:41.232 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:41.232 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:41.232 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:41.232 |     INFO |       log_parameters |   use_local_density: 0
20:47:41.232 |     INFO |       log_parameters |   nn_window: 5
20:47:41.232 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:41.232 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:41.233 |     INFO |       log_parameters |   len_for_classify: 5
20:47:41.233 |     INFO |       log_parameters |   res_limit: 0.1
20:47:41.233 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:41.233 |     INFO |       log_parameters |   strategy_bd: -1
20:47:41.233 |     INFO |       log_parameters |   lft_cdf: None
20:47:41.233 |     INFO |       log_parameters |   kalman_init_param: None
20:47:41.233 |     INFO |       log_parameters |   diagnostics: None
20:47:41.233 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:41.233 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:41.233 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:41.233 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:41.233 |     INFO |       log_parameters |   coords_shape: (58, 2)
20:47:41.233 |     INFO |       log_parameters |   uncertainties_shape: (58, 2)
20:47:41.233 |     INFO |       log_parameters |   mean_uncertainty: 0.31689497413793094
20:47:41.233 |     INFO |       log_parameters |   uncertainty_range: [0.202613, 0.357333]
20:47:41.233 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:41.233 |     INFO |       log_parameters |   coords_shape: (50, 2)
20:47:41.233 |     INFO |       log_parameters |   uncertainties_shape: (50, 2)
20:47:41.233 |     INFO |       log_parameters |   mean_uncertainty: 0.31595997
20:47:41.233 |     INFO |       log_parameters |   uncertainty_range: [0.200856, 0.358106]
20:47:41.233 |    DEBUG |            log_debug | Initializing Kalman for 50 features, prob_dim=2, state_dim=4
20:47:41.233 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:41.233 |     INFO |       log_parameters |   num_features: 50
20:47:41.233 |     INFO |       log_parameters |   state_dim: 4
20:47:41.233 |     INFO |       log_parameters |   prob_dim: 2
20:47:41.233 |     INFO |       log_parameters |   state_vec_shape: (50, 4)
20:47:41.233 |     INFO |       log_parameters |   state_noise_var_shape: (50, 4, 4)
20:47:41.233 |    DEBUG |            log_debug | State vector shape: (58, 4), Expected: (58, 4)
20:47:41.233 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:41.233 |     INFO |       log_parameters |   num_features_predicted: 58
20:47:41.233 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:41.233 |     INFO |       log_parameters |   brownian_motion_features: 58
20:47:41.233 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:41.233 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:41.234 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:41.234 |     INFO |       log_parameters |   search_radii_shape: (58, 2)
20:47:41.234 |     INFO |       log_parameters |   min_radius: 0.1
20:47:41.234 |     INFO |       log_parameters |   max_radius: 0.1
20:47:41.234 |     INFO |       log_parameters |   mean_radius: 0.09999999999999999
20:47:41.234 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:41.234 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999999
20:47:41.234 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:41.234 |     INFO |       log_parameters |   distance_matrix_shape: (58, 50)
20:47:41.234 |     INFO |       log_parameters |   cost_matrix_shape: (58, 50)
20:47:41.234 |     INFO |       log_parameters |   finite_costs: 2900
20:47:41.234 |     INFO |       log_parameters |   infinite_costs: 0
20:47:41.234 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:41.234 |     INFO |       log_parameters |   min_distance: 21.19975717708637
20:47:41.234 |     INFO |       log_parameters |   max_distance: 126.69773560851367
20:47:41.234 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:41.234 |     INFO |       log_parameters |   motion_costs_shape: (58, 50)
20:47:41.234 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:41.234 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:41.234 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:41.234 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:41.234 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:41.236 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:41.236 |     INFO |       log_parameters |   coords_shape: (58, 2)
20:47:41.236 |     INFO |       log_parameters |   uncertainties_shape: (58, 2)
20:47:41.236 |     INFO |       log_parameters |   mean_uncertainty: 0.31689497413793094
20:47:41.236 |     INFO |       log_parameters |   uncertainty_range: [0.202613, 0.357333]
20:47:41.236 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:41.236 |     INFO |       log_parameters |   coords_shape: (50, 2)
20:47:41.236 |     INFO |       log_parameters |   uncertainties_shape: (50, 2)
20:47:41.236 |     INFO |       log_parameters |   mean_uncertainty: 0.31595997
20:47:41.236 |     INFO |       log_parameters |   uncertainty_range: [0.200856, 0.358106]
20:47:41.236 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:41.236 |     INFO |       log_parameters |   feature_costs_shape: (58, 50)
20:47:41.236 |     INFO |       log_parameters |   feature_costs_min: 1.0000559947171557
20:47:41.236 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:41.236 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:41.236 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:41.236 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:41.236 |     INFO |       log_parameters |   original_shape: (58, 50)
20:47:41.236 |     INFO |       log_parameters |   augmented_shape: (108, 108)
20:47:41.236 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:41.236 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:41.236 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:41.236 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:41.236 |    DEBUG |            log_debug |   observed_positions.shape: (50, 2)
20:47:41.236 |    DEBUG |            log_debug |   num_features (from observed_positions): 50
20:47:41.236 |    DEBUG |            log_debug |   predicted_positions.shape: (58, 2)
20:47:41.236 |    DEBUG |            log_debug |   predicted_velocities.shape: (58, 2)
20:47:41.236 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (50, 4)
20:47:41.236 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=50 but predicted_positions has 58 rows
20:47:41.236 |    ERROR |            log_error |   This will cause index 49 to fail when array only goes to 57
20:47:41.236 |    DEBUG |            log_debug | Kalman update: 50 features, state_dim=4, prob_dim=2
20:47:41.237 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman update):
20:47:41.237 |     INFO |       log_parameters |   features_updated: 50
20:47:41.237 |     INFO |       log_parameters |   state_dim: 4
20:47:41.237 |     INFO |       log_parameters |   dt_used: 1.0
20:47:41.237 |     INFO |       log_parameters |   process_noise_scale: 1.0
20:47:41.237 |     INFO |       log_parameters |   measurement_noise_scale: 1.0
20:47:41.237 |     INFO |             log_info | Enhanced linking completed successfully for frame 80
20:47:41.237 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0051 seconds
20:47:41.431 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=81, prob_dim=2, num_features_frame1=50, num_features_frame2=52)
20:47:41.431 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:41.431 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:41.431 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:41.431 |     INFO |       log_parameters |   current_frame: 81
20:47:41.431 |     INFO |       log_parameters |   prob_dim: 2
20:47:41.431 |     INFO |       log_parameters |   num_features_frame1: 50
20:47:41.431 |     INFO |       log_parameters |   num_features_frame2: 52
20:47:41.431 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:41.431 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:41.431 |     INFO |       log_parameters |   linear_motion: 1
20:47:41.431 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:41.431 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:41.431 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:41.431 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:41.431 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:41.431 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:41.431 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:41.431 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:41.431 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:41.431 |     INFO |       log_parameters |   use_local_density: 0
20:47:41.431 |     INFO |       log_parameters |   nn_window: 5
20:47:41.431 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:41.431 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:41.431 |     INFO |       log_parameters |   len_for_classify: 5
20:47:41.431 |     INFO |       log_parameters |   res_limit: 0.1
20:47:41.431 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:41.431 |     INFO |       log_parameters |   strategy_bd: -1
20:47:41.431 |     INFO |       log_parameters |   lft_cdf: None
20:47:41.431 |     INFO |       log_parameters |   kalman_init_param: None
20:47:41.431 |     INFO |       log_parameters |   diagnostics: None
20:47:41.431 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:41.431 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:41.431 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:41.431 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:41.431 |     INFO |       log_parameters |   coords_shape: (50, 2)
20:47:41.431 |     INFO |       log_parameters |   uncertainties_shape: (50, 2)
20:47:41.431 |     INFO |       log_parameters |   mean_uncertainty: 0.31595997
20:47:41.431 |     INFO |       log_parameters |   uncertainty_range: [0.200856, 0.358106]
20:47:41.431 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:41.431 |     INFO |       log_parameters |   coords_shape: (52, 2)
20:47:41.431 |     INFO |       log_parameters |   uncertainties_shape: (52, 2)
20:47:41.431 |     INFO |       log_parameters |   mean_uncertainty: 0.3132635192307692
20:47:41.431 |     INFO |       log_parameters |   uncertainty_range: [0.205105, 0.356951]
20:47:41.431 |    DEBUG |            log_debug | Initializing Kalman for 52 features, prob_dim=2, state_dim=4
20:47:41.431 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:41.431 |     INFO |       log_parameters |   num_features: 52
20:47:41.431 |     INFO |       log_parameters |   state_dim: 4
20:47:41.431 |     INFO |       log_parameters |   prob_dim: 2
20:47:41.431 |     INFO |       log_parameters |   state_vec_shape: (52, 4)
20:47:41.431 |     INFO |       log_parameters |   state_noise_var_shape: (52, 4, 4)
20:47:41.431 |    DEBUG |            log_debug | State vector shape: (50, 4), Expected: (50, 4)
20:47:41.432 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:41.432 |     INFO |       log_parameters |   num_features_predicted: 50
20:47:41.432 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:41.432 |     INFO |       log_parameters |   brownian_motion_features: 50
20:47:41.432 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:41.432 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:41.432 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:41.432 |     INFO |       log_parameters |   search_radii_shape: (50, 2)
20:47:41.432 |     INFO |       log_parameters |   min_radius: 0.1
20:47:41.432 |     INFO |       log_parameters |   max_radius: 0.1
20:47:41.432 |     INFO |       log_parameters |   mean_radius: 0.09999999999999998
20:47:41.432 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:41.432 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999998
20:47:41.433 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:41.433 |     INFO |       log_parameters |   distance_matrix_shape: (50, 52)
20:47:41.433 |     INFO |       log_parameters |   cost_matrix_shape: (50, 52)
20:47:41.433 |     INFO |       log_parameters |   finite_costs: 2600
20:47:41.433 |     INFO |       log_parameters |   infinite_costs: 0
20:47:41.433 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:41.433 |     INFO |       log_parameters |   min_distance: 2.654862498637924
20:47:41.433 |     INFO |       log_parameters |   max_distance: 126.7016490119591
20:47:41.433 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:41.433 |     INFO |       log_parameters |   motion_costs_shape: (50, 52)
20:47:41.433 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:41.433 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:41.433 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:41.433 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:41.433 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:41.434 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:41.434 |     INFO |       log_parameters |   coords_shape: (50, 2)
20:47:41.434 |     INFO |       log_parameters |   uncertainties_shape: (50, 2)
20:47:41.434 |     INFO |       log_parameters |   mean_uncertainty: 0.31595997
20:47:41.434 |     INFO |       log_parameters |   uncertainty_range: [0.200856, 0.358106]
20:47:41.434 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:41.434 |     INFO |       log_parameters |   coords_shape: (52, 2)
20:47:41.434 |     INFO |       log_parameters |   uncertainties_shape: (52, 2)
20:47:41.434 |     INFO |       log_parameters |   mean_uncertainty: 0.3132635192307692
20:47:41.434 |     INFO |       log_parameters |   uncertainty_range: [0.205105, 0.356951]
20:47:41.435 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:41.435 |     INFO |       log_parameters |   feature_costs_shape: (50, 52)
20:47:41.435 |     INFO |       log_parameters |   feature_costs_min: 1.0000514581018762
20:47:41.435 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:41.435 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:41.435 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:41.435 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:41.435 |     INFO |       log_parameters |   original_shape: (50, 52)
20:47:41.435 |     INFO |       log_parameters |   augmented_shape: (102, 102)
20:47:41.435 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:41.435 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:41.435 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:41.435 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:41.435 |    DEBUG |            log_debug |   observed_positions.shape: (52, 2)
20:47:41.435 |    DEBUG |            log_debug |   num_features (from observed_positions): 52
20:47:41.435 |    DEBUG |            log_debug |   predicted_positions.shape: (50, 2)
20:47:41.435 |    DEBUG |            log_debug |   predicted_velocities.shape: (50, 2)
20:47:41.435 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (52, 4)
20:47:41.435 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=52 but predicted_positions has 50 rows
20:47:41.435 |    ERROR |            log_error |   This will cause index 51 to fail when array only goes to 49
20:47:41.435 |    DEBUG |            log_debug | Kalman update: 52 features, state_dim=4, prob_dim=2
20:47:41.436 |    ERROR |            log_error | Error in enhanced linking: index 50 is out of bounds for axis 0 with size 50
20:47:41.436 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 50 is out of bounds for axis 0 with size 50
20:47:41.436 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0049 seconds
20:47:41.446 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=82, prob_dim=2, num_features_frame1=52, num_features_frame2=55)
20:47:41.446 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:41.446 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:41.446 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:41.446 |     INFO |       log_parameters |   current_frame: 82
20:47:41.446 |     INFO |       log_parameters |   prob_dim: 2
20:47:41.446 |     INFO |       log_parameters |   num_features_frame1: 52
20:47:41.446 |     INFO |       log_parameters |   num_features_frame2: 55
20:47:41.446 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:41.446 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:41.446 |     INFO |       log_parameters |   linear_motion: 1
20:47:41.446 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:41.446 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:41.446 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:41.446 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:41.446 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:41.446 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:41.446 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:41.446 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:41.446 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:41.446 |     INFO |       log_parameters |   use_local_density: 0
20:47:41.446 |     INFO |       log_parameters |   nn_window: 5
20:47:41.446 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:41.446 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:41.446 |     INFO |       log_parameters |   len_for_classify: 5
20:47:41.446 |     INFO |       log_parameters |   res_limit: 0.1
20:47:41.446 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:41.446 |     INFO |       log_parameters |   strategy_bd: -1
20:47:41.446 |     INFO |       log_parameters |   lft_cdf: None
20:47:41.446 |     INFO |       log_parameters |   kalman_init_param: None
20:47:41.446 |     INFO |       log_parameters |   diagnostics: None
20:47:41.446 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:41.446 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:41.446 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:41.446 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:41.446 |     INFO |       log_parameters |   coords_shape: (52, 2)
20:47:41.446 |     INFO |       log_parameters |   uncertainties_shape: (52, 2)
20:47:41.446 |     INFO |       log_parameters |   mean_uncertainty: 0.3132635192307692
20:47:41.446 |     INFO |       log_parameters |   uncertainty_range: [0.205105, 0.356951]
20:47:41.446 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:41.446 |     INFO |       log_parameters |   coords_shape: (55, 2)
20:47:41.446 |     INFO |       log_parameters |   uncertainties_shape: (55, 2)
20:47:41.446 |     INFO |       log_parameters |   mean_uncertainty: 0.3133346727272728
20:47:41.446 |     INFO |       log_parameters |   uncertainty_range: [0.198276, 0.360465]
20:47:41.446 |    DEBUG |            log_debug | Initializing Kalman for 55 features, prob_dim=2, state_dim=4
20:47:41.446 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:41.446 |     INFO |       log_parameters |   num_features: 55
20:47:41.446 |     INFO |       log_parameters |   state_dim: 4
20:47:41.446 |     INFO |       log_parameters |   prob_dim: 2
20:47:41.446 |     INFO |       log_parameters |   state_vec_shape: (55, 4)
20:47:41.446 |     INFO |       log_parameters |   state_noise_var_shape: (55, 4, 4)
20:47:41.446 |    DEBUG |            log_debug | State vector shape: (52, 4), Expected: (52, 4)
20:47:41.447 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:41.447 |     INFO |       log_parameters |   num_features_predicted: 52
20:47:41.447 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:41.447 |     INFO |       log_parameters |   brownian_motion_features: 52
20:47:41.447 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:41.447 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:41.447 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:41.447 |     INFO |       log_parameters |   search_radii_shape: (52, 2)
20:47:41.447 |     INFO |       log_parameters |   min_radius: 0.1
20:47:41.447 |     INFO |       log_parameters |   max_radius: 0.1
20:47:41.447 |     INFO |       log_parameters |   mean_radius: 0.1
20:47:41.447 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:41.447 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.1
20:47:41.447 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:41.447 |     INFO |       log_parameters |   distance_matrix_shape: (52, 55)
20:47:41.447 |     INFO |       log_parameters |   cost_matrix_shape: (52, 55)
20:47:41.447 |     INFO |       log_parameters |   finite_costs: 2860
20:47:41.447 |     INFO |       log_parameters |   infinite_costs: 0
20:47:41.447 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:41.447 |     INFO |       log_parameters |   min_distance: 2.754931799603395
20:47:41.447 |     INFO |       log_parameters |   max_distance: 126.74602927432672
20:47:41.447 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:41.447 |     INFO |       log_parameters |   motion_costs_shape: (52, 55)
20:47:41.447 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:41.447 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:41.447 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:41.447 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:41.447 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:41.449 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:41.449 |     INFO |       log_parameters |   coords_shape: (52, 2)
20:47:41.449 |     INFO |       log_parameters |   uncertainties_shape: (52, 2)
20:47:41.449 |     INFO |       log_parameters |   mean_uncertainty: 0.3132635192307692
20:47:41.449 |     INFO |       log_parameters |   uncertainty_range: [0.205105, 0.356951]
20:47:41.449 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:41.449 |     INFO |       log_parameters |   coords_shape: (55, 2)
20:47:41.449 |     INFO |       log_parameters |   uncertainties_shape: (55, 2)
20:47:41.449 |     INFO |       log_parameters |   mean_uncertainty: 0.3133346727272728
20:47:41.449 |     INFO |       log_parameters |   uncertainty_range: [0.198276, 0.360465]
20:47:41.449 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:41.449 |     INFO |       log_parameters |   feature_costs_shape: (52, 55)
20:47:41.449 |     INFO |       log_parameters |   feature_costs_min: 1.000021641123821
20:47:41.449 |     INFO |       log_parameters |   feature_costs_max: 5.0
20:47:41.450 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:41.450 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:41.450 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:41.450 |     INFO |       log_parameters |   original_shape: (52, 55)
20:47:41.450 |     INFO |       log_parameters |   augmented_shape: (107, 107)
20:47:41.450 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:41.450 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:41.450 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:41.450 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:41.450 |    DEBUG |            log_debug |   observed_positions.shape: (55, 2)
20:47:41.450 |    DEBUG |            log_debug |   num_features (from observed_positions): 55
20:47:41.450 |    DEBUG |            log_debug |   predicted_positions.shape: (52, 2)
20:47:41.450 |    DEBUG |            log_debug |   predicted_velocities.shape: (52, 2)
20:47:41.450 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (55, 4)
20:47:41.450 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=55 but predicted_positions has 52 rows
20:47:41.450 |    ERROR |            log_error |   This will cause index 54 to fail when array only goes to 51
20:47:41.450 |    DEBUG |            log_debug | Kalman update: 55 features, state_dim=4, prob_dim=2
20:47:41.451 |    ERROR |            log_error | Error in enhanced linking: index 52 is out of bounds for axis 0 with size 52
20:47:41.451 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 52 is out of bounds for axis 0 with size 52
20:47:41.451 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0051 seconds
20:47:41.460 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=83, prob_dim=2, num_features_frame1=55, num_features_frame2=47)
20:47:41.460 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:41.460 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:41.460 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:41.460 |     INFO |       log_parameters |   current_frame: 83
20:47:41.460 |     INFO |       log_parameters |   prob_dim: 2
20:47:41.460 |     INFO |       log_parameters |   num_features_frame1: 55
20:47:41.460 |     INFO |       log_parameters |   num_features_frame2: 47
20:47:41.460 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:41.460 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:41.460 |     INFO |       log_parameters |   linear_motion: 1
20:47:41.460 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:41.460 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:41.460 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:41.460 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:41.460 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:41.460 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:41.460 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:41.460 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:41.460 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:41.460 |     INFO |       log_parameters |   use_local_density: 0
20:47:41.460 |     INFO |       log_parameters |   nn_window: 5
20:47:41.461 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:41.461 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:41.461 |     INFO |       log_parameters |   len_for_classify: 5
20:47:41.461 |     INFO |       log_parameters |   res_limit: 0.1
20:47:41.461 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:41.461 |     INFO |       log_parameters |   strategy_bd: -1
20:47:41.461 |     INFO |       log_parameters |   lft_cdf: None
20:47:41.461 |     INFO |       log_parameters |   kalman_init_param: None
20:47:41.461 |     INFO |       log_parameters |   diagnostics: None
20:47:41.461 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:41.461 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:41.461 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:41.461 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:41.461 |     INFO |       log_parameters |   coords_shape: (55, 2)
20:47:41.461 |     INFO |       log_parameters |   uncertainties_shape: (55, 2)
20:47:41.461 |     INFO |       log_parameters |   mean_uncertainty: 0.3133346727272728
20:47:41.461 |     INFO |       log_parameters |   uncertainty_range: [0.198276, 0.360465]
20:47:41.461 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:41.461 |     INFO |       log_parameters |   coords_shape: (47, 2)
20:47:41.461 |     INFO |       log_parameters |   uncertainties_shape: (47, 2)
20:47:41.461 |     INFO |       log_parameters |   mean_uncertainty: 0.31013503191489356
20:47:41.461 |     INFO |       log_parameters |   uncertainty_range: [0.196411, 0.356007]
20:47:41.461 |    DEBUG |            log_debug | Initializing Kalman for 47 features, prob_dim=2, state_dim=4
20:47:41.461 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:41.461 |     INFO |       log_parameters |   num_features: 47
20:47:41.461 |     INFO |       log_parameters |   state_dim: 4
20:47:41.461 |     INFO |       log_parameters |   prob_dim: 2
20:47:41.461 |     INFO |       log_parameters |   state_vec_shape: (47, 4)
20:47:41.461 |     INFO |       log_parameters |   state_noise_var_shape: (47, 4, 4)
20:47:41.461 |    DEBUG |            log_debug | State vector shape: (55, 4), Expected: (55, 4)
20:47:41.461 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:41.461 |     INFO |       log_parameters |   num_features_predicted: 55
20:47:41.461 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:41.461 |     INFO |       log_parameters |   brownian_motion_features: 55
20:47:41.461 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:41.461 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:41.461 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:41.461 |     INFO |       log_parameters |   search_radii_shape: (55, 2)
20:47:41.461 |     INFO |       log_parameters |   min_radius: 0.1
20:47:41.461 |     INFO |       log_parameters |   max_radius: 0.1
20:47:41.461 |     INFO |       log_parameters |   mean_radius: 0.09999999999999998
20:47:41.461 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:41.462 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999998
20:47:41.462 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:41.462 |     INFO |       log_parameters |   distance_matrix_shape: (55, 47)
20:47:41.462 |     INFO |       log_parameters |   cost_matrix_shape: (55, 47)
20:47:41.462 |     INFO |       log_parameters |   finite_costs: 2585
20:47:41.462 |     INFO |       log_parameters |   infinite_costs: 0
20:47:41.462 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:41.462 |     INFO |       log_parameters |   min_distance: 21.014431658424883
20:47:41.462 |     INFO |       log_parameters |   max_distance: 134.39907953804604
20:47:41.462 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:41.462 |     INFO |       log_parameters |   motion_costs_shape: (55, 47)
20:47:41.462 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:41.462 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:41.462 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:41.462 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:41.462 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:41.464 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:41.464 |     INFO |       log_parameters |   coords_shape: (55, 2)
20:47:41.464 |     INFO |       log_parameters |   uncertainties_shape: (55, 2)
20:47:41.464 |     INFO |       log_parameters |   mean_uncertainty: 0.3133346727272728
20:47:41.464 |     INFO |       log_parameters |   uncertainty_range: [0.198276, 0.360465]
20:47:41.464 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:41.464 |     INFO |       log_parameters |   coords_shape: (47, 2)
20:47:41.464 |     INFO |       log_parameters |   uncertainties_shape: (47, 2)
20:47:41.464 |     INFO |       log_parameters |   mean_uncertainty: 0.31013503191489356
20:47:41.464 |     INFO |       log_parameters |   uncertainty_range: [0.196411, 0.356007]
20:47:41.464 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:41.464 |     INFO |       log_parameters |   feature_costs_shape: (55, 47)
20:47:41.464 |     INFO |       log_parameters |   feature_costs_min: 1.0000054867212962
20:47:41.464 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:41.464 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:41.464 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:41.464 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:41.464 |     INFO |       log_parameters |   original_shape: (55, 47)
20:47:41.464 |     INFO |       log_parameters |   augmented_shape: (102, 102)
20:47:41.464 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:41.464 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:41.464 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:41.464 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:41.464 |    DEBUG |            log_debug |   observed_positions.shape: (47, 2)
20:47:41.464 |    DEBUG |            log_debug |   num_features (from observed_positions): 47
20:47:41.464 |    DEBUG |            log_debug |   predicted_positions.shape: (55, 2)
20:47:41.464 |    DEBUG |            log_debug |   predicted_velocities.shape: (55, 2)
20:47:41.464 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (47, 4)
20:47:41.464 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=47 but predicted_positions has 55 rows
20:47:41.464 |    ERROR |            log_error |   This will cause index 46 to fail when array only goes to 54
20:47:41.464 |    DEBUG |            log_debug | Kalman update: 47 features, state_dim=4, prob_dim=2
20:47:41.465 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman update):
20:47:41.465 |     INFO |       log_parameters |   features_updated: 47
20:47:41.465 |     INFO |       log_parameters |   state_dim: 4
20:47:41.465 |     INFO |       log_parameters |   dt_used: 1.0
20:47:41.465 |     INFO |       log_parameters |   process_noise_scale: 1.0
20:47:41.465 |     INFO |       log_parameters |   measurement_noise_scale: 1.0
20:47:41.465 |     INFO |             log_info | Enhanced linking completed successfully for frame 83
20:47:41.465 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0047 seconds
20:47:41.641 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=84, prob_dim=2, num_features_frame1=47, num_features_frame2=47)
20:47:41.641 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:41.641 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:41.641 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:41.641 |     INFO |       log_parameters |   current_frame: 84
20:47:41.641 |     INFO |       log_parameters |   prob_dim: 2
20:47:41.641 |     INFO |       log_parameters |   num_features_frame1: 47
20:47:41.641 |     INFO |       log_parameters |   num_features_frame2: 47
20:47:41.641 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:41.641 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:41.641 |     INFO |       log_parameters |   linear_motion: 1
20:47:41.641 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:41.641 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:41.641 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:41.641 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:41.641 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:41.641 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:41.641 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:41.641 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:41.641 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:41.641 |     INFO |       log_parameters |   use_local_density: 0
20:47:41.641 |     INFO |       log_parameters |   nn_window: 5
20:47:41.641 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:41.641 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:41.641 |     INFO |       log_parameters |   len_for_classify: 5
20:47:41.641 |     INFO |       log_parameters |   res_limit: 0.1
20:47:41.641 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:41.641 |     INFO |       log_parameters |   strategy_bd: -1
20:47:41.641 |     INFO |       log_parameters |   lft_cdf: None
20:47:41.641 |     INFO |       log_parameters |   kalman_init_param: None
20:47:41.641 |     INFO |       log_parameters |   diagnostics: None
20:47:41.641 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:41.641 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:41.641 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:41.641 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:41.641 |     INFO |       log_parameters |   coords_shape: (47, 2)
20:47:41.641 |     INFO |       log_parameters |   uncertainties_shape: (47, 2)
20:47:41.641 |     INFO |       log_parameters |   mean_uncertainty: 0.31013503191489356
20:47:41.641 |     INFO |       log_parameters |   uncertainty_range: [0.196411, 0.356007]
20:47:41.641 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:41.641 |     INFO |       log_parameters |   coords_shape: (47, 2)
20:47:41.641 |     INFO |       log_parameters |   uncertainties_shape: (47, 2)
20:47:41.641 |     INFO |       log_parameters |   mean_uncertainty: 0.31322236170212764
20:47:41.641 |     INFO |       log_parameters |   uncertainty_range: [0.19354, 0.354387]
20:47:41.641 |    DEBUG |            log_debug | Initializing Kalman for 47 features, prob_dim=2, state_dim=4
20:47:41.641 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:41.641 |     INFO |       log_parameters |   num_features: 47
20:47:41.642 |     INFO |       log_parameters |   state_dim: 4
20:47:41.642 |     INFO |       log_parameters |   prob_dim: 2
20:47:41.642 |     INFO |       log_parameters |   state_vec_shape: (47, 4)
20:47:41.642 |     INFO |       log_parameters |   state_noise_var_shape: (47, 4, 4)
20:47:41.642 |    DEBUG |            log_debug | State vector shape: (47, 4), Expected: (47, 4)
20:47:41.642 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:41.642 |     INFO |       log_parameters |   num_features_predicted: 47
20:47:41.642 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:41.642 |     INFO |       log_parameters |   brownian_motion_features: 47
20:47:41.642 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:41.642 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:41.642 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:41.642 |     INFO |       log_parameters |   search_radii_shape: (47, 2)
20:47:41.642 |     INFO |       log_parameters |   min_radius: 0.1
20:47:41.642 |     INFO |       log_parameters |   max_radius: 0.1
20:47:41.642 |     INFO |       log_parameters |   mean_radius: 0.09999999999999996
20:47:41.642 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:41.642 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999996
20:47:41.643 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:41.643 |     INFO |       log_parameters |   distance_matrix_shape: (47, 47)
20:47:41.643 |     INFO |       log_parameters |   cost_matrix_shape: (47, 47)
20:47:41.643 |     INFO |       log_parameters |   finite_costs: 2209
20:47:41.643 |     INFO |       log_parameters |   infinite_costs: 0
20:47:41.643 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:41.643 |     INFO |       log_parameters |   min_distance: 7.67996352489548
20:47:41.643 |     INFO |       log_parameters |   max_distance: 126.7389985194631
20:47:41.643 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:41.643 |     INFO |       log_parameters |   motion_costs_shape: (47, 47)
20:47:41.643 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:41.643 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:41.643 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:41.643 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:41.643 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:41.644 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:41.644 |     INFO |       log_parameters |   coords_shape: (47, 2)
20:47:41.644 |     INFO |       log_parameters |   uncertainties_shape: (47, 2)
20:47:41.644 |     INFO |       log_parameters |   mean_uncertainty: 0.31013503191489356
20:47:41.644 |     INFO |       log_parameters |   uncertainty_range: [0.196411, 0.356007]
20:47:41.644 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:41.644 |     INFO |       log_parameters |   coords_shape: (47, 2)
20:47:41.644 |     INFO |       log_parameters |   uncertainties_shape: (47, 2)
20:47:41.644 |     INFO |       log_parameters |   mean_uncertainty: 0.31322236170212764
20:47:41.644 |     INFO |       log_parameters |   uncertainty_range: [0.19354, 0.354387]
20:47:41.644 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:41.644 |     INFO |       log_parameters |   feature_costs_shape: (47, 47)
20:47:41.644 |     INFO |       log_parameters |   feature_costs_min: 1.000214468363183
20:47:41.644 |     INFO |       log_parameters |   feature_costs_max: 5.0
20:47:41.644 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:41.644 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:41.644 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:41.644 |     INFO |       log_parameters |   original_shape: (47, 47)
20:47:41.644 |     INFO |       log_parameters |   augmented_shape: (94, 94)
20:47:41.644 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:41.644 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:41.644 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:41.644 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:41.644 |    DEBUG |            log_debug |   observed_positions.shape: (47, 2)
20:47:41.644 |    DEBUG |            log_debug |   num_features (from observed_positions): 47
20:47:41.644 |    DEBUG |            log_debug |   predicted_positions.shape: (47, 2)
20:47:41.645 |    DEBUG |            log_debug |   predicted_velocities.shape: (47, 2)
20:47:41.645 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (47, 4)
20:47:41.645 |    DEBUG |            log_debug | Kalman update: 47 features, state_dim=4, prob_dim=2
20:47:41.645 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman update):
20:47:41.645 |     INFO |       log_parameters |   features_updated: 47
20:47:41.645 |     INFO |       log_parameters |   state_dim: 4
20:47:41.645 |     INFO |       log_parameters |   dt_used: 1.0
20:47:41.645 |     INFO |       log_parameters |   process_noise_scale: 1.0
20:47:41.645 |     INFO |       log_parameters |   measurement_noise_scale: 1.0
20:47:41.645 |     INFO |             log_info | Enhanced linking completed successfully for frame 84
20:47:41.645 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0044 seconds
20:47:41.810 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=85, prob_dim=2, num_features_frame1=47, num_features_frame2=53)
20:47:41.810 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:41.810 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:41.810 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:41.810 |     INFO |       log_parameters |   current_frame: 85
20:47:41.810 |     INFO |       log_parameters |   prob_dim: 2
20:47:41.810 |     INFO |       log_parameters |   num_features_frame1: 47
20:47:41.810 |     INFO |       log_parameters |   num_features_frame2: 53
20:47:41.810 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:41.810 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:41.810 |     INFO |       log_parameters |   linear_motion: 1
20:47:41.810 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:41.810 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:41.810 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:41.810 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:41.810 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:41.810 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:41.810 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:41.810 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:41.811 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:41.811 |     INFO |       log_parameters |   use_local_density: 0
20:47:41.811 |     INFO |       log_parameters |   nn_window: 5
20:47:41.811 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:41.811 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:41.811 |     INFO |       log_parameters |   len_for_classify: 5
20:47:41.811 |     INFO |       log_parameters |   res_limit: 0.1
20:47:41.811 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:41.811 |     INFO |       log_parameters |   strategy_bd: -1
20:47:41.811 |     INFO |       log_parameters |   lft_cdf: None
20:47:41.811 |     INFO |       log_parameters |   kalman_init_param: None
20:47:41.811 |     INFO |       log_parameters |   diagnostics: None
20:47:41.811 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:41.811 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:41.811 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:41.811 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:41.811 |     INFO |       log_parameters |   coords_shape: (47, 2)
20:47:41.811 |     INFO |       log_parameters |   uncertainties_shape: (47, 2)
20:47:41.811 |     INFO |       log_parameters |   mean_uncertainty: 0.31322236170212764
20:47:41.811 |     INFO |       log_parameters |   uncertainty_range: [0.19354, 0.354387]
20:47:41.811 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:41.811 |     INFO |       log_parameters |   coords_shape: (53, 2)
20:47:41.811 |     INFO |       log_parameters |   uncertainties_shape: (53, 2)
20:47:41.811 |     INFO |       log_parameters |   mean_uncertainty: 0.31563552830188674
20:47:41.811 |     INFO |       log_parameters |   uncertainty_range: [0.191658, 0.351752]
20:47:41.811 |    DEBUG |            log_debug | Initializing Kalman for 53 features, prob_dim=2, state_dim=4
20:47:41.811 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:41.811 |     INFO |       log_parameters |   num_features: 53
20:47:41.811 |     INFO |       log_parameters |   state_dim: 4
20:47:41.811 |     INFO |       log_parameters |   prob_dim: 2
20:47:41.811 |     INFO |       log_parameters |   state_vec_shape: (53, 4)
20:47:41.811 |     INFO |       log_parameters |   state_noise_var_shape: (53, 4, 4)
20:47:41.811 |    DEBUG |            log_debug | State vector shape: (47, 4), Expected: (47, 4)
20:47:41.811 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:41.811 |     INFO |       log_parameters |   num_features_predicted: 47
20:47:41.811 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:41.811 |     INFO |       log_parameters |   brownian_motion_features: 47
20:47:41.811 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:41.811 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:41.811 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:41.811 |     INFO |       log_parameters |   search_radii_shape: (47, 2)
20:47:41.811 |     INFO |       log_parameters |   min_radius: 0.1
20:47:41.811 |     INFO |       log_parameters |   max_radius: 0.1
20:47:41.811 |     INFO |       log_parameters |   mean_radius: 0.09999999999999996
20:47:41.811 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:41.811 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999996
20:47:41.812 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:41.812 |     INFO |       log_parameters |   distance_matrix_shape: (47, 53)
20:47:41.812 |     INFO |       log_parameters |   cost_matrix_shape: (47, 53)
20:47:41.812 |     INFO |       log_parameters |   finite_costs: 2491
20:47:41.812 |     INFO |       log_parameters |   infinite_costs: 0
20:47:41.812 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:41.812 |     INFO |       log_parameters |   min_distance: 7.209661172691891
20:47:41.812 |     INFO |       log_parameters |   max_distance: 132.95843165549334
20:47:41.812 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:41.812 |     INFO |       log_parameters |   motion_costs_shape: (47, 53)
20:47:41.812 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:41.812 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:41.812 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:41.812 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:41.812 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:41.814 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:41.814 |     INFO |       log_parameters |   coords_shape: (47, 2)
20:47:41.814 |     INFO |       log_parameters |   uncertainties_shape: (47, 2)
20:47:41.814 |     INFO |       log_parameters |   mean_uncertainty: 0.31322236170212764
20:47:41.814 |     INFO |       log_parameters |   uncertainty_range: [0.19354, 0.354387]
20:47:41.814 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:41.814 |     INFO |       log_parameters |   coords_shape: (53, 2)
20:47:41.814 |     INFO |       log_parameters |   uncertainties_shape: (53, 2)
20:47:41.814 |     INFO |       log_parameters |   mean_uncertainty: 0.31563552830188674
20:47:41.814 |     INFO |       log_parameters |   uncertainty_range: [0.191658, 0.351752]
20:47:41.814 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:41.814 |     INFO |       log_parameters |   feature_costs_shape: (47, 53)
20:47:41.814 |     INFO |       log_parameters |   feature_costs_min: 1.0000735836598833
20:47:41.814 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:41.814 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:41.814 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:41.814 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:41.814 |     INFO |       log_parameters |   original_shape: (47, 53)
20:47:41.814 |     INFO |       log_parameters |   augmented_shape: (100, 100)
20:47:41.814 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:41.814 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:41.814 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:41.814 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:41.814 |    DEBUG |            log_debug |   observed_positions.shape: (53, 2)
20:47:41.814 |    DEBUG |            log_debug |   num_features (from observed_positions): 53
20:47:41.814 |    DEBUG |            log_debug |   predicted_positions.shape: (47, 2)
20:47:41.814 |    DEBUG |            log_debug |   predicted_velocities.shape: (47, 2)
20:47:41.814 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (53, 4)
20:47:41.814 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=53 but predicted_positions has 47 rows
20:47:41.814 |    ERROR |            log_error |   This will cause index 52 to fail when array only goes to 46
20:47:41.814 |    DEBUG |            log_debug | Kalman update: 53 features, state_dim=4, prob_dim=2
20:47:41.815 |    ERROR |            log_error | Error in enhanced linking: index 47 is out of bounds for axis 0 with size 47
20:47:41.815 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 47 is out of bounds for axis 0 with size 47
20:47:41.815 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0047 seconds
20:47:41.825 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=86, prob_dim=2, num_features_frame1=53, num_features_frame2=49)
20:47:41.825 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:41.825 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:41.825 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:41.825 |     INFO |       log_parameters |   current_frame: 86
20:47:41.825 |     INFO |       log_parameters |   prob_dim: 2
20:47:41.825 |     INFO |       log_parameters |   num_features_frame1: 53
20:47:41.825 |     INFO |       log_parameters |   num_features_frame2: 49
20:47:41.825 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:41.825 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:41.825 |     INFO |       log_parameters |   linear_motion: 1
20:47:41.825 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:41.825 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:41.825 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:41.825 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:41.825 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:41.825 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:41.825 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:41.825 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:41.825 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:41.825 |     INFO |       log_parameters |   use_local_density: 0
20:47:41.825 |     INFO |       log_parameters |   nn_window: 5
20:47:41.825 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:41.825 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:41.825 |     INFO |       log_parameters |   len_for_classify: 5
20:47:41.825 |     INFO |       log_parameters |   res_limit: 0.1
20:47:41.825 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:41.825 |     INFO |       log_parameters |   strategy_bd: -1
20:47:41.825 |     INFO |       log_parameters |   lft_cdf: None
20:47:41.825 |     INFO |       log_parameters |   kalman_init_param: None
20:47:41.825 |     INFO |       log_parameters |   diagnostics: None
20:47:41.825 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:41.825 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:41.825 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:41.825 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:41.825 |     INFO |       log_parameters |   coords_shape: (53, 2)
20:47:41.825 |     INFO |       log_parameters |   uncertainties_shape: (53, 2)
20:47:41.825 |     INFO |       log_parameters |   mean_uncertainty: 0.31563552830188674
20:47:41.825 |     INFO |       log_parameters |   uncertainty_range: [0.191658, 0.351752]
20:47:41.825 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:41.825 |     INFO |       log_parameters |   coords_shape: (49, 2)
20:47:41.825 |     INFO |       log_parameters |   uncertainties_shape: (49, 2)
20:47:41.825 |     INFO |       log_parameters |   mean_uncertainty: 0.314586612244898
20:47:41.825 |     INFO |       log_parameters |   uncertainty_range: [0.19244, 0.356151]
20:47:41.825 |    DEBUG |            log_debug | Initializing Kalman for 49 features, prob_dim=2, state_dim=4
20:47:41.825 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:41.825 |     INFO |       log_parameters |   num_features: 49
20:47:41.825 |     INFO |       log_parameters |   state_dim: 4
20:47:41.825 |     INFO |       log_parameters |   prob_dim: 2
20:47:41.825 |     INFO |       log_parameters |   state_vec_shape: (49, 4)
20:47:41.825 |     INFO |       log_parameters |   state_noise_var_shape: (49, 4, 4)
20:47:41.825 |    DEBUG |            log_debug | State vector shape: (53, 4), Expected: (53, 4)
20:47:41.826 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:41.826 |     INFO |       log_parameters |   num_features_predicted: 53
20:47:41.826 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:41.826 |     INFO |       log_parameters |   brownian_motion_features: 53
20:47:41.826 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:41.826 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:41.826 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:41.826 |     INFO |       log_parameters |   search_radii_shape: (53, 2)
20:47:41.826 |     INFO |       log_parameters |   min_radius: 0.1
20:47:41.826 |     INFO |       log_parameters |   max_radius: 0.1
20:47:41.826 |     INFO |       log_parameters |   mean_radius: 0.09999999999999999
20:47:41.826 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:41.826 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999999
20:47:41.826 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:41.826 |     INFO |       log_parameters |   distance_matrix_shape: (53, 49)
20:47:41.826 |     INFO |       log_parameters |   cost_matrix_shape: (53, 49)
20:47:41.826 |     INFO |       log_parameters |   finite_costs: 2597
20:47:41.826 |     INFO |       log_parameters |   infinite_costs: 0
20:47:41.826 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:41.826 |     INFO |       log_parameters |   min_distance: 21.117835166588666
20:47:41.826 |     INFO |       log_parameters |   max_distance: 133.57678667283287
20:47:41.827 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:41.827 |     INFO |       log_parameters |   motion_costs_shape: (53, 49)
20:47:41.827 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:41.827 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:41.827 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:41.827 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:41.827 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:41.828 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:41.828 |     INFO |       log_parameters |   coords_shape: (53, 2)
20:47:41.828 |     INFO |       log_parameters |   uncertainties_shape: (53, 2)
20:47:41.828 |     INFO |       log_parameters |   mean_uncertainty: 0.31563552830188674
20:47:41.828 |     INFO |       log_parameters |   uncertainty_range: [0.191658, 0.351752]
20:47:41.828 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:41.828 |     INFO |       log_parameters |   coords_shape: (49, 2)
20:47:41.828 |     INFO |       log_parameters |   uncertainties_shape: (49, 2)
20:47:41.828 |     INFO |       log_parameters |   mean_uncertainty: 0.314586612244898
20:47:41.828 |     INFO |       log_parameters |   uncertainty_range: [0.19244, 0.356151]
20:47:41.828 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:41.828 |     INFO |       log_parameters |   feature_costs_shape: (53, 49)
20:47:41.828 |     INFO |       log_parameters |   feature_costs_min: 1.0000185578214338
20:47:41.828 |     INFO |       log_parameters |   feature_costs_max: 5.0
20:47:41.828 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:41.828 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:41.828 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:41.828 |     INFO |       log_parameters |   original_shape: (53, 49)
20:47:41.828 |     INFO |       log_parameters |   augmented_shape: (102, 102)
20:47:41.828 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:41.828 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:41.828 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:41.828 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:41.828 |    DEBUG |            log_debug |   observed_positions.shape: (49, 2)
20:47:41.828 |    DEBUG |            log_debug |   num_features (from observed_positions): 49
20:47:41.828 |    DEBUG |            log_debug |   predicted_positions.shape: (53, 2)
20:47:41.828 |    DEBUG |            log_debug |   predicted_velocities.shape: (53, 2)
20:47:41.828 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (49, 4)
20:47:41.828 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=49 but predicted_positions has 53 rows
20:47:41.829 |    ERROR |            log_error |   This will cause index 48 to fail when array only goes to 52
20:47:41.829 |    DEBUG |            log_debug | Kalman update: 49 features, state_dim=4, prob_dim=2
20:47:41.829 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman update):
20:47:41.829 |     INFO |       log_parameters |   features_updated: 49
20:47:41.829 |     INFO |       log_parameters |   state_dim: 4
20:47:41.829 |     INFO |       log_parameters |   dt_used: 1.0
20:47:41.829 |     INFO |       log_parameters |   process_noise_scale: 1.0
20:47:41.829 |     INFO |       log_parameters |   measurement_noise_scale: 1.0
20:47:41.829 |     INFO |             log_info | Enhanced linking completed successfully for frame 86
20:47:41.829 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0047 seconds
20:47:42.009 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=87, prob_dim=2, num_features_frame1=49, num_features_frame2=51)
20:47:42.009 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:42.009 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:42.009 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:42.009 |     INFO |       log_parameters |   current_frame: 87
20:47:42.009 |     INFO |       log_parameters |   prob_dim: 2
20:47:42.009 |     INFO |       log_parameters |   num_features_frame1: 49
20:47:42.009 |     INFO |       log_parameters |   num_features_frame2: 51
20:47:42.009 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:42.009 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:42.009 |     INFO |       log_parameters |   linear_motion: 1
20:47:42.009 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:42.010 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:42.010 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:42.010 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:42.010 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:42.010 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:42.010 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:42.010 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:42.010 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:42.010 |     INFO |       log_parameters |   use_local_density: 0
20:47:42.010 |     INFO |       log_parameters |   nn_window: 5
20:47:42.010 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:42.010 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:42.010 |     INFO |       log_parameters |   len_for_classify: 5
20:47:42.010 |     INFO |       log_parameters |   res_limit: 0.1
20:47:42.010 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:42.010 |     INFO |       log_parameters |   strategy_bd: -1
20:47:42.010 |     INFO |       log_parameters |   lft_cdf: None
20:47:42.010 |     INFO |       log_parameters |   kalman_init_param: None
20:47:42.010 |     INFO |       log_parameters |   diagnostics: None
20:47:42.010 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:42.010 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:42.010 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:42.010 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:42.010 |     INFO |       log_parameters |   coords_shape: (49, 2)
20:47:42.010 |     INFO |       log_parameters |   uncertainties_shape: (49, 2)
20:47:42.010 |     INFO |       log_parameters |   mean_uncertainty: 0.314586612244898
20:47:42.010 |     INFO |       log_parameters |   uncertainty_range: [0.19244, 0.356151]
20:47:42.010 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:42.010 |     INFO |       log_parameters |   coords_shape: (51, 2)
20:47:42.010 |     INFO |       log_parameters |   uncertainties_shape: (51, 2)
20:47:42.010 |     INFO |       log_parameters |   mean_uncertainty: 0.31487960784313723
20:47:42.010 |     INFO |       log_parameters |   uncertainty_range: [0.194088, 0.354796]
20:47:42.010 |    DEBUG |            log_debug | Initializing Kalman for 51 features, prob_dim=2, state_dim=4
20:47:42.010 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:42.010 |     INFO |       log_parameters |   num_features: 51
20:47:42.010 |     INFO |       log_parameters |   state_dim: 4
20:47:42.010 |     INFO |       log_parameters |   prob_dim: 2
20:47:42.010 |     INFO |       log_parameters |   state_vec_shape: (51, 4)
20:47:42.010 |     INFO |       log_parameters |   state_noise_var_shape: (51, 4, 4)
20:47:42.010 |    DEBUG |            log_debug | State vector shape: (49, 4), Expected: (49, 4)
20:47:42.010 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:42.010 |     INFO |       log_parameters |   num_features_predicted: 49
20:47:42.010 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:42.010 |     INFO |       log_parameters |   brownian_motion_features: 49
20:47:42.010 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:42.010 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:42.011 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:42.011 |     INFO |       log_parameters |   search_radii_shape: (49, 2)
20:47:42.011 |     INFO |       log_parameters |   min_radius: 0.1
20:47:42.011 |     INFO |       log_parameters |   max_radius: 0.1
20:47:42.011 |     INFO |       log_parameters |   mean_radius: 0.09999999999999999
20:47:42.011 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:42.011 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999999
20:47:42.011 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:42.011 |     INFO |       log_parameters |   distance_matrix_shape: (49, 51)
20:47:42.011 |     INFO |       log_parameters |   cost_matrix_shape: (49, 51)
20:47:42.011 |     INFO |       log_parameters |   finite_costs: 2499
20:47:42.011 |     INFO |       log_parameters |   infinite_costs: 0
20:47:42.011 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:42.011 |     INFO |       log_parameters |   min_distance: 8.074471034650877
20:47:42.011 |     INFO |       log_parameters |   max_distance: 134.68125295826064
20:47:42.011 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:42.011 |     INFO |       log_parameters |   motion_costs_shape: (49, 51)
20:47:42.011 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:42.011 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:42.011 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:42.011 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:42.011 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:42.013 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:42.013 |     INFO |       log_parameters |   coords_shape: (49, 2)
20:47:42.013 |     INFO |       log_parameters |   uncertainties_shape: (49, 2)
20:47:42.013 |     INFO |       log_parameters |   mean_uncertainty: 0.314586612244898
20:47:42.013 |     INFO |       log_parameters |   uncertainty_range: [0.19244, 0.356151]
20:47:42.013 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:42.013 |     INFO |       log_parameters |   coords_shape: (51, 2)
20:47:42.013 |     INFO |       log_parameters |   uncertainties_shape: (51, 2)
20:47:42.013 |     INFO |       log_parameters |   mean_uncertainty: 0.31487960784313723
20:47:42.013 |     INFO |       log_parameters |   uncertainty_range: [0.194088, 0.354796]
20:47:42.013 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:42.013 |     INFO |       log_parameters |   feature_costs_shape: (49, 51)
20:47:42.013 |     INFO |       log_parameters |   feature_costs_min: 1.0000451186045765
20:47:42.013 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:42.013 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:42.013 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:42.013 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:42.013 |     INFO |       log_parameters |   original_shape: (49, 51)
20:47:42.013 |     INFO |       log_parameters |   augmented_shape: (100, 100)
20:47:42.013 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:42.013 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:42.013 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:42.013 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:42.013 |    DEBUG |            log_debug |   observed_positions.shape: (51, 2)
20:47:42.013 |    DEBUG |            log_debug |   num_features (from observed_positions): 51
20:47:42.013 |    DEBUG |            log_debug |   predicted_positions.shape: (49, 2)
20:47:42.013 |    DEBUG |            log_debug |   predicted_velocities.shape: (49, 2)
20:47:42.013 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (51, 4)
20:47:42.013 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=51 but predicted_positions has 49 rows
20:47:42.013 |    ERROR |            log_error |   This will cause index 50 to fail when array only goes to 48
20:47:42.013 |    DEBUG |            log_debug | Kalman update: 51 features, state_dim=4, prob_dim=2
20:47:42.014 |    ERROR |            log_error | Error in enhanced linking: index 49 is out of bounds for axis 0 with size 49
20:47:42.014 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 49 is out of bounds for axis 0 with size 49
20:47:42.014 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0048 seconds
20:47:42.024 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=88, prob_dim=2, num_features_frame1=51, num_features_frame2=58)
20:47:42.024 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:42.024 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:42.024 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:42.024 |     INFO |       log_parameters |   current_frame: 88
20:47:42.024 |     INFO |       log_parameters |   prob_dim: 2
20:47:42.024 |     INFO |       log_parameters |   num_features_frame1: 51
20:47:42.024 |     INFO |       log_parameters |   num_features_frame2: 58
20:47:42.024 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:42.024 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:42.024 |     INFO |       log_parameters |   linear_motion: 1
20:47:42.024 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:42.024 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:42.024 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:42.024 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:42.024 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:42.024 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:42.024 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:42.024 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:42.024 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:42.024 |     INFO |       log_parameters |   use_local_density: 0
20:47:42.024 |     INFO |       log_parameters |   nn_window: 5
20:47:42.024 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:42.024 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:42.024 |     INFO |       log_parameters |   len_for_classify: 5
20:47:42.024 |     INFO |       log_parameters |   res_limit: 0.1
20:47:42.024 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:42.024 |     INFO |       log_parameters |   strategy_bd: -1
20:47:42.024 |     INFO |       log_parameters |   lft_cdf: None
20:47:42.024 |     INFO |       log_parameters |   kalman_init_param: None
20:47:42.024 |     INFO |       log_parameters |   diagnostics: None
20:47:42.024 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:42.024 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:42.024 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:42.024 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:42.024 |     INFO |       log_parameters |   coords_shape: (51, 2)
20:47:42.024 |     INFO |       log_parameters |   uncertainties_shape: (51, 2)
20:47:42.024 |     INFO |       log_parameters |   mean_uncertainty: 0.31487960784313723
20:47:42.024 |     INFO |       log_parameters |   uncertainty_range: [0.194088, 0.354796]
20:47:42.024 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:42.024 |     INFO |       log_parameters |   coords_shape: (58, 2)
20:47:42.024 |     INFO |       log_parameters |   uncertainties_shape: (58, 2)
20:47:42.024 |     INFO |       log_parameters |   mean_uncertainty: 0.31838882758620696
20:47:42.024 |     INFO |       log_parameters |   uncertainty_range: [0.190326, 0.355736]
20:47:42.024 |    DEBUG |            log_debug | Initializing Kalman for 58 features, prob_dim=2, state_dim=4
20:47:42.025 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:42.025 |     INFO |       log_parameters |   num_features: 58
20:47:42.025 |     INFO |       log_parameters |   state_dim: 4
20:47:42.025 |     INFO |       log_parameters |   prob_dim: 2
20:47:42.025 |     INFO |       log_parameters |   state_vec_shape: (58, 4)
20:47:42.025 |     INFO |       log_parameters |   state_noise_var_shape: (58, 4, 4)
20:47:42.025 |    DEBUG |            log_debug | State vector shape: (51, 4), Expected: (51, 4)
20:47:42.025 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:42.025 |     INFO |       log_parameters |   num_features_predicted: 51
20:47:42.025 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:42.025 |     INFO |       log_parameters |   brownian_motion_features: 51
20:47:42.025 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:42.025 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:42.025 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:42.025 |     INFO |       log_parameters |   search_radii_shape: (51, 2)
20:47:42.025 |     INFO |       log_parameters |   min_radius: 0.1
20:47:42.025 |     INFO |       log_parameters |   max_radius: 0.1
20:47:42.025 |     INFO |       log_parameters |   mean_radius: 0.09999999999999998
20:47:42.025 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:42.025 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999998
20:47:42.026 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:42.026 |     INFO |       log_parameters |   distance_matrix_shape: (51, 58)
20:47:42.026 |     INFO |       log_parameters |   cost_matrix_shape: (51, 58)
20:47:42.026 |     INFO |       log_parameters |   finite_costs: 2958
20:47:42.026 |     INFO |       log_parameters |   infinite_costs: 0
20:47:42.026 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:42.026 |     INFO |       log_parameters |   min_distance: 7.456472069649627
20:47:42.026 |     INFO |       log_parameters |   max_distance: 132.63819085016812
20:47:42.026 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:42.026 |     INFO |       log_parameters |   motion_costs_shape: (51, 58)
20:47:42.026 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:42.026 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:42.026 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:42.026 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:42.026 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:42.028 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:42.028 |     INFO |       log_parameters |   coords_shape: (51, 2)
20:47:42.028 |     INFO |       log_parameters |   uncertainties_shape: (51, 2)
20:47:42.028 |     INFO |       log_parameters |   mean_uncertainty: 0.31487960784313723
20:47:42.028 |     INFO |       log_parameters |   uncertainty_range: [0.194088, 0.354796]
20:47:42.028 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:42.028 |     INFO |       log_parameters |   coords_shape: (58, 2)
20:47:42.028 |     INFO |       log_parameters |   uncertainties_shape: (58, 2)
20:47:42.028 |     INFO |       log_parameters |   mean_uncertainty: 0.31838882758620696
20:47:42.028 |     INFO |       log_parameters |   uncertainty_range: [0.190326, 0.355736]
20:47:42.028 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:42.028 |     INFO |       log_parameters |   feature_costs_shape: (51, 58)
20:47:42.028 |     INFO |       log_parameters |   feature_costs_min: 1.000060816085523
20:47:42.028 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:42.028 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:42.028 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:42.028 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:42.028 |     INFO |       log_parameters |   original_shape: (51, 58)
20:47:42.028 |     INFO |       log_parameters |   augmented_shape: (109, 109)
20:47:42.028 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:42.028 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:42.028 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:42.028 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:42.028 |    DEBUG |            log_debug |   observed_positions.shape: (58, 2)
20:47:42.028 |    DEBUG |            log_debug |   num_features (from observed_positions): 58
20:47:42.028 |    DEBUG |            log_debug |   predicted_positions.shape: (51, 2)
20:47:42.028 |    DEBUG |            log_debug |   predicted_velocities.shape: (51, 2)
20:47:42.028 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (58, 4)
20:47:42.028 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=58 but predicted_positions has 51 rows
20:47:42.028 |    ERROR |            log_error |   This will cause index 57 to fail when array only goes to 50
20:47:42.028 |    DEBUG |            log_debug | Kalman update: 58 features, state_dim=4, prob_dim=2
20:47:42.029 |    ERROR |            log_error | Error in enhanced linking: index 51 is out of bounds for axis 0 with size 51
20:47:42.029 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 51 is out of bounds for axis 0 with size 51
20:47:42.029 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0052 seconds
20:47:42.039 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=89, prob_dim=2, num_features_frame1=58, num_features_frame2=53)
20:47:42.039 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:42.039 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:42.039 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:42.039 |     INFO |       log_parameters |   current_frame: 89
20:47:42.039 |     INFO |       log_parameters |   prob_dim: 2
20:47:42.039 |     INFO |       log_parameters |   num_features_frame1: 58
20:47:42.039 |     INFO |       log_parameters |   num_features_frame2: 53
20:47:42.039 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:42.039 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:42.040 |     INFO |       log_parameters |   linear_motion: 1
20:47:42.040 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:42.040 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:42.040 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:42.040 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:42.040 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:42.040 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:42.040 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:42.040 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:42.040 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:42.040 |     INFO |       log_parameters |   use_local_density: 0
20:47:42.040 |     INFO |       log_parameters |   nn_window: 5
20:47:42.040 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:42.040 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:42.040 |     INFO |       log_parameters |   len_for_classify: 5
20:47:42.040 |     INFO |       log_parameters |   res_limit: 0.1
20:47:42.040 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:42.040 |     INFO |       log_parameters |   strategy_bd: -1
20:47:42.040 |     INFO |       log_parameters |   lft_cdf: None
20:47:42.040 |     INFO |       log_parameters |   kalman_init_param: None
20:47:42.040 |     INFO |       log_parameters |   diagnostics: None
20:47:42.040 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:42.040 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:42.040 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:42.040 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:42.040 |     INFO |       log_parameters |   coords_shape: (58, 2)
20:47:42.040 |     INFO |       log_parameters |   uncertainties_shape: (58, 2)
20:47:42.040 |     INFO |       log_parameters |   mean_uncertainty: 0.31838882758620696
20:47:42.040 |     INFO |       log_parameters |   uncertainty_range: [0.190326, 0.355736]
20:47:42.040 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:42.040 |     INFO |       log_parameters |   coords_shape: (53, 2)
20:47:42.040 |     INFO |       log_parameters |   uncertainties_shape: (53, 2)
20:47:42.040 |     INFO |       log_parameters |   mean_uncertainty: 0.3159996981132076
20:47:42.040 |     INFO |       log_parameters |   uncertainty_range: [0.189964, 0.353878]
20:47:42.040 |    DEBUG |            log_debug | Initializing Kalman for 53 features, prob_dim=2, state_dim=4
20:47:42.040 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:42.040 |     INFO |       log_parameters |   num_features: 53
20:47:42.040 |     INFO |       log_parameters |   state_dim: 4
20:47:42.040 |     INFO |       log_parameters |   prob_dim: 2
20:47:42.040 |     INFO |       log_parameters |   state_vec_shape: (53, 4)
20:47:42.040 |     INFO |       log_parameters |   state_noise_var_shape: (53, 4, 4)
20:47:42.040 |    DEBUG |            log_debug | State vector shape: (58, 4), Expected: (58, 4)
20:47:42.040 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:42.040 |     INFO |       log_parameters |   num_features_predicted: 58
20:47:42.040 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:42.040 |     INFO |       log_parameters |   brownian_motion_features: 58
20:47:42.040 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:42.040 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:42.041 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:42.041 |     INFO |       log_parameters |   search_radii_shape: (58, 2)
20:47:42.041 |     INFO |       log_parameters |   min_radius: 0.1
20:47:42.041 |     INFO |       log_parameters |   max_radius: 0.1
20:47:42.041 |     INFO |       log_parameters |   mean_radius: 0.09999999999999999
20:47:42.041 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:42.041 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999999
20:47:42.041 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:42.041 |     INFO |       log_parameters |   distance_matrix_shape: (58, 53)
20:47:42.041 |     INFO |       log_parameters |   cost_matrix_shape: (58, 53)
20:47:42.041 |     INFO |       log_parameters |   finite_costs: 3074
20:47:42.041 |     INFO |       log_parameters |   infinite_costs: 0
20:47:42.041 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:42.041 |     INFO |       log_parameters |   min_distance: 2.6316506879036967
20:47:42.041 |     INFO |       log_parameters |   max_distance: 130.90095317386107
20:47:42.041 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:42.041 |     INFO |       log_parameters |   motion_costs_shape: (58, 53)
20:47:42.041 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:42.041 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:42.041 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:42.041 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:42.041 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:42.043 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:42.043 |     INFO |       log_parameters |   coords_shape: (58, 2)
20:47:42.043 |     INFO |       log_parameters |   uncertainties_shape: (58, 2)
20:47:42.043 |     INFO |       log_parameters |   mean_uncertainty: 0.31838882758620696
20:47:42.043 |     INFO |       log_parameters |   uncertainty_range: [0.190326, 0.355736]
20:47:42.043 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:42.043 |     INFO |       log_parameters |   coords_shape: (53, 2)
20:47:42.043 |     INFO |       log_parameters |   uncertainties_shape: (53, 2)
20:47:42.043 |     INFO |       log_parameters |   mean_uncertainty: 0.3159996981132076
20:47:42.043 |     INFO |       log_parameters |   uncertainty_range: [0.189964, 0.353878]
20:47:42.044 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:42.044 |     INFO |       log_parameters |   feature_costs_shape: (58, 53)
20:47:42.044 |     INFO |       log_parameters |   feature_costs_min: 1.0001748438324465
20:47:42.044 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:42.044 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:42.044 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:42.044 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:42.044 |     INFO |       log_parameters |   original_shape: (58, 53)
20:47:42.044 |     INFO |       log_parameters |   augmented_shape: (111, 111)
20:47:42.044 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:42.044 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:42.044 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:42.044 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:42.044 |    DEBUG |            log_debug |   observed_positions.shape: (53, 2)
20:47:42.044 |    DEBUG |            log_debug |   num_features (from observed_positions): 53
20:47:42.044 |    DEBUG |            log_debug |   predicted_positions.shape: (58, 2)
20:47:42.044 |    DEBUG |            log_debug |   predicted_velocities.shape: (58, 2)
20:47:42.044 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (53, 4)
20:47:42.044 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=53 but predicted_positions has 58 rows
20:47:42.044 |    ERROR |            log_error |   This will cause index 52 to fail when array only goes to 57
20:47:42.044 |    DEBUG |            log_debug | Kalman update: 53 features, state_dim=4, prob_dim=2
20:47:42.045 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman update):
20:47:42.045 |     INFO |       log_parameters |   features_updated: 53
20:47:42.045 |     INFO |       log_parameters |   state_dim: 4
20:47:42.045 |     INFO |       log_parameters |   dt_used: 1.0
20:47:42.045 |     INFO |       log_parameters |   process_noise_scale: 1.0
20:47:42.045 |     INFO |       log_parameters |   measurement_noise_scale: 1.0
20:47:42.045 |     INFO |             log_info | Enhanced linking completed successfully for frame 89
20:47:42.045 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0053 seconds
20:47:42.253 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=90, prob_dim=2, num_features_frame1=53, num_features_frame2=56)
20:47:42.253 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:42.253 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:42.253 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:42.253 |     INFO |       log_parameters |   current_frame: 90
20:47:42.253 |     INFO |       log_parameters |   prob_dim: 2
20:47:42.253 |     INFO |       log_parameters |   num_features_frame1: 53
20:47:42.253 |     INFO |       log_parameters |   num_features_frame2: 56
20:47:42.253 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:42.253 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:42.253 |     INFO |       log_parameters |   linear_motion: 1
20:47:42.253 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:42.253 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:42.253 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:42.253 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:42.253 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:42.253 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:42.253 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:42.253 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:42.253 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:42.253 |     INFO |       log_parameters |   use_local_density: 0
20:47:42.253 |     INFO |       log_parameters |   nn_window: 5
20:47:42.253 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:42.253 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:42.253 |     INFO |       log_parameters |   len_for_classify: 5
20:47:42.253 |     INFO |       log_parameters |   res_limit: 0.1
20:47:42.253 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:42.253 |     INFO |       log_parameters |   strategy_bd: -1
20:47:42.253 |     INFO |       log_parameters |   lft_cdf: None
20:47:42.253 |     INFO |       log_parameters |   kalman_init_param: None
20:47:42.253 |     INFO |       log_parameters |   diagnostics: None
20:47:42.253 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:42.253 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:42.253 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:42.253 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:42.253 |     INFO |       log_parameters |   coords_shape: (53, 2)
20:47:42.253 |     INFO |       log_parameters |   uncertainties_shape: (53, 2)
20:47:42.253 |     INFO |       log_parameters |   mean_uncertainty: 0.3159996981132076
20:47:42.253 |     INFO |       log_parameters |   uncertainty_range: [0.189964, 0.353878]
20:47:42.253 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:42.253 |     INFO |       log_parameters |   coords_shape: (56, 2)
20:47:42.253 |     INFO |       log_parameters |   uncertainties_shape: (56, 2)
20:47:42.253 |     INFO |       log_parameters |   mean_uncertainty: 0.3180062946428572
20:47:42.253 |     INFO |       log_parameters |   uncertainty_range: [0.193187, 0.357969]
20:47:42.253 |    DEBUG |            log_debug | Initializing Kalman for 56 features, prob_dim=2, state_dim=4
20:47:42.253 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:42.253 |     INFO |       log_parameters |   num_features: 56
20:47:42.253 |     INFO |       log_parameters |   state_dim: 4
20:47:42.253 |     INFO |       log_parameters |   prob_dim: 2
20:47:42.253 |     INFO |       log_parameters |   state_vec_shape: (56, 4)
20:47:42.253 |     INFO |       log_parameters |   state_noise_var_shape: (56, 4, 4)
20:47:42.253 |    DEBUG |            log_debug | State vector shape: (53, 4), Expected: (53, 4)
20:47:42.254 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:42.254 |     INFO |       log_parameters |   num_features_predicted: 53
20:47:42.254 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:42.254 |     INFO |       log_parameters |   brownian_motion_features: 53
20:47:42.254 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:42.254 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:42.254 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:42.254 |     INFO |       log_parameters |   search_radii_shape: (53, 2)
20:47:42.254 |     INFO |       log_parameters |   min_radius: 0.1
20:47:42.254 |     INFO |       log_parameters |   max_radius: 0.1
20:47:42.254 |     INFO |       log_parameters |   mean_radius: 0.09999999999999999
20:47:42.254 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:42.254 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999999
20:47:42.254 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:42.254 |     INFO |       log_parameters |   distance_matrix_shape: (53, 56)
20:47:42.254 |     INFO |       log_parameters |   cost_matrix_shape: (53, 56)
20:47:42.254 |     INFO |       log_parameters |   finite_costs: 2968
20:47:42.254 |     INFO |       log_parameters |   infinite_costs: 0
20:47:42.255 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:42.255 |     INFO |       log_parameters |   min_distance: 15.16675601094189
20:47:42.255 |     INFO |       log_parameters |   max_distance: 131.20973516038643
20:47:42.255 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:42.255 |     INFO |       log_parameters |   motion_costs_shape: (53, 56)
20:47:42.255 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:42.255 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:42.255 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:42.255 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:42.255 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:42.256 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:42.256 |     INFO |       log_parameters |   coords_shape: (53, 2)
20:47:42.256 |     INFO |       log_parameters |   uncertainties_shape: (53, 2)
20:47:42.256 |     INFO |       log_parameters |   mean_uncertainty: 0.3159996981132076
20:47:42.256 |     INFO |       log_parameters |   uncertainty_range: [0.189964, 0.353878]
20:47:42.256 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:42.256 |     INFO |       log_parameters |   coords_shape: (56, 2)
20:47:42.256 |     INFO |       log_parameters |   uncertainties_shape: (56, 2)
20:47:42.256 |     INFO |       log_parameters |   mean_uncertainty: 0.3180062946428572
20:47:42.256 |     INFO |       log_parameters |   uncertainty_range: [0.193187, 0.357969]
20:47:42.257 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:42.257 |     INFO |       log_parameters |   feature_costs_shape: (53, 56)
20:47:42.257 |     INFO |       log_parameters |   feature_costs_min: 1.0000132406062194
20:47:42.257 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:42.257 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:42.257 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:42.257 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:42.257 |     INFO |       log_parameters |   original_shape: (53, 56)
20:47:42.257 |     INFO |       log_parameters |   augmented_shape: (109, 109)
20:47:42.257 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:42.257 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:42.257 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:42.257 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:42.257 |    DEBUG |            log_debug |   observed_positions.shape: (56, 2)
20:47:42.257 |    DEBUG |            log_debug |   num_features (from observed_positions): 56
20:47:42.257 |    DEBUG |            log_debug |   predicted_positions.shape: (53, 2)
20:47:42.257 |    DEBUG |            log_debug |   predicted_velocities.shape: (53, 2)
20:47:42.257 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (56, 4)
20:47:42.257 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=56 but predicted_positions has 53 rows
20:47:42.257 |    ERROR |            log_error |   This will cause index 55 to fail when array only goes to 52
20:47:42.257 |    DEBUG |            log_debug | Kalman update: 56 features, state_dim=4, prob_dim=2
20:47:42.258 |    ERROR |            log_error | Error in enhanced linking: index 53 is out of bounds for axis 0 with size 53
20:47:42.258 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 53 is out of bounds for axis 0 with size 53
20:47:42.258 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0052 seconds
20:47:42.268 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=91, prob_dim=2, num_features_frame1=56, num_features_frame2=51)
20:47:42.268 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:42.268 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:42.268 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:42.268 |     INFO |       log_parameters |   current_frame: 91
20:47:42.268 |     INFO |       log_parameters |   prob_dim: 2
20:47:42.268 |     INFO |       log_parameters |   num_features_frame1: 56
20:47:42.268 |     INFO |       log_parameters |   num_features_frame2: 51
20:47:42.268 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:42.268 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:42.268 |     INFO |       log_parameters |   linear_motion: 1
20:47:42.268 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:42.268 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:42.268 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:42.268 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:42.268 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:42.268 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:42.268 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:42.268 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:42.268 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:42.268 |     INFO |       log_parameters |   use_local_density: 0
20:47:42.268 |     INFO |       log_parameters |   nn_window: 5
20:47:42.268 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:42.268 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:42.268 |     INFO |       log_parameters |   len_for_classify: 5
20:47:42.268 |     INFO |       log_parameters |   res_limit: 0.1
20:47:42.268 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:42.268 |     INFO |       log_parameters |   strategy_bd: -1
20:47:42.268 |     INFO |       log_parameters |   lft_cdf: None
20:47:42.268 |     INFO |       log_parameters |   kalman_init_param: None
20:47:42.268 |     INFO |       log_parameters |   diagnostics: None
20:47:42.268 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:42.268 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:42.268 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:42.268 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:42.268 |     INFO |       log_parameters |   coords_shape: (56, 2)
20:47:42.268 |     INFO |       log_parameters |   uncertainties_shape: (56, 2)
20:47:42.268 |     INFO |       log_parameters |   mean_uncertainty: 0.3180062946428572
20:47:42.268 |     INFO |       log_parameters |   uncertainty_range: [0.193187, 0.357969]
20:47:42.268 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:42.268 |     INFO |       log_parameters |   coords_shape: (51, 2)
20:47:42.268 |     INFO |       log_parameters |   uncertainties_shape: (51, 2)
20:47:42.268 |     INFO |       log_parameters |   mean_uncertainty: 0.31646974509803927
20:47:42.268 |     INFO |       log_parameters |   uncertainty_range: [0.195547, 0.356022]
20:47:42.268 |    DEBUG |            log_debug | Initializing Kalman for 51 features, prob_dim=2, state_dim=4
20:47:42.268 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:42.268 |     INFO |       log_parameters |   num_features: 51
20:47:42.268 |     INFO |       log_parameters |   state_dim: 4
20:47:42.268 |     INFO |       log_parameters |   prob_dim: 2
20:47:42.268 |     INFO |       log_parameters |   state_vec_shape: (51, 4)
20:47:42.268 |     INFO |       log_parameters |   state_noise_var_shape: (51, 4, 4)
20:47:42.268 |    DEBUG |            log_debug | State vector shape: (56, 4), Expected: (56, 4)
20:47:42.269 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:42.269 |     INFO |       log_parameters |   num_features_predicted: 56
20:47:42.269 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:42.269 |     INFO |       log_parameters |   brownian_motion_features: 56
20:47:42.269 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:42.269 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:42.269 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:42.269 |     INFO |       log_parameters |   search_radii_shape: (56, 2)
20:47:42.269 |     INFO |       log_parameters |   min_radius: 0.1
20:47:42.269 |     INFO |       log_parameters |   max_radius: 0.1
20:47:42.269 |     INFO |       log_parameters |   mean_radius: 0.1
20:47:42.269 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:42.269 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.1
20:47:42.270 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:42.270 |     INFO |       log_parameters |   distance_matrix_shape: (56, 51)
20:47:42.270 |     INFO |       log_parameters |   cost_matrix_shape: (56, 51)
20:47:42.270 |     INFO |       log_parameters |   finite_costs: 2856
20:47:42.270 |     INFO |       log_parameters |   infinite_costs: 0
20:47:42.270 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:42.270 |     INFO |       log_parameters |   min_distance: 8.515038081719013
20:47:42.270 |     INFO |       log_parameters |   max_distance: 132.53535514587207
20:47:42.270 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:42.270 |     INFO |       log_parameters |   motion_costs_shape: (56, 51)
20:47:42.270 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:42.270 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:42.270 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:42.270 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:42.270 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:42.272 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:42.272 |     INFO |       log_parameters |   coords_shape: (56, 2)
20:47:42.272 |     INFO |       log_parameters |   uncertainties_shape: (56, 2)
20:47:42.272 |     INFO |       log_parameters |   mean_uncertainty: 0.3180062946428572
20:47:42.272 |     INFO |       log_parameters |   uncertainty_range: [0.193187, 0.357969]
20:47:42.272 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:42.272 |     INFO |       log_parameters |   coords_shape: (51, 2)
20:47:42.272 |     INFO |       log_parameters |   uncertainties_shape: (51, 2)
20:47:42.272 |     INFO |       log_parameters |   mean_uncertainty: 0.31646974509803927
20:47:42.272 |     INFO |       log_parameters |   uncertainty_range: [0.195547, 0.356022]
20:47:42.272 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:42.272 |     INFO |       log_parameters |   feature_costs_shape: (56, 51)
20:47:42.272 |     INFO |       log_parameters |   feature_costs_min: 1.0000422250388625
20:47:42.272 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:42.272 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:42.272 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:42.272 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:42.272 |     INFO |       log_parameters |   original_shape: (56, 51)
20:47:42.272 |     INFO |       log_parameters |   augmented_shape: (107, 107)
20:47:42.272 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:42.272 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:42.272 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:42.272 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:42.272 |    DEBUG |            log_debug |   observed_positions.shape: (51, 2)
20:47:42.272 |    DEBUG |            log_debug |   num_features (from observed_positions): 51
20:47:42.272 |    DEBUG |            log_debug |   predicted_positions.shape: (56, 2)
20:47:42.272 |    DEBUG |            log_debug |   predicted_velocities.shape: (56, 2)
20:47:42.272 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (51, 4)
20:47:42.272 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=51 but predicted_positions has 56 rows
20:47:42.272 |    ERROR |            log_error |   This will cause index 50 to fail when array only goes to 55
20:47:42.272 |    DEBUG |            log_debug | Kalman update: 51 features, state_dim=4, prob_dim=2
20:47:42.273 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman update):
20:47:42.273 |     INFO |       log_parameters |   features_updated: 51
20:47:42.273 |     INFO |       log_parameters |   state_dim: 4
20:47:42.273 |     INFO |       log_parameters |   dt_used: 1.0
20:47:42.273 |     INFO |       log_parameters |   process_noise_scale: 1.0
20:47:42.273 |     INFO |       log_parameters |   measurement_noise_scale: 1.0
20:47:42.273 |     INFO |             log_info | Enhanced linking completed successfully for frame 91
20:47:42.273 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0050 seconds
20:47:42.467 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=92, prob_dim=2, num_features_frame1=51, num_features_frame2=53)
20:47:42.467 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:42.467 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:42.467 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:42.467 |     INFO |       log_parameters |   current_frame: 92
20:47:42.467 |     INFO |       log_parameters |   prob_dim: 2
20:47:42.467 |     INFO |       log_parameters |   num_features_frame1: 51
20:47:42.467 |     INFO |       log_parameters |   num_features_frame2: 53
20:47:42.467 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:42.467 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:42.467 |     INFO |       log_parameters |   linear_motion: 1
20:47:42.467 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:42.467 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:42.467 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:42.467 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:42.467 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:42.467 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:42.467 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:42.467 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:42.467 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:42.467 |     INFO |       log_parameters |   use_local_density: 0
20:47:42.467 |     INFO |       log_parameters |   nn_window: 5
20:47:42.467 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:42.467 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:42.467 |     INFO |       log_parameters |   len_for_classify: 5
20:47:42.467 |     INFO |       log_parameters |   res_limit: 0.1
20:47:42.467 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:42.467 |     INFO |       log_parameters |   strategy_bd: -1
20:47:42.467 |     INFO |       log_parameters |   lft_cdf: None
20:47:42.467 |     INFO |       log_parameters |   kalman_init_param: None
20:47:42.467 |     INFO |       log_parameters |   diagnostics: None
20:47:42.468 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:42.468 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:42.468 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:42.468 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:42.468 |     INFO |       log_parameters |   coords_shape: (51, 2)
20:47:42.468 |     INFO |       log_parameters |   uncertainties_shape: (51, 2)
20:47:42.468 |     INFO |       log_parameters |   mean_uncertainty: 0.31646974509803927
20:47:42.468 |     INFO |       log_parameters |   uncertainty_range: [0.195547, 0.356022]
20:47:42.468 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:42.468 |     INFO |       log_parameters |   coords_shape: (53, 2)
20:47:42.468 |     INFO |       log_parameters |   uncertainties_shape: (53, 2)
20:47:42.468 |     INFO |       log_parameters |   mean_uncertainty: 0.317865820754717
20:47:42.468 |     INFO |       log_parameters |   uncertainty_range: [0.202538, 0.356027]
20:47:42.468 |    DEBUG |            log_debug | Initializing Kalman for 53 features, prob_dim=2, state_dim=4
20:47:42.468 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:42.468 |     INFO |       log_parameters |   num_features: 53
20:47:42.468 |     INFO |       log_parameters |   state_dim: 4
20:47:42.468 |     INFO |       log_parameters |   prob_dim: 2
20:47:42.468 |     INFO |       log_parameters |   state_vec_shape: (53, 4)
20:47:42.468 |     INFO |       log_parameters |   state_noise_var_shape: (53, 4, 4)
20:47:42.468 |    DEBUG |            log_debug | State vector shape: (51, 4), Expected: (51, 4)
20:47:42.468 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:42.468 |     INFO |       log_parameters |   num_features_predicted: 51
20:47:42.468 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:42.468 |     INFO |       log_parameters |   brownian_motion_features: 51
20:47:42.468 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:42.468 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:42.468 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:42.468 |     INFO |       log_parameters |   search_radii_shape: (51, 2)
20:47:42.468 |     INFO |       log_parameters |   min_radius: 0.1
20:47:42.468 |     INFO |       log_parameters |   max_radius: 0.1
20:47:42.468 |     INFO |       log_parameters |   mean_radius: 0.09999999999999998
20:47:42.468 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:42.468 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999998
20:47:42.469 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:42.469 |     INFO |       log_parameters |   distance_matrix_shape: (51, 53)
20:47:42.469 |     INFO |       log_parameters |   cost_matrix_shape: (51, 53)
20:47:42.469 |     INFO |       log_parameters |   finite_costs: 2703
20:47:42.469 |     INFO |       log_parameters |   infinite_costs: 0
20:47:42.469 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:42.469 |     INFO |       log_parameters |   min_distance: 20.948876464998047
20:47:42.469 |     INFO |       log_parameters |   max_distance: 131.98463078362167
20:47:42.469 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:42.469 |     INFO |       log_parameters |   motion_costs_shape: (51, 53)
20:47:42.469 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:42.469 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:42.469 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:42.469 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:42.469 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:42.471 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:42.471 |     INFO |       log_parameters |   coords_shape: (51, 2)
20:47:42.471 |     INFO |       log_parameters |   uncertainties_shape: (51, 2)
20:47:42.471 |     INFO |       log_parameters |   mean_uncertainty: 0.31646974509803927
20:47:42.471 |     INFO |       log_parameters |   uncertainty_range: [0.195547, 0.356022]
20:47:42.471 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:42.471 |     INFO |       log_parameters |   coords_shape: (53, 2)
20:47:42.471 |     INFO |       log_parameters |   uncertainties_shape: (53, 2)
20:47:42.471 |     INFO |       log_parameters |   mean_uncertainty: 0.317865820754717
20:47:42.471 |     INFO |       log_parameters |   uncertainty_range: [0.202538, 0.356027]
20:47:42.471 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:42.471 |     INFO |       log_parameters |   feature_costs_shape: (51, 53)
20:47:42.471 |     INFO |       log_parameters |   feature_costs_min: 1.0000046420809972
20:47:42.471 |     INFO |       log_parameters |   feature_costs_max: 5.0
20:47:42.471 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:42.471 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:42.471 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:42.471 |     INFO |       log_parameters |   original_shape: (51, 53)
20:47:42.471 |     INFO |       log_parameters |   augmented_shape: (104, 104)
20:47:42.471 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:42.471 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:42.471 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:42.471 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:42.471 |    DEBUG |            log_debug |   observed_positions.shape: (53, 2)
20:47:42.471 |    DEBUG |            log_debug |   num_features (from observed_positions): 53
20:47:42.471 |    DEBUG |            log_debug |   predicted_positions.shape: (51, 2)
20:47:42.471 |    DEBUG |            log_debug |   predicted_velocities.shape: (51, 2)
20:47:42.471 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (53, 4)
20:47:42.471 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=53 but predicted_positions has 51 rows
20:47:42.471 |    ERROR |            log_error |   This will cause index 52 to fail when array only goes to 50
20:47:42.471 |    DEBUG |            log_debug | Kalman update: 53 features, state_dim=4, prob_dim=2
20:47:42.472 |    ERROR |            log_error | Error in enhanced linking: index 51 is out of bounds for axis 0 with size 51
20:47:42.472 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 51 is out of bounds for axis 0 with size 51
20:47:42.472 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0049 seconds
20:47:42.482 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=93, prob_dim=2, num_features_frame1=53, num_features_frame2=59)
20:47:42.482 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:42.482 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:42.482 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:42.482 |     INFO |       log_parameters |   current_frame: 93
20:47:42.482 |     INFO |       log_parameters |   prob_dim: 2
20:47:42.482 |     INFO |       log_parameters |   num_features_frame1: 53
20:47:42.482 |     INFO |       log_parameters |   num_features_frame2: 59
20:47:42.482 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:42.482 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:42.482 |     INFO |       log_parameters |   linear_motion: 1
20:47:42.482 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:42.482 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:42.482 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:42.482 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:42.482 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:42.482 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:42.482 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:42.482 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:42.482 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:42.482 |     INFO |       log_parameters |   use_local_density: 0
20:47:42.482 |     INFO |       log_parameters |   nn_window: 5
20:47:42.482 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:42.482 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:42.482 |     INFO |       log_parameters |   len_for_classify: 5
20:47:42.482 |     INFO |       log_parameters |   res_limit: 0.1
20:47:42.482 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:42.482 |     INFO |       log_parameters |   strategy_bd: -1
20:47:42.482 |     INFO |       log_parameters |   lft_cdf: None
20:47:42.482 |     INFO |       log_parameters |   kalman_init_param: None
20:47:42.482 |     INFO |       log_parameters |   diagnostics: None
20:47:42.482 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:42.482 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:42.483 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:42.483 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:42.483 |     INFO |       log_parameters |   coords_shape: (53, 2)
20:47:42.483 |     INFO |       log_parameters |   uncertainties_shape: (53, 2)
20:47:42.483 |     INFO |       log_parameters |   mean_uncertainty: 0.317865820754717
20:47:42.483 |     INFO |       log_parameters |   uncertainty_range: [0.202538, 0.356027]
20:47:42.483 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:42.483 |     INFO |       log_parameters |   coords_shape: (59, 2)
20:47:42.483 |     INFO |       log_parameters |   uncertainties_shape: (59, 2)
20:47:42.483 |     INFO |       log_parameters |   mean_uncertainty: 0.318494593220339
20:47:42.483 |     INFO |       log_parameters |   uncertainty_range: [0.198487, 0.356748]
20:47:42.483 |    DEBUG |            log_debug | Initializing Kalman for 59 features, prob_dim=2, state_dim=4
20:47:42.483 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:42.483 |     INFO |       log_parameters |   num_features: 59
20:47:42.483 |     INFO |       log_parameters |   state_dim: 4
20:47:42.483 |     INFO |       log_parameters |   prob_dim: 2
20:47:42.483 |     INFO |       log_parameters |   state_vec_shape: (59, 4)
20:47:42.483 |     INFO |       log_parameters |   state_noise_var_shape: (59, 4, 4)
20:47:42.483 |    DEBUG |            log_debug | State vector shape: (53, 4), Expected: (53, 4)
20:47:42.483 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:42.483 |     INFO |       log_parameters |   num_features_predicted: 53
20:47:42.483 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:42.483 |     INFO |       log_parameters |   brownian_motion_features: 53
20:47:42.483 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:42.483 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:42.483 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:42.483 |     INFO |       log_parameters |   search_radii_shape: (53, 2)
20:47:42.483 |     INFO |       log_parameters |   min_radius: 0.1
20:47:42.483 |     INFO |       log_parameters |   max_radius: 0.1
20:47:42.483 |     INFO |       log_parameters |   mean_radius: 0.09999999999999999
20:47:42.483 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:42.483 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999999
20:47:42.484 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:42.484 |     INFO |       log_parameters |   distance_matrix_shape: (53, 59)
20:47:42.484 |     INFO |       log_parameters |   cost_matrix_shape: (53, 59)
20:47:42.484 |     INFO |       log_parameters |   finite_costs: 3127
20:47:42.484 |     INFO |       log_parameters |   infinite_costs: 0
20:47:42.484 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:42.484 |     INFO |       log_parameters |   min_distance: 2.568249100556447
20:47:42.484 |     INFO |       log_parameters |   max_distance: 131.49522590439062
20:47:42.484 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:42.484 |     INFO |       log_parameters |   motion_costs_shape: (53, 59)
20:47:42.484 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:42.484 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:42.484 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:42.484 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:42.484 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:42.486 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:42.486 |     INFO |       log_parameters |   coords_shape: (53, 2)
20:47:42.486 |     INFO |       log_parameters |   uncertainties_shape: (53, 2)
20:47:42.486 |     INFO |       log_parameters |   mean_uncertainty: 0.317865820754717
20:47:42.486 |     INFO |       log_parameters |   uncertainty_range: [0.202538, 0.356027]
20:47:42.486 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:42.486 |     INFO |       log_parameters |   coords_shape: (59, 2)
20:47:42.486 |     INFO |       log_parameters |   uncertainties_shape: (59, 2)
20:47:42.486 |     INFO |       log_parameters |   mean_uncertainty: 0.318494593220339
20:47:42.486 |     INFO |       log_parameters |   uncertainty_range: [0.198487, 0.356748]
20:47:42.486 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:42.486 |     INFO |       log_parameters |   feature_costs_shape: (53, 59)
20:47:42.486 |     INFO |       log_parameters |   feature_costs_min: 1.0000657181751518
20:47:42.486 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:42.486 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:42.486 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:42.486 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:42.486 |     INFO |       log_parameters |   original_shape: (53, 59)
20:47:42.486 |     INFO |       log_parameters |   augmented_shape: (112, 112)
20:47:42.486 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:42.486 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:42.486 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:42.486 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:42.486 |    DEBUG |            log_debug |   observed_positions.shape: (59, 2)
20:47:42.486 |    DEBUG |            log_debug |   num_features (from observed_positions): 59
20:47:42.486 |    DEBUG |            log_debug |   predicted_positions.shape: (53, 2)
20:47:42.486 |    DEBUG |            log_debug |   predicted_velocities.shape: (53, 2)
20:47:42.486 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (59, 4)
20:47:42.486 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=59 but predicted_positions has 53 rows
20:47:42.486 |    ERROR |            log_error |   This will cause index 58 to fail when array only goes to 52
20:47:42.486 |    DEBUG |            log_debug | Kalman update: 59 features, state_dim=4, prob_dim=2
20:47:42.487 |    ERROR |            log_error | Error in enhanced linking: index 53 is out of bounds for axis 0 with size 53
20:47:42.487 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 53 is out of bounds for axis 0 with size 53
20:47:42.488 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0053 seconds
20:47:42.497 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=94, prob_dim=2, num_features_frame1=59, num_features_frame2=48)
20:47:42.497 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:42.498 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:42.498 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:42.498 |     INFO |       log_parameters |   current_frame: 94
20:47:42.498 |     INFO |       log_parameters |   prob_dim: 2
20:47:42.498 |     INFO |       log_parameters |   num_features_frame1: 59
20:47:42.498 |     INFO |       log_parameters |   num_features_frame2: 48
20:47:42.498 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:42.498 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:42.498 |     INFO |       log_parameters |   linear_motion: 1
20:47:42.498 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:42.498 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:42.498 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:42.498 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:42.498 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:42.498 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:42.498 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:42.498 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:42.498 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:42.498 |     INFO |       log_parameters |   use_local_density: 0
20:47:42.498 |     INFO |       log_parameters |   nn_window: 5
20:47:42.498 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:42.498 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:42.498 |     INFO |       log_parameters |   len_for_classify: 5
20:47:42.498 |     INFO |       log_parameters |   res_limit: 0.1
20:47:42.498 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:42.498 |     INFO |       log_parameters |   strategy_bd: -1
20:47:42.498 |     INFO |       log_parameters |   lft_cdf: None
20:47:42.498 |     INFO |       log_parameters |   kalman_init_param: None
20:47:42.498 |     INFO |       log_parameters |   diagnostics: None
20:47:42.498 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:42.498 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:42.498 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:42.498 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:42.498 |     INFO |       log_parameters |   coords_shape: (59, 2)
20:47:42.498 |     INFO |       log_parameters |   uncertainties_shape: (59, 2)
20:47:42.498 |     INFO |       log_parameters |   mean_uncertainty: 0.318494593220339
20:47:42.498 |     INFO |       log_parameters |   uncertainty_range: [0.198487, 0.356748]
20:47:42.498 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:42.498 |     INFO |       log_parameters |   coords_shape: (48, 2)
20:47:42.498 |     INFO |       log_parameters |   uncertainties_shape: (48, 2)
20:47:42.498 |     INFO |       log_parameters |   mean_uncertainty: 0.3150543333333334
20:47:42.498 |     INFO |       log_parameters |   uncertainty_range: [0.193681, 0.354293]
20:47:42.498 |    DEBUG |            log_debug | Initializing Kalman for 48 features, prob_dim=2, state_dim=4
20:47:42.498 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:42.498 |     INFO |       log_parameters |   num_features: 48
20:47:42.498 |     INFO |       log_parameters |   state_dim: 4
20:47:42.498 |     INFO |       log_parameters |   prob_dim: 2
20:47:42.498 |     INFO |       log_parameters |   state_vec_shape: (48, 4)
20:47:42.498 |     INFO |       log_parameters |   state_noise_var_shape: (48, 4, 4)
20:47:42.498 |    DEBUG |            log_debug | State vector shape: (59, 4), Expected: (59, 4)
20:47:42.498 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:42.499 |     INFO |       log_parameters |   num_features_predicted: 59
20:47:42.499 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:42.499 |     INFO |       log_parameters |   brownian_motion_features: 59
20:47:42.499 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:42.499 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:42.499 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:42.499 |     INFO |       log_parameters |   search_radii_shape: (59, 2)
20:47:42.499 |     INFO |       log_parameters |   min_radius: 0.1
20:47:42.499 |     INFO |       log_parameters |   max_radius: 0.1
20:47:42.499 |     INFO |       log_parameters |   mean_radius: 0.09999999999999999
20:47:42.499 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:42.499 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999999
20:47:42.499 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:42.499 |     INFO |       log_parameters |   distance_matrix_shape: (59, 48)
20:47:42.499 |     INFO |       log_parameters |   cost_matrix_shape: (59, 48)
20:47:42.499 |     INFO |       log_parameters |   finite_costs: 2832
20:47:42.499 |     INFO |       log_parameters |   infinite_costs: 0
20:47:42.499 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:42.499 |     INFO |       log_parameters |   min_distance: 21.17433857888652
20:47:42.499 |     INFO |       log_parameters |   max_distance: 126.81992902513038
20:47:42.499 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:42.499 |     INFO |       log_parameters |   motion_costs_shape: (59, 48)
20:47:42.499 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:42.499 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:42.500 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:42.500 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:42.500 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:42.501 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:42.501 |     INFO |       log_parameters |   coords_shape: (59, 2)
20:47:42.501 |     INFO |       log_parameters |   uncertainties_shape: (59, 2)
20:47:42.501 |     INFO |       log_parameters |   mean_uncertainty: 0.318494593220339
20:47:42.501 |     INFO |       log_parameters |   uncertainty_range: [0.198487, 0.356748]
20:47:42.501 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:42.501 |     INFO |       log_parameters |   coords_shape: (48, 2)
20:47:42.501 |     INFO |       log_parameters |   uncertainties_shape: (48, 2)
20:47:42.501 |     INFO |       log_parameters |   mean_uncertainty: 0.3150543333333334
20:47:42.501 |     INFO |       log_parameters |   uncertainty_range: [0.193681, 0.354293]
20:47:42.501 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:42.501 |     INFO |       log_parameters |   feature_costs_shape: (59, 48)
20:47:42.501 |     INFO |       log_parameters |   feature_costs_min: 1.00000974036953
20:47:42.501 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:42.501 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:42.501 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:42.501 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:42.501 |     INFO |       log_parameters |   original_shape: (59, 48)
20:47:42.502 |     INFO |       log_parameters |   augmented_shape: (107, 107)
20:47:42.502 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:42.502 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:42.502 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:42.502 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:42.502 |    DEBUG |            log_debug |   observed_positions.shape: (48, 2)
20:47:42.502 |    DEBUG |            log_debug |   num_features (from observed_positions): 48
20:47:42.502 |    DEBUG |            log_debug |   predicted_positions.shape: (59, 2)
20:47:42.502 |    DEBUG |            log_debug |   predicted_velocities.shape: (59, 2)
20:47:42.502 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (48, 4)
20:47:42.502 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=48 but predicted_positions has 59 rows
20:47:42.502 |    ERROR |            log_error |   This will cause index 47 to fail when array only goes to 58
20:47:42.502 |    DEBUG |            log_debug | Kalman update: 48 features, state_dim=4, prob_dim=2
20:47:42.502 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman update):
20:47:42.502 |     INFO |       log_parameters |   features_updated: 48
20:47:42.502 |     INFO |       log_parameters |   state_dim: 4
20:47:42.502 |     INFO |       log_parameters |   dt_used: 1.0
20:47:42.502 |     INFO |       log_parameters |   process_noise_scale: 1.0
20:47:42.502 |     INFO |       log_parameters |   measurement_noise_scale: 1.0
20:47:42.502 |     INFO |             log_info | Enhanced linking completed successfully for frame 94
20:47:42.502 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0049 seconds
20:47:42.688 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=95, prob_dim=2, num_features_frame1=48, num_features_frame2=65)
20:47:42.688 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:42.688 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:42.688 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:42.688 |     INFO |       log_parameters |   current_frame: 95
20:47:42.688 |     INFO |       log_parameters |   prob_dim: 2
20:47:42.688 |     INFO |       log_parameters |   num_features_frame1: 48
20:47:42.688 |     INFO |       log_parameters |   num_features_frame2: 65
20:47:42.688 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:42.688 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:42.688 |     INFO |       log_parameters |   linear_motion: 1
20:47:42.688 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:42.688 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:42.688 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:42.688 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:42.688 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:42.688 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:42.688 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:42.688 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:42.688 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:42.688 |     INFO |       log_parameters |   use_local_density: 0
20:47:42.688 |     INFO |       log_parameters |   nn_window: 5
20:47:42.689 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:42.689 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:42.689 |     INFO |       log_parameters |   len_for_classify: 5
20:47:42.689 |     INFO |       log_parameters |   res_limit: 0.1
20:47:42.689 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:42.689 |     INFO |       log_parameters |   strategy_bd: -1
20:47:42.689 |     INFO |       log_parameters |   lft_cdf: None
20:47:42.689 |     INFO |       log_parameters |   kalman_init_param: None
20:47:42.689 |     INFO |       log_parameters |   diagnostics: None
20:47:42.689 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:42.689 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:42.689 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:42.689 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:42.689 |     INFO |       log_parameters |   coords_shape: (48, 2)
20:47:42.689 |     INFO |       log_parameters |   uncertainties_shape: (48, 2)
20:47:42.689 |     INFO |       log_parameters |   mean_uncertainty: 0.3150543333333334
20:47:42.689 |     INFO |       log_parameters |   uncertainty_range: [0.193681, 0.354293]
20:47:42.689 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:42.689 |     INFO |       log_parameters |   coords_shape: (65, 2)
20:47:42.689 |     INFO |       log_parameters |   uncertainties_shape: (65, 2)
20:47:42.689 |     INFO |       log_parameters |   mean_uncertainty: 0.32088913076923076
20:47:42.689 |     INFO |       log_parameters |   uncertainty_range: [0.196301, 0.354662]
20:47:42.689 |    DEBUG |            log_debug | Initializing Kalman for 65 features, prob_dim=2, state_dim=4
20:47:42.689 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:42.689 |     INFO |       log_parameters |   num_features: 65
20:47:42.689 |     INFO |       log_parameters |   state_dim: 4
20:47:42.689 |     INFO |       log_parameters |   prob_dim: 2
20:47:42.689 |     INFO |       log_parameters |   state_vec_shape: (65, 4)
20:47:42.689 |     INFO |       log_parameters |   state_noise_var_shape: (65, 4, 4)
20:47:42.689 |    DEBUG |            log_debug | State vector shape: (48, 4), Expected: (48, 4)
20:47:42.689 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:42.689 |     INFO |       log_parameters |   num_features_predicted: 48
20:47:42.689 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:42.689 |     INFO |       log_parameters |   brownian_motion_features: 48
20:47:42.689 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:42.689 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:42.689 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:42.689 |     INFO |       log_parameters |   search_radii_shape: (48, 2)
20:47:42.689 |     INFO |       log_parameters |   min_radius: 0.1
20:47:42.689 |     INFO |       log_parameters |   max_radius: 0.1
20:47:42.689 |     INFO |       log_parameters |   mean_radius: 0.09999999999999999
20:47:42.689 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:42.689 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999999
20:47:42.690 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:42.690 |     INFO |       log_parameters |   distance_matrix_shape: (48, 65)
20:47:42.690 |     INFO |       log_parameters |   cost_matrix_shape: (48, 65)
20:47:42.690 |     INFO |       log_parameters |   finite_costs: 3120
20:47:42.690 |     INFO |       log_parameters |   infinite_costs: 0
20:47:42.690 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:42.690 |     INFO |       log_parameters |   min_distance: 3.107437671973647
20:47:42.690 |     INFO |       log_parameters |   max_distance: 133.60318760084257
20:47:42.690 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:42.690 |     INFO |       log_parameters |   motion_costs_shape: (48, 65)
20:47:42.690 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:42.690 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:42.690 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:42.690 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:42.690 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:42.692 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:42.692 |     INFO |       log_parameters |   coords_shape: (48, 2)
20:47:42.692 |     INFO |       log_parameters |   uncertainties_shape: (48, 2)
20:47:42.692 |     INFO |       log_parameters |   mean_uncertainty: 0.3150543333333334
20:47:42.692 |     INFO |       log_parameters |   uncertainty_range: [0.193681, 0.354293]
20:47:42.692 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:42.692 |     INFO |       log_parameters |   coords_shape: (65, 2)
20:47:42.692 |     INFO |       log_parameters |   uncertainties_shape: (65, 2)
20:47:42.692 |     INFO |       log_parameters |   mean_uncertainty: 0.32088913076923076
20:47:42.692 |     INFO |       log_parameters |   uncertainty_range: [0.196301, 0.354662]
20:47:42.693 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:42.693 |     INFO |       log_parameters |   feature_costs_shape: (48, 65)
20:47:42.693 |     INFO |       log_parameters |   feature_costs_min: 1.0000423874055757
20:47:42.693 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:42.693 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:42.693 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:42.693 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:42.693 |     INFO |       log_parameters |   original_shape: (48, 65)
20:47:42.693 |     INFO |       log_parameters |   augmented_shape: (113, 113)
20:47:42.693 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:42.693 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:42.693 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:42.693 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:42.693 |    DEBUG |            log_debug |   observed_positions.shape: (65, 2)
20:47:42.693 |    DEBUG |            log_debug |   num_features (from observed_positions): 65
20:47:42.693 |    DEBUG |            log_debug |   predicted_positions.shape: (48, 2)
20:47:42.693 |    DEBUG |            log_debug |   predicted_velocities.shape: (48, 2)
20:47:42.693 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (65, 4)
20:47:42.693 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=65 but predicted_positions has 48 rows
20:47:42.693 |    ERROR |            log_error |   This will cause index 64 to fail when array only goes to 47
20:47:42.693 |    DEBUG |            log_debug | Kalman update: 65 features, state_dim=4, prob_dim=2
20:47:42.694 |    ERROR |            log_error | Error in enhanced linking: index 48 is out of bounds for axis 0 with size 48
20:47:42.694 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 48 is out of bounds for axis 0 with size 48
20:47:42.694 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0055 seconds
20:47:42.704 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=96, prob_dim=2, num_features_frame1=65, num_features_frame2=55)
20:47:42.704 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:42.704 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:42.704 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:42.704 |     INFO |       log_parameters |   current_frame: 96
20:47:42.704 |     INFO |       log_parameters |   prob_dim: 2
20:47:42.704 |     INFO |       log_parameters |   num_features_frame1: 65
20:47:42.704 |     INFO |       log_parameters |   num_features_frame2: 55
20:47:42.704 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:42.704 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:42.704 |     INFO |       log_parameters |   linear_motion: 1
20:47:42.704 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:42.704 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:42.704 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:42.704 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:42.704 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:42.704 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:42.704 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:42.704 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:42.704 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:42.704 |     INFO |       log_parameters |   use_local_density: 0
20:47:42.704 |     INFO |       log_parameters |   nn_window: 5
20:47:42.704 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:42.704 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:42.704 |     INFO |       log_parameters |   len_for_classify: 5
20:47:42.704 |     INFO |       log_parameters |   res_limit: 0.1
20:47:42.704 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:42.704 |     INFO |       log_parameters |   strategy_bd: -1
20:47:42.704 |     INFO |       log_parameters |   lft_cdf: None
20:47:42.704 |     INFO |       log_parameters |   kalman_init_param: None
20:47:42.704 |     INFO |       log_parameters |   diagnostics: None
20:47:42.704 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:42.704 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:42.704 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:42.704 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:42.704 |     INFO |       log_parameters |   coords_shape: (65, 2)
20:47:42.704 |     INFO |       log_parameters |   uncertainties_shape: (65, 2)
20:47:42.704 |     INFO |       log_parameters |   mean_uncertainty: 0.32088913076923076
20:47:42.704 |     INFO |       log_parameters |   uncertainty_range: [0.196301, 0.354662]
20:47:42.704 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:42.704 |     INFO |       log_parameters |   coords_shape: (55, 2)
20:47:42.704 |     INFO |       log_parameters |   uncertainties_shape: (55, 2)
20:47:42.704 |     INFO |       log_parameters |   mean_uncertainty: 0.31766739090909096
20:47:42.704 |     INFO |       log_parameters |   uncertainty_range: [0.196299, 0.357206]
20:47:42.704 |    DEBUG |            log_debug | Initializing Kalman for 55 features, prob_dim=2, state_dim=4
20:47:42.704 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:42.704 |     INFO |       log_parameters |   num_features: 55
20:47:42.704 |     INFO |       log_parameters |   state_dim: 4
20:47:42.704 |     INFO |       log_parameters |   prob_dim: 2
20:47:42.704 |     INFO |       log_parameters |   state_vec_shape: (55, 4)
20:47:42.704 |     INFO |       log_parameters |   state_noise_var_shape: (55, 4, 4)
20:47:42.704 |    DEBUG |            log_debug | State vector shape: (65, 4), Expected: (65, 4)
20:47:42.705 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:42.705 |     INFO |       log_parameters |   num_features_predicted: 65
20:47:42.705 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:42.705 |     INFO |       log_parameters |   brownian_motion_features: 65
20:47:42.705 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:42.705 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:42.705 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:42.705 |     INFO |       log_parameters |   search_radii_shape: (65, 2)
20:47:42.705 |     INFO |       log_parameters |   min_radius: 0.1
20:47:42.705 |     INFO |       log_parameters |   max_radius: 0.1
20:47:42.705 |     INFO |       log_parameters |   mean_radius: 0.09999999999999999
20:47:42.705 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:42.705 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999999
20:47:42.706 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:42.706 |     INFO |       log_parameters |   distance_matrix_shape: (65, 55)
20:47:42.706 |     INFO |       log_parameters |   cost_matrix_shape: (65, 55)
20:47:42.706 |     INFO |       log_parameters |   finite_costs: 3575
20:47:42.706 |     INFO |       log_parameters |   infinite_costs: 0
20:47:42.706 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:42.706 |     INFO |       log_parameters |   min_distance: 7.73362283713222
20:47:42.706 |     INFO |       log_parameters |   max_distance: 126.78363703706081
20:47:42.706 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:42.706 |     INFO |       log_parameters |   motion_costs_shape: (65, 55)
20:47:42.706 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:42.706 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:42.706 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:42.706 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:42.706 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:42.708 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:42.708 |     INFO |       log_parameters |   coords_shape: (65, 2)
20:47:42.708 |     INFO |       log_parameters |   uncertainties_shape: (65, 2)
20:47:42.708 |     INFO |       log_parameters |   mean_uncertainty: 0.32088913076923076
20:47:42.708 |     INFO |       log_parameters |   uncertainty_range: [0.196301, 0.354662]
20:47:42.708 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:42.708 |     INFO |       log_parameters |   coords_shape: (55, 2)
20:47:42.708 |     INFO |       log_parameters |   uncertainties_shape: (55, 2)
20:47:42.708 |     INFO |       log_parameters |   mean_uncertainty: 0.31766739090909096
20:47:42.708 |     INFO |       log_parameters |   uncertainty_range: [0.196299, 0.357206]
20:47:42.708 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:42.708 |     INFO |       log_parameters |   feature_costs_shape: (65, 55)
20:47:42.708 |     INFO |       log_parameters |   feature_costs_min: 1.000189448326917
20:47:42.708 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:42.708 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:42.708 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:42.708 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:42.708 |     INFO |       log_parameters |   original_shape: (65, 55)
20:47:42.708 |     INFO |       log_parameters |   augmented_shape: (120, 120)
20:47:42.708 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:42.709 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:42.709 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:42.709 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:42.709 |    DEBUG |            log_debug |   observed_positions.shape: (55, 2)
20:47:42.709 |    DEBUG |            log_debug |   num_features (from observed_positions): 55
20:47:42.709 |    DEBUG |            log_debug |   predicted_positions.shape: (65, 2)
20:47:42.709 |    DEBUG |            log_debug |   predicted_velocities.shape: (65, 2)
20:47:42.709 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (55, 4)
20:47:42.709 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=55 but predicted_positions has 65 rows
20:47:42.709 |    ERROR |            log_error |   This will cause index 54 to fail when array only goes to 64
20:47:42.709 |    DEBUG |            log_debug | Kalman update: 55 features, state_dim=4, prob_dim=2
20:47:42.710 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman update):
20:47:42.710 |     INFO |       log_parameters |   features_updated: 55
20:47:42.710 |     INFO |       log_parameters |   state_dim: 4
20:47:42.710 |     INFO |       log_parameters |   dt_used: 1.0
20:47:42.710 |     INFO |       log_parameters |   process_noise_scale: 1.0
20:47:42.710 |     INFO |       log_parameters |   measurement_noise_scale: 1.0
20:47:42.710 |     INFO |             log_info | Enhanced linking completed successfully for frame 96
20:47:42.710 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0058 seconds
20:47:42.944 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=97, prob_dim=2, num_features_frame1=55, num_features_frame2=58)
20:47:42.944 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:42.944 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:42.944 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:42.944 |     INFO |       log_parameters |   current_frame: 97
20:47:42.944 |     INFO |       log_parameters |   prob_dim: 2
20:47:42.944 |     INFO |       log_parameters |   num_features_frame1: 55
20:47:42.944 |     INFO |       log_parameters |   num_features_frame2: 58
20:47:42.944 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:42.944 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:42.944 |     INFO |       log_parameters |   linear_motion: 1
20:47:42.944 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:42.944 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:42.944 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:42.944 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:42.944 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:42.944 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:42.944 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:42.944 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:42.944 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:42.944 |     INFO |       log_parameters |   use_local_density: 0
20:47:42.944 |     INFO |       log_parameters |   nn_window: 5
20:47:42.944 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:42.944 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:42.944 |     INFO |       log_parameters |   len_for_classify: 5
20:47:42.944 |     INFO |       log_parameters |   res_limit: 0.1
20:47:42.944 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:42.944 |     INFO |       log_parameters |   strategy_bd: -1
20:47:42.944 |     INFO |       log_parameters |   lft_cdf: None
20:47:42.944 |     INFO |       log_parameters |   kalman_init_param: None
20:47:42.944 |     INFO |       log_parameters |   diagnostics: None
20:47:42.944 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:42.944 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:42.944 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:42.944 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:42.944 |     INFO |       log_parameters |   coords_shape: (55, 2)
20:47:42.944 |     INFO |       log_parameters |   uncertainties_shape: (55, 2)
20:47:42.944 |     INFO |       log_parameters |   mean_uncertainty: 0.31766739090909096
20:47:42.944 |     INFO |       log_parameters |   uncertainty_range: [0.196299, 0.357206]
20:47:42.944 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:42.944 |     INFO |       log_parameters |   coords_shape: (58, 2)
20:47:42.944 |     INFO |       log_parameters |   uncertainties_shape: (58, 2)
20:47:42.944 |     INFO |       log_parameters |   mean_uncertainty: 0.3196121810344828
20:47:42.944 |     INFO |       log_parameters |   uncertainty_range: [0.189915, 0.360835]
20:47:42.944 |    DEBUG |            log_debug | Initializing Kalman for 58 features, prob_dim=2, state_dim=4
20:47:42.944 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:42.944 |     INFO |       log_parameters |   num_features: 58
20:47:42.944 |     INFO |       log_parameters |   state_dim: 4
20:47:42.944 |     INFO |       log_parameters |   prob_dim: 2
20:47:42.944 |     INFO |       log_parameters |   state_vec_shape: (58, 4)
20:47:42.944 |     INFO |       log_parameters |   state_noise_var_shape: (58, 4, 4)
20:47:42.944 |    DEBUG |            log_debug | State vector shape: (55, 4), Expected: (55, 4)
20:47:42.945 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:42.945 |     INFO |       log_parameters |   num_features_predicted: 55
20:47:42.945 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:42.945 |     INFO |       log_parameters |   brownian_motion_features: 55
20:47:42.945 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:42.945 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:42.945 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:42.945 |     INFO |       log_parameters |   search_radii_shape: (55, 2)
20:47:42.945 |     INFO |       log_parameters |   min_radius: 0.1
20:47:42.945 |     INFO |       log_parameters |   max_radius: 0.1
20:47:42.945 |     INFO |       log_parameters |   mean_radius: 0.09999999999999998
20:47:42.945 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:42.945 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999998
20:47:42.946 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:42.946 |     INFO |       log_parameters |   distance_matrix_shape: (55, 58)
20:47:42.946 |     INFO |       log_parameters |   cost_matrix_shape: (55, 58)
20:47:42.946 |     INFO |       log_parameters |   finite_costs: 3190
20:47:42.946 |     INFO |       log_parameters |   infinite_costs: 0
20:47:42.946 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:42.946 |     INFO |       log_parameters |   min_distance: 16.793358999417656
20:47:42.946 |     INFO |       log_parameters |   max_distance: 134.39637965744052
20:47:42.946 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:42.946 |     INFO |       log_parameters |   motion_costs_shape: (55, 58)
20:47:42.946 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:42.946 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:42.946 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:42.946 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:42.946 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:42.948 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:42.948 |     INFO |       log_parameters |   coords_shape: (55, 2)
20:47:42.948 |     INFO |       log_parameters |   uncertainties_shape: (55, 2)
20:47:42.948 |     INFO |       log_parameters |   mean_uncertainty: 0.31766739090909096
20:47:42.948 |     INFO |       log_parameters |   uncertainty_range: [0.196299, 0.357206]
20:47:42.948 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:42.948 |     INFO |       log_parameters |   coords_shape: (58, 2)
20:47:42.948 |     INFO |       log_parameters |   uncertainties_shape: (58, 2)
20:47:42.948 |     INFO |       log_parameters |   mean_uncertainty: 0.3196121810344828
20:47:42.948 |     INFO |       log_parameters |   uncertainty_range: [0.189915, 0.360835]
20:47:42.948 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:42.948 |     INFO |       log_parameters |   feature_costs_shape: (55, 58)
20:47:42.948 |     INFO |       log_parameters |   feature_costs_min: 1.0002558938248993
20:47:42.948 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:42.948 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:42.948 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:42.948 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:42.948 |     INFO |       log_parameters |   original_shape: (55, 58)
20:47:42.948 |     INFO |       log_parameters |   augmented_shape: (113, 113)
20:47:42.948 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:42.948 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:42.948 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:42.948 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:42.948 |    DEBUG |            log_debug |   observed_positions.shape: (58, 2)
20:47:42.948 |    DEBUG |            log_debug |   num_features (from observed_positions): 58
20:47:42.948 |    DEBUG |            log_debug |   predicted_positions.shape: (55, 2)
20:47:42.948 |    DEBUG |            log_debug |   predicted_velocities.shape: (55, 2)
20:47:42.948 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (58, 4)
20:47:42.948 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=58 but predicted_positions has 55 rows
20:47:42.948 |    ERROR |            log_error |   This will cause index 57 to fail when array only goes to 54
20:47:42.948 |    DEBUG |            log_debug | Kalman update: 58 features, state_dim=4, prob_dim=2
20:47:42.949 |    ERROR |            log_error | Error in enhanced linking: index 55 is out of bounds for axis 0 with size 55
20:47:42.949 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 55 is out of bounds for axis 0 with size 55
20:47:42.950 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0056 seconds
20:47:42.960 |    DEBUG |    log_function_call | CALL: enhanced_cost_mat_link(movie_info_frames=2, kalman_info_keys=['num_features', 'state_vec', 'state_noise_var', 'observation_vec'], current_frame=98, prob_dim=2, num_features_frame1=58, num_features_frame2=59)
20:47:42.960 |     INFO |       log_parameters | PARAMETERS (enhanced linking inputs):
20:47:42.960 |     INFO |       log_parameters |   movie_info_frames: 2
20:47:42.960 |     INFO |       log_parameters |   kalman_info_keys: ['num_features', 'state_vec', 'state_noise_var', 'observation_vec']
20:47:42.960 |     INFO |       log_parameters |   current_frame: 98
20:47:42.960 |     INFO |       log_parameters |   prob_dim: 2
20:47:42.960 |     INFO |       log_parameters |   num_features_frame1: 58
20:47:42.960 |     INFO |       log_parameters |   num_features_frame2: 59
20:47:42.960 |    DEBUG |            __enter__ | TIMING: Starting Enhanced linking cost matrix calculation
20:47:42.960 |     INFO |       log_parameters | PARAMETERS (validated parameters):
20:47:42.960 |     INFO |       log_parameters |   linear_motion: 1
20:47:42.960 |     INFO |       log_parameters |   min_search_radius: 0.1
20:47:42.960 |     INFO |       log_parameters |   max_search_radius: 1.0
20:47:42.960 |     INFO |       log_parameters |   brown_std_mult: 1.0
20:47:42.960 |     INFO |       log_parameters |   brown_scaling: [0.25, 0.01]
20:47:42.960 |     INFO |       log_parameters |   time_reach_conf_b: 2
20:47:42.960 |     INFO |       log_parameters |   lin_std_mult: [1. 1. 1. 1. 1.]
20:47:42.960 |     INFO |       log_parameters |   lin_scaling: [1.0, 0.01]
20:47:42.960 |     INFO |       log_parameters |   time_reach_conf_l: 2
20:47:42.960 |     INFO |       log_parameters |   max_angle_vv: 5.0
20:47:42.960 |     INFO |       log_parameters |   use_local_density: 0
20:47:42.960 |     INFO |       log_parameters |   nn_window: 5
20:47:42.960 |     INFO |       log_parameters |   amp_ratio_limit: [0.1, 1.0]
20:47:42.960 |     INFO |       log_parameters |   gap_penalty: 1.5
20:47:42.960 |     INFO |       log_parameters |   len_for_classify: 5
20:47:42.960 |     INFO |       log_parameters |   res_limit: 0.1
20:47:42.960 |     INFO |       log_parameters |   gap_exclude_ms: 1
20:47:42.960 |     INFO |       log_parameters |   strategy_bd: -1
20:47:42.960 |     INFO |       log_parameters |   lft_cdf: None
20:47:42.960 |     INFO |       log_parameters |   kalman_init_param: None
20:47:42.960 |     INFO |       log_parameters |   diagnostics: None
20:47:42.960 |     INFO |       log_parameters |   logger: <Logger utrack.track_general (DEBUG)>
20:47:42.960 |     INFO |       log_parameters |   velocity_weight: 1.0
20:47:42.960 |     INFO |       log_parameters |   diffusion_weight: 1.0
20:47:42.960 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:42.960 |     INFO |       log_parameters |   coords_shape: (58, 2)
20:47:42.960 |     INFO |       log_parameters |   uncertainties_shape: (58, 2)
20:47:42.960 |     INFO |       log_parameters |   mean_uncertainty: 0.3196121810344828
20:47:42.960 |     INFO |       log_parameters |   uncertainty_range: [0.189915, 0.360835]
20:47:42.960 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:42.960 |     INFO |       log_parameters |   coords_shape: (59, 2)
20:47:42.961 |     INFO |       log_parameters |   uncertainties_shape: (59, 2)
20:47:42.961 |     INFO |       log_parameters |   mean_uncertainty: 0.32034306779661026
20:47:42.961 |     INFO |       log_parameters |   uncertainty_range: [0.192717, 0.36198]
20:47:42.961 |    DEBUG |            log_debug | Initializing Kalman for 59 features, prob_dim=2, state_dim=4
20:47:42.961 |     INFO |       log_parameters | PARAMETERS (enhanced Kalman initialization):
20:47:42.961 |     INFO |       log_parameters |   num_features: 59
20:47:42.961 |     INFO |       log_parameters |   state_dim: 4
20:47:42.961 |     INFO |       log_parameters |   prob_dim: 2
20:47:42.961 |     INFO |       log_parameters |   state_vec_shape: (59, 4)
20:47:42.961 |     INFO |       log_parameters |   state_noise_var_shape: (59, 4, 4)
20:47:42.961 |    DEBUG |            log_debug | State vector shape: (58, 4), Expected: (58, 4)
20:47:42.961 |     INFO |       log_parameters | PARAMETERS (enhanced motion prediction):
20:47:42.961 |     INFO |       log_parameters |   num_features_predicted: 58
20:47:42.961 |     INFO |       log_parameters |   directed_motion_features: 0
20:47:42.961 |     INFO |       log_parameters |   brownian_motion_features: 58
20:47:42.961 |     INFO |       log_parameters |   mean_motion_confidence: 0.0
20:47:42.961 |     INFO |       log_parameters |   mean_velocity_magnitude: 0.0
20:47:42.961 |     INFO |       log_parameters | PARAMETERS (enhanced search radii):
20:47:42.961 |     INFO |       log_parameters |   search_radii_shape: (58, 2)
20:47:42.961 |     INFO |       log_parameters |   min_radius: 0.1
20:47:42.961 |     INFO |       log_parameters |   max_radius: 0.1
20:47:42.961 |     INFO |       log_parameters |   mean_radius: 0.09999999999999999
20:47:42.961 |     INFO |       log_parameters |   directed_motion_mean_radius: 0
20:47:42.961 |     INFO |       log_parameters |   brownian_motion_mean_radius: 0.09999999999999999
20:47:42.962 |     INFO |       log_parameters | PARAMETERS (enhanced distance costs):
20:47:42.962 |     INFO |       log_parameters |   distance_matrix_shape: (58, 59)
20:47:42.962 |     INFO |       log_parameters |   cost_matrix_shape: (58, 59)
20:47:42.962 |     INFO |       log_parameters |   finite_costs: 3422
20:47:42.962 |     INFO |       log_parameters |   infinite_costs: 0
20:47:42.962 |     INFO |       log_parameters |   mean_finite_cost: 1000000.0
20:47:42.962 |     INFO |       log_parameters |   min_distance: 7.607999099269399
20:47:42.962 |     INFO |       log_parameters |   max_distance: 131.0274121214452
20:47:42.962 |     INFO |       log_parameters | PARAMETERS (enhanced motion costs):
20:47:42.962 |     INFO |       log_parameters |   motion_costs_shape: (58, 59)
20:47:42.962 |     INFO |       log_parameters |   motion_costs_min: 1.0
20:47:42.962 |     INFO |       log_parameters |   motion_costs_max: 1.0
20:47:42.962 |     INFO |       log_parameters |   motion_costs_mean: 1.0
20:47:42.962 |     INFO |       log_parameters |   features_with_motion_constraints: 0
20:47:42.962 |     INFO |       log_parameters |   high_confidence_motion_features: 0
20:47:42.964 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:42.964 |     INFO |       log_parameters |   coords_shape: (58, 2)
20:47:42.964 |     INFO |       log_parameters |   uncertainties_shape: (58, 2)
20:47:42.964 |     INFO |       log_parameters |   mean_uncertainty: 0.3196121810344828
20:47:42.964 |     INFO |       log_parameters |   uncertainty_range: [0.189915, 0.360835]
20:47:42.964 |     INFO |       log_parameters | PARAMETERS (coordinate extraction with uncertainties):
20:47:42.964 |     INFO |       log_parameters |   coords_shape: (59, 2)
20:47:42.964 |     INFO |       log_parameters |   uncertainties_shape: (59, 2)
20:47:42.964 |     INFO |       log_parameters |   mean_uncertainty: 0.32034306779661026
20:47:42.964 |     INFO |       log_parameters |   uncertainty_range: [0.192717, 0.36198]
20:47:42.965 |     INFO |       log_parameters | PARAMETERS (enhanced feature costs):
20:47:42.965 |     INFO |       log_parameters |   feature_costs_shape: (58, 59)
20:47:42.965 |     INFO |       log_parameters |   feature_costs_min: 1.00000013628481
20:47:42.965 |     INFO |       log_parameters |   feature_costs_max: 15.0
20:47:42.965 |     INFO |       log_parameters |   amplitude_constraints_applied: True
20:47:42.965 |     INFO |       log_parameters |   resolution_constraints_applied: True
20:47:42.965 |     INFO |       log_parameters | PARAMETERS (enhanced matrix augmentation):
20:47:42.965 |     INFO |       log_parameters |   original_shape: (58, 59)
20:47:42.965 |     INFO |       log_parameters |   augmented_shape: (117, 117)
20:47:42.965 |     INFO |       log_parameters |   birth_death_cost: 1.0
20:47:42.965 |     INFO |       log_parameters |   nonlink_marker: -5
20:47:42.965 |     INFO |       log_parameters |   valid_linking_costs: 0
20:47:42.965 |    DEBUG |            log_debug | 
DEBUG _update_enhanced_kalman:
20:47:42.965 |    DEBUG |            log_debug |   observed_positions.shape: (59, 2)
20:47:42.965 |    DEBUG |            log_debug |   num_features (from observed_positions): 59
20:47:42.965 |    DEBUG |            log_debug |   predicted_positions.shape: (58, 2)
20:47:42.965 |    DEBUG |            log_debug |   predicted_velocities.shape: (58, 2)
20:47:42.965 |    DEBUG |            log_debug |   kalman_info_next['state_vec'].shape: (59, 4)
20:47:42.965 |    ERROR |            log_error |   ERROR: Size mismatch! num_features=59 but predicted_positions has 58 rows
20:47:42.965 |    ERROR |            log_error |   This will cause index 58 to fail when array only goes to 57
20:47:42.965 |    DEBUG |            log_debug | Kalman update: 59 features, state_dim=4, prob_dim=2
20:47:42.966 |    ERROR |            log_error | Error in enhanced linking: index 58 is out of bounds for axis 0 with size 58
20:47:42.966 |    ERROR | cost_mat_random_directed_switching_motion_link | Full traceback:
Traceback (most recent call last):
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 257, in cost_mat_random_directed_switching_motion_link
    kalman_info_next = self._update_enhanced_kalman(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/george/.FLIKA/plugins/utrack_tracking/cost_matrices.py", line 911, in _update_enhanced_kalman
    current_state[2*d] = motion_predictions['predicted_positions'][i, d]     # position
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
IndexError: index 58 is out of bounds for axis 0 with size 58
20:47:42.966 |     INFO |             __exit__ | TIMING: Enhanced linking cost matrix calculation completed in 0.0058 seconds
